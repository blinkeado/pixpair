<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PixCrab - Synchronized Photo Capture</title>
    <link rel="stylesheet" href="dist/output.css">
    <!-- Third-party libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    
    <!-- Firebase configuration -->
    <script src="firebase-config.js"></script>
    
    <!-- Application script (MCP architecture) -->
    <script type="module" src="src/app.js"></script>
    
    <!-- App configuration constant - needed for QR generation -->
    <script>
        window.APP_BASE_URL = 'https://pixcrab.netlify.app';
    </script>
</head>
<body>
    <div class="container">
        <!-- Authentication Section -->
        <div id="authSection" class="hidden">
            <div class="auth-logo">PixCrab</div>
            <div class="auth-message">Sync photos with friends in real-time</div>
            <div class="auth-buttons">
                <button id="googleSignIn" class="auth-btn">
                    <svg width="24" height="24" viewBox="0 0 24 24" class="mr-2">
                        <path fill="currentColor" d="M12.24 10.285V14.4h6.806c-.275 1.765-2.056 5.174-6.806 5.174-4.095 0-7.439-3.389-7.439-7.574s3.345-7.574 7.439-7.574c2.33 0 3.891.989 4.785 1.849l3.254-3.138C18.189 1.186 15.479 0 12.24 0c-6.635 0-12 5.365-12 12s5.365 12 12 12c6.926 0 11.52-4.869 11.52-11.726 0-.788-.085-1.39-.189-1.989H12.24z"/>
                    </svg>
                    Continue with Google
                </button>
                <button id="appleSignIn" class="auth-btn">
                    <svg width="24" height="24" viewBox="0 0 24 24" class="mr-2">
                        <path fill="currentColor" d="M17.05 20.28a9.85 9.85 0 0 1-.98 1.8c-.52.74-1.05 1.32-1.59 1.74-.85.7-1.73 1.06-2.64 1.07-68 0-1.5-.19-2.45-.58-96-.39-1.83-.58-2.63-.58-.83 0-1.73.2-2.71.6-.97.39-1.8.59-2.48.59s-1.52-.2-2.46-.61c-.95-.4-1.73-.61-2.35-.63-.9-.03-1.8-.38-2.68-1.06-.58-.44-1.16-1.04-1.73-1.81a11.2 11.2 0 0 1-1.21-2.27c-.41-.94-.73-2.03-.98-3.25-.27-1.3-.4-2.64-.4-4.01 0-1.6.34-3 1.03-4.2.54-.95 1.26-1.7 2.17-2.27.9-.57 1.9-.86 2.99-.88.6 0 1.37.12 2.33.35.95.23 1.56.35 1.84.35.2 0 .88-.14 2.05-.42 1.1-.25 2.02-.36 2.78-.33 2.06.16 3.6.95 4.63 2.38-1.84 1.12-2.75 2.69-2.75 4.7 0 1.57.58 2.87 1.72 3.9.52.5 1.09.89 1.73 1.18-.14.4-.28.79-.44 1.16zM12.92.02c0 .23-.02.47-.05.7-.04.24-.1.5-.19.75-.33 1.07-.9 1.99-1.72 2.75-.93.81-1.9 1.21-2.9 1.15-.05-.42-.08-.82-.08-1.2 0-.27.03-.57.09-.91.05-.34.14-.67.26-1 .12-.32.28-.63.48-.92.2-.3.4-.55.62-.75.22-.2.48-.4.76-.58.28-.18.52-.31.74-.39.22-.08.5-.16.83-.23.33-.07.58-.1.76-.11h.32z"/>
                    </svg>
                    Continue with Apple
                </button>
                <button id="guestSignIn" class="auth-btn">
                    <svg width="24" height="24" viewBox="0 0 24 24" class="mr-2">
                        <path fill="currentColor" d="M12 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                    </svg>
                    Continue as Guest
                </button>
            </div>
        </div>
        
        <!-- Session Setup Section -->
        <div id="sessionSetup" class="hidden">
            <div class="session-logo">PixCrab</div>
            <div class="session-message">Capture photos with friends in perfect sync</div>
            <div class="session-input">
                <input type="text" id="sessionId" placeholder="Enter Session ID" maxlength="10">
                <button id="joinSession" disabled>Join</button>
            </div>
            <button id="createSession" disabled>Create New Session</button>
            <button id="viewGalleryBtn" class="gallery-btn">View Gallery</button>
            <p class="text-sm text-gray-300">Share the session ID with a friend to sync photos</p>
            
            <button id="signOutBtn">Sign Out</button>
        </div>
        
        <!-- Camera Section -->
        <div id="cameraSection" class="hidden">
            <div class="camera-header">
                <h1 class="text-2xl font-bold text-secondary">PixCrab</h1>
                <div class="session-badge" id="sessionIdBadge">
                    <span id="displaySessionId"></span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="ml-1" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
                        <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
                    </svg>
                </div>
                <div class="flex space-x-4">
                    <button id="galleryBtn" class="btn-secondary px-3 py-1 rounded-lg text-sm">Gallery</button>
                    <button id="profileBtn" class="btn-secondary px-3 py-1 rounded-lg text-sm">Profile</button>
                    <button id="cameraSignOutBtn" class="btn-secondary px-3 py-1 rounded-lg text-sm">Sign Out</button>
                </div>
            </div>
            
            <div id="slideContainer">
                <div class="slide">
                    <div class="camera-feed-container">
                        <video id="cameraFeed" autoplay playsinline></video>
                        <img id="photoResult" alt="Photo result">
                        
                        <div id="countdownOverlay" class="hidden">
                            <div id="countdownText" class="hidden">3</div>
                            <div id="captureText" class="hidden">Snap!</div>
                        </div>
                        
                        <button id="cameraSwitchBtn" class="hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7"></path>
                                <line x1="16" y1="5" x2="22" y2="5"></line>
                                <line x1="19" y1="2" x2="19" y2="8"></line>
                                <circle cx="9" cy="9" r="3"></circle>
                                <path d="M13 13L9 9"></path>
                            </svg>
                        </button>
                        
                        <div id="qrcode" class="hidden"></div>
                        <div id="qrFallback" class="hidden"></div>
                        
                        <div id="hintText">Swipe up to view photos</div>
                        
                        <div id="gallerySection" class="hidden"></div>
                        
                        <div id="imageQualityInfo" class="hidden">
                            <span id="imageSize">0</span> KB
                        </div>
                    </div>
                    
                    <div class="camera-controls">
                        <button id="newSessionBtn">Exit</button>
                        <button id="captureBtn" disabled></button>
                        <div class="w-20"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- New Dedicated Gallery Section -->
        <div id="galleryFullScreen" class="hidden fixed inset-0 bg-primary z-50 overflow-y-auto">
            <div class="flex justify-between items-center w-full p-4 bg-primary shadow-md">
                <h1 class="text-2xl font-bold text-secondary">Photo Gallery</h1>
                <button id="closeGalleryBtn" class="btn-secondary px-4 py-2 rounded-lg">Back to Camera</button>
            </div>
            
            <div class="p-4">
                <div id="galleryGrid" class="gallery-grid">
                    <!-- Gallery items will be added here -->
                    <div class="text-center text-secondary p-8 col-span-2">
                        No photos yet. Take some photos with a friend to see them here!
                    </div>
                </div>
            </div>
        </div>
        
        <!-- New User Profile Page -->
        <div id="userProfilePage" class="hidden fixed inset-0 bg-white z-50 overflow-y-auto text-black">
            <div class="profile-header p-4 flex justify-between items-center border-b border-gray-200">
                <div class="flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lock-icon mr-2">
                        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                        <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                    </svg>
                    <span id="profileUsername" class="text-lg font-semibold"></span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ml-2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </div>
                <button id="closeProfileBtn" class="text-black">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            
            <div class="profile-info p-4">
                <div class="flex mb-4">
                    <div class="profile-pic mr-8">
                        <div id="userProfilePic" class="w-20 h-20 rounded-full bg-gray-300 overflow-hidden flex items-center justify-center text-gray-600 text-3xl font-bold">
                            <!-- Will be filled with user initials or photo -->
                        </div>
                    </div>
                    <div class="profile-stats flex-grow">
                        <div class="flex justify-around text-center">
                            <div class="stat">
                                <div id="profilePhotoCount" class="font-bold">0</div>
                                <div class="text-sm">Posts</div>
                            </div>
                            <div class="stat">
                                <div class="font-bold">0</div>
                                <div class="text-sm">Followers</div>
                            </div>
                            <div class="stat">
                                <div class="font-bold">0</div>
                                <div class="text-sm">Following</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="profile-bio mb-4">
                    <div id="profileDisplayName" class="font-bold"></div>
                    <div class="text-sm">PixCrab user</div>
                    <div class="text-sm mt-1">Capture moments together with friends in real-time.</div>
                </div>
                
                <button id="editProfileBtn" class="w-full py-1 border border-gray-300 rounded-md text-sm font-semibold mb-4">Edit Profile</button>
                
                <div class="profile-highlights flex overflow-x-auto mb-4 pb-2">
                    <div class="highlight-item flex flex-col items-center mr-4">
                        <div class="w-16 h-16 rounded-full border border-gray-300 flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                        </div>
                        <span class="text-xs mt-1">New</span>
                    </div>
                </div>
            </div>
            
            <div class="profile-tabs border-t border-gray-200">
                <div class="flex">
                    <div class="flex-1 py-2 text-center border-b-2 border-black">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="9" y1="3" x2="9" y2="21"></line>
                            <line x1="15" y1="3" x2="15" y2="21"></line>
                            <line x1="3" y1="9" x2="21" y2="9"></line>
                            <line x1="3" y1="15" x2="21" y2="15"></line>
                        </svg>
                    </div>
                    <div class="flex-1 py-2 text-center text-gray-400">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                    </div>
                </div>
            </div>
            
            <div id="profilePhotoGrid" class="profile-photos grid grid-cols-3 gap-1">
                <!-- Profile photos will be added here -->
            </div>
        </div>
        
        <!-- Toast Notification -->
        <div id="toast" class="hidden"></div>
        
        <!-- Photo Modal -->
        <div id="photoModal" class="hidden">
            <button id="modalCloseBtn">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
            <img id="modalFullImg" src="" alt="Full size photo">
            <div class="modal-actions">
                <button id="modalDownloadBtn" class="modal-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                </button>
                <button id="modalShareBtn" class="modal-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="18" cy="5" r="3"></circle>
                        <circle cx="6" cy="12" r="3"></circle>
                        <circle cx="18" cy="19" r="3"></circle>
                        <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                        <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                    </svg>
                </button>
            </div>
        </div>
        
        <!-- Debug Console -->
        <div id="debugConsole"></div>
        <button id="debugToggle" style="position: fixed; bottom: 10px; right: 10px; width: 30px; height: 30px; background: rgba(0,0,0,0.5); border: none; color: white; border-radius: 50%; z-index: 1000; display: flex; justify-content: center; align-items: center;">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="4 17 10 11 4 5"></polyline>
                <line x1="12" y1="19" x2="20" y2="19"></line>
            </svg>
        </button>
    </div>
<style>
    /* Base styles */
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #1a1a1a;
        color: #ffffff;
        height: 100vh;
        overflow: hidden;
    }
    
    /* Main container */
    .container {
        display: flex;
        flex-direction: column;
        height: 100vh;
        width: 100%;
        margin: 0 auto;
        position: relative;
        overflow: hidden;
    }
    
    /* Authentication section */
    #authSection {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        background-color: #4831D4;
        color: #CCF381;
        text-align: center;
        padding: 20px;
        z-index: 50;
    }
    
    .auth-logo {
        font-size: 2.5rem;
        font-weight: bold;
        margin-bottom: 2rem;
    }
    
    .auth-message {
        font-size: 1.2rem;
        margin-bottom: 2rem;
        max-width: 300px;
    }
    
    .auth-buttons {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        width: 100%;
        max-width: 300px;
    }
    
    .auth-btn {
        padding: 1rem;
        border-radius: 0.5rem;
        font-weight: bold;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: transform 0.2s;
    }
    
    .auth-btn:active {
        transform: scale(0.98);
    }
    
    #googleSignIn {
        background-color: #ffffff;
        color: #4285F4;
    }
    
    #appleSignIn {
        background-color: #000000;
        color: #ffffff;
    }
    
    #guestSignIn {
        background-color: #CCF381;
        color: #4831D4;
    }
    
    /* Session setup section */
    #sessionSetup {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        background-color: #4831D4;
        color: #CCF381;
        text-align: center;
        padding: 20px;
        z-index: 40;
    }
    
    .session-logo {
        font-size: 2rem;
        font-weight: bold;
        margin-bottom: 1.5rem;
    }
    
    .session-message {
        font-size: 1rem;
        margin-bottom: 1.5rem;
        max-width: 300px;
    }
    
    .session-input {
        display: flex;
        width: 100%;
        max-width: 300px;
        margin-bottom: 1rem;
    }
    
    #sessionId {
        flex-grow: 1;
        padding: 0.75rem;
        border-radius: 0.5rem 0 0 0.5rem;
        border: none;
        background-color: #ffffff;
        color: #333333;
        font-size: 1rem;
        text-transform: uppercase;
    }
    
    #joinSession {
        padding: 0.75rem 1rem;
        border-radius: 0 0.5rem 0.5rem 0;
        border: none;
        background-color: #CCF381;
        color: #4831D4;
        font-weight: bold;
        cursor: pointer;
    }
    
    #createSession {
        width: 100%;
        max-width: 300px;
        padding: 0.75rem;
        border-radius: 0.5rem;
        border: none;
        background-color: #CCF381;
        color: #4831D4;
        font-weight: bold;
        font-size: 1rem;
        cursor: pointer;
        margin-bottom: 1rem;
        transition: transform 0.2s;
    }
    
    #createSession:active {
        transform: scale(0.98);
    }
    
    #signOutBtn {
        padding: 0.5rem 1rem;
        border-radius: 0.5rem;
        border: 1px solid #CCF381;
        background-color: transparent;
        color: #CCF381;
        font-weight: bold;
        cursor: pointer;
        margin-top: 2rem;
    }
    
    /* Camera section */
    #cameraSection {
        position: relative;
        flex: 1;
        display: flex;
        flex-direction: column;
        background-color: #000000;
        overflow: hidden;
        height: 100vh;
    }
    
    .camera-feed-container {
        flex: 1;
        position: relative;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        margin-top: 50px; /* Reduced from 60px to reduce space at the top */
        margin-bottom: 70px; /* Add space at bottom for controls */
    }
    
    #cameraFeed {
        width: 100%;
        height: 100%;
        object-fit: cover;
        position: absolute;
        top: 0;
        left: 0;
    }
    
    .camera-controls {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        display: flex;
        justify-content: space-around;
        align-items: center;
        padding: 1rem;
        background-color: rgba(0,0,0,0.7);
        z-index: 100;
    }
    
    #captureBtn {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        border: 3px solid #ffffff;
        background-color: #4831D4;
        cursor: pointer;
        position: relative;
        z-index: 101;
    }
    
    #newSessionBtn {
        padding: 0.5rem 1rem;
        border-radius: 0.5rem;
        border: none;
        background-color: #333333;
        color: #ffffff;
        cursor: pointer;
        position: relative;
        z-index: 101;
    }
    
    .session-badge {
        position: fixed;
        top: 1rem;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        align-items: center;
        background-color: rgba(72, 49, 212, 0.8);
        color: #CCF381;
        padding: 0.25rem 0.5rem;
        border-radius: 1rem;
        font-size: 0.8rem;
        cursor: pointer;
        z-index: 100;
    }
    
    #cameraSwitchBtn {
        position: fixed;
        top: 5rem;
        right: 1rem;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: rgba(0,0,0,0.5);
        border: none;
        color: #ffffff;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        z-index: 100;
    }
    
    /* Slideshow container */
    #slideContainer {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        overflow-y: auto;
        scroll-snap-type: y mandatory;
        z-index: 5;
    }
    
    .slide {
        scroll-snap-align: start;
        height: 100vh;
        width: 100%;
        display: flex;
        flex-direction: column;
    }
    
    .photo-slide {
        scroll-snap-align: start;
        height: 100vh;
        width: 100%;
        background-color: #000000;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        padding-bottom: 60px; /* Add padding to prevent browser bar from cutting off content */
    }
    
    .photo-wrapper {
        position: relative;
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    
    .photo-wrapper img {
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
    }
    
    .photo-actions-container {
        position: absolute;
        bottom: 80px; /* Position above the camera controls */
        display: flex;
        gap: 1rem;
        z-index: 101; /* Above camera controls */
    }
    
    .photo-action-btn {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background-color: rgba(72, 49, 212, 0.8);
        color: #CCF381;
        border: none;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
    }
    
    .photo-action-btn svg {
        width: 24px;
        height: 24px;
    }
    
    /* Countdown overlay */
    #countdownOverlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 20;
    }
    
    #countdownText {
        font-size: 6rem;
        font-weight: bold;
        color: #ffffff;
    }
    
    #captureText {
        font-size: 3rem;
        font-weight: bold;
        color: #CCF381;
    }
    
    /* Toast notification */
    #toast {
        position: fixed;
        bottom: 2rem;
        left: 50%;
        transform: translateX(-50%);
        background-color: rgba(0,0,0,0.8);
        color: #ffffff;
        padding: 0.75rem 1.5rem;
        border-radius: 2rem;
        z-index: 100;
        transition: opacity 0.3s;
    }
    
    /* QR code */
    #qrcode {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: #ffffff;
        padding: 1rem;
        border-radius: 1rem;
        box-shadow: 0 0 20px rgba(0,0,0,0.5);
        z-index: 15;
    }
    
    #qrFallback {
        margin-top: 0.5rem;
        font-size: 1rem;
        color: #4831D4;
        text-align: center;
    }
    
    /* Hints */
    #hintText {
        position: absolute;
        bottom: 8rem;
        left: 50%;
        transform: translateX(-50%);
        background-color: rgba(72, 49, 212, 0.8);
        color: #CCF381;
        padding: 0.5rem 1rem;
        border-radius: 1rem;
        font-size: 0.9rem;
        opacity: 0;
        transition: opacity 0.5s;
        z-index: 25;
    }
    
    /* Image quality info */
    #imageQualityInfo {
        position: absolute;
        bottom: 1rem;
        right: 1rem;
        background-color: rgba(0,0,0,0.7);
        padding: 0.25rem 0.5rem;
        border-radius: 0.5rem;
        font-size: 0.7rem;
        color: #cccccc;
        z-index: 10;
    }
    
    /* Camera switch button */
    #cameraSwitchBtn {
        position: absolute;
        top: 5rem;
        right: 1rem;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: rgba(0,0,0,0.5);
        border: none;
        color: #ffffff;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        z-index: 15;
    }
    
    /* Debug console */
    #debugConsole {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 150px;
        background-color: rgba(0,0,0,0.9);
        color: #00ff00;
        font-family: monospace;
        font-size: 0.7rem;
        padding: 0.5rem;
        overflow-y: auto;
        z-index: 1000;
        display: none;
    }
    
    /* Gallery section */
    #gallerySection {
        position: absolute;
        bottom: 80px; /* Increased to place above the camera controls */
        left: 0;
        right: 0;
        display: flex;
        flex-wrap: nowrap;
        overflow-x: auto;
        padding: 0.5rem;
        background-color: rgba(72, 49, 212, 0.8);
        z-index: 101; /* Increased to be above camera controls */
        scrollbar-width: none;
        backdrop-filter: blur(5px);
        margin: 0 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }
    
    #gallerySection::-webkit-scrollbar {
        display: none;
    }
    
    /* Shutter effect animation */
    .shutter-effect {
        animation: shutter 0.5s;
    }
    
    @keyframes shutter {
        0% { opacity: 1; }
        50% { opacity: 0; }
        100% { opacity: 1; }
    }
    
    /* Utility classes */
    .hidden {
        display: none !important;
    }
    
    /* Photo Modal */
    #photoModal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.9);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 1000;
    }
    
    #modalFullImg {
        max-width: 95%;
        max-height: 80%;
        object-fit: contain;
    }
    
    .modal-actions {
        display: flex;
        gap: 1rem;
        margin-top: 1rem;
    }
    
    .modal-btn {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: #4831D4;
        color: #CCF381;
        border: none;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
    }
    
    #modalCloseBtn {
        position: absolute;
        top: 1rem;
        right: 1rem;
        background-color: rgba(255,255,255,0.2);
    }
    
    /* Add a semi-transparent header bar */
    .camera-header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem;
        background-color: rgba(0,0,0,0.7);
        z-index: 100;
    }
    
    /* Update session badge to show on top of the header bar */
    .session-badge {
        display: flex;
        align-items: center;
        background-color: rgba(72, 49, 212, 0.8);
        color: #CCF381;
        padding: 0.25rem 0.5rem;
        border-radius: 1rem;
        font-size: 0.8rem;
        cursor: pointer;
        margin: 0 auto;
    }
    
    /* Make camera switch button consistent with other controls */
    #cameraSwitchBtn {
        position: fixed;
        top: 1rem;
        right: 1rem;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: rgba(0,0,0,0.5);
        border: none;
        color: #ffffff;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        z-index: 100;
    }

    .gallery-btn {
        width: 100%;
        max-width: 300px;
        padding: 0.75rem;
        border-radius: 0.5rem;
        border: none;
        background-color: #333333;
        color: #ffffff;
        font-weight: bold;
        font-size: 1rem;
        cursor: pointer;
        margin-bottom: 1rem;
        transition: transform 0.2s;
    }

    .gallery-btn:active {
        transform: scale(0.98);
    }

    /* Add responsive design improvements */
    @media (min-width: 768px) {
        /* Desktop improvements */
        .camera-header {
            padding: 1rem 2rem;
        }

        .camera-controls {
            padding: 1.5rem;
        }

        #captureBtn {
            width: 80px;
            height: 80px;
        }
        
        #gallerySection {
            margin: 0 15px;
        }
        
        .session-badge {
            font-size: 1rem;
            padding: 0.5rem 0.75rem;
        }
    }

    @media (max-width: 480px) {
        /* Small phone improvements */
        .camera-header {
            padding: 0.5rem;
        }
        
        .camera-controls {
            padding: 0.75rem;
        }
        
        #captureBtn {
            width: 50px;
            height: 50px;
        }
        
        .btn-secondary {
            padding: 0.25rem 0.5rem !important;
            font-size: 0.75rem !important;
        }
        
        /* Adjust spacing for smaller screens */
        .camera-feed-container {
            margin-top: 50px;
        }
        
        /* Make gallery thumbnails smaller */
        .gallery-photo-wrapper {
            width: 70px !important;
            height: 70px !important;
        }
        
        /* Ensure session badge fits */
        .session-badge {
            font-size: 0.7rem;
            padding: 0.2rem 0.4rem;
        }
    }

    /* Make sure the camera feed container is responsive */
    .camera-feed-container {
        flex: 1;
        position: relative;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        margin-top: 50px; /* Reduced from 60px to reduce space at the top */
        margin-bottom: 70px; /* Add space at bottom for controls */
    }

    /* Improve gallery grid responsiveness */
    #galleryGrid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
        padding: 12px;
    }

    @media (min-width: 640px) {
        #galleryGrid {
            grid-template-columns: repeat(3, 1fr);
        }
    }

    @media (min-width: 1024px) {
        #galleryGrid {
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            padding: 16px;
        }
    }

    /* Make the gallery section responsive */
    #gallerySection {
        position: absolute;
        bottom: 80px; /* Increased to place above the camera controls */
        left: 0;
        right: 0;
        display: flex;
        flex-wrap: nowrap;
        overflow-x: auto;
        padding: 0.5rem;
        background-color: rgba(72, 49, 212, 0.8);
        z-index: 101; /* Increased to be above camera controls */
        scrollbar-width: none;
        backdrop-filter: blur(5px);
        margin: 0 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }

    /* Instagram-style Gallery Grid */
    .gallery-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 2px;
        padding: 2px;
    }
    
    .gallery-grid-item {
        aspect-ratio: 1/1;
        overflow: hidden;
        position: relative;
    }
    
    .gallery-grid-item img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    /* Profile page styles */
    #userProfilePage {
        background-color: white;
        color: black;
    }
    
    .profile-photos {
        background-color: white;
    }
    
    .profile-photos .photo-item {
        aspect-ratio: 1/1;
        overflow: hidden;
    }
    
    .profile-photos .photo-item img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    
    /* Updated gallery grid responsive design */
    @media (min-width: 640px) {
        .gallery-grid {
            gap: 4px;
            padding: 4px;
        }
    }

    @media (min-width: 1024px) {
        .gallery-grid {
            gap: 6px;
            padding: 6px;
        }
    }

</style>
</body>
</html>
