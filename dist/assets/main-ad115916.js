function _mergeNamespaces(i,e){for(var o=0;o<e.length;o++){const s=e[o];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in i)){const c=Object.getOwnPropertyDescriptor(s,a);c&&Object.defineProperty(i,a,c.get?c:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function o(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(a){if(a.ep)return;a.ep=!0;const c=o(a);fetch(a.href,c)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$2=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$1=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(i){return i===null||typeof i!="object"?null:(i=z$1&&i[z$1]||i["@@iterator"],typeof i=="function"?i:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(i,e,o){this.props=i,this.context=e,this.refs=D$1,this.updater=o||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(i,e){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,e,"setState")};E$1.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(i,e,o){this.props=i,this.context=e,this.refs=D$1,this.updater=o||B$1}var H$1=G$1.prototype=new F;H$1.constructor=G$1;C$1(H$1,E$1.prototype);H$1.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(i,e,o){var s,a={},c=null,d=null;if(e!=null)for(s in e.ref!==void 0&&(d=e.ref),e.key!==void 0&&(c=""+e.key),e)J.call(e,s)&&!L$1.hasOwnProperty(s)&&(a[s]=e[s]);var h=arguments.length-2;if(h===1)a.children=o;else if(1<h){for(var g=Array(h),_=0;_<h;_++)g[_]=arguments[_+2];a.children=g}if(i&&i.defaultProps)for(s in h=i.defaultProps,h)a[s]===void 0&&(a[s]=h[s]);return{$$typeof:l$1,type:i,key:c,ref:d,props:a,_owner:K$1.current}}function N$1(i,e){return{$$typeof:l$1,type:i.type,key:e,ref:i.ref,props:i.props,_owner:i._owner}}function O$1(i){return typeof i=="object"&&i!==null&&i.$$typeof===l$1}function escape(i){var e={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(o){return e[o]})}var P$1=/\/+/g;function Q$1(i,e){return typeof i=="object"&&i!==null&&i.key!=null?escape(""+i.key):e.toString(36)}function R$1(i,e,o,s,a){var c=typeof i;(c==="undefined"||c==="boolean")&&(i=null);var d=!1;if(i===null)d=!0;else switch(c){case"string":case"number":d=!0;break;case"object":switch(i.$$typeof){case l$1:case n$1:d=!0}}if(d)return d=i,a=a(d),i=s===""?"."+Q$1(d,0):s,I$1(a)?(o="",i!=null&&(o=i.replace(P$1,"$&/")+"/"),R$1(a,e,o,"",function(_){return _})):a!=null&&(O$1(a)&&(a=N$1(a,o+(!a.key||d&&d.key===a.key?"":(""+a.key).replace(P$1,"$&/")+"/")+i)),e.push(a)),1;if(d=0,s=s===""?".":s+":",I$1(i))for(var h=0;h<i.length;h++){c=i[h];var g=s+Q$1(c,h);d+=R$1(c,e,o,g,a)}else if(g=A$1(i),typeof g=="function")for(i=g.call(i),h=0;!(c=i.next()).done;)c=c.value,g=s+Q$1(c,h++),d+=R$1(c,e,o,g,a);else if(c==="object")throw e=String(i),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return d}function S$1(i,e,o){if(i==null)return i;var s=[],a=0;return R$1(i,s,"","",function(c){return e.call(o,c,a++)}),s}function T$1(i){if(i._status===-1){var e=i._result;e=e(),e.then(function(o){(i._status===0||i._status===-1)&&(i._status=1,i._result=o)},function(o){(i._status===0||i._status===-1)&&(i._status=2,i._result=o)}),i._status===-1&&(i._status=0,i._result=e)}if(i._status===1)return i._result.default;throw i._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};function X$1(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$1,forEach:function(i,e,o){S$1(i,function(){e.apply(this,arguments)},o)},count:function(i){var e=0;return S$1(i,function(){e++}),e},toArray:function(i){return S$1(i,function(e){return e})||[]},only:function(i){if(!O$1(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};react_production_min.Component=E$1;react_production_min.Fragment=p$2;react_production_min.Profiler=r;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.act=X$1;react_production_min.cloneElement=function(i,e,o){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var s=C$1({},i.props),a=i.key,c=i.ref,d=i._owner;if(e!=null){if(e.ref!==void 0&&(c=e.ref,d=K$1.current),e.key!==void 0&&(a=""+e.key),i.type&&i.type.defaultProps)var h=i.type.defaultProps;for(g in e)J.call(e,g)&&!L$1.hasOwnProperty(g)&&(s[g]=e[g]===void 0&&h!==void 0?h[g]:e[g])}var g=arguments.length-2;if(g===1)s.children=o;else if(1<g){h=Array(g);for(var _=0;_<g;_++)h[_]=arguments[_+2];s.children=h}return{$$typeof:l$1,type:i.type,key:a,ref:c,props:s,_owner:d}};react_production_min.createContext=function(i){return i={$$typeof:u,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:t,_context:i},i.Consumer=i};react_production_min.createElement=M$1;react_production_min.createFactory=function(i){var e=M$1.bind(null,i);return e.type=i,e};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(i){return{$$typeof:v$1,render:i}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(i){return{$$typeof:y,_payload:{_status:-1,_result:i},_init:T$1}};react_production_min.memo=function(i,e){return{$$typeof:x,type:i,compare:e===void 0?null:e}};react_production_min.startTransition=function(i){var e=V$1.transition;V$1.transition={};try{i()}finally{V$1.transition=e}};react_production_min.unstable_act=X$1;react_production_min.useCallback=function(i,e){return U$1.current.useCallback(i,e)};react_production_min.useContext=function(i){return U$1.current.useContext(i)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(i){return U$1.current.useDeferredValue(i)};react_production_min.useEffect=function(i,e){return U$1.current.useEffect(i,e)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(i,e,o){return U$1.current.useImperativeHandle(i,e,o)};react_production_min.useInsertionEffect=function(i,e){return U$1.current.useInsertionEffect(i,e)};react_production_min.useLayoutEffect=function(i,e){return U$1.current.useLayoutEffect(i,e)};react_production_min.useMemo=function(i,e){return U$1.current.useMemo(i,e)};react_production_min.useReducer=function(i,e,o){return U$1.current.useReducer(i,e,o)};react_production_min.useRef=function(i){return U$1.current.useRef(i)};react_production_min.useState=function(i){return U$1.current.useState(i)};react_production_min.useSyncExternalStore=function(i,e,o){return U$1.current.useSyncExternalStore(i,e,o)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$1={key:!0,ref:!0,__self:!0,__source:!0};function q(i,e,o){var s,a={},c=null,d=null;o!==void 0&&(c=""+o),e.key!==void 0&&(c=""+e.key),e.ref!==void 0&&(d=e.ref);for(s in e)m$1.call(e,s)&&!p$1.hasOwnProperty(s)&&(a[s]=e[s]);if(i&&i.defaultProps)for(s in e=i.defaultProps,e)a[s]===void 0&&(a[s]=e[s]);return{$$typeof:k,type:i,key:c,ref:d,props:a,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function e(St,xt){var $t=St.length;St.push(xt);e:for(;0<$t;){var _t=$t-1>>>1,ut=St[_t];if(0<a(ut,xt))St[_t]=xt,St[$t]=ut,$t=_t;else break e}}function o(St){return St.length===0?null:St[0]}function s(St){if(St.length===0)return null;var xt=St[0],$t=St.pop();if($t!==xt){St[0]=$t;e:for(var _t=0,ut=St.length,gt=ut>>>1;_t<gt;){var yt=2*(_t+1)-1,kt=St[yt],lt=yt+1,Mt=St[lt];if(0>a(kt,$t))lt<ut&&0>a(Mt,kt)?(St[_t]=Mt,St[lt]=$t,_t=lt):(St[_t]=kt,St[yt]=$t,_t=yt);else if(lt<ut&&0>a(Mt,$t))St[_t]=Mt,St[lt]=$t,_t=lt;else break e}}return xt}function a(St,xt){var $t=St.sortIndex-xt.sortIndex;return $t!==0?$t:St.id-xt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;i.unstable_now=function(){return c.now()}}else{var d=Date,h=d.now();i.unstable_now=function(){return d.now()-h}}var g=[],_=[],j=1,b=null,$=3,nt=!1,tt=!1,it=!1,ot=typeof setTimeout=="function"?setTimeout:null,_e=typeof clearTimeout=="function"?clearTimeout:null,et=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function rt(St){for(var xt=o(_);xt!==null;){if(xt.callback===null)s(_);else if(xt.startTime<=St)s(_),xt.sortIndex=xt.expirationTime,e(g,xt);else break;xt=o(_)}}function st(St){if(it=!1,rt(St),!tt)if(o(g)!==null)tt=!0,Gt(dt);else{var xt=o(_);xt!==null&&Ht(st,xt.startTime-St)}}function dt(St,xt){tt=!1,it&&(it=!1,_e(ft),ft=-1),nt=!0;var $t=$;try{for(rt(xt),b=o(g);b!==null&&(!(b.expirationTime>xt)||St&&!Et());){var _t=b.callback;if(typeof _t=="function"){b.callback=null,$=b.priorityLevel;var ut=_t(b.expirationTime<=xt);xt=i.unstable_now(),typeof ut=="function"?b.callback=ut:b===o(g)&&s(g),rt(xt)}else s(g);b=o(g)}if(b!==null)var gt=!0;else{var yt=o(_);yt!==null&&Ht(st,yt.startTime-xt),gt=!1}return gt}finally{b=null,$=$t,nt=!1}}var ht=!1,mt=null,ft=-1,bt=5,vt=-1;function Et(){return!(i.unstable_now()-vt<bt)}function It(){if(mt!==null){var St=i.unstable_now();vt=St;var xt=!0;try{xt=mt(!0,St)}finally{xt?Rt():(ht=!1,mt=null)}}else ht=!1}var Rt;if(typeof et=="function")Rt=function(){et(It)};else if(typeof MessageChannel<"u"){var Dt=new MessageChannel,Ft=Dt.port2;Dt.port1.onmessage=It,Rt=function(){Ft.postMessage(null)}}else Rt=function(){ot(It,0)};function Gt(St){mt=St,ht||(ht=!0,Rt())}function Ht(St,xt){ft=ot(function(){St(i.unstable_now())},xt)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(St){St.callback=null},i.unstable_continueExecution=function(){tt||nt||(tt=!0,Gt(dt))},i.unstable_forceFrameRate=function(St){0>St||125<St?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):bt=0<St?Math.floor(1e3/St):5},i.unstable_getCurrentPriorityLevel=function(){return $},i.unstable_getFirstCallbackNode=function(){return o(g)},i.unstable_next=function(St){switch($){case 1:case 2:case 3:var xt=3;break;default:xt=$}var $t=$;$=xt;try{return St()}finally{$=$t}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(St,xt){switch(St){case 1:case 2:case 3:case 4:case 5:break;default:St=3}var $t=$;$=St;try{return xt()}finally{$=$t}},i.unstable_scheduleCallback=function(St,xt,$t){var _t=i.unstable_now();switch(typeof $t=="object"&&$t!==null?($t=$t.delay,$t=typeof $t=="number"&&0<$t?_t+$t:_t):$t=_t,St){case 1:var ut=-1;break;case 2:ut=250;break;case 5:ut=1073741823;break;case 4:ut=1e4;break;default:ut=5e3}return ut=$t+ut,St={id:j++,callback:xt,priorityLevel:St,startTime:$t,expirationTime:ut,sortIndex:-1},$t>_t?(St.sortIndex=$t,e(_,St),o(g)===null&&St===o(_)&&(it?(_e(ft),ft=-1):it=!0,Ht(st,$t-_t))):(St.sortIndex=ut,e(g,St),tt||nt||(tt=!0,Gt(dt))),St},i.unstable_shouldYield=Et,i.unstable_wrapCallback=function(St){var xt=$;return function(){var $t=$;$=xt;try{return St.apply(this,arguments)}finally{$=$t}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p(i){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+i,o=1;o<arguments.length;o++)e+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+i+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(i,e){ha(i,e),ha(i+"Capture",e)}function ha(i,e){for(ea[i]=e,i=0;i<e.length;i++)da.add(e[i])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(i){return ja.call(ma,i)?!0:ja.call(la,i)?!1:ka.test(i)?ma[i]=!0:(la[i]=!0,!1)}function pa(i,e,o,s){if(o!==null&&o.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:o!==null?!o.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function qa(i,e,o,s){if(e===null||typeof e>"u"||pa(i,e,o,s))return!0;if(s)return!1;if(o!==null)switch(o.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function v(i,e,o,s,a,c,d){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=a,this.mustUseProperty=o,this.propertyName=i,this.type=e,this.sanitizeURL=c,this.removeEmptyString=d}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){z[i]=new v(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var e=i[0];z[e]=new v(e,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){z[i]=new v(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){z[i]=new v(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){z[i]=new v(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){z[i]=new v(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){z[i]=new v(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){z[i]=new v(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){z[i]=new v(i,5,!1,i.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var e=i.replace(ra,sa);z[e]=new v(e,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var e=i.replace(ra,sa);z[e]=new v(e,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var e=i.replace(ra,sa);z[e]=new v(e,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){z[i]=new v(i,1,!1,i.toLowerCase(),null,!1,!1)});z.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){z[i]=new v(i,1,!1,i.toLowerCase(),null,!0,!0)});function ta(i,e,o,s){var a=z.hasOwnProperty(e)?z[e]:null;(a!==null?a.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(qa(e,o,a,s)&&(o=null),s||a===null?oa(e)&&(o===null?i.removeAttribute(e):i.setAttribute(e,""+o)):a.mustUseProperty?i[a.propertyName]=o===null?a.type===3?!1:"":o:(e=a.attributeName,s=a.attributeNamespace,o===null?i.removeAttribute(e):(a=a.type,o=a===3||a===4&&o===!0?"":""+o,s?i.setAttributeNS(s,e,o):i.setAttribute(e,o))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(i){return i===null||typeof i!="object"?null:(i=Ja&&i[Ja]||i["@@iterator"],typeof i=="function"?i:null)}var A=Object.assign,La;function Ma(i){if(La===void 0)try{throw Error()}catch(o){var e=o.stack.trim().match(/\n( *(at )?)/);La=e&&e[1]||""}return`
`+La+i}var Na=!1;function Oa(i,e){if(!i||Na)return"";Na=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(_){var s=_}Reflect.construct(i,[],e)}else{try{e.call()}catch(_){s=_}i.call(e.prototype)}else{try{throw Error()}catch(_){s=_}i()}}catch(_){if(_&&s&&typeof _.stack=="string"){for(var a=_.stack.split(`
`),c=s.stack.split(`
`),d=a.length-1,h=c.length-1;1<=d&&0<=h&&a[d]!==c[h];)h--;for(;1<=d&&0<=h;d--,h--)if(a[d]!==c[h]){if(d!==1||h!==1)do if(d--,h--,0>h||a[d]!==c[h]){var g=`
`+a[d].replace(" at new "," at ");return i.displayName&&g.includes("<anonymous>")&&(g=g.replace("<anonymous>",i.displayName)),g}while(1<=d&&0<=h);break}}}finally{Na=!1,Error.prepareStackTrace=o}return(i=i?i.displayName||i.name:"")?Ma(i):""}function Pa(i){switch(i.tag){case 5:return Ma(i.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return i=Oa(i.type,!1),i;case 11:return i=Oa(i.type.render,!1),i;case 1:return i=Oa(i.type,!0),i;default:return""}}function Qa(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case Ca:return(i.displayName||"Context")+".Consumer";case Ba:return(i._context.displayName||"Context")+".Provider";case Da:var e=i.render;return i=i.displayName,i||(i=e.displayName||e.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Ga:return e=i.displayName||null,e!==null?e:Qa(i.type)||"Memo";case Ha:e=i._payload,i=i._init;try{return Qa(i(e))}catch{}}return null}function Ra(i){var e=i.type;switch(i.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=e.render,i=i.displayName||i.name||"",e.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(e);case 8:return e===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Sa(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Ta(i){var e=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ua(i){var e=Ta(i)?"checked":"value",o=Object.getOwnPropertyDescriptor(i.constructor.prototype,e),s=""+i[e];if(!i.hasOwnProperty(e)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var a=o.get,c=o.set;return Object.defineProperty(i,e,{configurable:!0,get:function(){return a.call(this)},set:function(d){s=""+d,c.call(this,d)}}),Object.defineProperty(i,e,{enumerable:o.enumerable}),{getValue:function(){return s},setValue:function(d){s=""+d},stopTracking:function(){i._valueTracker=null,delete i[e]}}}}function Va(i){i._valueTracker||(i._valueTracker=Ua(i))}function Wa(i){if(!i)return!1;var e=i._valueTracker;if(!e)return!0;var o=e.getValue(),s="";return i&&(s=Ta(i)?i.checked?"true":"false":i.value),i=s,i!==o?(e.setValue(i),!0):!1}function Xa(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Ya(i,e){var o=e.checked;return A({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??i._wrapperState.initialChecked})}function Za(i,e){var o=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;o=Sa(e.value!=null?e.value:o),i._wrapperState={initialChecked:s,initialValue:o,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function ab(i,e){e=e.checked,e!=null&&ta(i,"checked",e,!1)}function bb(i,e){ab(i,e);var o=Sa(e.value),s=e.type;if(o!=null)s==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+o):i.value!==""+o&&(i.value=""+o);else if(s==="submit"||s==="reset"){i.removeAttribute("value");return}e.hasOwnProperty("value")?cb(i,e.type,o):e.hasOwnProperty("defaultValue")&&cb(i,e.type,Sa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(i.defaultChecked=!!e.defaultChecked)}function db(i,e,o){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+i._wrapperState.initialValue,o||e===i.value||(i.value=e),i.defaultValue=e}o=i.name,o!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,o!==""&&(i.name=o)}function cb(i,e,o){(e!=="number"||Xa(i.ownerDocument)!==i)&&(o==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+o&&(i.defaultValue=""+o))}var eb=Array.isArray;function fb(i,e,o,s){if(i=i.options,e){e={};for(var a=0;a<o.length;a++)e["$"+o[a]]=!0;for(o=0;o<i.length;o++)a=e.hasOwnProperty("$"+i[o].value),i[o].selected!==a&&(i[o].selected=a),a&&s&&(i[o].defaultSelected=!0)}else{for(o=""+Sa(o),e=null,a=0;a<i.length;a++){if(i[a].value===o){i[a].selected=!0,s&&(i[a].defaultSelected=!0);return}e!==null||i[a].disabled||(e=i[a])}e!==null&&(e.selected=!0)}}function gb(i,e){if(e.dangerouslySetInnerHTML!=null)throw Error(p(91));return A({},e,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function hb(i,e){var o=e.value;if(o==null){if(o=e.children,e=e.defaultValue,o!=null){if(e!=null)throw Error(p(92));if(eb(o)){if(1<o.length)throw Error(p(93));o=o[0]}e=o}e==null&&(e=""),o=e}i._wrapperState={initialValue:Sa(o)}}function ib(i,e){var o=Sa(e.value),s=Sa(e.defaultValue);o!=null&&(o=""+o,o!==i.value&&(i.value=o),e.defaultValue==null&&i.defaultValue!==o&&(i.defaultValue=o)),s!=null&&(i.defaultValue=""+s)}function jb(i){var e=i.textContent;e===i._wrapperState.initialValue&&e!==""&&e!==null&&(i.value=e)}function kb(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(i,e){return i==null||i==="http://www.w3.org/1999/xhtml"?kb(e):i==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var mb,nb=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,o,s,a){MSApp.execUnsafeLocalFunction(function(){return i(e,o,s,a)})}:i}(function(i,e){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=e;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=mb.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;e.firstChild;)i.appendChild(e.firstChild)}});function ob(i,e){if(e){var o=i.firstChild;if(o&&o===i.lastChild&&o.nodeType===3){o.nodeValue=e;return}}i.textContent=e}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(i){qb.forEach(function(e){e=e+i.charAt(0).toUpperCase()+i.substring(1),pb[e]=pb[i]})});function rb(i,e,o){return e==null||typeof e=="boolean"||e===""?"":o||typeof e!="number"||e===0||pb.hasOwnProperty(i)&&pb[i]?(""+e).trim():e+"px"}function sb(i,e){i=i.style;for(var o in e)if(e.hasOwnProperty(o)){var s=o.indexOf("--")===0,a=rb(o,e[o],s);o==="float"&&(o="cssFloat"),s?i.setProperty(o,a):i[o]=a}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(i,e){if(e){if(tb[i]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(p(137,i));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(p(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(p(61))}if(e.style!=null&&typeof e.style!="object")throw Error(p(62))}}function vb(i,e){if(i.indexOf("-")===-1)return typeof e.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var yb=null,zb=null,Ab=null;function Bb(i){if(i=Cb(i)){if(typeof yb!="function")throw Error(p(280));var e=i.stateNode;e&&(e=Db(e),yb(i.stateNode,i.type,e))}}function Eb(i){zb?Ab?Ab.push(i):Ab=[i]:zb=i}function Fb(){if(zb){var i=zb,e=Ab;if(Ab=zb=null,Bb(i),e)for(i=0;i<e.length;i++)Bb(e[i])}}function Gb(i,e){return i(e)}function Hb(){}var Ib=!1;function Jb(i,e,o){if(Ib)return i(e,o);Ib=!0;try{return Gb(i,e,o)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(i,e){var o=i.stateNode;if(o===null)return null;var s=Db(o);if(s===null)return null;o=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(i=i.type,s=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!s;break e;default:i=!1}if(i)return null;if(o&&typeof o!="function")throw Error(p(231,e,typeof o));return o}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(i,e,o,s,a,c,d,h,g){var _=Array.prototype.slice.call(arguments,3);try{e.apply(o,_)}catch(j){this.onError(j)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(i){Ob=!0,Pb=i}};function Tb(i,e,o,s,a,c,d,h,g){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(i,e,o,s,a,c,d,h,g){if(Tb.apply(this,arguments),Ob){if(Ob){var _=Pb;Ob=!1,Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=_)}}function Vb(i){var e=i,o=i;if(i.alternate)for(;e.return;)e=e.return;else{i=e;do e=i,e.flags&4098&&(o=e.return),i=e.return;while(i)}return e.tag===3?o:null}function Wb(i){if(i.tag===13){var e=i.memoizedState;if(e===null&&(i=i.alternate,i!==null&&(e=i.memoizedState)),e!==null)return e.dehydrated}return null}function Xb(i){if(Vb(i)!==i)throw Error(p(188))}function Yb(i){var e=i.alternate;if(!e){if(e=Vb(i),e===null)throw Error(p(188));return e!==i?null:i}for(var o=i,s=e;;){var a=o.return;if(a===null)break;var c=a.alternate;if(c===null){if(s=a.return,s!==null){o=s;continue}break}if(a.child===c.child){for(c=a.child;c;){if(c===o)return Xb(a),i;if(c===s)return Xb(a),e;c=c.sibling}throw Error(p(188))}if(o.return!==s.return)o=a,s=c;else{for(var d=!1,h=a.child;h;){if(h===o){d=!0,o=a,s=c;break}if(h===s){d=!0,s=a,o=c;break}h=h.sibling}if(!d){for(h=c.child;h;){if(h===o){d=!0,o=c,s=a;break}if(h===s){d=!0,s=c,o=a;break}h=h.sibling}if(!d)throw Error(p(189))}}if(o.alternate!==s)throw Error(p(190))}if(o.tag!==3)throw Error(p(188));return o.stateNode.current===o?i:e}function Zb(i){return i=Yb(i),i!==null?$b(i):null}function $b(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var e=$b(i);if(e!==null)return e;i=i.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(i){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,i,void 0,(i.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(i){return i>>>=0,i===0?32:31-(pc(i)/qc|0)|0}var rc=64,sc=4194304;function tc(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function uc(i,e){var o=i.pendingLanes;if(o===0)return 0;var s=0,a=i.suspendedLanes,c=i.pingedLanes,d=o&268435455;if(d!==0){var h=d&~a;h!==0?s=tc(h):(c&=d,c!==0&&(s=tc(c)))}else d=o&~a,d!==0?s=tc(d):c!==0&&(s=tc(c));if(s===0)return 0;if(e!==0&&e!==s&&!(e&a)&&(a=s&-s,c=e&-e,a>=c||a===16&&(c&4194240)!==0))return e;if(s&4&&(s|=o&16),e=i.entangledLanes,e!==0)for(i=i.entanglements,e&=s;0<e;)o=31-oc(e),a=1<<o,s|=i[o],e&=~a;return s}function vc(i,e){switch(i){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(i,e){for(var o=i.suspendedLanes,s=i.pingedLanes,a=i.expirationTimes,c=i.pendingLanes;0<c;){var d=31-oc(c),h=1<<d,g=a[d];g===-1?(!(h&o)||h&s)&&(a[d]=vc(h,e)):g<=e&&(i.expiredLanes|=h),c&=~h}}function xc(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function yc(){var i=rc;return rc<<=1,!(rc&4194240)&&(rc=64),i}function zc(i){for(var e=[],o=0;31>o;o++)e.push(i);return e}function Ac(i,e,o){i.pendingLanes|=e,e!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,e=31-oc(e),i[e]=o}function Bc(i,e){var o=i.pendingLanes&~e;i.pendingLanes=e,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=e,i.mutableReadLanes&=e,i.entangledLanes&=e,e=i.entanglements;var s=i.eventTimes;for(i=i.expirationTimes;0<o;){var a=31-oc(o),c=1<<a;e[a]=0,s[a]=-1,i[a]=-1,o&=~c}}function Cc(i,e){var o=i.entangledLanes|=e;for(i=i.entanglements;o;){var s=31-oc(o),a=1<<s;a&e|i[s]&e&&(i[s]|=e),o&=~a}}var C=0;function Dc(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(i,e){switch(i){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(e.pointerId)}}function Tc(i,e,o,s,a,c){return i===null||i.nativeEvent!==c?(i={blockedOn:e,domEventName:o,eventSystemFlags:s,nativeEvent:c,targetContainers:[a]},e!==null&&(e=Cb(e),e!==null&&Fc(e)),i):(i.eventSystemFlags|=s,e=i.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),i)}function Uc(i,e,o,s,a){switch(e){case"focusin":return Lc=Tc(Lc,i,e,o,s,a),!0;case"dragenter":return Mc=Tc(Mc,i,e,o,s,a),!0;case"mouseover":return Nc=Tc(Nc,i,e,o,s,a),!0;case"pointerover":var c=a.pointerId;return Oc.set(c,Tc(Oc.get(c)||null,i,e,o,s,a)),!0;case"gotpointercapture":return c=a.pointerId,Pc.set(c,Tc(Pc.get(c)||null,i,e,o,s,a)),!0}return!1}function Vc(i){var e=Wc(i.target);if(e!==null){var o=Vb(e);if(o!==null){if(e=o.tag,e===13){if(e=Wb(o),e!==null){i.blockedOn=e,Ic(i.priority,function(){Gc(o)});return}}else if(e===3&&o.stateNode.current.memoizedState.isDehydrated){i.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Xc(i){if(i.blockedOn!==null)return!1;for(var e=i.targetContainers;0<e.length;){var o=Yc(i.domEventName,i.eventSystemFlags,e[0],i.nativeEvent);if(o===null){o=i.nativeEvent;var s=new o.constructor(o.type,o);wb=s,o.target.dispatchEvent(s),wb=null}else return e=Cb(o),e!==null&&Fc(e),i.blockedOn=o,!1;e.shift()}return!0}function Zc(i,e,o){Xc(i)&&o.delete(e)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(i,e){i.blockedOn===e&&(i.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(i){function e(a){return ad(a,i)}if(0<Kc.length){ad(Kc[0],i);for(var o=1;o<Kc.length;o++){var s=Kc[o];s.blockedOn===i&&(s.blockedOn=null)}}for(Lc!==null&&ad(Lc,i),Mc!==null&&ad(Mc,i),Nc!==null&&ad(Nc,i),Oc.forEach(e),Pc.forEach(e),o=0;o<Qc.length;o++)s=Qc[o],s.blockedOn===i&&(s.blockedOn=null);for(;0<Qc.length&&(o=Qc[0],o.blockedOn===null);)Vc(o),o.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(i,e,o,s){var a=C,c=cd.transition;cd.transition=null;try{C=1,fd(i,e,o,s)}finally{C=a,cd.transition=c}}function gd(i,e,o,s){var a=C,c=cd.transition;cd.transition=null;try{C=4,fd(i,e,o,s)}finally{C=a,cd.transition=c}}function fd(i,e,o,s){if(dd){var a=Yc(i,e,o,s);if(a===null)hd(i,e,s,id,o),Sc(i,s);else if(Uc(a,i,e,o,s))s.stopPropagation();else if(Sc(i,s),e&4&&-1<Rc.indexOf(i)){for(;a!==null;){var c=Cb(a);if(c!==null&&Ec(c),c=Yc(i,e,o,s),c===null&&hd(i,e,s,id,o),c===a)break;a=c}a!==null&&s.stopPropagation()}else hd(i,e,s,null,o)}}var id=null;function Yc(i,e,o,s){if(id=null,i=xb(s),i=Wc(i),i!==null)if(e=Vb(i),e===null)i=null;else if(o=e.tag,o===13){if(i=Wb(e),i!==null)return i;i=null}else if(o===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;i=null}else e!==i&&(i=null);return id=i,null}function jd(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var i,e=ld,o=e.length,s,a="value"in kd?kd.value:kd.textContent,c=a.length;for(i=0;i<o&&e[i]===a[i];i++);var d=o-i;for(s=1;s<=d&&e[o-s]===a[c-s];s++);return md=a.slice(i,1<s?1-s:void 0)}function od(i){var e=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&e===13&&(i=13)):i=e,i===10&&(i=13),32<=i||i===13?i:0}function pd(){return!0}function qd(){return!1}function rd(i){function e(o,s,a,c,d){this._reactName=o,this._targetInst=a,this.type=s,this.nativeEvent=c,this.target=d,this.currentTarget=null;for(var h in i)i.hasOwnProperty(h)&&(o=i[h],this[h]=o?o(c):c[h]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),e}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==yd&&(yd&&i.type==="mousemove"?(wd=i.screenX-yd.screenX,xd=i.screenY-yd.screenY):xd=wd=0,yd=i),wd)},movementY:function(i){return"movementY"in i?i.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(i){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(i):(i=Od[i])?!!e[i]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(i){if(i.key){var e=Md[i.key]||i.key;if(e!=="Unidentified")return e}return i.type==="keypress"?(i=od(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Nd[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(i){return i.type==="keypress"?od(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?od(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=String.fromCharCode(32),fe=!1;function ge(i,e){switch(i){case"keyup":return $d.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ie=!1;function je(i,e){switch(i){case"compositionend":return he(e);case"keypress":return e.which!==32?null:(fe=!0,ee);case"textInput":return i=e.data,i===ee&&fe?null:i;default:return null}}function ke(i,e){if(ie)return i==="compositionend"||!ae&&ge(i,e)?(i=nd(),md=ld=kd=null,ie=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return de&&e.locale!=="ko"?null:e.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e==="input"?!!le[i.type]:e==="textarea"}function ne(i,e,o,s){Eb(s),e=oe(e,"onChange"),0<e.length&&(o=new td("onChange","change",null,o,s),i.push({event:o,listeners:e}))}var pe=null,qe=null;function re(i){se(i,0)}function te(i){var e=ue(i);if(Wa(e))return i}function ve(i,e){if(i==="change")return e}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(i){if(i.propertyName==="value"&&te(qe)){var e=[];ne(e,qe,i,xb(i)),Jb(re,e)}}function Ce(i,e,o){i==="focusin"?(Ae(),pe=e,qe=o,pe.attachEvent("onpropertychange",Be)):i==="focusout"&&Ae()}function De(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return te(qe)}function Ee(i,e){if(i==="click")return te(e)}function Fe(i,e){if(i==="input"||i==="change")return te(e)}function Ge(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(i,e){if(He(i,e))return!0;if(typeof i!="object"||i===null||typeof e!="object"||e===null)return!1;var o=Object.keys(i),s=Object.keys(e);if(o.length!==s.length)return!1;for(s=0;s<o.length;s++){var a=o[s];if(!ja.call(e,a)||!He(i[a],e[a]))return!1}return!0}function Je(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Ke(i,e){var o=Je(i);i=0;for(var s;o;){if(o.nodeType===3){if(s=i+o.textContent.length,i<=e&&s>=e)return{node:o,offset:e-i};i=s}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Je(o)}}function Le(i,e){return i&&e?i===e?!0:i&&i.nodeType===3?!1:e&&e.nodeType===3?Le(i,e.parentNode):"contains"in i?i.contains(e):i.compareDocumentPosition?!!(i.compareDocumentPosition(e)&16):!1:!1}function Me(){for(var i=window,e=Xa();e instanceof i.HTMLIFrameElement;){try{var o=typeof e.contentWindow.location.href=="string"}catch{o=!1}if(o)i=e.contentWindow;else break;e=Xa(i.document)}return e}function Ne(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e&&(e==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||e==="textarea"||i.contentEditable==="true")}function Oe(i){var e=Me(),o=i.focusedElem,s=i.selectionRange;if(e!==o&&o&&o.ownerDocument&&Le(o.ownerDocument.documentElement,o)){if(s!==null&&Ne(o)){if(e=s.start,i=s.end,i===void 0&&(i=e),"selectionStart"in o)o.selectionStart=e,o.selectionEnd=Math.min(i,o.value.length);else if(i=(e=o.ownerDocument||document)&&e.defaultView||window,i.getSelection){i=i.getSelection();var a=o.textContent.length,c=Math.min(s.start,a);s=s.end===void 0?c:Math.min(s.end,a),!i.extend&&c>s&&(a=s,s=c,c=a),a=Ke(o,c);var d=Ke(o,s);a&&d&&(i.rangeCount!==1||i.anchorNode!==a.node||i.anchorOffset!==a.offset||i.focusNode!==d.node||i.focusOffset!==d.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),i.removeAllRanges(),c>s?(i.addRange(e),i.extend(d.node,d.offset)):(e.setEnd(d.node,d.offset),i.addRange(e)))}}for(e=[],i=o;i=i.parentNode;)i.nodeType===1&&e.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<e.length;o++)i=e[o],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(i,e,o){var s=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Te||Qe==null||Qe!==Xa(s)||(s=Qe,"selectionStart"in s&&Ne(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Se&&Ie(Se,s)||(Se=s,s=oe(Re,"onSelect"),0<s.length&&(e=new td("onSelect","select",null,e,o),i.push({event:e,listeners:s}),e.target=Qe)))}function Ve(i,e){var o={};return o[i.toLowerCase()]=e.toLowerCase(),o["Webkit"+i]="webkit"+e,o["Moz"+i]="moz"+e,o}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(i){if(Xe[i])return Xe[i];if(!We[i])return i;var e=We[i],o;for(o in e)if(e.hasOwnProperty(o)&&o in Ye)return Xe[i]=e[o];return i}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(i,e){df.set(i,e),fa(e,[i])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(i,e,o){var s=i.type||"unknown-event";i.currentTarget=o,Ub(s,e,void 0,i),i.currentTarget=null}function se(i,e){e=(e&4)!==0;for(var o=0;o<i.length;o++){var s=i[o],a=s.event;s=s.listeners;e:{var c=void 0;if(e)for(var d=s.length-1;0<=d;d--){var h=s[d],g=h.instance,_=h.currentTarget;if(h=h.listener,g!==c&&a.isPropagationStopped())break e;nf(a,h,_),c=g}else for(d=0;d<s.length;d++){if(h=s[d],g=h.instance,_=h.currentTarget,h=h.listener,g!==c&&a.isPropagationStopped())break e;nf(a,h,_),c=g}}}if(Qb)throw i=Rb,Qb=!1,Rb=null,i}function D(i,e){var o=e[of];o===void 0&&(o=e[of]=new Set);var s=i+"__bubble";o.has(s)||(pf(e,i,2,!1),o.add(s))}function qf(i,e,o){var s=0;e&&(s|=4),pf(o,i,s,e)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(i){if(!i[rf]){i[rf]=!0,da.forEach(function(o){o!=="selectionchange"&&(mf.has(o)||qf(o,!1,i),qf(o,!0,i))});var e=i.nodeType===9?i:i.ownerDocument;e===null||e[rf]||(e[rf]=!0,qf("selectionchange",!1,e))}}function pf(i,e,o,s){switch(jd(e)){case 1:var a=ed;break;case 4:a=gd;break;default:a=fd}o=a.bind(null,e,o,i),a=void 0,!Lb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),s?a!==void 0?i.addEventListener(e,o,{capture:!0,passive:a}):i.addEventListener(e,o,!0):a!==void 0?i.addEventListener(e,o,{passive:a}):i.addEventListener(e,o,!1)}function hd(i,e,o,s,a){var c=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var d=s.tag;if(d===3||d===4){var h=s.stateNode.containerInfo;if(h===a||h.nodeType===8&&h.parentNode===a)break;if(d===4)for(d=s.return;d!==null;){var g=d.tag;if((g===3||g===4)&&(g=d.stateNode.containerInfo,g===a||g.nodeType===8&&g.parentNode===a))return;d=d.return}for(;h!==null;){if(d=Wc(h),d===null)return;if(g=d.tag,g===5||g===6){s=c=d;continue e}h=h.parentNode}}s=s.return}Jb(function(){var _=c,j=xb(o),b=[];e:{var $=df.get(i);if($!==void 0){var nt=td,tt=i;switch(i){case"keypress":if(od(o)===0)break e;case"keydown":case"keyup":nt=Rd;break;case"focusin":tt="focus",nt=Fd;break;case"focusout":tt="blur",nt=Fd;break;case"beforeblur":case"afterblur":nt=Fd;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":nt=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":nt=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":nt=Vd;break;case $e:case af:case bf:nt=Hd;break;case cf:nt=Xd;break;case"scroll":nt=vd;break;case"wheel":nt=Zd;break;case"copy":case"cut":case"paste":nt=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":nt=Td}var it=(e&4)!==0,ot=!it&&i==="scroll",_e=it?$!==null?$+"Capture":null:$;it=[];for(var et=_,rt;et!==null;){rt=et;var st=rt.stateNode;if(rt.tag===5&&st!==null&&(rt=st,_e!==null&&(st=Kb(et,_e),st!=null&&it.push(tf(et,st,rt)))),ot)break;et=et.return}0<it.length&&($=new nt($,tt,null,o,j),b.push({event:$,listeners:it}))}}if(!(e&7)){e:{if($=i==="mouseover"||i==="pointerover",nt=i==="mouseout"||i==="pointerout",$&&o!==wb&&(tt=o.relatedTarget||o.fromElement)&&(Wc(tt)||tt[uf]))break e;if((nt||$)&&($=j.window===j?j:($=j.ownerDocument)?$.defaultView||$.parentWindow:window,nt?(tt=o.relatedTarget||o.toElement,nt=_,tt=tt?Wc(tt):null,tt!==null&&(ot=Vb(tt),tt!==ot||tt.tag!==5&&tt.tag!==6)&&(tt=null)):(nt=null,tt=_),nt!==tt)){if(it=Bd,st="onMouseLeave",_e="onMouseEnter",et="mouse",(i==="pointerout"||i==="pointerover")&&(it=Td,st="onPointerLeave",_e="onPointerEnter",et="pointer"),ot=nt==null?$:ue(nt),rt=tt==null?$:ue(tt),$=new it(st,et+"leave",nt,o,j),$.target=ot,$.relatedTarget=rt,st=null,Wc(j)===_&&(it=new it(_e,et+"enter",tt,o,j),it.target=rt,it.relatedTarget=ot,st=it),ot=st,nt&&tt)t:{for(it=nt,_e=tt,et=0,rt=it;rt;rt=vf(rt))et++;for(rt=0,st=_e;st;st=vf(st))rt++;for(;0<et-rt;)it=vf(it),et--;for(;0<rt-et;)_e=vf(_e),rt--;for(;et--;){if(it===_e||_e!==null&&it===_e.alternate)break t;it=vf(it),_e=vf(_e)}it=null}else it=null;nt!==null&&wf(b,$,nt,it,!1),tt!==null&&ot!==null&&wf(b,ot,tt,it,!0)}}e:{if($=_?ue(_):window,nt=$.nodeName&&$.nodeName.toLowerCase(),nt==="select"||nt==="input"&&$.type==="file")var dt=ve;else if(me($))if(we)dt=Fe;else{dt=De;var ht=Ce}else(nt=$.nodeName)&&nt.toLowerCase()==="input"&&($.type==="checkbox"||$.type==="radio")&&(dt=Ee);if(dt&&(dt=dt(i,_))){ne(b,dt,o,j);break e}ht&&ht(i,$,_),i==="focusout"&&(ht=$._wrapperState)&&ht.controlled&&$.type==="number"&&cb($,"number",$.value)}switch(ht=_?ue(_):window,i){case"focusin":(me(ht)||ht.contentEditable==="true")&&(Qe=ht,Re=_,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(b,o,j);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(b,o,j)}var mt;if(ae)e:{switch(i){case"compositionstart":var ft="onCompositionStart";break e;case"compositionend":ft="onCompositionEnd";break e;case"compositionupdate":ft="onCompositionUpdate";break e}ft=void 0}else ie?ge(i,o)&&(ft="onCompositionEnd"):i==="keydown"&&o.keyCode===229&&(ft="onCompositionStart");ft&&(de&&o.locale!=="ko"&&(ie||ft!=="onCompositionStart"?ft==="onCompositionEnd"&&ie&&(mt=nd()):(kd=j,ld="value"in kd?kd.value:kd.textContent,ie=!0)),ht=oe(_,ft),0<ht.length&&(ft=new Ld(ft,i,null,o,j),b.push({event:ft,listeners:ht}),mt?ft.data=mt:(mt=he(o),mt!==null&&(ft.data=mt)))),(mt=ce?je(i,o):ke(i,o))&&(_=oe(_,"onBeforeInput"),0<_.length&&(j=new Ld("onBeforeInput","beforeinput",null,o,j),b.push({event:j,listeners:_}),j.data=mt))}se(b,e)})}function tf(i,e,o){return{instance:i,listener:e,currentTarget:o}}function oe(i,e){for(var o=e+"Capture",s=[];i!==null;){var a=i,c=a.stateNode;a.tag===5&&c!==null&&(a=c,c=Kb(i,o),c!=null&&s.unshift(tf(i,c,a)),c=Kb(i,e),c!=null&&s.push(tf(i,c,a))),i=i.return}return s}function vf(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function wf(i,e,o,s,a){for(var c=e._reactName,d=[];o!==null&&o!==s;){var h=o,g=h.alternate,_=h.stateNode;if(g!==null&&g===s)break;h.tag===5&&_!==null&&(h=_,a?(g=Kb(o,c),g!=null&&d.unshift(tf(o,g,h))):a||(g=Kb(o,c),g!=null&&d.push(tf(o,g,h)))),o=o.return}d.length!==0&&i.push({event:e,listeners:d})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(i){return(typeof i=="string"?i:""+i).replace(xf,`
`).replace(yf,"")}function Af(i,e,o){if(e=zf(e),zf(i)!==e&&o)throw Error(p(425))}function Bf(){}var Cf=null,Df=null;function Ef(i,e){return i==="textarea"||i==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(i){return Hf.resolve(null).then(i).catch(If)}:Ff;function If(i){setTimeout(function(){throw i})}function Kf(i,e){var o=e,s=0;do{var a=o.nextSibling;if(i.removeChild(o),a&&a.nodeType===8)if(o=a.data,o==="/$"){if(s===0){i.removeChild(a),bd(e);return}s--}else o!=="$"&&o!=="$?"&&o!=="$!"||s++;o=a}while(o);bd(e)}function Lf(i){for(;i!=null;i=i.nextSibling){var e=i.nodeType;if(e===1||e===3)break;if(e===8){if(e=i.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return i}function Mf(i){i=i.previousSibling;for(var e=0;i;){if(i.nodeType===8){var o=i.data;if(o==="$"||o==="$!"||o==="$?"){if(e===0)return i;e--}else o==="/$"&&e++}i=i.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(i){var e=i[Of];if(e)return e;for(var o=i.parentNode;o;){if(e=o[uf]||o[Of]){if(o=e.alternate,e.child!==null||o!==null&&o.child!==null)for(i=Mf(i);i!==null;){if(o=i[Of])return o;i=Mf(i)}return e}i=o,o=i.parentNode}return null}function Cb(i){return i=i[Of]||i[uf],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function ue(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(p(33))}function Db(i){return i[Pf]||null}var Sf=[],Tf=-1;function Uf(i){return{current:i}}function E(i){0>Tf||(i.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(i,e){Tf++,Sf[Tf]=i.current,i.current=e}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(i,e){var o=i.type.contextTypes;if(!o)return Vf;var s=i.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var a={},c;for(c in o)a[c]=e[c];return s&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=e,i.__reactInternalMemoizedMaskedChildContext=a),a}function Zf(i){return i=i.childContextTypes,i!=null}function $f(){E(Wf),E(H)}function ag(i,e,o){if(H.current!==Vf)throw Error(p(168));G(H,e),G(Wf,o)}function bg(i,e,o){var s=i.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return o;s=s.getChildContext();for(var a in s)if(!(a in e))throw Error(p(108,Ra(i)||"Unknown",a));return A({},o,s)}function cg(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,i),G(Wf,Wf.current),!0}function dg(i,e,o){var s=i.stateNode;if(!s)throw Error(p(169));o?(i=bg(i,e,Xf),s.__reactInternalMemoizedMergedChildContext=i,E(Wf),E(H),G(H,i)):E(Wf),G(Wf,o)}var eg=null,fg=!1,gg=!1;function hg(i){eg===null?eg=[i]:eg.push(i)}function ig(i){fg=!0,hg(i)}function jg(){if(!gg&&eg!==null){gg=!0;var i=0,e=C;try{var o=eg;for(C=1;i<o.length;i++){var s=o[i];do s=s(!0);while(s!==null)}eg=null,fg=!1}catch(a){throw eg!==null&&(eg=eg.slice(i+1)),ac(fc,jg),a}finally{C=e,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(i,e){kg[lg++]=ng,kg[lg++]=mg,mg=i,ng=e}function ug(i,e,o){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=i;var s=rg;i=sg;var a=32-oc(s)-1;s&=~(1<<a),o+=1;var c=32-oc(e)+a;if(30<c){var d=a-a%5;c=(s&(1<<d)-1).toString(32),s>>=d,a-=d,rg=1<<32-oc(e)+a|o<<a|s,sg=c+i}else rg=1<<c|o<<a|s,sg=i}function vg(i){i.return!==null&&(tg(i,1),ug(i,1,0))}function wg(i){for(;i===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;i===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(i,e){var o=Bg(5,null,null,0);o.elementType="DELETED",o.stateNode=e,o.return=i,e=i.deletions,e===null?(i.deletions=[o],i.flags|=16):e.push(o)}function Cg(i,e){switch(i.tag){case 5:var o=i.type;return e=e.nodeType!==1||o.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(i.stateNode=e,xg=i,yg=Lf(e.firstChild),!0):!1;case 6:return e=i.pendingProps===""||e.nodeType!==3?null:e,e!==null?(i.stateNode=e,xg=i,yg=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(o=qg!==null?{id:rg,overflow:sg}:null,i.memoizedState={dehydrated:e,treeContext:o,retryLane:1073741824},o=Bg(18,null,null,0),o.stateNode=e,o.return=i,i.child=o,xg=i,yg=null,!0):!1;default:return!1}}function Dg(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Eg(i){if(I){var e=yg;if(e){var o=e;if(!Cg(i,e)){if(Dg(i))throw Error(p(418));e=Lf(o.nextSibling);var s=xg;e&&Cg(i,e)?Ag(s,o):(i.flags=i.flags&-4097|2,I=!1,xg=i)}}else{if(Dg(i))throw Error(p(418));i.flags=i.flags&-4097|2,I=!1,xg=i}}}function Fg(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;xg=i}function Gg(i){if(i!==xg)return!1;if(!I)return Fg(i),I=!0,!1;var e;if((e=i.tag!==3)&&!(e=i.tag!==5)&&(e=i.type,e=e!=="head"&&e!=="body"&&!Ef(i.type,i.memoizedProps)),e&&(e=yg)){if(Dg(i))throw Hg(),Error(p(418));for(;e;)Ag(i,e),e=Lf(e.nextSibling)}if(Fg(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(p(317));e:{for(i=i.nextSibling,e=0;i;){if(i.nodeType===8){var o=i.data;if(o==="/$"){if(e===0){yg=Lf(i.nextSibling);break e}e--}else o!=="$"&&o!=="$!"&&o!=="$?"||e++}i=i.nextSibling}yg=null}}else yg=xg?Lf(i.stateNode.nextSibling):null;return!0}function Hg(){for(var i=yg;i;)i=Lf(i.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(i){zg===null?zg=[i]:zg.push(i)}var Kg=ua.ReactCurrentBatchConfig;function Lg(i,e,o){if(i=o.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(p(309));var s=o.stateNode}if(!s)throw Error(p(147,i));var a=s,c=""+i;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===c?e.ref:(e=function(d){var h=a.refs;d===null?delete h[c]:h[c]=d},e._stringRef=c,e)}if(typeof i!="string")throw Error(p(284));if(!o._owner)throw Error(p(290,i))}return i}function Mg(i,e){throw i=Object.prototype.toString.call(e),Error(p(31,i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i))}function Ng(i){var e=i._init;return e(i._payload)}function Og(i){function e(_e,et){if(i){var rt=_e.deletions;rt===null?(_e.deletions=[et],_e.flags|=16):rt.push(et)}}function o(_e,et){if(!i)return null;for(;et!==null;)e(_e,et),et=et.sibling;return null}function s(_e,et){for(_e=new Map;et!==null;)et.key!==null?_e.set(et.key,et):_e.set(et.index,et),et=et.sibling;return _e}function a(_e,et){return _e=Pg(_e,et),_e.index=0,_e.sibling=null,_e}function c(_e,et,rt){return _e.index=rt,i?(rt=_e.alternate,rt!==null?(rt=rt.index,rt<et?(_e.flags|=2,et):rt):(_e.flags|=2,et)):(_e.flags|=1048576,et)}function d(_e){return i&&_e.alternate===null&&(_e.flags|=2),_e}function h(_e,et,rt,st){return et===null||et.tag!==6?(et=Qg(rt,_e.mode,st),et.return=_e,et):(et=a(et,rt),et.return=_e,et)}function g(_e,et,rt,st){var dt=rt.type;return dt===ya?j(_e,et,rt.props.children,st,rt.key):et!==null&&(et.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===Ha&&Ng(dt)===et.type)?(st=a(et,rt.props),st.ref=Lg(_e,et,rt),st.return=_e,st):(st=Rg(rt.type,rt.key,rt.props,null,_e.mode,st),st.ref=Lg(_e,et,rt),st.return=_e,st)}function _(_e,et,rt,st){return et===null||et.tag!==4||et.stateNode.containerInfo!==rt.containerInfo||et.stateNode.implementation!==rt.implementation?(et=Sg(rt,_e.mode,st),et.return=_e,et):(et=a(et,rt.children||[]),et.return=_e,et)}function j(_e,et,rt,st,dt){return et===null||et.tag!==7?(et=Tg(rt,_e.mode,st,dt),et.return=_e,et):(et=a(et,rt),et.return=_e,et)}function b(_e,et,rt){if(typeof et=="string"&&et!==""||typeof et=="number")return et=Qg(""+et,_e.mode,rt),et.return=_e,et;if(typeof et=="object"&&et!==null){switch(et.$$typeof){case va:return rt=Rg(et.type,et.key,et.props,null,_e.mode,rt),rt.ref=Lg(_e,null,et),rt.return=_e,rt;case wa:return et=Sg(et,_e.mode,rt),et.return=_e,et;case Ha:var st=et._init;return b(_e,st(et._payload),rt)}if(eb(et)||Ka(et))return et=Tg(et,_e.mode,rt,null),et.return=_e,et;Mg(_e,et)}return null}function $(_e,et,rt,st){var dt=et!==null?et.key:null;if(typeof rt=="string"&&rt!==""||typeof rt=="number")return dt!==null?null:h(_e,et,""+rt,st);if(typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case va:return rt.key===dt?g(_e,et,rt,st):null;case wa:return rt.key===dt?_(_e,et,rt,st):null;case Ha:return dt=rt._init,$(_e,et,dt(rt._payload),st)}if(eb(rt)||Ka(rt))return dt!==null?null:j(_e,et,rt,st,null);Mg(_e,rt)}return null}function nt(_e,et,rt,st,dt){if(typeof st=="string"&&st!==""||typeof st=="number")return _e=_e.get(rt)||null,h(et,_e,""+st,dt);if(typeof st=="object"&&st!==null){switch(st.$$typeof){case va:return _e=_e.get(st.key===null?rt:st.key)||null,g(et,_e,st,dt);case wa:return _e=_e.get(st.key===null?rt:st.key)||null,_(et,_e,st,dt);case Ha:var ht=st._init;return nt(_e,et,rt,ht(st._payload),dt)}if(eb(st)||Ka(st))return _e=_e.get(rt)||null,j(et,_e,st,dt,null);Mg(et,st)}return null}function tt(_e,et,rt,st){for(var dt=null,ht=null,mt=et,ft=et=0,bt=null;mt!==null&&ft<rt.length;ft++){mt.index>ft?(bt=mt,mt=null):bt=mt.sibling;var vt=$(_e,mt,rt[ft],st);if(vt===null){mt===null&&(mt=bt);break}i&&mt&&vt.alternate===null&&e(_e,mt),et=c(vt,et,ft),ht===null?dt=vt:ht.sibling=vt,ht=vt,mt=bt}if(ft===rt.length)return o(_e,mt),I&&tg(_e,ft),dt;if(mt===null){for(;ft<rt.length;ft++)mt=b(_e,rt[ft],st),mt!==null&&(et=c(mt,et,ft),ht===null?dt=mt:ht.sibling=mt,ht=mt);return I&&tg(_e,ft),dt}for(mt=s(_e,mt);ft<rt.length;ft++)bt=nt(mt,_e,ft,rt[ft],st),bt!==null&&(i&&bt.alternate!==null&&mt.delete(bt.key===null?ft:bt.key),et=c(bt,et,ft),ht===null?dt=bt:ht.sibling=bt,ht=bt);return i&&mt.forEach(function(Et){return e(_e,Et)}),I&&tg(_e,ft),dt}function it(_e,et,rt,st){var dt=Ka(rt);if(typeof dt!="function")throw Error(p(150));if(rt=dt.call(rt),rt==null)throw Error(p(151));for(var ht=dt=null,mt=et,ft=et=0,bt=null,vt=rt.next();mt!==null&&!vt.done;ft++,vt=rt.next()){mt.index>ft?(bt=mt,mt=null):bt=mt.sibling;var Et=$(_e,mt,vt.value,st);if(Et===null){mt===null&&(mt=bt);break}i&&mt&&Et.alternate===null&&e(_e,mt),et=c(Et,et,ft),ht===null?dt=Et:ht.sibling=Et,ht=Et,mt=bt}if(vt.done)return o(_e,mt),I&&tg(_e,ft),dt;if(mt===null){for(;!vt.done;ft++,vt=rt.next())vt=b(_e,vt.value,st),vt!==null&&(et=c(vt,et,ft),ht===null?dt=vt:ht.sibling=vt,ht=vt);return I&&tg(_e,ft),dt}for(mt=s(_e,mt);!vt.done;ft++,vt=rt.next())vt=nt(mt,_e,ft,vt.value,st),vt!==null&&(i&&vt.alternate!==null&&mt.delete(vt.key===null?ft:vt.key),et=c(vt,et,ft),ht===null?dt=vt:ht.sibling=vt,ht=vt);return i&&mt.forEach(function(It){return e(_e,It)}),I&&tg(_e,ft),dt}function ot(_e,et,rt,st){if(typeof rt=="object"&&rt!==null&&rt.type===ya&&rt.key===null&&(rt=rt.props.children),typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case va:e:{for(var dt=rt.key,ht=et;ht!==null;){if(ht.key===dt){if(dt=rt.type,dt===ya){if(ht.tag===7){o(_e,ht.sibling),et=a(ht,rt.props.children),et.return=_e,_e=et;break e}}else if(ht.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===Ha&&Ng(dt)===ht.type){o(_e,ht.sibling),et=a(ht,rt.props),et.ref=Lg(_e,ht,rt),et.return=_e,_e=et;break e}o(_e,ht);break}else e(_e,ht);ht=ht.sibling}rt.type===ya?(et=Tg(rt.props.children,_e.mode,st,rt.key),et.return=_e,_e=et):(st=Rg(rt.type,rt.key,rt.props,null,_e.mode,st),st.ref=Lg(_e,et,rt),st.return=_e,_e=st)}return d(_e);case wa:e:{for(ht=rt.key;et!==null;){if(et.key===ht)if(et.tag===4&&et.stateNode.containerInfo===rt.containerInfo&&et.stateNode.implementation===rt.implementation){o(_e,et.sibling),et=a(et,rt.children||[]),et.return=_e,_e=et;break e}else{o(_e,et);break}else e(_e,et);et=et.sibling}et=Sg(rt,_e.mode,st),et.return=_e,_e=et}return d(_e);case Ha:return ht=rt._init,ot(_e,et,ht(rt._payload),st)}if(eb(rt))return tt(_e,et,rt,st);if(Ka(rt))return it(_e,et,rt,st);Mg(_e,rt)}return typeof rt=="string"&&rt!==""||typeof rt=="number"?(rt=""+rt,et!==null&&et.tag===6?(o(_e,et.sibling),et=a(et,rt),et.return=_e,_e=et):(o(_e,et),et=Qg(rt,_e.mode,st),et.return=_e,_e=et),d(_e)):o(_e,et)}return ot}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(i){var e=Wg.current;E(Wg),i._currentValue=e}function bh(i,e,o){for(;i!==null;){var s=i.alternate;if((i.childLanes&e)!==e?(i.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),i===o)break;i=i.return}}function ch(i,e){Xg=i,Zg=Yg=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&e&&(dh=!0),i.firstContext=null)}function eh(i){var e=i._currentValue;if(Zg!==i)if(i={context:i,memoizedValue:e,next:null},Yg===null){if(Xg===null)throw Error(p(308));Yg=i,Xg.dependencies={lanes:0,firstContext:i}}else Yg=Yg.next=i;return e}var fh=null;function gh(i){fh===null?fh=[i]:fh.push(i)}function hh(i,e,o,s){var a=e.interleaved;return a===null?(o.next=o,gh(e)):(o.next=a.next,a.next=o),e.interleaved=o,ih(i,s)}function ih(i,e){i.lanes|=e;var o=i.alternate;for(o!==null&&(o.lanes|=e),o=i,i=i.return;i!==null;)i.childLanes|=e,o=i.alternate,o!==null&&(o.childLanes|=e),o=i,i=i.return;return o.tag===3?o.stateNode:null}var jh=!1;function kh(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(i,e){i=i.updateQueue,e.updateQueue===i&&(e.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function mh(i,e){return{eventTime:i,lane:e,tag:0,payload:null,callback:null,next:null}}function nh(i,e,o){var s=i.updateQueue;if(s===null)return null;if(s=s.shared,K&2){var a=s.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),s.pending=e,ih(i,o)}return a=s.interleaved,a===null?(e.next=e,gh(s)):(e.next=a.next,a.next=e),s.interleaved=e,ih(i,o)}function oh(i,e,o){if(e=e.updateQueue,e!==null&&(e=e.shared,(o&4194240)!==0)){var s=e.lanes;s&=i.pendingLanes,o|=s,e.lanes=o,Cc(i,o)}}function ph(i,e){var o=i.updateQueue,s=i.alternate;if(s!==null&&(s=s.updateQueue,o===s)){var a=null,c=null;if(o=o.firstBaseUpdate,o!==null){do{var d={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};c===null?a=c=d:c=c.next=d,o=o.next}while(o!==null);c===null?a=c=e:c=c.next=e}else a=c=e;o={baseState:s.baseState,firstBaseUpdate:a,lastBaseUpdate:c,shared:s.shared,effects:s.effects},i.updateQueue=o;return}i=o.lastBaseUpdate,i===null?o.firstBaseUpdate=e:i.next=e,o.lastBaseUpdate=e}function qh(i,e,o,s){var a=i.updateQueue;jh=!1;var c=a.firstBaseUpdate,d=a.lastBaseUpdate,h=a.shared.pending;if(h!==null){a.shared.pending=null;var g=h,_=g.next;g.next=null,d===null?c=_:d.next=_,d=g;var j=i.alternate;j!==null&&(j=j.updateQueue,h=j.lastBaseUpdate,h!==d&&(h===null?j.firstBaseUpdate=_:h.next=_,j.lastBaseUpdate=g))}if(c!==null){var b=a.baseState;d=0,j=_=g=null,h=c;do{var $=h.lane,nt=h.eventTime;if((s&$)===$){j!==null&&(j=j.next={eventTime:nt,lane:0,tag:h.tag,payload:h.payload,callback:h.callback,next:null});e:{var tt=i,it=h;switch($=e,nt=o,it.tag){case 1:if(tt=it.payload,typeof tt=="function"){b=tt.call(nt,b,$);break e}b=tt;break e;case 3:tt.flags=tt.flags&-65537|128;case 0:if(tt=it.payload,$=typeof tt=="function"?tt.call(nt,b,$):tt,$==null)break e;b=A({},b,$);break e;case 2:jh=!0}}h.callback!==null&&h.lane!==0&&(i.flags|=64,$=a.effects,$===null?a.effects=[h]:$.push(h))}else nt={eventTime:nt,lane:$,tag:h.tag,payload:h.payload,callback:h.callback,next:null},j===null?(_=j=nt,g=b):j=j.next=nt,d|=$;if(h=h.next,h===null){if(h=a.shared.pending,h===null)break;$=h,h=$.next,$.next=null,a.lastBaseUpdate=$,a.shared.pending=null}}while(1);if(j===null&&(g=b),a.baseState=g,a.firstBaseUpdate=_,a.lastBaseUpdate=j,e=a.shared.interleaved,e!==null){a=e;do d|=a.lane,a=a.next;while(a!==e)}else c===null&&(a.shared.lanes=0);rh|=d,i.lanes=d,i.memoizedState=b}}function sh(i,e,o){if(i=e.effects,e.effects=null,i!==null)for(e=0;e<i.length;e++){var s=i[e],a=s.callback;if(a!==null){if(s.callback=null,s=o,typeof a!="function")throw Error(p(191,a));a.call(s)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(i){if(i===th)throw Error(p(174));return i}function yh(i,e){switch(G(wh,e),G(vh,i),G(uh,th),i=e.nodeType,i){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lb(null,"");break;default:i=i===8?e.parentNode:e,e=i.namespaceURI||null,i=i.tagName,e=lb(e,i)}E(uh),G(uh,e)}function zh(){E(uh),E(vh),E(wh)}function Ah(i){xh(wh.current);var e=xh(uh.current),o=lb(e,i.type);e!==o&&(G(vh,i),G(uh,o))}function Bh(i){vh.current===i&&(E(uh),E(vh))}var L=Uf(0);function Ch(i){for(var e=i;e!==null;){if(e.tag===13){var o=e.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Dh=[];function Eh(){for(var i=0;i<Dh.length;i++)Dh[i]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P(){throw Error(p(321))}function Mh(i,e){if(e===null)return!1;for(var o=0;o<e.length&&o<i.length;o++)if(!He(i[o],e[o]))return!1;return!0}function Nh(i,e,o,s,a,c){if(Hh=c,M=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Fh.current=i===null||i.memoizedState===null?Oh:Ph,i=o(s,a),Jh){c=0;do{if(Jh=!1,Kh=0,25<=c)throw Error(p(301));c+=1,O=N=null,e.updateQueue=null,Fh.current=Qh,i=o(s,a)}while(Jh)}if(Fh.current=Rh,e=N!==null&&N.next!==null,Hh=0,O=N=M=null,Ih=!1,e)throw Error(p(300));return i}function Sh(){var i=Kh!==0;return Kh=0,i}function Th(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O===null?M.memoizedState=O=i:O=O.next=i,O}function Uh(){if(N===null){var i=M.alternate;i=i!==null?i.memoizedState:null}else i=N.next;var e=O===null?M.memoizedState:O.next;if(e!==null)O=e,N=i;else{if(i===null)throw Error(p(310));N=i,i={memoizedState:N.memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null},O===null?M.memoizedState=O=i:O=O.next=i}return O}function Vh(i,e){return typeof e=="function"?e(i):e}function Wh(i){var e=Uh(),o=e.queue;if(o===null)throw Error(p(311));o.lastRenderedReducer=i;var s=N,a=s.baseQueue,c=o.pending;if(c!==null){if(a!==null){var d=a.next;a.next=c.next,c.next=d}s.baseQueue=a=c,o.pending=null}if(a!==null){c=a.next,s=s.baseState;var h=d=null,g=null,_=c;do{var j=_.lane;if((Hh&j)===j)g!==null&&(g=g.next={lane:0,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null}),s=_.hasEagerState?_.eagerState:i(s,_.action);else{var b={lane:j,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null};g===null?(h=g=b,d=s):g=g.next=b,M.lanes|=j,rh|=j}_=_.next}while(_!==null&&_!==c);g===null?d=s:g.next=h,He(s,e.memoizedState)||(dh=!0),e.memoizedState=s,e.baseState=d,e.baseQueue=g,o.lastRenderedState=s}if(i=o.interleaved,i!==null){a=i;do c=a.lane,M.lanes|=c,rh|=c,a=a.next;while(a!==i)}else a===null&&(o.lanes=0);return[e.memoizedState,o.dispatch]}function Xh(i){var e=Uh(),o=e.queue;if(o===null)throw Error(p(311));o.lastRenderedReducer=i;var s=o.dispatch,a=o.pending,c=e.memoizedState;if(a!==null){o.pending=null;var d=a=a.next;do c=i(c,d.action),d=d.next;while(d!==a);He(c,e.memoizedState)||(dh=!0),e.memoizedState=c,e.baseQueue===null&&(e.baseState=c),o.lastRenderedState=c}return[c,s]}function Yh(){}function Zh(i,e){var o=M,s=Uh(),a=e(),c=!He(s.memoizedState,a);if(c&&(s.memoizedState=a,dh=!0),s=s.queue,$h(ai.bind(null,o,s,i),[i]),s.getSnapshot!==e||c||O!==null&&O.memoizedState.tag&1){if(o.flags|=2048,bi(9,ci.bind(null,o,s,a,e),void 0,null),Q===null)throw Error(p(349));Hh&30||di(o,e,a)}return a}function di(i,e,o){i.flags|=16384,i={getSnapshot:e,value:o},e=M.updateQueue,e===null?(e={lastEffect:null,stores:null},M.updateQueue=e,e.stores=[i]):(o=e.stores,o===null?e.stores=[i]:o.push(i))}function ci(i,e,o,s){e.value=o,e.getSnapshot=s,ei(e)&&fi(i)}function ai(i,e,o){return o(function(){ei(e)&&fi(i)})}function ei(i){var e=i.getSnapshot;i=i.value;try{var o=e();return!He(i,o)}catch{return!0}}function fi(i){var e=ih(i,1);e!==null&&gi(e,i,1,-1)}function hi(i){var e=Th();return typeof i=="function"&&(i=i()),e.memoizedState=e.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:i},e.queue=i,i=i.dispatch=ii.bind(null,M,i),[e.memoizedState,i]}function bi(i,e,o,s){return i={tag:i,create:e,destroy:o,deps:s,next:null},e=M.updateQueue,e===null?(e={lastEffect:null,stores:null},M.updateQueue=e,e.lastEffect=i.next=i):(o=e.lastEffect,o===null?e.lastEffect=i.next=i:(s=o.next,o.next=i,i.next=s,e.lastEffect=i)),i}function ji(){return Uh().memoizedState}function ki(i,e,o,s){var a=Th();M.flags|=i,a.memoizedState=bi(1|e,o,void 0,s===void 0?null:s)}function li(i,e,o,s){var a=Uh();s=s===void 0?null:s;var c=void 0;if(N!==null){var d=N.memoizedState;if(c=d.destroy,s!==null&&Mh(s,d.deps)){a.memoizedState=bi(e,o,c,s);return}}M.flags|=i,a.memoizedState=bi(1|e,o,c,s)}function mi(i,e){return ki(8390656,8,i,e)}function $h(i,e){return li(2048,8,i,e)}function ni(i,e){return li(4,2,i,e)}function oi(i,e){return li(4,4,i,e)}function pi(i,e){if(typeof e=="function")return i=i(),e(i),function(){e(null)};if(e!=null)return i=i(),e.current=i,function(){e.current=null}}function qi(i,e,o){return o=o!=null?o.concat([i]):null,li(4,4,pi.bind(null,e,i),o)}function ri(){}function si(i,e){var o=Uh();e=e===void 0?null:e;var s=o.memoizedState;return s!==null&&e!==null&&Mh(e,s[1])?s[0]:(o.memoizedState=[i,e],i)}function ti(i,e){var o=Uh();e=e===void 0?null:e;var s=o.memoizedState;return s!==null&&e!==null&&Mh(e,s[1])?s[0]:(i=i(),o.memoizedState=[i,e],i)}function ui(i,e,o){return Hh&21?(He(o,e)||(o=yc(),M.lanes|=o,rh|=o,i.baseState=!0),e):(i.baseState&&(i.baseState=!1,dh=!0),i.memoizedState=o)}function vi(i,e){var o=C;C=o!==0&&4>o?o:4,i(!0);var s=Gh.transition;Gh.transition={};try{i(!1),e()}finally{C=o,Gh.transition=s}}function wi(){return Uh().memoizedState}function xi(i,e,o){var s=yi(i);if(o={lane:s,action:o,hasEagerState:!1,eagerState:null,next:null},zi(i))Ai(e,o);else if(o=hh(i,e,o,s),o!==null){var a=R();gi(o,i,s,a),Bi(o,e,s)}}function ii(i,e,o){var s=yi(i),a={lane:s,action:o,hasEagerState:!1,eagerState:null,next:null};if(zi(i))Ai(e,a);else{var c=i.alternate;if(i.lanes===0&&(c===null||c.lanes===0)&&(c=e.lastRenderedReducer,c!==null))try{var d=e.lastRenderedState,h=c(d,o);if(a.hasEagerState=!0,a.eagerState=h,He(h,d)){var g=e.interleaved;g===null?(a.next=a,gh(e)):(a.next=g.next,g.next=a),e.interleaved=a;return}}catch{}finally{}o=hh(i,e,a,s),o!==null&&(a=R(),gi(o,i,s,a),Bi(o,e,s))}}function zi(i){var e=i.alternate;return i===M||e!==null&&e===M}function Ai(i,e){Jh=Ih=!0;var o=i.pending;o===null?e.next=e:(e.next=o.next,o.next=e),i.pending=e}function Bi(i,e,o){if(o&4194240){var s=e.lanes;s&=i.pendingLanes,o|=s,e.lanes=o,Cc(i,o)}}var Rh={readContext:eh,useCallback:P,useContext:P,useEffect:P,useImperativeHandle:P,useInsertionEffect:P,useLayoutEffect:P,useMemo:P,useReducer:P,useRef:P,useState:P,useDebugValue:P,useDeferredValue:P,useTransition:P,useMutableSource:P,useSyncExternalStore:P,useId:P,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(i,e){return Th().memoizedState=[i,e===void 0?null:e],i},useContext:eh,useEffect:mi,useImperativeHandle:function(i,e,o){return o=o!=null?o.concat([i]):null,ki(4194308,4,pi.bind(null,e,i),o)},useLayoutEffect:function(i,e){return ki(4194308,4,i,e)},useInsertionEffect:function(i,e){return ki(4,2,i,e)},useMemo:function(i,e){var o=Th();return e=e===void 0?null:e,i=i(),o.memoizedState=[i,e],i},useReducer:function(i,e,o){var s=Th();return e=o!==void 0?o(e):e,s.memoizedState=s.baseState=e,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:e},s.queue=i,i=i.dispatch=xi.bind(null,M,i),[s.memoizedState,i]},useRef:function(i){var e=Th();return i={current:i},e.memoizedState=i},useState:hi,useDebugValue:ri,useDeferredValue:function(i){return Th().memoizedState=i},useTransition:function(){var i=hi(!1),e=i[0];return i=vi.bind(null,i[1]),Th().memoizedState=i,[e,i]},useMutableSource:function(){},useSyncExternalStore:function(i,e,o){var s=M,a=Th();if(I){if(o===void 0)throw Error(p(407));o=o()}else{if(o=e(),Q===null)throw Error(p(349));Hh&30||di(s,e,o)}a.memoizedState=o;var c={value:o,getSnapshot:e};return a.queue=c,mi(ai.bind(null,s,c,i),[i]),s.flags|=2048,bi(9,ci.bind(null,s,c,o,e),void 0,null),o},useId:function(){var i=Th(),e=Q.identifierPrefix;if(I){var o=sg,s=rg;o=(s&~(1<<32-oc(s)-1)).toString(32)+o,e=":"+e+"R"+o,o=Kh++,0<o&&(e+="H"+o.toString(32)),e+=":"}else o=Lh++,e=":"+e+"r"+o.toString(32)+":";return i.memoizedState=e},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(i){var e=Uh();return ui(e,N.memoizedState,i)},useTransition:function(){var i=Wh(Vh)[0],e=Uh().memoizedState;return[i,e]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(i){var e=Uh();return N===null?e.memoizedState=i:ui(e,N.memoizedState,i)},useTransition:function(){var i=Xh(Vh)[0],e=Uh().memoizedState;return[i,e]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(i,e){if(i&&i.defaultProps){e=A({},e),i=i.defaultProps;for(var o in i)e[o]===void 0&&(e[o]=i[o]);return e}return e}function Di(i,e,o,s){e=i.memoizedState,o=o(s,e),o=o==null?e:A({},e,o),i.memoizedState=o,i.lanes===0&&(i.updateQueue.baseState=o)}var Ei={isMounted:function(i){return(i=i._reactInternals)?Vb(i)===i:!1},enqueueSetState:function(i,e,o){i=i._reactInternals;var s=R(),a=yi(i),c=mh(s,a);c.payload=e,o!=null&&(c.callback=o),e=nh(i,c,a),e!==null&&(gi(e,i,a,s),oh(e,i,a))},enqueueReplaceState:function(i,e,o){i=i._reactInternals;var s=R(),a=yi(i),c=mh(s,a);c.tag=1,c.payload=e,o!=null&&(c.callback=o),e=nh(i,c,a),e!==null&&(gi(e,i,a,s),oh(e,i,a))},enqueueForceUpdate:function(i,e){i=i._reactInternals;var o=R(),s=yi(i),a=mh(o,s);a.tag=2,e!=null&&(a.callback=e),e=nh(i,a,s),e!==null&&(gi(e,i,s,o),oh(e,i,s))}};function Fi(i,e,o,s,a,c,d){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(s,c,d):e.prototype&&e.prototype.isPureReactComponent?!Ie(o,s)||!Ie(a,c):!0}function Gi(i,e,o){var s=!1,a=Vf,c=e.contextType;return typeof c=="object"&&c!==null?c=eh(c):(a=Zf(e)?Xf:H.current,s=e.contextTypes,c=(s=s!=null)?Yf(i,a):Vf),e=new e(o,c),i.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ei,i.stateNode=e,e._reactInternals=i,s&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=a,i.__reactInternalMemoizedMaskedChildContext=c),e}function Hi(i,e,o,s){i=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(o,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(o,s),e.state!==i&&Ei.enqueueReplaceState(e,e.state,null)}function Ii(i,e,o,s){var a=i.stateNode;a.props=o,a.state=i.memoizedState,a.refs={},kh(i);var c=e.contextType;typeof c=="object"&&c!==null?a.context=eh(c):(c=Zf(e)?Xf:H.current,a.context=Yf(i,c)),a.state=i.memoizedState,c=e.getDerivedStateFromProps,typeof c=="function"&&(Di(i,e,c,o),a.state=i.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&Ei.enqueueReplaceState(a,a.state,null),qh(i,o,a,s),a.state=i.memoizedState),typeof a.componentDidMount=="function"&&(i.flags|=4194308)}function Ji(i,e){try{var o="",s=e;do o+=Pa(s),s=s.return;while(s);var a=o}catch(c){a=`
Error generating stack: `+c.message+`
`+c.stack}return{value:i,source:e,stack:a,digest:null}}function Ki(i,e,o){return{value:i,source:null,stack:o??null,digest:e??null}}function Li(i,e){try{console.error(e.value)}catch(o){setTimeout(function(){throw o})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(i,e,o){o=mh(-1,o),o.tag=3,o.payload={element:null};var s=e.value;return o.callback=function(){Oi||(Oi=!0,Pi=s),Li(i,e)},o}function Qi(i,e,o){o=mh(-1,o),o.tag=3;var s=i.type.getDerivedStateFromError;if(typeof s=="function"){var a=e.value;o.payload=function(){return s(a)},o.callback=function(){Li(i,e)}}var c=i.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(o.callback=function(){Li(i,e),typeof s!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var d=e.stack;this.componentDidCatch(e.value,{componentStack:d!==null?d:""})}),o}function Si(i,e,o){var s=i.pingCache;if(s===null){s=i.pingCache=new Mi;var a=new Set;s.set(e,a)}else a=s.get(e),a===void 0&&(a=new Set,s.set(e,a));a.has(o)||(a.add(o),i=Ti.bind(null,i,e,o),e.then(i,i))}function Ui(i){do{var e;if((e=i.tag===13)&&(e=i.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return i;i=i.return}while(i!==null);return null}function Vi(i,e,o,s,a){return i.mode&1?(i.flags|=65536,i.lanes=a,i):(i===e?i.flags|=65536:(i.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(e=mh(-1,1),e.tag=2,nh(o,e,1))),o.lanes|=1),i)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(i,e,o,s){e.child=i===null?Vg(e,null,o,s):Ug(e,i.child,o,s)}function Yi(i,e,o,s,a){o=o.render;var c=e.ref;return ch(e,a),s=Nh(i,e,o,s,c,a),o=Sh(),i!==null&&!dh?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~a,Zi(i,e,a)):(I&&o&&vg(e),e.flags|=1,Xi(i,e,s,a),e.child)}function $i(i,e,o,s,a){if(i===null){var c=o.type;return typeof c=="function"&&!aj(c)&&c.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(e.tag=15,e.type=c,bj(i,e,c,s,a)):(i=Rg(o.type,null,s,e,e.mode,a),i.ref=e.ref,i.return=e,e.child=i)}if(c=i.child,!(i.lanes&a)){var d=c.memoizedProps;if(o=o.compare,o=o!==null?o:Ie,o(d,s)&&i.ref===e.ref)return Zi(i,e,a)}return e.flags|=1,i=Pg(c,s),i.ref=e.ref,i.return=e,e.child=i}function bj(i,e,o,s,a){if(i!==null){var c=i.memoizedProps;if(Ie(c,s)&&i.ref===e.ref)if(dh=!1,e.pendingProps=s=c,(i.lanes&a)!==0)i.flags&131072&&(dh=!0);else return e.lanes=i.lanes,Zi(i,e,a)}return cj(i,e,o,s,a)}function dj(i,e,o){var s=e.pendingProps,a=s.children,c=i!==null?i.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=o;else{if(!(o&1073741824))return i=c!==null?c.baseLanes|o:o,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:i,cachePool:null,transitions:null},e.updateQueue=null,G(ej,fj),fj|=i,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=c!==null?c.baseLanes:o,G(ej,fj),fj|=s}else c!==null?(s=c.baseLanes|o,e.memoizedState=null):s=o,G(ej,fj),fj|=s;return Xi(i,e,a,o),e.child}function gj(i,e){var o=e.ref;(i===null&&o!==null||i!==null&&i.ref!==o)&&(e.flags|=512,e.flags|=2097152)}function cj(i,e,o,s,a){var c=Zf(o)?Xf:H.current;return c=Yf(e,c),ch(e,a),o=Nh(i,e,o,s,c,a),s=Sh(),i!==null&&!dh?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~a,Zi(i,e,a)):(I&&s&&vg(e),e.flags|=1,Xi(i,e,o,a),e.child)}function hj(i,e,o,s,a){if(Zf(o)){var c=!0;cg(e)}else c=!1;if(ch(e,a),e.stateNode===null)ij(i,e),Gi(e,o,s),Ii(e,o,s,a),s=!0;else if(i===null){var d=e.stateNode,h=e.memoizedProps;d.props=h;var g=d.context,_=o.contextType;typeof _=="object"&&_!==null?_=eh(_):(_=Zf(o)?Xf:H.current,_=Yf(e,_));var j=o.getDerivedStateFromProps,b=typeof j=="function"||typeof d.getSnapshotBeforeUpdate=="function";b||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(h!==s||g!==_)&&Hi(e,d,s,_),jh=!1;var $=e.memoizedState;d.state=$,qh(e,s,d,a),g=e.memoizedState,h!==s||$!==g||Wf.current||jh?(typeof j=="function"&&(Di(e,o,j,s),g=e.memoizedState),(h=jh||Fi(e,o,h,s,$,g,_))?(b||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(e.flags|=4194308)):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=g),d.props=s,d.state=g,d.context=_,s=h):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{d=e.stateNode,lh(i,e),h=e.memoizedProps,_=e.type===e.elementType?h:Ci(e.type,h),d.props=_,b=e.pendingProps,$=d.context,g=o.contextType,typeof g=="object"&&g!==null?g=eh(g):(g=Zf(o)?Xf:H.current,g=Yf(e,g));var nt=o.getDerivedStateFromProps;(j=typeof nt=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(h!==b||$!==g)&&Hi(e,d,s,g),jh=!1,$=e.memoizedState,d.state=$,qh(e,s,d,a);var tt=e.memoizedState;h!==b||$!==tt||Wf.current||jh?(typeof nt=="function"&&(Di(e,o,nt,s),tt=e.memoizedState),(_=jh||Fi(e,o,_,s,$,tt,g)||!1)?(j||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(s,tt,g),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(s,tt,g)),typeof d.componentDidUpdate=="function"&&(e.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof d.componentDidUpdate!="function"||h===i.memoizedProps&&$===i.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||h===i.memoizedProps&&$===i.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=tt),d.props=s,d.state=tt,d.context=g,s=_):(typeof d.componentDidUpdate!="function"||h===i.memoizedProps&&$===i.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||h===i.memoizedProps&&$===i.memoizedState||(e.flags|=1024),s=!1)}return jj(i,e,o,s,c,a)}function jj(i,e,o,s,a,c){gj(i,e);var d=(e.flags&128)!==0;if(!s&&!d)return a&&dg(e,o,!1),Zi(i,e,c);s=e.stateNode,Wi.current=e;var h=d&&typeof o.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,i!==null&&d?(e.child=Ug(e,i.child,null,c),e.child=Ug(e,null,h,c)):Xi(i,e,h,c),e.memoizedState=s.state,a&&dg(e,o,!0),e.child}function kj(i){var e=i.stateNode;e.pendingContext?ag(i,e.pendingContext,e.pendingContext!==e.context):e.context&&ag(i,e.context,!1),yh(i,e.containerInfo)}function lj(i,e,o,s,a){return Ig(),Jg(a),e.flags|=256,Xi(i,e,o,s),e.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(i){return{baseLanes:i,cachePool:null,transitions:null}}function oj(i,e,o){var s=e.pendingProps,a=L.current,c=!1,d=(e.flags&128)!==0,h;if((h=d)||(h=i!==null&&i.memoizedState===null?!1:(a&2)!==0),h?(c=!0,e.flags&=-129):(i===null||i.memoizedState!==null)&&(a|=1),G(L,a&1),i===null)return Eg(e),i=e.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(e.mode&1?i.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(d=s.children,i=s.fallback,c?(s=e.mode,c=e.child,d={mode:"hidden",children:d},!(s&1)&&c!==null?(c.childLanes=0,c.pendingProps=d):c=pj(d,s,0,null),i=Tg(i,s,o,null),c.return=e,i.return=e,c.sibling=i,e.child=c,e.child.memoizedState=nj(o),e.memoizedState=mj,i):qj(e,d));if(a=i.memoizedState,a!==null&&(h=a.dehydrated,h!==null))return rj(i,e,d,s,h,a,o);if(c){c=s.fallback,d=e.mode,a=i.child,h=a.sibling;var g={mode:"hidden",children:s.children};return!(d&1)&&e.child!==a?(s=e.child,s.childLanes=0,s.pendingProps=g,e.deletions=null):(s=Pg(a,g),s.subtreeFlags=a.subtreeFlags&14680064),h!==null?c=Pg(h,c):(c=Tg(c,d,o,null),c.flags|=2),c.return=e,s.return=e,s.sibling=c,e.child=s,s=c,c=e.child,d=i.child.memoizedState,d=d===null?nj(o):{baseLanes:d.baseLanes|o,cachePool:null,transitions:d.transitions},c.memoizedState=d,c.childLanes=i.childLanes&~o,e.memoizedState=mj,s}return c=i.child,i=c.sibling,s=Pg(c,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=o),s.return=e,s.sibling=null,i!==null&&(o=e.deletions,o===null?(e.deletions=[i],e.flags|=16):o.push(i)),e.child=s,e.memoizedState=null,s}function qj(i,e){return e=pj({mode:"visible",children:e},i.mode,0,null),e.return=i,i.child=e}function sj(i,e,o,s){return s!==null&&Jg(s),Ug(e,i.child,null,o),i=qj(e,e.pendingProps.children),i.flags|=2,e.memoizedState=null,i}function rj(i,e,o,s,a,c,d){if(o)return e.flags&256?(e.flags&=-257,s=Ki(Error(p(422))),sj(i,e,d,s)):e.memoizedState!==null?(e.child=i.child,e.flags|=128,null):(c=s.fallback,a=e.mode,s=pj({mode:"visible",children:s.children},a,0,null),c=Tg(c,a,d,null),c.flags|=2,s.return=e,c.return=e,s.sibling=c,e.child=s,e.mode&1&&Ug(e,i.child,null,d),e.child.memoizedState=nj(d),e.memoizedState=mj,c);if(!(e.mode&1))return sj(i,e,d,null);if(a.data==="$!"){if(s=a.nextSibling&&a.nextSibling.dataset,s)var h=s.dgst;return s=h,c=Error(p(419)),s=Ki(c,s,void 0),sj(i,e,d,s)}if(h=(d&i.childLanes)!==0,dh||h){if(s=Q,s!==null){switch(d&-d){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(s.suspendedLanes|d)?0:a,a!==0&&a!==c.retryLane&&(c.retryLane=a,ih(i,a),gi(s,i,a,-1))}return tj(),s=Ki(Error(p(421))),sj(i,e,d,s)}return a.data==="$?"?(e.flags|=128,e.child=i.child,e=uj.bind(null,i),a._reactRetry=e,null):(i=c.treeContext,yg=Lf(a.nextSibling),xg=e,I=!0,zg=null,i!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=i.id,sg=i.overflow,qg=e),e=qj(e,s.children),e.flags|=4096,e)}function vj(i,e,o){i.lanes|=e;var s=i.alternate;s!==null&&(s.lanes|=e),bh(i.return,e,o)}function wj(i,e,o,s,a){var c=i.memoizedState;c===null?i.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:o,tailMode:a}:(c.isBackwards=e,c.rendering=null,c.renderingStartTime=0,c.last=s,c.tail=o,c.tailMode=a)}function xj(i,e,o){var s=e.pendingProps,a=s.revealOrder,c=s.tail;if(Xi(i,e,s.children,o),s=L.current,s&2)s=s&1|2,e.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=e.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&vj(i,o,e);else if(i.tag===19)vj(i,o,e);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break e;for(;i.sibling===null;){if(i.return===null||i.return===e)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}s&=1}if(G(L,s),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(o=e.child,a=null;o!==null;)i=o.alternate,i!==null&&Ch(i)===null&&(a=o),o=o.sibling;o=a,o===null?(a=e.child,e.child=null):(a=o.sibling,o.sibling=null),wj(e,!1,a,o,c);break;case"backwards":for(o=null,a=e.child,e.child=null;a!==null;){if(i=a.alternate,i!==null&&Ch(i)===null){e.child=a;break}i=a.sibling,a.sibling=o,o=a,a=i}wj(e,!0,o,null,c);break;case"together":wj(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ij(i,e){!(e.mode&1)&&i!==null&&(i.alternate=null,e.alternate=null,e.flags|=2)}function Zi(i,e,o){if(i!==null&&(e.dependencies=i.dependencies),rh|=e.lanes,!(o&e.childLanes))return null;if(i!==null&&e.child!==i.child)throw Error(p(153));if(e.child!==null){for(i=e.child,o=Pg(i,i.pendingProps),e.child=o,o.return=e;i.sibling!==null;)i=i.sibling,o=o.sibling=Pg(i,i.pendingProps),o.return=e;o.sibling=null}return e.child}function yj(i,e,o){switch(e.tag){case 3:kj(e),Ig();break;case 5:Ah(e);break;case 1:Zf(e.type)&&cg(e);break;case 4:yh(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,a=e.memoizedProps.value;G(Wg,s._currentValue),s._currentValue=a;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(G(L,L.current&1),e.flags|=128,null):o&e.child.childLanes?oj(i,e,o):(G(L,L.current&1),i=Zi(i,e,o),i!==null?i.sibling:null);G(L,L.current&1);break;case 19:if(s=(o&e.childLanes)!==0,i.flags&128){if(s)return xj(i,e,o);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),G(L,L.current),s)break;return null;case 22:case 23:return e.lanes=0,dj(i,e,o)}return Zi(i,e,o)}var zj,Aj,Bj,Cj;zj=function(i,e){for(var o=e.child;o!==null;){if(o.tag===5||o.tag===6)i.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===e)break;for(;o.sibling===null;){if(o.return===null||o.return===e)return;o=o.return}o.sibling.return=o.return,o=o.sibling}};Aj=function(){};Bj=function(i,e,o,s){var a=i.memoizedProps;if(a!==s){i=e.stateNode,xh(uh.current);var c=null;switch(o){case"input":a=Ya(i,a),s=Ya(i,s),c=[];break;case"select":a=A({},a,{value:void 0}),s=A({},s,{value:void 0}),c=[];break;case"textarea":a=gb(i,a),s=gb(i,s),c=[];break;default:typeof a.onClick!="function"&&typeof s.onClick=="function"&&(i.onclick=Bf)}ub(o,s);var d;o=null;for(_ in a)if(!s.hasOwnProperty(_)&&a.hasOwnProperty(_)&&a[_]!=null)if(_==="style"){var h=a[_];for(d in h)h.hasOwnProperty(d)&&(o||(o={}),o[d]="")}else _!=="dangerouslySetInnerHTML"&&_!=="children"&&_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(ea.hasOwnProperty(_)?c||(c=[]):(c=c||[]).push(_,null));for(_ in s){var g=s[_];if(h=a!=null?a[_]:void 0,s.hasOwnProperty(_)&&g!==h&&(g!=null||h!=null))if(_==="style")if(h){for(d in h)!h.hasOwnProperty(d)||g&&g.hasOwnProperty(d)||(o||(o={}),o[d]="");for(d in g)g.hasOwnProperty(d)&&h[d]!==g[d]&&(o||(o={}),o[d]=g[d])}else o||(c||(c=[]),c.push(_,o)),o=g;else _==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,h=h?h.__html:void 0,g!=null&&h!==g&&(c=c||[]).push(_,g)):_==="children"?typeof g!="string"&&typeof g!="number"||(c=c||[]).push(_,""+g):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&(ea.hasOwnProperty(_)?(g!=null&&_==="onScroll"&&D("scroll",i),c||h===g||(c=[])):(c=c||[]).push(_,g))}o&&(c=c||[]).push("style",o);var _=c;(e.updateQueue=_)&&(e.flags|=4)}};Cj=function(i,e,o,s){o!==s&&(e.flags|=4)};function Dj(i,e){if(!I)switch(i.tailMode){case"hidden":e=i.tail;for(var o=null;e!==null;)e.alternate!==null&&(o=e),e=e.sibling;o===null?i.tail=null:o.sibling=null;break;case"collapsed":o=i.tail;for(var s=null;o!==null;)o.alternate!==null&&(s=o),o=o.sibling;s===null?e||i.tail===null?i.tail=null:i.tail.sibling=null:s.sibling=null}}function S(i){var e=i.alternate!==null&&i.alternate.child===i.child,o=0,s=0;if(e)for(var a=i.child;a!==null;)o|=a.lanes|a.childLanes,s|=a.subtreeFlags&14680064,s|=a.flags&14680064,a.return=i,a=a.sibling;else for(a=i.child;a!==null;)o|=a.lanes|a.childLanes,s|=a.subtreeFlags,s|=a.flags,a.return=i,a=a.sibling;return i.subtreeFlags|=s,i.childLanes=o,e}function Ej(i,e,o){var s=e.pendingProps;switch(wg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(e),null;case 1:return Zf(e.type)&&$f(),S(e),null;case 3:return s=e.stateNode,zh(),E(Wf),E(H),Eh(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(i===null||i.child===null)&&(Gg(e)?e.flags|=4:i===null||i.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(i,e),S(e),null;case 5:Bh(e);var a=xh(wh.current);if(o=e.type,i!==null&&e.stateNode!=null)Bj(i,e,o,s,a),i.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(p(166));return S(e),null}if(i=xh(uh.current),Gg(e)){s=e.stateNode,o=e.type;var c=e.memoizedProps;switch(s[Of]=e,s[Pf]=c,i=(e.mode&1)!==0,o){case"dialog":D("cancel",s),D("close",s);break;case"iframe":case"object":case"embed":D("load",s);break;case"video":case"audio":for(a=0;a<lf.length;a++)D(lf[a],s);break;case"source":D("error",s);break;case"img":case"image":case"link":D("error",s),D("load",s);break;case"details":D("toggle",s);break;case"input":Za(s,c),D("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!c.multiple},D("invalid",s);break;case"textarea":hb(s,c),D("invalid",s)}ub(o,c),a=null;for(var d in c)if(c.hasOwnProperty(d)){var h=c[d];d==="children"?typeof h=="string"?s.textContent!==h&&(c.suppressHydrationWarning!==!0&&Af(s.textContent,h,i),a=["children",h]):typeof h=="number"&&s.textContent!==""+h&&(c.suppressHydrationWarning!==!0&&Af(s.textContent,h,i),a=["children",""+h]):ea.hasOwnProperty(d)&&h!=null&&d==="onScroll"&&D("scroll",s)}switch(o){case"input":Va(s),db(s,c,!0);break;case"textarea":Va(s),jb(s);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(s.onclick=Bf)}s=a,e.updateQueue=s,s!==null&&(e.flags|=4)}else{d=a.nodeType===9?a:a.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=kb(o)),i==="http://www.w3.org/1999/xhtml"?o==="script"?(i=d.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof s.is=="string"?i=d.createElement(o,{is:s.is}):(i=d.createElement(o),o==="select"&&(d=i,s.multiple?d.multiple=!0:s.size&&(d.size=s.size))):i=d.createElementNS(i,o),i[Of]=e,i[Pf]=s,zj(i,e,!1,!1),e.stateNode=i;e:{switch(d=vb(o,s),o){case"dialog":D("cancel",i),D("close",i),a=s;break;case"iframe":case"object":case"embed":D("load",i),a=s;break;case"video":case"audio":for(a=0;a<lf.length;a++)D(lf[a],i);a=s;break;case"source":D("error",i),a=s;break;case"img":case"image":case"link":D("error",i),D("load",i),a=s;break;case"details":D("toggle",i),a=s;break;case"input":Za(i,s),a=Ya(i,s),D("invalid",i);break;case"option":a=s;break;case"select":i._wrapperState={wasMultiple:!!s.multiple},a=A({},s,{value:void 0}),D("invalid",i);break;case"textarea":hb(i,s),a=gb(i,s),D("invalid",i);break;default:a=s}ub(o,a),h=a;for(c in h)if(h.hasOwnProperty(c)){var g=h[c];c==="style"?sb(i,g):c==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,g!=null&&nb(i,g)):c==="children"?typeof g=="string"?(o!=="textarea"||g!=="")&&ob(i,g):typeof g=="number"&&ob(i,""+g):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ea.hasOwnProperty(c)?g!=null&&c==="onScroll"&&D("scroll",i):g!=null&&ta(i,c,g,d))}switch(o){case"input":Va(i),db(i,s,!1);break;case"textarea":Va(i),jb(i);break;case"option":s.value!=null&&i.setAttribute("value",""+Sa(s.value));break;case"select":i.multiple=!!s.multiple,c=s.value,c!=null?fb(i,!!s.multiple,c,!1):s.defaultValue!=null&&fb(i,!!s.multiple,s.defaultValue,!0);break;default:typeof a.onClick=="function"&&(i.onclick=Bf)}switch(o){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return S(e),null;case 6:if(i&&e.stateNode!=null)Cj(i,e,i.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(p(166));if(o=xh(wh.current),xh(uh.current),Gg(e)){if(s=e.stateNode,o=e.memoizedProps,s[Of]=e,(c=s.nodeValue!==o)&&(i=xg,i!==null))switch(i.tag){case 3:Af(s.nodeValue,o,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Af(s.nodeValue,o,(i.mode&1)!==0)}c&&(e.flags|=4)}else s=(o.nodeType===9?o:o.ownerDocument).createTextNode(s),s[Of]=e,e.stateNode=s}return S(e),null;case 13:if(E(L),s=e.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(I&&yg!==null&&e.mode&1&&!(e.flags&128))Hg(),Ig(),e.flags|=98560,c=!1;else if(c=Gg(e),s!==null&&s.dehydrated!==null){if(i===null){if(!c)throw Error(p(318));if(c=e.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(p(317));c[Of]=e}else Ig(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;S(e),c=!1}else zg!==null&&(Fj(zg),zg=null),c=!0;if(!c)return e.flags&65536?e:null}return e.flags&128?(e.lanes=o,e):(s=s!==null,s!==(i!==null&&i.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(i===null||L.current&1?T===0&&(T=3):tj())),e.updateQueue!==null&&(e.flags|=4),S(e),null);case 4:return zh(),Aj(i,e),i===null&&sf(e.stateNode.containerInfo),S(e),null;case 10:return ah(e.type._context),S(e),null;case 17:return Zf(e.type)&&$f(),S(e),null;case 19:if(E(L),c=e.memoizedState,c===null)return S(e),null;if(s=(e.flags&128)!==0,d=c.rendering,d===null)if(s)Dj(c,!1);else{if(T!==0||i!==null&&i.flags&128)for(i=e.child;i!==null;){if(d=Ch(i),d!==null){for(e.flags|=128,Dj(c,!1),s=d.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=o,o=e.child;o!==null;)c=o,i=s,c.flags&=14680066,d=c.alternate,d===null?(c.childLanes=0,c.lanes=i,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=d.childLanes,c.lanes=d.lanes,c.child=d.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=d.memoizedProps,c.memoizedState=d.memoizedState,c.updateQueue=d.updateQueue,c.type=d.type,i=d.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),o=o.sibling;return G(L,L.current&1|2),e.child}i=i.sibling}c.tail!==null&&B()>Gj&&(e.flags|=128,s=!0,Dj(c,!1),e.lanes=4194304)}else{if(!s)if(i=Ch(d),i!==null){if(e.flags|=128,s=!0,o=i.updateQueue,o!==null&&(e.updateQueue=o,e.flags|=4),Dj(c,!0),c.tail===null&&c.tailMode==="hidden"&&!d.alternate&&!I)return S(e),null}else 2*B()-c.renderingStartTime>Gj&&o!==1073741824&&(e.flags|=128,s=!0,Dj(c,!1),e.lanes=4194304);c.isBackwards?(d.sibling=e.child,e.child=d):(o=c.last,o!==null?o.sibling=d:e.child=d,c.last=d)}return c.tail!==null?(e=c.tail,c.rendering=e,c.tail=e.sibling,c.renderingStartTime=B(),e.sibling=null,o=L.current,G(L,s?o&1|2:o&1),e):(S(e),null);case 22:case 23:return Hj(),s=e.memoizedState!==null,i!==null&&i.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?fj&1073741824&&(S(e),e.subtreeFlags&6&&(e.flags|=8192)):S(e),null;case 24:return null;case 25:return null}throw Error(p(156,e.tag))}function Ij(i,e){switch(wg(e),e.tag){case 1:return Zf(e.type)&&$f(),i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 3:return zh(),E(Wf),E(H),Eh(),i=e.flags,i&65536&&!(i&128)?(e.flags=i&-65537|128,e):null;case 5:return Bh(e),null;case 13:if(E(L),i=e.memoizedState,i!==null&&i.dehydrated!==null){if(e.alternate===null)throw Error(p(340));Ig()}return i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 19:return E(L),null;case 4:return zh(),null;case 10:return ah(e.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lj(i,e){var o=i.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(s){W(i,e,s)}else o.current=null}function Mj(i,e,o){try{o()}catch(s){W(i,e,s)}}var Nj=!1;function Oj(i,e){if(Cf=dd,i=Me(),Ne(i)){if("selectionStart"in i)var o={start:i.selectionStart,end:i.selectionEnd};else e:{o=(o=i.ownerDocument)&&o.defaultView||window;var s=o.getSelection&&o.getSelection();if(s&&s.rangeCount!==0){o=s.anchorNode;var a=s.anchorOffset,c=s.focusNode;s=s.focusOffset;try{o.nodeType,c.nodeType}catch{o=null;break e}var d=0,h=-1,g=-1,_=0,j=0,b=i,$=null;t:for(;;){for(var nt;b!==o||a!==0&&b.nodeType!==3||(h=d+a),b!==c||s!==0&&b.nodeType!==3||(g=d+s),b.nodeType===3&&(d+=b.nodeValue.length),(nt=b.firstChild)!==null;)$=b,b=nt;for(;;){if(b===i)break t;if($===o&&++_===a&&(h=d),$===c&&++j===s&&(g=d),(nt=b.nextSibling)!==null)break;b=$,$=b.parentNode}b=nt}o=h===-1||g===-1?null:{start:h,end:g}}else o=null}o=o||{start:0,end:0}}else o=null;for(Df={focusedElem:i,selectionRange:o},dd=!1,V=e;V!==null;)if(e=V,i=e.child,(e.subtreeFlags&1028)!==0&&i!==null)i.return=e,V=i;else for(;V!==null;){e=V;try{var tt=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(tt!==null){var it=tt.memoizedProps,ot=tt.memoizedState,_e=e.stateNode,et=_e.getSnapshotBeforeUpdate(e.elementType===e.type?it:Ci(e.type,it),ot);_e.__reactInternalSnapshotBeforeUpdate=et}break;case 3:var rt=e.stateNode.containerInfo;rt.nodeType===1?rt.textContent="":rt.nodeType===9&&rt.documentElement&&rt.removeChild(rt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163))}}catch(st){W(e,e.return,st)}if(i=e.sibling,i!==null){i.return=e.return,V=i;break}V=e.return}return tt=Nj,Nj=!1,tt}function Pj(i,e,o){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var a=s=s.next;do{if((a.tag&i)===i){var c=a.destroy;a.destroy=void 0,c!==void 0&&Mj(e,o,c)}a=a.next}while(a!==s)}}function Qj(i,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var o=e=e.next;do{if((o.tag&i)===i){var s=o.create;o.destroy=s()}o=o.next}while(o!==e)}}function Rj(i){var e=i.ref;if(e!==null){var o=i.stateNode;switch(i.tag){case 5:i=o;break;default:i=o}typeof e=="function"?e(i):e.current=i}}function Sj(i){var e=i.alternate;e!==null&&(i.alternate=null,Sj(e)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(e=i.stateNode,e!==null&&(delete e[Of],delete e[Pf],delete e[of],delete e[Qf],delete e[Rf])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Tj(i){return i.tag===5||i.tag===3||i.tag===4}function Uj(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Tj(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Vj(i,e,o){var s=i.tag;if(s===5||s===6)i=i.stateNode,e?o.nodeType===8?o.parentNode.insertBefore(i,e):o.insertBefore(i,e):(o.nodeType===8?(e=o.parentNode,e.insertBefore(i,o)):(e=o,e.appendChild(i)),o=o._reactRootContainer,o!=null||e.onclick!==null||(e.onclick=Bf));else if(s!==4&&(i=i.child,i!==null))for(Vj(i,e,o),i=i.sibling;i!==null;)Vj(i,e,o),i=i.sibling}function Wj(i,e,o){var s=i.tag;if(s===5||s===6)i=i.stateNode,e?o.insertBefore(i,e):o.appendChild(i);else if(s!==4&&(i=i.child,i!==null))for(Wj(i,e,o),i=i.sibling;i!==null;)Wj(i,e,o),i=i.sibling}var X=null,Xj=!1;function Yj(i,e,o){for(o=o.child;o!==null;)Zj(i,e,o),o=o.sibling}function Zj(i,e,o){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,o)}catch{}switch(o.tag){case 5:U||Lj(o,e);case 6:var s=X,a=Xj;X=null,Yj(i,e,o),X=s,Xj=a,X!==null&&(Xj?(i=X,o=o.stateNode,i.nodeType===8?i.parentNode.removeChild(o):i.removeChild(o)):X.removeChild(o.stateNode));break;case 18:X!==null&&(Xj?(i=X,o=o.stateNode,i.nodeType===8?Kf(i.parentNode,o):i.nodeType===1&&Kf(i,o),bd(i)):Kf(X,o.stateNode));break;case 4:s=X,a=Xj,X=o.stateNode.containerInfo,Xj=!0,Yj(i,e,o),X=s,Xj=a;break;case 0:case 11:case 14:case 15:if(!U&&(s=o.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){a=s=s.next;do{var c=a,d=c.destroy;c=c.tag,d!==void 0&&(c&2||c&4)&&Mj(o,e,d),a=a.next}while(a!==s)}Yj(i,e,o);break;case 1:if(!U&&(Lj(o,e),s=o.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=o.memoizedProps,s.state=o.memoizedState,s.componentWillUnmount()}catch(h){W(o,e,h)}Yj(i,e,o);break;case 21:Yj(i,e,o);break;case 22:o.mode&1?(U=(s=U)||o.memoizedState!==null,Yj(i,e,o),U=s):Yj(i,e,o);break;default:Yj(i,e,o)}}function ak(i){var e=i.updateQueue;if(e!==null){i.updateQueue=null;var o=i.stateNode;o===null&&(o=i.stateNode=new Kj),e.forEach(function(s){var a=bk.bind(null,i,s);o.has(s)||(o.add(s),s.then(a,a))})}}function ck(i,e){var o=e.deletions;if(o!==null)for(var s=0;s<o.length;s++){var a=o[s];try{var c=i,d=e,h=d;e:for(;h!==null;){switch(h.tag){case 5:X=h.stateNode,Xj=!1;break e;case 3:X=h.stateNode.containerInfo,Xj=!0;break e;case 4:X=h.stateNode.containerInfo,Xj=!0;break e}h=h.return}if(X===null)throw Error(p(160));Zj(c,d,a),X=null,Xj=!1;var g=a.alternate;g!==null&&(g.return=null),a.return=null}catch(_){W(a,e,_)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)dk(e,i),e=e.sibling}function dk(i,e){var o=i.alternate,s=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(ck(e,i),ek(i),s&4){try{Pj(3,i,i.return),Qj(3,i)}catch(it){W(i,i.return,it)}try{Pj(5,i,i.return)}catch(it){W(i,i.return,it)}}break;case 1:ck(e,i),ek(i),s&512&&o!==null&&Lj(o,o.return);break;case 5:if(ck(e,i),ek(i),s&512&&o!==null&&Lj(o,o.return),i.flags&32){var a=i.stateNode;try{ob(a,"")}catch(it){W(i,i.return,it)}}if(s&4&&(a=i.stateNode,a!=null)){var c=i.memoizedProps,d=o!==null?o.memoizedProps:c,h=i.type,g=i.updateQueue;if(i.updateQueue=null,g!==null)try{h==="input"&&c.type==="radio"&&c.name!=null&&ab(a,c),vb(h,d);var _=vb(h,c);for(d=0;d<g.length;d+=2){var j=g[d],b=g[d+1];j==="style"?sb(a,b):j==="dangerouslySetInnerHTML"?nb(a,b):j==="children"?ob(a,b):ta(a,j,b,_)}switch(h){case"input":bb(a,c);break;case"textarea":ib(a,c);break;case"select":var $=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!c.multiple;var nt=c.value;nt!=null?fb(a,!!c.multiple,nt,!1):$!==!!c.multiple&&(c.defaultValue!=null?fb(a,!!c.multiple,c.defaultValue,!0):fb(a,!!c.multiple,c.multiple?[]:"",!1))}a[Pf]=c}catch(it){W(i,i.return,it)}}break;case 6:if(ck(e,i),ek(i),s&4){if(i.stateNode===null)throw Error(p(162));a=i.stateNode,c=i.memoizedProps;try{a.nodeValue=c}catch(it){W(i,i.return,it)}}break;case 3:if(ck(e,i),ek(i),s&4&&o!==null&&o.memoizedState.isDehydrated)try{bd(e.containerInfo)}catch(it){W(i,i.return,it)}break;case 4:ck(e,i),ek(i);break;case 13:ck(e,i),ek(i),a=i.child,a.flags&8192&&(c=a.memoizedState!==null,a.stateNode.isHidden=c,!c||a.alternate!==null&&a.alternate.memoizedState!==null||(fk=B())),s&4&&ak(i);break;case 22:if(j=o!==null&&o.memoizedState!==null,i.mode&1?(U=(_=U)||j,ck(e,i),U=_):ck(e,i),ek(i),s&8192){if(_=i.memoizedState!==null,(i.stateNode.isHidden=_)&&!j&&i.mode&1)for(V=i,j=i.child;j!==null;){for(b=V=j;V!==null;){switch($=V,nt=$.child,$.tag){case 0:case 11:case 14:case 15:Pj(4,$,$.return);break;case 1:Lj($,$.return);var tt=$.stateNode;if(typeof tt.componentWillUnmount=="function"){s=$,o=$.return;try{e=s,tt.props=e.memoizedProps,tt.state=e.memoizedState,tt.componentWillUnmount()}catch(it){W(s,o,it)}}break;case 5:Lj($,$.return);break;case 22:if($.memoizedState!==null){gk(b);continue}}nt!==null?(nt.return=$,V=nt):gk(b)}j=j.sibling}e:for(j=null,b=i;;){if(b.tag===5){if(j===null){j=b;try{a=b.stateNode,_?(c=a.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(h=b.stateNode,g=b.memoizedProps.style,d=g!=null&&g.hasOwnProperty("display")?g.display:null,h.style.display=rb("display",d))}catch(it){W(i,i.return,it)}}}else if(b.tag===6){if(j===null)try{b.stateNode.nodeValue=_?"":b.memoizedProps}catch(it){W(i,i.return,it)}}else if((b.tag!==22&&b.tag!==23||b.memoizedState===null||b===i)&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===i)break e;for(;b.sibling===null;){if(b.return===null||b.return===i)break e;j===b&&(j=null),b=b.return}j===b&&(j=null),b.sibling.return=b.return,b=b.sibling}}break;case 19:ck(e,i),ek(i),s&4&&ak(i);break;case 21:break;default:ck(e,i),ek(i)}}function ek(i){var e=i.flags;if(e&2){try{e:{for(var o=i.return;o!==null;){if(Tj(o)){var s=o;break e}o=o.return}throw Error(p(160))}switch(s.tag){case 5:var a=s.stateNode;s.flags&32&&(ob(a,""),s.flags&=-33);var c=Uj(i);Wj(i,c,a);break;case 3:case 4:var d=s.stateNode.containerInfo,h=Uj(i);Vj(i,h,d);break;default:throw Error(p(161))}}catch(g){W(i,i.return,g)}i.flags&=-3}e&4096&&(i.flags&=-4097)}function hk(i,e,o){V=i,ik(i)}function ik(i,e,o){for(var s=(i.mode&1)!==0;V!==null;){var a=V,c=a.child;if(a.tag===22&&s){var d=a.memoizedState!==null||Jj;if(!d){var h=a.alternate,g=h!==null&&h.memoizedState!==null||U;h=Jj;var _=U;if(Jj=d,(U=g)&&!_)for(V=a;V!==null;)d=V,g=d.child,d.tag===22&&d.memoizedState!==null?jk(a):g!==null?(g.return=d,V=g):jk(a);for(;c!==null;)V=c,ik(c),c=c.sibling;V=a,Jj=h,U=_}kk(i)}else a.subtreeFlags&8772&&c!==null?(c.return=a,V=c):kk(i)}}function kk(i){for(;V!==null;){var e=V;if(e.flags&8772){var o=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:U||Qj(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!U)if(o===null)s.componentDidMount();else{var a=e.elementType===e.type?o.memoizedProps:Ci(e.type,o.memoizedProps);s.componentDidUpdate(a,o.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var c=e.updateQueue;c!==null&&sh(e,c,s);break;case 3:var d=e.updateQueue;if(d!==null){if(o=null,e.child!==null)switch(e.child.tag){case 5:o=e.child.stateNode;break;case 1:o=e.child.stateNode}sh(e,d,o)}break;case 5:var h=e.stateNode;if(o===null&&e.flags&4){o=h;var g=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":g.autoFocus&&o.focus();break;case"img":g.src&&(o.src=g.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var _=e.alternate;if(_!==null){var j=_.memoizedState;if(j!==null){var b=j.dehydrated;b!==null&&bd(b)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p(163))}U||e.flags&512&&Rj(e)}catch($){W(e,e.return,$)}}if(e===i){V=null;break}if(o=e.sibling,o!==null){o.return=e.return,V=o;break}V=e.return}}function gk(i){for(;V!==null;){var e=V;if(e===i){V=null;break}var o=e.sibling;if(o!==null){o.return=e.return,V=o;break}V=e.return}}function jk(i){for(;V!==null;){var e=V;try{switch(e.tag){case 0:case 11:case 15:var o=e.return;try{Qj(4,e)}catch(g){W(e,o,g)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var a=e.return;try{s.componentDidMount()}catch(g){W(e,a,g)}}var c=e.return;try{Rj(e)}catch(g){W(e,c,g)}break;case 5:var d=e.return;try{Rj(e)}catch(g){W(e,d,g)}}}catch(g){W(e,e.return,g)}if(e===i){V=null;break}var h=e.sibling;if(h!==null){h.return=e.return,V=h;break}V=e.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R(){return K&6?B():Ak!==-1?Ak:Ak=B()}function yi(i){return i.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(i=C,i!==0||(i=window.event,i=i===void 0?16:jd(i.type)),i):1}function gi(i,e,o,s){if(50<yk)throw yk=0,zk=null,Error(p(185));Ac(i,o,s),(!(K&2)||i!==Q)&&(i===Q&&(!(K&2)&&(qk|=o),T===4&&Ck(i,Z)),Dk(i,s),o===1&&K===0&&!(e.mode&1)&&(Gj=B()+500,fg&&jg()))}function Dk(i,e){var o=i.callbackNode;wc(i,e);var s=uc(i,i===Q?Z:0);if(s===0)o!==null&&bc(o),i.callbackNode=null,i.callbackPriority=0;else if(e=s&-s,i.callbackPriority!==e){if(o!=null&&bc(o),e===1)i.tag===0?ig(Ek.bind(null,i)):hg(Ek.bind(null,i)),Jf(function(){!(K&6)&&jg()}),o=null;else{switch(Dc(s)){case 1:o=fc;break;case 4:o=gc;break;case 16:o=hc;break;case 536870912:o=jc;break;default:o=hc}o=Fk(o,Gk.bind(null,i))}i.callbackPriority=e,i.callbackNode=o}}function Gk(i,e){if(Ak=-1,Bk=0,K&6)throw Error(p(327));var o=i.callbackNode;if(Hk()&&i.callbackNode!==o)return null;var s=uc(i,i===Q?Z:0);if(s===0)return null;if(s&30||s&i.expiredLanes||e)e=Ik(i,s);else{e=s;var a=K;K|=2;var c=Jk();(Q!==i||Z!==e)&&(uk=null,Gj=B()+500,Kk(i,e));do try{Lk();break}catch(h){Mk(i,h)}while(1);$g(),mk.current=c,K=a,Y!==null?e=0:(Q=null,Z=0,e=T)}if(e!==0){if(e===2&&(a=xc(i),a!==0&&(s=a,e=Nk(i,a))),e===1)throw o=pk,Kk(i,0),Ck(i,s),Dk(i,B()),o;if(e===6)Ck(i,s);else{if(a=i.current.alternate,!(s&30)&&!Ok(a)&&(e=Ik(i,s),e===2&&(c=xc(i),c!==0&&(s=c,e=Nk(i,c))),e===1))throw o=pk,Kk(i,0),Ck(i,s),Dk(i,B()),o;switch(i.finishedWork=a,i.finishedLanes=s,e){case 0:case 1:throw Error(p(345));case 2:Pk(i,tk,uk);break;case 3:if(Ck(i,s),(s&130023424)===s&&(e=fk+500-B(),10<e)){if(uc(i,0)!==0)break;if(a=i.suspendedLanes,(a&s)!==s){R(),i.pingedLanes|=i.suspendedLanes&a;break}i.timeoutHandle=Ff(Pk.bind(null,i,tk,uk),e);break}Pk(i,tk,uk);break;case 4:if(Ck(i,s),(s&4194240)===s)break;for(e=i.eventTimes,a=-1;0<s;){var d=31-oc(s);c=1<<d,d=e[d],d>a&&(a=d),s&=~c}if(s=a,s=B()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*lk(s/1960))-s,10<s){i.timeoutHandle=Ff(Pk.bind(null,i,tk,uk),s);break}Pk(i,tk,uk);break;case 5:Pk(i,tk,uk);break;default:throw Error(p(329))}}}return Dk(i,B()),i.callbackNode===o?Gk.bind(null,i):null}function Nk(i,e){var o=sk;return i.current.memoizedState.isDehydrated&&(Kk(i,e).flags|=256),i=Ik(i,e),i!==2&&(e=tk,tk=o,e!==null&&Fj(e)),i}function Fj(i){tk===null?tk=i:tk.push.apply(tk,i)}function Ok(i){for(var e=i;;){if(e.flags&16384){var o=e.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var s=0;s<o.length;s++){var a=o[s],c=a.getSnapshot;a=a.value;try{if(!He(c(),a))return!1}catch{return!1}}}if(o=e.child,e.subtreeFlags&16384&&o!==null)o.return=e,e=o;else{if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ck(i,e){for(e&=~rk,e&=~qk,i.suspendedLanes|=e,i.pingedLanes&=~e,i=i.expirationTimes;0<e;){var o=31-oc(e),s=1<<o;i[o]=-1,e&=~s}}function Ek(i){if(K&6)throw Error(p(327));Hk();var e=uc(i,0);if(!(e&1))return Dk(i,B()),null;var o=Ik(i,e);if(i.tag!==0&&o===2){var s=xc(i);s!==0&&(e=s,o=Nk(i,s))}if(o===1)throw o=pk,Kk(i,0),Ck(i,e),Dk(i,B()),o;if(o===6)throw Error(p(345));return i.finishedWork=i.current.alternate,i.finishedLanes=e,Pk(i,tk,uk),Dk(i,B()),null}function Qk(i,e){var o=K;K|=1;try{return i(e)}finally{K=o,K===0&&(Gj=B()+500,fg&&jg())}}function Rk(i){wk!==null&&wk.tag===0&&!(K&6)&&Hk();var e=K;K|=1;var o=ok.transition,s=C;try{if(ok.transition=null,C=1,i)return i()}finally{C=s,ok.transition=o,K=e,!(K&6)&&jg()}}function Hj(){fj=ej.current,E(ej)}function Kk(i,e){i.finishedWork=null,i.finishedLanes=0;var o=i.timeoutHandle;if(o!==-1&&(i.timeoutHandle=-1,Gf(o)),Y!==null)for(o=Y.return;o!==null;){var s=o;switch(wg(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&$f();break;case 3:zh(),E(Wf),E(H),Eh();break;case 5:Bh(s);break;case 4:zh();break;case 13:E(L);break;case 19:E(L);break;case 10:ah(s.type._context);break;case 22:case 23:Hj()}o=o.return}if(Q=i,Y=i=Pg(i.current,null),Z=fj=e,T=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(e=0;e<fh.length;e++)if(o=fh[e],s=o.interleaved,s!==null){o.interleaved=null;var a=s.next,c=o.pending;if(c!==null){var d=c.next;c.next=a,s.next=d}o.pending=s}fh=null}return i}function Mk(i,e){do{var o=Y;try{if($g(),Fh.current=Rh,Ih){for(var s=M.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}Ih=!1}if(Hh=0,O=N=M=null,Jh=!1,Kh=0,nk.current=null,o===null||o.return===null){T=1,pk=e,Y=null;break}e:{var c=i,d=o.return,h=o,g=e;if(e=Z,h.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){var _=g,j=h,b=j.tag;if(!(j.mode&1)&&(b===0||b===11||b===15)){var $=j.alternate;$?(j.updateQueue=$.updateQueue,j.memoizedState=$.memoizedState,j.lanes=$.lanes):(j.updateQueue=null,j.memoizedState=null)}var nt=Ui(d);if(nt!==null){nt.flags&=-257,Vi(nt,d,h,c,e),nt.mode&1&&Si(c,_,e),e=nt,g=_;var tt=e.updateQueue;if(tt===null){var it=new Set;it.add(g),e.updateQueue=it}else tt.add(g);break e}else{if(!(e&1)){Si(c,_,e),tj();break e}g=Error(p(426))}}else if(I&&h.mode&1){var ot=Ui(d);if(ot!==null){!(ot.flags&65536)&&(ot.flags|=256),Vi(ot,d,h,c,e),Jg(Ji(g,h));break e}}c=g=Ji(g,h),T!==4&&(T=2),sk===null?sk=[c]:sk.push(c),c=d;do{switch(c.tag){case 3:c.flags|=65536,e&=-e,c.lanes|=e;var _e=Ni(c,g,e);ph(c,_e);break e;case 1:h=g;var et=c.type,rt=c.stateNode;if(!(c.flags&128)&&(typeof et.getDerivedStateFromError=="function"||rt!==null&&typeof rt.componentDidCatch=="function"&&(Ri===null||!Ri.has(rt)))){c.flags|=65536,e&=-e,c.lanes|=e;var st=Qi(c,h,e);ph(c,st);break e}}c=c.return}while(c!==null)}Sk(o)}catch(dt){e=dt,Y===o&&o!==null&&(Y=o=o.return);continue}break}while(1)}function Jk(){var i=mk.current;return mk.current=Rh,i===null?Rh:i}function tj(){(T===0||T===3||T===2)&&(T=4),Q===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q,Z)}function Ik(i,e){var o=K;K|=2;var s=Jk();(Q!==i||Z!==e)&&(uk=null,Kk(i,e));do try{Tk();break}catch(a){Mk(i,a)}while(1);if($g(),K=o,mk.current=s,Y!==null)throw Error(p(261));return Q=null,Z=0,T}function Tk(){for(;Y!==null;)Uk(Y)}function Lk(){for(;Y!==null&&!cc();)Uk(Y)}function Uk(i){var e=Vk(i.alternate,i,fj);i.memoizedProps=i.pendingProps,e===null?Sk(i):Y=e,nk.current=null}function Sk(i){var e=i;do{var o=e.alternate;if(i=e.return,e.flags&32768){if(o=Ij(o,e),o!==null){o.flags&=32767,Y=o;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{T=6,Y=null;return}}else if(o=Ej(o,e,fj),o!==null){Y=o;return}if(e=e.sibling,e!==null){Y=e;return}Y=e=i}while(e!==null);T===0&&(T=5)}function Pk(i,e,o){var s=C,a=ok.transition;try{ok.transition=null,C=1,Wk(i,e,o,s)}finally{ok.transition=a,C=s}return null}function Wk(i,e,o,s){do Hk();while(wk!==null);if(K&6)throw Error(p(327));o=i.finishedWork;var a=i.finishedLanes;if(o===null)return null;if(i.finishedWork=null,i.finishedLanes=0,o===i.current)throw Error(p(177));i.callbackNode=null,i.callbackPriority=0;var c=o.lanes|o.childLanes;if(Bc(i,c),i===Q&&(Y=Q=null,Z=0),!(o.subtreeFlags&2064)&&!(o.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),c=(o.flags&15990)!==0,o.subtreeFlags&15990||c){c=ok.transition,ok.transition=null;var d=C;C=1;var h=K;K|=4,nk.current=null,Oj(i,o),dk(o,i),Oe(Df),dd=!!Cf,Df=Cf=null,i.current=o,hk(o),dc(),K=h,C=d,ok.transition=c}else i.current=o;if(vk&&(vk=!1,wk=i,xk=a),c=i.pendingLanes,c===0&&(Ri=null),mc(o.stateNode),Dk(i,B()),e!==null)for(s=i.onRecoverableError,o=0;o<e.length;o++)a=e[o],s(a.value,{componentStack:a.stack,digest:a.digest});if(Oi)throw Oi=!1,i=Pi,Pi=null,i;return xk&1&&i.tag!==0&&Hk(),c=i.pendingLanes,c&1?i===zk?yk++:(yk=0,zk=i):yk=0,jg(),null}function Hk(){if(wk!==null){var i=Dc(xk),e=ok.transition,o=C;try{if(ok.transition=null,C=16>i?16:i,wk===null)var s=!1;else{if(i=wk,wk=null,xk=0,K&6)throw Error(p(331));var a=K;for(K|=4,V=i.current;V!==null;){var c=V,d=c.child;if(V.flags&16){var h=c.deletions;if(h!==null){for(var g=0;g<h.length;g++){var _=h[g];for(V=_;V!==null;){var j=V;switch(j.tag){case 0:case 11:case 15:Pj(8,j,c)}var b=j.child;if(b!==null)b.return=j,V=b;else for(;V!==null;){j=V;var $=j.sibling,nt=j.return;if(Sj(j),j===_){V=null;break}if($!==null){$.return=nt,V=$;break}V=nt}}}var tt=c.alternate;if(tt!==null){var it=tt.child;if(it!==null){tt.child=null;do{var ot=it.sibling;it.sibling=null,it=ot}while(it!==null)}}V=c}}if(c.subtreeFlags&2064&&d!==null)d.return=c,V=d;else e:for(;V!==null;){if(c=V,c.flags&2048)switch(c.tag){case 0:case 11:case 15:Pj(9,c,c.return)}var _e=c.sibling;if(_e!==null){_e.return=c.return,V=_e;break e}V=c.return}}var et=i.current;for(V=et;V!==null;){d=V;var rt=d.child;if(d.subtreeFlags&2064&&rt!==null)rt.return=d,V=rt;else e:for(d=et;V!==null;){if(h=V,h.flags&2048)try{switch(h.tag){case 0:case 11:case 15:Qj(9,h)}}catch(dt){W(h,h.return,dt)}if(h===d){V=null;break e}var st=h.sibling;if(st!==null){st.return=h.return,V=st;break e}V=h.return}}if(K=a,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,i)}catch{}s=!0}return s}finally{C=o,ok.transition=e}}return!1}function Xk(i,e,o){e=Ji(o,e),e=Ni(i,e,1),i=nh(i,e,1),e=R(),i!==null&&(Ac(i,1,e),Dk(i,e))}function W(i,e,o){if(i.tag===3)Xk(i,i,o);else for(;e!==null;){if(e.tag===3){Xk(e,i,o);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Ri===null||!Ri.has(s))){i=Ji(o,i),i=Qi(e,i,1),e=nh(e,i,1),i=R(),e!==null&&(Ac(e,1,i),Dk(e,i));break}}e=e.return}}function Ti(i,e,o){var s=i.pingCache;s!==null&&s.delete(e),e=R(),i.pingedLanes|=i.suspendedLanes&o,Q===i&&(Z&o)===o&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-fk?Kk(i,0):rk|=o),Dk(i,e)}function Yk(i,e){e===0&&(i.mode&1?(e=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):e=1);var o=R();i=ih(i,e),i!==null&&(Ac(i,e,o),Dk(i,o))}function uj(i){var e=i.memoizedState,o=0;e!==null&&(o=e.retryLane),Yk(i,o)}function bk(i,e){var o=0;switch(i.tag){case 13:var s=i.stateNode,a=i.memoizedState;a!==null&&(o=a.retryLane);break;case 19:s=i.stateNode;break;default:throw Error(p(314))}s!==null&&s.delete(e),Yk(i,o)}var Vk;Vk=function(i,e,o){if(i!==null)if(i.memoizedProps!==e.pendingProps||Wf.current)dh=!0;else{if(!(i.lanes&o)&&!(e.flags&128))return dh=!1,yj(i,e,o);dh=!!(i.flags&131072)}else dh=!1,I&&e.flags&1048576&&ug(e,ng,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;ij(i,e),i=e.pendingProps;var a=Yf(e,H.current);ch(e,o),a=Nh(null,e,s,i,a,o);var c=Sh();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Zf(s)?(c=!0,cg(e)):c=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,kh(e),a.updater=Ei,e.stateNode=a,a._reactInternals=e,Ii(e,s,i,o),e=jj(null,e,s,!0,c,o)):(e.tag=0,I&&c&&vg(e),Xi(null,e,a,o),e=e.child),e;case 16:s=e.elementType;e:{switch(ij(i,e),i=e.pendingProps,a=s._init,s=a(s._payload),e.type=s,a=e.tag=Zk(s),i=Ci(s,i),a){case 0:e=cj(null,e,s,i,o);break e;case 1:e=hj(null,e,s,i,o);break e;case 11:e=Yi(null,e,s,i,o);break e;case 14:e=$i(null,e,s,Ci(s.type,i),o);break e}throw Error(p(306,s,""))}return e;case 0:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:Ci(s,a),cj(i,e,s,a,o);case 1:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:Ci(s,a),hj(i,e,s,a,o);case 3:e:{if(kj(e),i===null)throw Error(p(387));s=e.pendingProps,c=e.memoizedState,a=c.element,lh(i,e),qh(e,s,null,o);var d=e.memoizedState;if(s=d.element,c.isDehydrated)if(c={element:s,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},e.updateQueue.baseState=c,e.memoizedState=c,e.flags&256){a=Ji(Error(p(423)),e),e=lj(i,e,s,o,a);break e}else if(s!==a){a=Ji(Error(p(424)),e),e=lj(i,e,s,o,a);break e}else for(yg=Lf(e.stateNode.containerInfo.firstChild),xg=e,I=!0,zg=null,o=Vg(e,null,s,o),e.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Ig(),s===a){e=Zi(i,e,o);break e}Xi(i,e,s,o)}e=e.child}return e;case 5:return Ah(e),i===null&&Eg(e),s=e.type,a=e.pendingProps,c=i!==null?i.memoizedProps:null,d=a.children,Ef(s,a)?d=null:c!==null&&Ef(s,c)&&(e.flags|=32),gj(i,e),Xi(i,e,d,o),e.child;case 6:return i===null&&Eg(e),null;case 13:return oj(i,e,o);case 4:return yh(e,e.stateNode.containerInfo),s=e.pendingProps,i===null?e.child=Ug(e,null,s,o):Xi(i,e,s,o),e.child;case 11:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:Ci(s,a),Yi(i,e,s,a,o);case 7:return Xi(i,e,e.pendingProps,o),e.child;case 8:return Xi(i,e,e.pendingProps.children,o),e.child;case 12:return Xi(i,e,e.pendingProps.children,o),e.child;case 10:e:{if(s=e.type._context,a=e.pendingProps,c=e.memoizedProps,d=a.value,G(Wg,s._currentValue),s._currentValue=d,c!==null)if(He(c.value,d)){if(c.children===a.children&&!Wf.current){e=Zi(i,e,o);break e}}else for(c=e.child,c!==null&&(c.return=e);c!==null;){var h=c.dependencies;if(h!==null){d=c.child;for(var g=h.firstContext;g!==null;){if(g.context===s){if(c.tag===1){g=mh(-1,o&-o),g.tag=2;var _=c.updateQueue;if(_!==null){_=_.shared;var j=_.pending;j===null?g.next=g:(g.next=j.next,j.next=g),_.pending=g}}c.lanes|=o,g=c.alternate,g!==null&&(g.lanes|=o),bh(c.return,o,e),h.lanes|=o;break}g=g.next}}else if(c.tag===10)d=c.type===e.type?null:c.child;else if(c.tag===18){if(d=c.return,d===null)throw Error(p(341));d.lanes|=o,h=d.alternate,h!==null&&(h.lanes|=o),bh(d,o,e),d=c.sibling}else d=c.child;if(d!==null)d.return=c;else for(d=c;d!==null;){if(d===e){d=null;break}if(c=d.sibling,c!==null){c.return=d.return,d=c;break}d=d.return}c=d}Xi(i,e,a.children,o),e=e.child}return e;case 9:return a=e.type,s=e.pendingProps.children,ch(e,o),a=eh(a),s=s(a),e.flags|=1,Xi(i,e,s,o),e.child;case 14:return s=e.type,a=Ci(s,e.pendingProps),a=Ci(s.type,a),$i(i,e,s,a,o);case 15:return bj(i,e,e.type,e.pendingProps,o);case 17:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:Ci(s,a),ij(i,e),e.tag=1,Zf(s)?(i=!0,cg(e)):i=!1,ch(e,o),Gi(e,s,a),Ii(e,s,a,o),jj(null,e,s,!0,i,o);case 19:return xj(i,e,o);case 22:return dj(i,e,o)}throw Error(p(156,e.tag))};function Fk(i,e){return ac(i,e)}function $k(i,e,o,s){this.tag=i,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(i,e,o,s){return new $k(i,e,o,s)}function aj(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Zk(i){if(typeof i=="function")return aj(i)?1:0;if(i!=null){if(i=i.$$typeof,i===Da)return 11;if(i===Ga)return 14}return 2}function Pg(i,e){var o=i.alternate;return o===null?(o=Bg(i.tag,e,i.key,i.mode),o.elementType=i.elementType,o.type=i.type,o.stateNode=i.stateNode,o.alternate=i,i.alternate=o):(o.pendingProps=e,o.type=i.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=i.flags&14680064,o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,e=i.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},o.sibling=i.sibling,o.index=i.index,o.ref=i.ref,o}function Rg(i,e,o,s,a,c){var d=2;if(s=i,typeof i=="function")aj(i)&&(d=1);else if(typeof i=="string")d=5;else e:switch(i){case ya:return Tg(o.children,a,c,e);case za:d=8,a|=8;break;case Aa:return i=Bg(12,o,e,a|2),i.elementType=Aa,i.lanes=c,i;case Ea:return i=Bg(13,o,e,a),i.elementType=Ea,i.lanes=c,i;case Fa:return i=Bg(19,o,e,a),i.elementType=Fa,i.lanes=c,i;case Ia:return pj(o,a,c,e);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Ba:d=10;break e;case Ca:d=9;break e;case Da:d=11;break e;case Ga:d=14;break e;case Ha:d=16,s=null;break e}throw Error(p(130,i==null?i:typeof i,""))}return e=Bg(d,o,e,a),e.elementType=i,e.type=s,e.lanes=c,e}function Tg(i,e,o,s){return i=Bg(7,i,s,e),i.lanes=o,i}function pj(i,e,o,s){return i=Bg(22,i,s,e),i.elementType=Ia,i.lanes=o,i.stateNode={isHidden:!1},i}function Qg(i,e,o){return i=Bg(6,i,null,e),i.lanes=o,i}function Sg(i,e,o){return e=Bg(4,i.children!==null?i.children:[],i.key,e),e.lanes=o,e.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},e}function al(i,e,o,s,a){this.tag=e,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=s,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function bl(i,e,o,s,a,c,d,h,g){return i=new al(i,e,o,h,g),e===1?(e=1,c===!0&&(e|=8)):e=0,c=Bg(3,null,null,e),i.current=c,c.stateNode=i,c.memoizedState={element:s,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(c),i}function cl(i,e,o){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:s==null?null:""+s,children:i,containerInfo:e,implementation:o}}function dl(i){if(!i)return Vf;i=i._reactInternals;e:{if(Vb(i)!==i||i.tag!==1)throw Error(p(170));var e=i;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Zf(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(p(171))}if(i.tag===1){var o=i.type;if(Zf(o))return bg(i,o,e)}return e}function el(i,e,o,s,a,c,d,h,g){return i=bl(o,s,!0,i,a,c,d,h,g),i.context=dl(null),o=i.current,s=R(),a=yi(o),c=mh(s,a),c.callback=e??null,nh(o,c,a),i.current.lanes=a,Ac(i,a,s),Dk(i,s),i}function fl(i,e,o,s){var a=e.current,c=R(),d=yi(a);return o=dl(o),e.context===null?e.context=o:e.pendingContext=o,e=mh(c,d),e.payload={element:i},s=s===void 0?null:s,s!==null&&(e.callback=s),i=nh(a,e,d),i!==null&&(gi(i,a,d,c),oh(i,a,d)),d}function gl(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function hl(i,e){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var o=i.retryLane;i.retryLane=o!==0&&o<e?o:e}}function il(i,e){hl(i,e),(i=i.alternate)&&hl(i,e)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(i){console.error(i)};function ll(i){this._internalRoot=i}ml.prototype.render=ll.prototype.render=function(i){var e=this._internalRoot;if(e===null)throw Error(p(409));fl(i,e,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var e=i.containerInfo;Rk(function(){fl(null,i,null,null)}),e[uf]=null}};function ml(i){this._internalRoot=i}ml.prototype.unstable_scheduleHydration=function(i){if(i){var e=Hc();i={blockedOn:null,target:i,priority:e};for(var o=0;o<Qc.length&&e!==0&&e<Qc[o].priority;o++);Qc.splice(o,0,i),o===0&&Vc(i)}};function nl(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function ol(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(i,e,o,s,a){if(a){if(typeof s=="function"){var c=s;s=function(){var _=gl(d);c.call(_)}}var d=el(e,s,i,0,null,!1,!1,"",pl);return i._reactRootContainer=d,i[uf]=d.current,sf(i.nodeType===8?i.parentNode:i),Rk(),d}for(;a=i.lastChild;)i.removeChild(a);if(typeof s=="function"){var h=s;s=function(){var _=gl(g);h.call(_)}}var g=bl(i,0,!1,null,null,!1,!1,"",pl);return i._reactRootContainer=g,i[uf]=g.current,sf(i.nodeType===8?i.parentNode:i),Rk(function(){fl(e,g,o,s)}),g}function rl(i,e,o,s,a){var c=o._reactRootContainer;if(c){var d=c;if(typeof a=="function"){var h=a;a=function(){var g=gl(d);h.call(g)}}fl(e,d,i,a)}else d=ql(o,e,i,a,s);return gl(d)}Ec=function(i){switch(i.tag){case 3:var e=i.stateNode;if(e.current.memoizedState.isDehydrated){var o=tc(e.pendingLanes);o!==0&&(Cc(e,o|1),Dk(e,B()),!(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var s=ih(i,1);if(s!==null){var a=R();gi(s,i,1,a)}}),il(i,1)}};Fc=function(i){if(i.tag===13){var e=ih(i,134217728);if(e!==null){var o=R();gi(e,i,134217728,o)}il(i,134217728)}};Gc=function(i){if(i.tag===13){var e=yi(i),o=ih(i,e);if(o!==null){var s=R();gi(o,i,e,s)}il(i,e)}};Hc=function(){return C};Ic=function(i,e){var o=C;try{return C=i,e()}finally{C=o}};yb=function(i,e,o){switch(e){case"input":if(bb(i,o),e=o.name,o.type==="radio"&&e!=null){for(o=i;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<o.length;e++){var s=o[e];if(s!==i&&s.form===i.form){var a=Db(s);if(!a)throw Error(p(90));Wa(s),bb(s,a)}}}break;case"textarea":ib(i,o);break;case"select":e=o.value,e!=null&&fb(i,!!o.multiple,e,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=Zb(i),i===null?null:i.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(i,e){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(e))throw Error(p(200));return cl(i,e,null,o)};reactDom_production_min.createRoot=function(i,e){if(!nl(i))throw Error(p(299));var o=!1,s="",a=kl;return e!=null&&(e.unstable_strictMode===!0&&(o=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=bl(i,1,!1,null,null,o,!1,s,a),i[uf]=e.current,sf(i.nodeType===8?i.parentNode:i),new ll(e)};reactDom_production_min.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var e=i._reactInternals;if(e===void 0)throw typeof i.render=="function"?Error(p(188)):(i=Object.keys(i).join(","),Error(p(268,i)));return i=Zb(e),i=i===null?null:i.stateNode,i};reactDom_production_min.flushSync=function(i){return Rk(i)};reactDom_production_min.hydrate=function(i,e,o){if(!ol(e))throw Error(p(200));return rl(null,i,e,!0,o)};reactDom_production_min.hydrateRoot=function(i,e,o){if(!nl(i))throw Error(p(405));var s=o!=null&&o.hydratedSources||null,a=!1,c="",d=kl;if(o!=null&&(o.unstable_strictMode===!0&&(a=!0),o.identifierPrefix!==void 0&&(c=o.identifierPrefix),o.onRecoverableError!==void 0&&(d=o.onRecoverableError)),e=el(e,null,i,1,o??null,a,!1,c,d),i[uf]=e.current,sf(i),s)for(i=0;i<s.length;i++)o=s[i],a=o._getVersion,a=a(o._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[o,a]:e.mutableSourceEagerHydrationData.push(o,a);return new ml(e)};reactDom_production_min.render=function(i,e,o){if(!ol(e))throw Error(p(200));return rl(null,i,e,!1,o)};reactDom_production_min.unmountComponentAtNode=function(i){if(!ol(i))throw Error(p(40));return i._reactRootContainer?(Rk(function(){rl(null,null,i,!1,function(){i._reactRootContainer=null,i[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(i,e,o,s){if(!ol(o))throw Error(p(200));if(i==null||i._reactInternals===void 0)throw Error(p(38));return rl(i,e,o,!1,s)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(i){console.error(i)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports;const ReactDOM=getDefaultExportFromCjs(reactDomExports);var m=reactDomExports;client.createRoot=m.createRoot,client.hydrateRoot=m.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(i[s]=o[s])}return i},_extends$1.apply(this,arguments)}var Action;(function(i){i.Pop="POP",i.Push="PUSH",i.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(i){i===void 0&&(i={});function e(s,a){let{pathname:c,search:d,hash:h}=s.location;return createLocation("",{pathname:c,search:d,hash:h},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function o(s,a){return typeof a=="string"?a:createPath(a)}return getUrlBasedHistory(e,o,null,i)}function invariant(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function warning(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(i,e){return{usr:i.state,key:i.key,idx:e}}function createLocation(i,e,o,s){return o===void 0&&(o=null),_extends$1({pathname:typeof i=="string"?i:i.pathname,search:"",hash:""},typeof e=="string"?parsePath(e):e,{state:o,key:e&&e.key||s||createKey()})}function createPath(i){let{pathname:e="/",search:o="",hash:s=""}=i;return o&&o!=="?"&&(e+=o.charAt(0)==="?"?o:"?"+o),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function parsePath(i){let e={};if(i){let o=i.indexOf("#");o>=0&&(e.hash=i.substr(o),i=i.substr(0,o));let s=i.indexOf("?");s>=0&&(e.search=i.substr(s),i=i.substr(0,s)),i&&(e.pathname=i)}return e}function getUrlBasedHistory(i,e,o,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:c=!1}=s,d=a.history,h=Action.Pop,g=null,_=j();_==null&&(_=0,d.replaceState(_extends$1({},d.state,{idx:_}),""));function j(){return(d.state||{idx:null}).idx}function b(){h=Action.Pop;let ot=j(),_e=ot==null?null:ot-_;_=ot,g&&g({action:h,location:it.location,delta:_e})}function $(ot,_e){h=Action.Push;let et=createLocation(it.location,ot,_e);o&&o(et,ot),_=j()+1;let rt=getHistoryState(et,_),st=it.createHref(et);try{d.pushState(rt,"",st)}catch(dt){if(dt instanceof DOMException&&dt.name==="DataCloneError")throw dt;a.location.assign(st)}c&&g&&g({action:h,location:it.location,delta:1})}function nt(ot,_e){h=Action.Replace;let et=createLocation(it.location,ot,_e);o&&o(et,ot),_=j();let rt=getHistoryState(et,_),st=it.createHref(et);d.replaceState(rt,"",st),c&&g&&g({action:h,location:it.location,delta:0})}function tt(ot){let _e=a.location.origin!=="null"?a.location.origin:a.location.href,et=typeof ot=="string"?ot:createPath(ot);return et=et.replace(/ $/,"%20"),invariant(_e,"No window.location.(origin|href) available to create URL for href: "+et),new URL(et,_e)}let it={get action(){return h},get location(){return i(a,d)},listen(ot){if(g)throw new Error("A history only accepts one active listener");return a.addEventListener(PopStateEventType,b),g=ot,()=>{a.removeEventListener(PopStateEventType,b),g=null}},createHref(ot){return e(a,ot)},createURL:tt,encodeLocation(ot){let _e=tt(ot);return{pathname:_e.pathname,search:_e.search,hash:_e.hash}},push:$,replace:nt,go(ot){return d.go(ot)}};return it}var ResultType;(function(i){i.data="data",i.deferred="deferred",i.redirect="redirect",i.error="error"})(ResultType||(ResultType={}));function matchRoutes(i,e,o){return o===void 0&&(o="/"),matchRoutesImpl(i,e,o,!1)}function matchRoutesImpl(i,e,o,s){let a=typeof e=="string"?parsePath(e):e,c=stripBasename(a.pathname||"/",o);if(c==null)return null;let d=flattenRoutes(i);rankRouteBranches(d);let h=null;for(let g=0;h==null&&g<d.length;++g){let _=decodePath$1(c);h=matchRouteBranch(d[g],_,s)}return h}function flattenRoutes(i,e,o,s){e===void 0&&(e=[]),o===void 0&&(o=[]),s===void 0&&(s="");let a=(c,d,h)=>{let g={relativePath:h===void 0?c.path||"":h,caseSensitive:c.caseSensitive===!0,childrenIndex:d,route:c};g.relativePath.startsWith("/")&&(invariant(g.relativePath.startsWith(s),'Absolute route path "'+g.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),g.relativePath=g.relativePath.slice(s.length));let _=joinPaths([s,g.relativePath]),j=o.concat(g);c.children&&c.children.length>0&&(invariant(c.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+_+'".')),flattenRoutes(c.children,e,j,_)),!(c.path==null&&!c.index)&&e.push({path:_,score:computeScore(_,c.index),routesMeta:j})};return i.forEach((c,d)=>{var h;if(c.path===""||!((h=c.path)!=null&&h.includes("?")))a(c,d);else for(let g of explodeOptionalSegments(c.path))a(c,d,g)}),e}function explodeOptionalSegments(i){let e=i.split("/");if(e.length===0)return[];let[o,...s]=e,a=o.endsWith("?"),c=o.replace(/\?$/,"");if(s.length===0)return a?[c,""]:[c];let d=explodeOptionalSegments(s.join("/")),h=[];return h.push(...d.map(g=>g===""?c:[c,g].join("/"))),a&&h.push(...d),h.map(g=>i.startsWith("/")&&g===""?"/":g)}function rankRouteBranches(i){i.sort((e,o)=>e.score!==o.score?o.score-e.score:compareIndexes(e.routesMeta.map(s=>s.childrenIndex),o.routesMeta.map(s=>s.childrenIndex)))}const paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=i=>i==="*";function computeScore(i,e){let o=i.split("/"),s=o.length;return o.some(isSplat)&&(s+=splatPenalty),e&&(s+=indexRouteValue),o.filter(a=>!isSplat(a)).reduce((a,c)=>a+(paramRe.test(c)?dynamicSegmentValue:c===""?emptySegmentValue:staticSegmentValue),s)}function compareIndexes(i,e){return i.length===e.length&&i.slice(0,-1).every((s,a)=>s===e[a])?i[i.length-1]-e[e.length-1]:0}function matchRouteBranch(i,e,o){o===void 0&&(o=!1);let{routesMeta:s}=i,a={},c="/",d=[];for(let h=0;h<s.length;++h){let g=s[h],_=h===s.length-1,j=c==="/"?e:e.slice(c.length)||"/",b=matchPath({path:g.relativePath,caseSensitive:g.caseSensitive,end:_},j),$=g.route;if(!b&&_&&o&&!s[s.length-1].route.index&&(b=matchPath({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},j)),!b)return null;Object.assign(a,b.params),d.push({params:a,pathname:joinPaths([c,b.pathname]),pathnameBase:normalizePathname(joinPaths([c,b.pathnameBase])),route:$}),b.pathnameBase!=="/"&&(c=joinPaths([c,b.pathnameBase]))}return d}function matchPath(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[o,s]=compilePath(i.path,i.caseSensitive,i.end),a=e.match(o);if(!a)return null;let c=a[0],d=c.replace(/(.)\/+$/,"$1"),h=a.slice(1);return{params:s.reduce((_,j,b)=>{let{paramName:$,isOptional:nt}=j;if($==="*"){let it=h[b]||"";d=c.slice(0,c.length-it.length).replace(/(.)\/+$/,"$1")}const tt=h[b];return nt&&!tt?_[$]=void 0:_[$]=(tt||"").replace(/%2F/g,"/"),_},{}),pathname:c,pathnameBase:d,pattern:i}}function compilePath(i,e,o){e===void 0&&(e=!1),o===void 0&&(o=!0),warning(i==="*"||!i.endsWith("*")||i.endsWith("/*"),'Route path "'+i+'" will be treated as if it were '+('"'+i.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+i.replace(/\*$/,"/*")+'".'));let s=[],a="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,h,g)=>(s.push({paramName:h,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)"));return i.endsWith("*")?(s.push({paramName:"*"}),a+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):o?a+="\\/*$":i!==""&&i!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function decodePath$1(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return warning(!1,'The URL path "'+i+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),i}}function stripBasename(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let o=e.endsWith("/")?e.length-1:e.length,s=i.charAt(o);return s&&s!=="/"?null:i.slice(o)||"/"}const joinPaths=i=>i.join("/").replace(/\/\/+/g,"/"),normalizePathname=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/");function isRouteErrorResponse(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends(){return _extends=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(i[s]=o[s])}return i},_extends.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useParams(){let{matches:i}=reactExports.useContext(RouteContext),e=i[i.length-1];return e?e.params:{}}function useRoutes(i,e){return useRoutesImpl(i,e)}function useRoutesImpl(i,e,o,s){useInRouterContext()||invariant(!1);let{navigator:a,static:c}=reactExports.useContext(NavigationContext),{matches:d}=reactExports.useContext(RouteContext),h=d[d.length-1],g=h?h.params:{};h&&h.pathname;let _=h?h.pathnameBase:"/";h&&h.route;let j=useLocation(),b;if(e){var $;let _e=typeof e=="string"?parsePath(e):e;_==="/"||($=_e.pathname)!=null&&$.startsWith(_)||invariant(!1),b=_e}else b=j;let nt=b.pathname||"/",tt=nt;if(_!=="/"){let _e=_.replace(/^\//,"").split("/");tt="/"+nt.replace(/^\//,"").split("/").slice(_e.length).join("/")}let it=!c&&o&&o.matches&&o.matches.length>0?o.matches:matchRoutes(i,{pathname:tt}),ot=_renderMatches(it&&it.map(_e=>Object.assign({},_e,{params:Object.assign({},g,_e.params),pathname:joinPaths([_,a.encodeLocation?a.encodeLocation(_e.pathname).pathname:_e.pathname]),pathnameBase:_e.pathnameBase==="/"?_:joinPaths([_,a.encodeLocation?a.encodeLocation(_e.pathnameBase).pathname:_e.pathnameBase])})),d,o,s);return e&&ot?reactExports.createElement(LocationContext.Provider,{value:{location:_extends({pathname:"/",search:"",hash:"",state:null,key:"default"},b),navigationType:Action.Pop}},ot):ot}function DefaultErrorComponent(){let i=useRouteError(),e=isRouteErrorResponse(i)?i.status+" "+i.statusText:i instanceof Error?i.message:JSON.stringify(i),o=i instanceof Error?i.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},c=null;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},e),o?reactExports.createElement("pre",{style:a},o):null,c)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,o){return o.location!==e.location||o.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:o.error,location:o.location,revalidation:e.revalidation||o.revalidation}}componentDidCatch(e,o){console.error("React Router caught the following error during render",e,o)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(i){let{routeContext:e,match:o,children:s}=i,a=reactExports.useContext(DataRouterContext);return a&&a.static&&a.staticContext&&(o.route.errorElement||o.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=o.route.id),reactExports.createElement(RouteContext.Provider,{value:e},s)}function _renderMatches(i,e,o,s){var a;if(e===void 0&&(e=[]),o===void 0&&(o=null),s===void 0&&(s=null),i==null){var c;if(!o)return null;if(o.errors)i=o.matches;else if((c=s)!=null&&c.v7_partialHydration&&e.length===0&&!o.initialized&&o.matches.length>0)i=o.matches;else return null}let d=i,h=(a=o)==null?void 0:a.errors;if(h!=null){let j=d.findIndex(b=>b.route.id&&(h==null?void 0:h[b.route.id])!==void 0);j>=0||invariant(!1),d=d.slice(0,Math.min(d.length,j+1))}let g=!1,_=-1;if(o&&s&&s.v7_partialHydration)for(let j=0;j<d.length;j++){let b=d[j];if((b.route.HydrateFallback||b.route.hydrateFallbackElement)&&(_=j),b.route.id){let{loaderData:$,errors:nt}=o,tt=b.route.loader&&$[b.route.id]===void 0&&(!nt||nt[b.route.id]===void 0);if(b.route.lazy||tt){g=!0,_>=0?d=d.slice(0,_+1):d=[d[0]];break}}}return d.reduceRight((j,b,$)=>{let nt,tt=!1,it=null,ot=null;o&&(nt=h&&b.route.id?h[b.route.id]:void 0,it=b.route.errorElement||defaultErrorElement,g&&(_<0&&$===0?(warningOnce("route-fallback",!1),tt=!0,ot=null):_===$&&(tt=!0,ot=b.route.hydrateFallbackElement||null)));let _e=e.concat(d.slice(0,$+1)),et=()=>{let rt;return nt?rt=it:tt?rt=ot:b.route.Component?rt=reactExports.createElement(b.route.Component,null):b.route.element?rt=b.route.element:rt=j,reactExports.createElement(RenderedRoute,{match:b,routeContext:{outlet:j,matches:_e,isDataRoute:o!=null},children:rt})};return o&&(b.route.ErrorBoundary||b.route.errorElement||$===0)?reactExports.createElement(RenderErrorBoundary,{location:o.location,revalidation:o.revalidation,component:it,error:nt,children:et(),routeContext:{outlet:null,matches:_e,isDataRoute:!0}}):et()},null)}var DataRouterStateHook$1=function(i){return i.UseBlocker="useBlocker",i.UseLoaderData="useLoaderData",i.UseActionData="useActionData",i.UseRouteError="useRouteError",i.UseNavigation="useNavigation",i.UseRouteLoaderData="useRouteLoaderData",i.UseMatches="useMatches",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i.UseRouteId="useRouteId",i}(DataRouterStateHook$1||{});function useDataRouterState(i){let e=reactExports.useContext(DataRouterStateContext);return e||invariant(!1),e}function useRouteContext(i){let e=reactExports.useContext(RouteContext);return e||invariant(!1),e}function useCurrentRouteId(i){let e=useRouteContext(),o=e.matches[e.matches.length-1];return o.route.id||invariant(!1),o.route.id}function useRouteError(){var i;let e=reactExports.useContext(RouteErrorContext),o=useDataRouterState(DataRouterStateHook$1.UseRouteError),s=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return e!==void 0?e:(i=o.errors)==null?void 0:i[s]}const alreadyWarned$1={};function warningOnce(i,e,o){!e&&!alreadyWarned$1[i]&&(alreadyWarned$1[i]=!0)}function logV6DeprecationWarnings(i,e){i==null||i.v7_startTransition,(i==null?void 0:i.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function Route(i){invariant(!1)}function Router(i){let{basename:e="/",children:o=null,location:s,navigationType:a=Action.Pop,navigator:c,static:d=!1,future:h}=i;useInRouterContext()&&invariant(!1);let g=e.replace(/^\/*/,"/"),_=reactExports.useMemo(()=>({basename:g,navigator:c,static:d,future:_extends({v7_relativeSplatPath:!1},h)}),[g,h,c,d]);typeof s=="string"&&(s=parsePath(s));let{pathname:j="/",search:b="",hash:$="",state:nt=null,key:tt="default"}=s,it=reactExports.useMemo(()=>{let ot=stripBasename(j,g);return ot==null?null:{location:{pathname:ot,search:b,hash:$,state:nt,key:tt},navigationType:a}},[g,j,b,$,nt,tt,a]);return it==null?null:reactExports.createElement(NavigationContext.Provider,{value:_},reactExports.createElement(LocationContext.Provider,{children:o,value:it}))}function Routes(i){let{children:e,location:o}=i;return useRoutes(createRoutesFromChildren(e),o)}new Promise(()=>{});function createRoutesFromChildren(i,e){e===void 0&&(e=[]);let o=[];return reactExports.Children.forEach(i,(s,a)=>{if(!reactExports.isValidElement(s))return;let c=[...e,a];if(s.type===reactExports.Fragment){o.push.apply(o,createRoutesFromChildren(s.props.children,c));return}s.type!==Route&&invariant(!1),!s.props.index||!s.props.children||invariant(!1);let d={id:s.props.id||c.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(d.children=createRoutesFromChildren(s.props.children,c)),o.push(d)}),o}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const REACT_ROUTER_VERSION="6";try{window.__reactRouterVersion=REACT_ROUTER_VERSION}catch{}const START_TRANSITION="startTransition",startTransitionImpl=React$1[START_TRANSITION];function BrowserRouter(i){let{basename:e,children:o,future:s,window:a}=i,c=reactExports.useRef();c.current==null&&(c.current=createBrowserHistory({window:a,v5Compat:!0}));let d=c.current,[h,g]=reactExports.useState({action:d.action,location:d.location}),{v7_startTransition:_}=s||{},j=reactExports.useCallback(b=>{_&&startTransitionImpl?startTransitionImpl(()=>g(b)):g(b)},[g,_]);return reactExports.useLayoutEffect(()=>d.listen(j),[d,j]),reactExports.useEffect(()=>logV6DeprecationWarnings(s),[s]),reactExports.createElement(Router,{basename:e,children:o,location:h.location,navigationType:h.action,navigator:d,future:s})}var DataRouterHook;(function(i){i.UseScrollRestoration="useScrollRestoration",i.UseSubmit="useSubmit",i.UseSubmitFetcher="useSubmitFetcher",i.UseFetcher="useFetcher",i.useViewTransitionState="useViewTransitionState"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(i){i.UseFetcher="useFetcher",i.UseFetchers="useFetchers",i.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const assert=function(i,e){if(!i)throw assertionError(e)},assertionError=function(i){return new Error("Firebase Database ("+CONSTANTS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+i)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const stringToByteArray$1=function(i){const e=[];let o=0;for(let s=0;s<i.length;s++){let a=i.charCodeAt(s);a<128?e[o++]=a:a<2048?(e[o++]=a>>6|192,e[o++]=a&63|128):(a&64512)===55296&&s+1<i.length&&(i.charCodeAt(s+1)&64512)===56320?(a=65536+((a&1023)<<10)+(i.charCodeAt(++s)&1023),e[o++]=a>>18|240,e[o++]=a>>12&63|128,e[o++]=a>>6&63|128,e[o++]=a&63|128):(e[o++]=a>>12|224,e[o++]=a>>6&63|128,e[o++]=a&63|128)}return e},byteArrayToString=function(i){const e=[];let o=0,s=0;for(;o<i.length;){const a=i[o++];if(a<128)e[s++]=String.fromCharCode(a);else if(a>191&&a<224){const c=i[o++];e[s++]=String.fromCharCode((a&31)<<6|c&63)}else if(a>239&&a<365){const c=i[o++],d=i[o++],h=i[o++],g=((a&7)<<18|(c&63)<<12|(d&63)<<6|h&63)-65536;e[s++]=String.fromCharCode(55296+(g>>10)),e[s++]=String.fromCharCode(56320+(g&1023))}else{const c=i[o++],d=i[o++];e[s++]=String.fromCharCode((a&15)<<12|(c&63)<<6|d&63)}}return e.join("")},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const o=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let a=0;a<i.length;a+=3){const c=i[a],d=a+1<i.length,h=d?i[a+1]:0,g=a+2<i.length,_=g?i[a+2]:0,j=c>>2,b=(c&3)<<4|h>>4;let $=(h&15)<<2|_>>6,nt=_&63;g||(nt=64,d||($=64)),s.push(o[j],o[b],o[$],o[nt])}return s.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(stringToByteArray$1(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):byteArrayToString(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const o=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let a=0;a<i.length;){const c=o[i.charAt(a++)],h=a<i.length?o[i.charAt(a)]:0;++a;const _=a<i.length?o[i.charAt(a)]:64;++a;const b=a<i.length?o[i.charAt(a)]:64;if(++a,c==null||h==null||_==null||b==null)throw new DecodeBase64StringError;const $=c<<2|h>>4;if(s.push($),_!==64){const nt=h<<4&240|_>>2;if(s.push(nt),b!==64){const tt=_<<6&192|b;s.push(tt)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class DecodeBase64StringError extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const base64Encode=function(i){const e=stringToByteArray$1(i);return base64.encodeByteArray(e,!0)},base64urlEncodeWithoutPadding=function(i){return base64Encode(i).replace(/\./g,"")},base64Decode=function(i){try{return base64.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function deepCopy(i){return deepExtend(void 0,i)}function deepExtend(i,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const o=e;return new Date(o.getTime());case Object:i===void 0&&(i={});break;case Array:i=[];break;default:return e}for(const o in e)!e.hasOwnProperty(o)||!isValidKey$1(o)||(i[o]=deepExtend(i[o],e[o]));return i}function isValidKey$1(i){return i!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getGlobal(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const getDefaultsFromGlobal=()=>getGlobal().__FIREBASE_DEFAULTS__,getDefaultsFromEnvVariable=()=>{if(typeof process>"u"||typeof process.env>"u")return;const i={}.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},getDefaultsFromCookie=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&base64Decode(i[1]);return e&&JSON.parse(e)},getDefaults=()=>{try{return getDefaultsFromGlobal()||getDefaultsFromEnvVariable()||getDefaultsFromCookie()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},getDefaultAppConfig=()=>{var i;return(i=getDefaults())===null||i===void 0?void 0:i.config},getExperimentalSetting=i=>{var e;return(e=getDefaults())===null||e===void 0?void 0:e[`_${i}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Deferred{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,o)=>{this.resolve=e,this.reject=o})}wrapCallback(e){return(o,s)=>{o?this.reject(o):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(o):e(o,s))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createMockUserToken(i,e){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const o={alg:"none",type:"JWT"},s=e||"demo-project",a=i.iat||0,c=i.sub||i.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:a,exp:a+3600,auth_time:a,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}}},i),h="";return[base64urlEncodeWithoutPadding(JSON.stringify(o)),base64urlEncodeWithoutPadding(JSON.stringify(d)),h].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getUA(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function isMobileCordova(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())}function isNode(){var i;const e=(i=getDefaults())===null||i===void 0?void 0:i.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function isBrowser$2(){return typeof self=="object"&&self.self===self}function isBrowserExtension(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function isReactNative$1(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function isIE(){const i=getUA();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function isNodeSdk(){return CONSTANTS.NODE_ADMIN===!0}function isIndexedDBAvailable(){try{return typeof indexedDB=="object"}catch{return!1}}function validateIndexedDBOpenable(){return new Promise((i,e)=>{try{let o=!0;const s="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(s);a.onsuccess=()=>{a.result.close(),o||self.indexedDB.deleteDatabase(s),i(!0)},a.onupgradeneeded=()=>{o=!1},a.onerror=()=>{var c;e(((c=a.error)===null||c===void 0?void 0:c.message)||"")}}catch(o){e(o)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERROR_NAME="FirebaseError";class FirebaseError extends Error{constructor(e,o,s){super(o),this.code=e,this.customData=s,this.name=ERROR_NAME,Object.setPrototypeOf(this,FirebaseError.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ErrorFactory.prototype.create)}}class ErrorFactory{constructor(e,o,s){this.service=e,this.serviceName=o,this.errors=s}create(e,...o){const s=o[0]||{},a=`${this.service}/${e}`,c=this.errors[e],d=c?replaceTemplate(c,s):"Error",h=`${this.serviceName}: ${d} (${a}).`;return new FirebaseError(a,h,s)}}function replaceTemplate(i,e){return i.replace(PATTERN,(o,s)=>{const a=e[s];return a!=null?String(a):`<${s}?>`})}const PATTERN=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jsonEval(i){return JSON.parse(i)}function stringify(i){return JSON.stringify(i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const decode=function(i){let e={},o={},s={},a="";try{const c=i.split(".");e=jsonEval(base64Decode(c[0])||""),o=jsonEval(base64Decode(c[1])||""),a=c[2],s=o.d||{},delete o.d}catch{}return{header:e,claims:o,data:s,signature:a}},isValidFormat=function(i){const e=decode(i),o=e.claims;return!!o&&typeof o=="object"&&o.hasOwnProperty("iat")},isAdmin=function(i){const e=decode(i).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function contains(i,e){return Object.prototype.hasOwnProperty.call(i,e)}function safeGet(i,e){if(Object.prototype.hasOwnProperty.call(i,e))return i[e]}function isEmpty(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}function map(i,e,o){const s={};for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&(s[a]=e.call(o,i[a],a,i));return s}function deepEqual(i,e){if(i===e)return!0;const o=Object.keys(i),s=Object.keys(e);for(const a of o){if(!s.includes(a))return!1;const c=i[a],d=e[a];if(isObject$3(c)&&isObject$3(d)){if(!deepEqual(c,d))return!1}else if(c!==d)return!1}for(const a of s)if(!o.includes(a))return!1;return!0}function isObject$3(i){return i!==null&&typeof i=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function querystring(i){const e=[];for(const[o,s]of Object.entries(i))Array.isArray(s)?s.forEach(a=>{e.push(encodeURIComponent(o)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(o)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function querystringDecode(i){const e={};return i.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[a,c]=s.split("=");e[decodeURIComponent(a)]=decodeURIComponent(c)}}),e}function extractQuerystring(i){const e=i.indexOf("?");if(!e)return"";const o=i.indexOf("#",e);return i.substring(e,o>0?o:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sha1{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,o){o||(o=0);const s=this.W_;if(typeof e=="string")for(let b=0;b<16;b++)s[b]=e.charCodeAt(o)<<24|e.charCodeAt(o+1)<<16|e.charCodeAt(o+2)<<8|e.charCodeAt(o+3),o+=4;else for(let b=0;b<16;b++)s[b]=e[o]<<24|e[o+1]<<16|e[o+2]<<8|e[o+3],o+=4;for(let b=16;b<80;b++){const $=s[b-3]^s[b-8]^s[b-14]^s[b-16];s[b]=($<<1|$>>>31)&4294967295}let a=this.chain_[0],c=this.chain_[1],d=this.chain_[2],h=this.chain_[3],g=this.chain_[4],_,j;for(let b=0;b<80;b++){b<40?b<20?(_=h^c&(d^h),j=1518500249):(_=c^d^h,j=1859775393):b<60?(_=c&d|h&(c|d),j=2400959708):(_=c^d^h,j=3395469782);const $=(a<<5|a>>>27)+_+g+j+s[b]&4294967295;g=h,h=d,d=(c<<30|c>>>2)&4294967295,c=a,a=$}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+d&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+g&4294967295}update(e,o){if(e==null)return;o===void 0&&(o=e.length);const s=o-this.blockSize;let a=0;const c=this.buf_;let d=this.inbuf_;for(;a<o;){if(d===0)for(;a<=s;)this.compress_(e,a),a+=this.blockSize;if(typeof e=="string"){for(;a<o;)if(c[d]=e.charCodeAt(a),++d,++a,d===this.blockSize){this.compress_(c),d=0;break}}else for(;a<o;)if(c[d]=e[a],++d,++a,d===this.blockSize){this.compress_(c),d=0;break}}this.inbuf_=d,this.total_+=o}digest(){const e=[];let o=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let a=this.blockSize-1;a>=56;a--)this.buf_[a]=o&255,o/=256;this.compress_(this.buf_);let s=0;for(let a=0;a<5;a++)for(let c=24;c>=0;c-=8)e[s]=this.chain_[a]>>c&255,++s;return e}}function createSubscribe(i,e){const o=new ObserverProxy(i,e);return o.subscribe.bind(o)}class ObserverProxy{constructor(e,o){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=o,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(o=>{o.next(e)})}error(e){this.forEachObserver(o=>{o.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,o,s){let a;if(e===void 0&&o===void 0&&s===void 0)throw new Error("Missing Observer.");implementsAnyMethods(e,["next","error","complete"])?a=e:a={next:e,error:o,complete:s},a.next===void 0&&(a.next=noop$1),a.error===void 0&&(a.error=noop$1),a.complete===void 0&&(a.complete=noop$1);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let o=0;o<this.observers.length;o++)this.sendOne(o,e)}sendOne(e,o){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{o(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function implementsAnyMethods(i,e){if(typeof i!="object"||i===null)return!1;for(const o of e)if(o in i&&typeof i[o]=="function")return!0;return!1}function noop$1(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const validateArgCount=function(i,e,o,s){let a;if(s<e?a="at least "+e:s>o&&(a=o===0?"none":"no more than "+o),a){const c=i+" failed: Was called with "+s+(s===1?" argument.":" arguments.")+" Expects "+a+".";throw new Error(c)}};function errorPrefix(i,e){return`${i} failed: ${e} argument `}function validateCallback(i,e,o,s){if(!(s&&!o)&&typeof o!="function")throw new Error(errorPrefix(i,e)+"must be a valid function.")}function validateContextObject(i,e,o,s){if(!(s&&!o)&&(typeof o!="object"||o===null))throw new Error(errorPrefix(i,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const stringToByteArray=function(i){const e=[];let o=0;for(let s=0;s<i.length;s++){let a=i.charCodeAt(s);if(a>=55296&&a<=56319){const c=a-55296;s++,assert(s<i.length,"Surrogate pair missing trail surrogate.");const d=i.charCodeAt(s)-56320;a=65536+(c<<10)+d}a<128?e[o++]=a:a<2048?(e[o++]=a>>6|192,e[o++]=a&63|128):a<65536?(e[o++]=a>>12|224,e[o++]=a>>6&63|128,e[o++]=a&63|128):(e[o++]=a>>18|240,e[o++]=a>>12&63|128,e[o++]=a>>6&63|128,e[o++]=a&63|128)}return e},stringLength=function(i){let e=0;for(let o=0;o<i.length;o++){const s=i.charCodeAt(o);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,o++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getModularInstance(i){return i&&i._delegate?i._delegate:i}class Component{constructor(e,o,s){this.name=e,this.instanceFactory=o,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME$1="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Provider{constructor(e,o){this.name=e,this.container=o,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const o=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(o)){const s=new Deferred;if(this.instancesDeferred.set(o,s),this.isInitialized(o)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:o});a&&s.resolve(a)}catch{}}return this.instancesDeferred.get(o).promise}getImmediate(e){var o;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(o=e==null?void 0:e.optional)!==null&&o!==void 0?o:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(c){if(a)return null;throw c}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(isComponentEager(e))try{this.getOrInitializeService({instanceIdentifier:DEFAULT_ENTRY_NAME$1})}catch{}for(const[o,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(o);try{const c=this.getOrInitializeService({instanceIdentifier:a});s.resolve(c)}catch{}}}}clearInstance(e=DEFAULT_ENTRY_NAME$1){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(o=>"INTERNAL"in o).map(o=>o.INTERNAL.delete()),...e.filter(o=>"_delete"in o).map(o=>o._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=DEFAULT_ENTRY_NAME$1){return this.instances.has(e)}getOptions(e=DEFAULT_ENTRY_NAME$1){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:o={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:s,options:o});for(const[c,d]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(c);s===h&&d.resolve(a)}return a}onInit(e,o){var s;const a=this.normalizeInstanceIdentifier(o),c=(s=this.onInitCallbacks.get(a))!==null&&s!==void 0?s:new Set;c.add(e),this.onInitCallbacks.set(a,c);const d=this.instances.get(a);return d&&e(d,a),()=>{c.delete(e)}}invokeOnInitCallbacks(e,o){const s=this.onInitCallbacks.get(o);if(s)for(const a of s)try{a(e,o)}catch{}}getOrInitializeService({instanceIdentifier:e,options:o={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:normalizeIdentifierForFactory(e),options:o}),this.instances.set(e,s),this.instancesOptions.set(e,o),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=DEFAULT_ENTRY_NAME$1){return this.component?this.component.multipleInstances?e:DEFAULT_ENTRY_NAME$1:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function normalizeIdentifierForFactory(i){return i===DEFAULT_ENTRY_NAME$1?void 0:i}function isComponentEager(i){return i.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ComponentContainer{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const o=this.getProvider(e.name);if(o.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);o.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const o=new Provider(e,this);return this.providers.set(e,o),o}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const instances=[];var LogLevel;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(LogLevel||(LogLevel={}));const levelStringToEnum={debug:LogLevel.DEBUG,verbose:LogLevel.VERBOSE,info:LogLevel.INFO,warn:LogLevel.WARN,error:LogLevel.ERROR,silent:LogLevel.SILENT},defaultLogLevel=LogLevel.INFO,ConsoleMethod={[LogLevel.DEBUG]:"log",[LogLevel.VERBOSE]:"log",[LogLevel.INFO]:"info",[LogLevel.WARN]:"warn",[LogLevel.ERROR]:"error"},defaultLogHandler=(i,e,...o)=>{if(e<i.logLevel)return;const s=new Date().toISOString(),a=ConsoleMethod[e];if(a)console[a](`[${s}]  ${i.name}:`,...o);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Logger{constructor(e){this.name=e,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,this._userLogHandler=null,instances.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in LogLevel))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?levelStringToEnum[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.DEBUG,...e),this._logHandler(this,LogLevel.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.VERBOSE,...e),this._logHandler(this,LogLevel.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.INFO,...e),this._logHandler(this,LogLevel.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.WARN,...e),this._logHandler(this,LogLevel.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.ERROR,...e),this._logHandler(this,LogLevel.ERROR,...e)}}function setLogLevel$1(i){instances.forEach(e=>{e.setLogLevel(i)})}function setUserLogHandler(i,e){for(const o of instances){let s=null;e&&e.level&&(s=levelStringToEnum[e.level]),i===null?o.userLogHandler=null:o.userLogHandler=(a,c,...d)=>{const h=d.map(g=>{if(g==null)return null;if(typeof g=="string")return g;if(typeof g=="number"||typeof g=="boolean")return g.toString();if(g instanceof Error)return g.message;try{return JSON.stringify(g)}catch{return null}}).filter(g=>g).join(" ");c>=(s??a.logLevel)&&i({level:LogLevel[c].toLowerCase(),message:h,args:d,type:a.name})}}}const instanceOfAny=(i,e)=>e.some(o=>i instanceof o);let idbProxyableTypes,cursorAdvanceMethods;function getIdbProxyableTypes(){return idbProxyableTypes||(idbProxyableTypes=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function getCursorAdvanceMethods(){return cursorAdvanceMethods||(cursorAdvanceMethods=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cursorRequestMap=new WeakMap,transactionDoneMap=new WeakMap,transactionStoreNamesMap=new WeakMap,transformCache=new WeakMap,reverseTransformCache=new WeakMap;function promisifyRequest(i){const e=new Promise((o,s)=>{const a=()=>{i.removeEventListener("success",c),i.removeEventListener("error",d)},c=()=>{o(wrap(i.result)),a()},d=()=>{s(i.error),a()};i.addEventListener("success",c),i.addEventListener("error",d)});return e.then(o=>{o instanceof IDBCursor&&cursorRequestMap.set(o,i)}).catch(()=>{}),reverseTransformCache.set(e,i),e}function cacheDonePromiseForTransaction(i){if(transactionDoneMap.has(i))return;const e=new Promise((o,s)=>{const a=()=>{i.removeEventListener("complete",c),i.removeEventListener("error",d),i.removeEventListener("abort",d)},c=()=>{o(),a()},d=()=>{s(i.error||new DOMException("AbortError","AbortError")),a()};i.addEventListener("complete",c),i.addEventListener("error",d),i.addEventListener("abort",d)});transactionDoneMap.set(i,e)}let idbProxyTraps={get(i,e,o){if(i instanceof IDBTransaction){if(e==="done")return transactionDoneMap.get(i);if(e==="objectStoreNames")return i.objectStoreNames||transactionStoreNamesMap.get(i);if(e==="store")return o.objectStoreNames[1]?void 0:o.objectStore(o.objectStoreNames[0])}return wrap(i[e])},set(i,e,o){return i[e]=o,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function replaceTraps(i){idbProxyTraps=i(idbProxyTraps)}function wrapFunction(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...o){const s=i.call(unwrap$1(this),e,...o);return transactionStoreNamesMap.set(s,e.sort?e.sort():[e]),wrap(s)}:getCursorAdvanceMethods().includes(i)?function(...e){return i.apply(unwrap$1(this),e),wrap(cursorRequestMap.get(this))}:function(...e){return wrap(i.apply(unwrap$1(this),e))}}function transformCachableValue(i){return typeof i=="function"?wrapFunction(i):(i instanceof IDBTransaction&&cacheDonePromiseForTransaction(i),instanceOfAny(i,getIdbProxyableTypes())?new Proxy(i,idbProxyTraps):i)}function wrap(i){if(i instanceof IDBRequest)return promisifyRequest(i);if(transformCache.has(i))return transformCache.get(i);const e=transformCachableValue(i);return e!==i&&(transformCache.set(i,e),reverseTransformCache.set(e,i)),e}const unwrap$1=i=>reverseTransformCache.get(i);function openDB(i,e,{blocked:o,upgrade:s,blocking:a,terminated:c}={}){const d=indexedDB.open(i,e),h=wrap(d);return s&&d.addEventListener("upgradeneeded",g=>{s(wrap(d.result),g.oldVersion,g.newVersion,wrap(d.transaction),g)}),o&&d.addEventListener("blocked",g=>o(g.oldVersion,g.newVersion,g)),h.then(g=>{c&&g.addEventListener("close",()=>c()),a&&g.addEventListener("versionchange",_=>a(_.oldVersion,_.newVersion,_))}).catch(()=>{}),h}const readMethods=["get","getKey","getAll","getAllKeys","count"],writeMethods=["put","add","delete","clear"],cachedMethods=new Map;function getMethod(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(cachedMethods.get(e))return cachedMethods.get(e);const o=e.replace(/FromIndex$/,""),s=e!==o,a=writeMethods.includes(o);if(!(o in(s?IDBIndex:IDBObjectStore).prototype)||!(a||readMethods.includes(o)))return;const c=async function(d,...h){const g=this.transaction(d,a?"readwrite":"readonly");let _=g.store;return s&&(_=_.index(h.shift())),(await Promise.all([_[o](...h),a&&g.done]))[0]};return cachedMethods.set(e,c),c}replaceTraps(i=>({...i,get:(e,o,s)=>getMethod(e,o)||i.get(e,o,s),has:(e,o)=>!!getMethod(e,o)||i.has(e,o)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PlatformLoggerServiceImpl{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(o=>{if(isVersionServiceProvider(o)){const s=o.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(o=>o).join(" ")}}function isVersionServiceProvider(i){const e=i.getComponent();return(e==null?void 0:e.type)==="VERSION"}const name$o="@firebase/app",version$1$1="0.9.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logger$2=new Logger("@firebase/app"),name$n="@firebase/app-compat",name$m="@firebase/analytics-compat",name$l="@firebase/analytics",name$k="@firebase/app-check-compat",name$j="@firebase/app-check",name$i="@firebase/auth",name$h="@firebase/auth-compat",name$g="@firebase/database",name$f="@firebase/database-compat",name$e="@firebase/functions",name$d="@firebase/functions-compat",name$c="@firebase/installations",name$b="@firebase/installations-compat",name$a="@firebase/messaging",name$9="@firebase/messaging-compat",name$8="@firebase/performance",name$7$1="@firebase/performance-compat",name$6$1="@firebase/remote-config",name$5$1="@firebase/remote-config-compat",name$4$1="@firebase/storage",name$3$1="@firebase/storage-compat",name$2$1="@firebase/firestore",name$1$1="@firebase/firestore-compat",name$p="firebase",version$8="9.23.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME="[DEFAULT]",PLATFORM_LOG_STRING={[name$o]:"fire-core",[name$n]:"fire-core-compat",[name$l]:"fire-analytics",[name$m]:"fire-analytics-compat",[name$j]:"fire-app-check",[name$k]:"fire-app-check-compat",[name$i]:"fire-auth",[name$h]:"fire-auth-compat",[name$g]:"fire-rtdb",[name$f]:"fire-rtdb-compat",[name$e]:"fire-fn",[name$d]:"fire-fn-compat",[name$c]:"fire-iid",[name$b]:"fire-iid-compat",[name$a]:"fire-fcm",[name$9]:"fire-fcm-compat",[name$8]:"fire-perf",[name$7$1]:"fire-perf-compat",[name$6$1]:"fire-rc",[name$5$1]:"fire-rc-compat",[name$4$1]:"fire-gcs",[name$3$1]:"fire-gcs-compat",[name$2$1]:"fire-fst",[name$1$1]:"fire-fst-compat","fire-js":"fire-js",[name$p]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _apps=new Map,_components=new Map;function _addComponent(i,e){try{i.container.addComponent(e)}catch(o){logger$2.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,o)}}function _addOrOverwriteComponent(i,e){i.container.addOrOverwriteComponent(e)}function _registerComponent(i){const e=i.name;if(_components.has(e))return logger$2.debug(`There were multiple attempts to register component ${e}.`),!1;_components.set(e,i);for(const o of _apps.values())_addComponent(o,i);return!0}function _getProvider(i,e){const o=i.container.getProvider("heartbeat").getImmediate({optional:!0});return o&&o.triggerHeartbeat(),i.container.getProvider(e)}function _removeServiceInstance(i,e,o=DEFAULT_ENTRY_NAME){_getProvider(i,e).clearInstance(o)}function _clearComponents(){_components.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERRORS$1={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},ERROR_FACTORY$1=new ErrorFactory("app","Firebase",ERRORS$1);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FirebaseAppImpl$1=class{constructor(e,o,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},o),this._name=o.name,this._automaticDataCollectionEnabled=o.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ERROR_FACTORY$1.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SDK_VERSION$3=version$8;function initializeApp(i,e={}){let o=i;typeof e!="object"&&(e={name:e});const s=Object.assign({name:DEFAULT_ENTRY_NAME,automaticDataCollectionEnabled:!1},e),a=s.name;if(typeof a!="string"||!a)throw ERROR_FACTORY$1.create("bad-app-name",{appName:String(a)});if(o||(o=getDefaultAppConfig()),!o)throw ERROR_FACTORY$1.create("no-options");const c=_apps.get(a);if(c){if(deepEqual(o,c.options)&&deepEqual(s,c.config))return c;throw ERROR_FACTORY$1.create("duplicate-app",{appName:a})}const d=new ComponentContainer(a);for(const g of _components.values())d.addComponent(g);const h=new FirebaseAppImpl$1(o,s,d);return _apps.set(a,h),h}function getApp(i=DEFAULT_ENTRY_NAME){const e=_apps.get(i);if(!e&&i===DEFAULT_ENTRY_NAME&&getDefaultAppConfig())return initializeApp();if(!e)throw ERROR_FACTORY$1.create("no-app",{appName:i});return e}function getApps(){return Array.from(_apps.values())}async function deleteApp(i){const e=i.name;_apps.has(e)&&(_apps.delete(e),await Promise.all(i.container.getProviders().map(o=>o.delete())),i.isDeleted=!0)}function registerVersion(i,e,o){var s;let a=(s=PLATFORM_LOG_STRING[i])!==null&&s!==void 0?s:i;o&&(a+=`-${o}`);const c=a.match(/\s|\//),d=e.match(/\s|\//);if(c||d){const h=[`Unable to register library "${a}" with version "${e}":`];c&&h.push(`library name "${a}" contains illegal characters (whitespace or "/")`),c&&d&&h.push("and"),d&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),logger$2.warn(h.join(" "));return}_registerComponent(new Component(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}function onLog(i,e){if(i!==null&&typeof i!="function")throw ERROR_FACTORY$1.create("invalid-log-argument");setUserLogHandler(i,e)}function setLogLevel(i){setLogLevel$1(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME$1="firebase-heartbeat-database",DB_VERSION$1=1,STORE_NAME="firebase-heartbeat-store";let dbPromise=null;function getDbPromise(){return dbPromise||(dbPromise=openDB(DB_NAME$1,DB_VERSION$1,{upgrade:(i,e)=>{switch(e){case 0:i.createObjectStore(STORE_NAME)}}}).catch(i=>{throw ERROR_FACTORY$1.create("idb-open",{originalErrorMessage:i.message})})),dbPromise}async function readHeartbeatsFromIndexedDB(i){try{return await(await getDbPromise()).transaction(STORE_NAME).objectStore(STORE_NAME).get(computeKey(i))}catch(e){if(e instanceof FirebaseError)logger$2.warn(e.message);else{const o=ERROR_FACTORY$1.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});logger$2.warn(o.message)}}}async function writeHeartbeatsToIndexedDB(i,e){try{const s=(await getDbPromise()).transaction(STORE_NAME,"readwrite");await s.objectStore(STORE_NAME).put(e,computeKey(i)),await s.done}catch(o){if(o instanceof FirebaseError)logger$2.warn(o.message);else{const s=ERROR_FACTORY$1.create("idb-set",{originalErrorMessage:o==null?void 0:o.message});logger$2.warn(s.message)}}}function computeKey(i){return`${i.name}!${i.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MAX_HEADER_BYTES=1024,STORED_HEARTBEAT_RETENTION_MAX_MILLIS=30*24*60*60*1e3;class HeartbeatServiceImpl{constructor(e){this.container=e,this._heartbeatsCache=null;const o=this.container.getProvider("app").getImmediate();this._storage=new HeartbeatStorageImpl(o),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=getUTCDateString();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:o}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const c=new Date(a.date).valueOf();return Date.now()-c<=STORED_HEARTBEAT_RETENTION_MAX_MILLIS}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=getUTCDateString(),{heartbeatsToSend:o,unsentEntries:s}=extractHeartbeatsForHeader(this._heartbeatsCache.heartbeats),a=base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:o}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}}function getUTCDateString(){return new Date().toISOString().substring(0,10)}function extractHeartbeatsForHeader(i,e=MAX_HEADER_BYTES){const o=[];let s=i.slice();for(const a of i){const c=o.find(d=>d.agent===a.agent);if(c){if(c.dates.push(a.date),countBytes(o)>e){c.dates.pop();break}}else if(o.push({agent:a.agent,dates:[a.date]}),countBytes(o)>e){o.pop();break}s=s.slice(1)}return{heartbeatsToSend:o,unsentEntries:s}}class HeartbeatStorageImpl{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return isIndexedDBAvailable()?validateIndexedDBOpenable().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await readHeartbeatsFromIndexedDB(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var o;if(await this._canUseIndexedDBPromise){const a=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(o=e.lastSentHeartbeatDate)!==null&&o!==void 0?o:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var o;if(await this._canUseIndexedDBPromise){const a=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(o=e.lastSentHeartbeatDate)!==null&&o!==void 0?o:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function countBytes(i){return base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:i})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerCoreComponents$1(i){_registerComponent(new Component("platform-logger",e=>new PlatformLoggerServiceImpl(e),"PRIVATE")),_registerComponent(new Component("heartbeat",e=>new HeartbeatServiceImpl(e),"PRIVATE")),registerVersion(name$o,version$1$1,i),registerVersion(name$o,version$1$1,"esm2017"),registerVersion("fire-js","")}registerCoreComponents$1("");const modularAPIs=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError,SDK_VERSION:SDK_VERSION$3,_DEFAULT_ENTRY_NAME:DEFAULT_ENTRY_NAME,_addComponent,_addOrOverwriteComponent,_apps,_clearComponents,_components,_getProvider,_registerComponent,_removeServiceInstance,deleteApp,getApp,getApps,initializeApp,onLog,registerVersion,setLogLevel},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FirebaseAppImpl{constructor(e,o){this._delegate=e,this.firebase=o,_addComponent(e,new Component("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),deleteApp(this._delegate)))}_getService(e,o=DEFAULT_ENTRY_NAME){var s;this._delegate.checkDestroyed();const a=this._delegate.container.getProvider(e);return!a.isInitialized()&&((s=a.getComponent())===null||s===void 0?void 0:s.instantiationMode)==="EXPLICIT"&&a.initialize(),a.getImmediate({identifier:o})}_removeServiceInstance(e,o=DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(e).clearInstance(o)}_addComponent(e){_addComponent(this._delegate,e)}_addOrOverwriteComponent(e){_addOrOverwriteComponent(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERRORS={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},ERROR_FACTORY=new ErrorFactory("app-compat","Firebase",ERRORS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createFirebaseNamespaceCore(i){const e={},o={__esModule:!0,initializeApp:c,app:a,registerVersion,setLogLevel,onLog,apps:null,SDK_VERSION:SDK_VERSION$3,INTERNAL:{registerComponent:h,removeApp:s,useAsService:g,modularAPIs}};o.default=o,Object.defineProperty(o,"apps",{get:d});function s(_){delete e[_]}function a(_){if(_=_||DEFAULT_ENTRY_NAME,!contains(e,_))throw ERROR_FACTORY.create("no-app",{appName:_});return e[_]}a.App=i;function c(_,j={}){const b=initializeApp(_,j);if(contains(e,b.name))return e[b.name];const $=new i(b,o);return e[b.name]=$,$}function d(){return Object.keys(e).map(_=>e[_])}function h(_){const j=_.name,b=j.replace("-compat","");if(_registerComponent(_)&&_.type==="PUBLIC"){const $=(nt=a())=>{if(typeof nt[b]!="function")throw ERROR_FACTORY.create("invalid-app-argument",{appName:j});return nt[b]()};_.serviceProps!==void 0&&deepExtend($,_.serviceProps),o[b]=$,i.prototype[b]=function(...nt){return this._getService.bind(this,j).apply(this,_.multipleInstances?nt:[])}}return _.type==="PUBLIC"?o[b]:null}function g(_,j){return j==="serverAuth"?null:j}return o}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createFirebaseNamespace(){const i=createFirebaseNamespaceCore(FirebaseAppImpl);i.INTERNAL=Object.assign(Object.assign({},i.INTERNAL),{createFirebaseNamespace,extendNamespace:e,createSubscribe,ErrorFactory,deepExtend});function e(o){deepExtend(i,o)}return i}const firebase$1=createFirebaseNamespace();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logger$1=new Logger("@firebase/app-compat"),name$7="@firebase/app-compat",version$7="0.2.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerCoreComponents(i){registerVersion(name$7,version$7,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(isBrowser$2()&&self.firebase!==void 0){logger$1.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const i=self.firebase.SDK_VERSION;i&&i.indexOf("LITE")>=0&&logger$1.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const firebase=firebase$1;registerCoreComponents();var name$6="firebase",version$6="9.23.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */firebase.registerVersion(name$6,version$6,"app-compat");function __rest$1(i,e){var o={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(o[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(i);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(i,s[a])&&(o[s[a]]=i[s[a]]);return o}typeof SuppressedError=="function"&&SuppressedError;const ProviderId={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},ActionCodeOperation={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _debugErrorMap(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend."}}function _prodErrorMap(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const debugErrorMap=_debugErrorMap,prodErrorMap=_prodErrorMap,_DEFAULT_AUTH_ERROR_FACTORY=new ErrorFactory("auth","Firebase",_prodErrorMap());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logClient$2=new Logger("@firebase/auth");function _logWarn(i,...e){logClient$2.logLevel<=LogLevel.WARN&&logClient$2.warn(`Auth (${SDK_VERSION$3}): ${i}`,...e)}function _logError(i,...e){logClient$2.logLevel<=LogLevel.ERROR&&logClient$2.error(`Auth (${SDK_VERSION$3}): ${i}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _fail(i,...e){throw createErrorInternal(i,...e)}function _createError(i,...e){return createErrorInternal(i,...e)}function _errorWithCustomMessage(i,e,o){const s=Object.assign(Object.assign({},prodErrorMap()),{[e]:o});return new ErrorFactory("auth","Firebase",s).create(e,{appName:i.name})}function _assertInstanceOf(i,e,o){const s=o;if(!(e instanceof s))throw s.name!==e.constructor.name&&_fail(i,"argument-error"),_errorWithCustomMessage(i,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function createErrorInternal(i,...e){if(typeof i!="string"){const o=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=i.name),i._errorFactory.create(o,...s)}return _DEFAULT_AUTH_ERROR_FACTORY.create(i,...e)}function _assert$4(i,e,...o){if(!i)throw createErrorInternal(e,...o)}function debugFail(i){const e="INTERNAL ASSERTION FAILED: "+i;throw _logError(e),new Error(e)}function debugAssert(i,e){i||debugFail(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getCurrentUrl(){var i;return typeof self<"u"&&((i=self.location)===null||i===void 0?void 0:i.href)||""}function _isHttpOrHttps$1(){return _getCurrentScheme$1()==="http:"||_getCurrentScheme$1()==="https:"}function _getCurrentScheme$1(){var i;return typeof self<"u"&&((i=self.location)===null||i===void 0?void 0:i.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isOnline(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(_isHttpOrHttps$1()||isBrowserExtension()||"connection"in navigator)?navigator.onLine:!0}function _getUserLanguage(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Delay{constructor(e,o){this.shortDelay=e,this.longDelay=o,debugAssert(o>e,"Short delay should be less than long delay!"),this.isMobile=isMobileCordova()||isReactNative$1()}get(){return _isOnline()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _emulatorUrl(i,e){debugAssert(i.emulator,"Emulator should always be set here");const{url:o}=i.emulator;return e?`${o}${e.startsWith("/")?e.slice(1):e}`:o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FetchProvider{static initialize(e,o,s){this.fetchImpl=e,o&&(this.headersImpl=o),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;debugFail("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;debugFail("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;debugFail("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SERVER_ERROR_MAP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_API_TIMEOUT_MS=new Delay(3e4,6e4);function _addTidIfNecessary(i,e){return i.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:i.tenantId}):e}async function _performApiRequest(i,e,o,s,a={}){return _performFetchWithErrorHandling(i,a,async()=>{let c={},d={};s&&(e==="GET"?d=s:c={body:JSON.stringify(s)});const h=querystring(Object.assign({key:i.config.apiKey},d)).slice(1),g=await i._getAdditionalHeaders();return g["Content-Type"]="application/json",i.languageCode&&(g["X-Firebase-Locale"]=i.languageCode),FetchProvider.fetch()(_getFinalTarget(i,i.config.apiHost,o,h),Object.assign({method:e,headers:g,referrerPolicy:"no-referrer"},c))})}async function _performFetchWithErrorHandling(i,e,o){i._canInitEmulator=!1;const s=Object.assign(Object.assign({},SERVER_ERROR_MAP),e);try{const a=new NetworkTimeout(i),c=await Promise.race([o(),a.promise]);a.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw _makeTaggedError(i,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const h=c.ok?d.errorMessage:d.error.message,[g,_]=h.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw _makeTaggedError(i,"credential-already-in-use",d);if(g==="EMAIL_EXISTS")throw _makeTaggedError(i,"email-already-in-use",d);if(g==="USER_DISABLED")throw _makeTaggedError(i,"user-disabled",d);const j=s[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(_)throw _errorWithCustomMessage(i,j,_);_fail(i,j)}}catch(a){if(a instanceof FirebaseError)throw a;_fail(i,"network-request-failed",{message:String(a)})}}async function _performSignInRequest(i,e,o,s,a={}){const c=await _performApiRequest(i,e,o,s,a);return"mfaPendingCredential"in c&&_fail(i,"multi-factor-auth-required",{_serverResponse:c}),c}function _getFinalTarget(i,e,o,s){const a=`${e}${o}?${s}`;return i.config.emulator?_emulatorUrl(i.config,a):`${i.config.apiScheme}://${a}`}class NetworkTimeout{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((o,s)=>{this.timer=setTimeout(()=>s(_createError(this.auth,"network-request-failed")),DEFAULT_API_TIMEOUT_MS.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function _makeTaggedError(i,e,o){const s={appName:i.name};o.email&&(s.email=o.email),o.phoneNumber&&(s.phoneNumber=o.phoneNumber);const a=_createError(i,e,s);return a.customData._tokenResponse=o,a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function deleteAccount(i,e){return _performApiRequest(i,"POST","/v1/accounts:delete",e)}async function deleteLinkedAccounts(i,e){return _performApiRequest(i,"POST","/v1/accounts:update",e)}async function getAccountInfo(i,e){return _performApiRequest(i,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function utcTimestampToDateString(i){if(i)try{const e=new Date(Number(i));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function getIdTokenResult(i,e=!1){const o=getModularInstance(i),s=await o.getIdToken(e),a=_parseToken(s);_assert$4(a&&a.exp&&a.auth_time&&a.iat,o.auth,"internal-error");const c=typeof a.firebase=="object"?a.firebase:void 0,d=c==null?void 0:c.sign_in_provider;return{claims:a,token:s,authTime:utcTimestampToDateString(secondsStringToMilliseconds(a.auth_time)),issuedAtTime:utcTimestampToDateString(secondsStringToMilliseconds(a.iat)),expirationTime:utcTimestampToDateString(secondsStringToMilliseconds(a.exp)),signInProvider:d||null,signInSecondFactor:(c==null?void 0:c.sign_in_second_factor)||null}}function secondsStringToMilliseconds(i){return Number(i)*1e3}function _parseToken(i){const[e,o,s]=i.split(".");if(e===void 0||o===void 0||s===void 0)return _logError("JWT malformed, contained fewer than 3 sections"),null;try{const a=base64Decode(o);return a?JSON.parse(a):(_logError("Failed to decode base64 JWT payload"),null)}catch(a){return _logError("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function _tokenExpiresIn(i){const e=_parseToken(i);return _assert$4(e,"internal-error"),_assert$4(typeof e.exp<"u","internal-error"),_assert$4(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _logoutIfInvalidated(i,e,o=!1){if(o)return e;try{return await e}catch(s){throw s instanceof FirebaseError&&isUserInvalidated(s)&&i.auth.currentUser===i&&await i.auth.signOut(),s}}function isUserInvalidated({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ProactiveRefresh{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var o;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const a=((o=this.user.stsTokenManager.expirationTime)!==null&&o!==void 0?o:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const o=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},o)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UserMetadata{constructor(e,o){this.createdAt=e,this.lastLoginAt=o,this._initializeTime()}_initializeTime(){this.lastSignInTime=utcTimestampToDateString(this.lastLoginAt),this.creationTime=utcTimestampToDateString(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reloadWithoutSaving(i){var e;const o=i.auth,s=await i.getIdToken(),a=await _logoutIfInvalidated(i,getAccountInfo(o,{idToken:s}));_assert$4(a==null?void 0:a.users.length,o,"internal-error");const c=a.users[0];i._notifyReloadListener(c);const d=!((e=c.providerUserInfo)===null||e===void 0)&&e.length?extractProviderData(c.providerUserInfo):[],h=mergeProviderData(i.providerData,d),g=i.isAnonymous,_=!(i.email&&c.passwordHash)&&!(h!=null&&h.length),j=g?_:!1,b={uid:c.localId,displayName:c.displayName||null,photoURL:c.photoUrl||null,email:c.email||null,emailVerified:c.emailVerified||!1,phoneNumber:c.phoneNumber||null,tenantId:c.tenantId||null,providerData:h,metadata:new UserMetadata(c.createdAt,c.lastLoginAt),isAnonymous:j};Object.assign(i,b)}async function reload(i){const e=getModularInstance(i);await _reloadWithoutSaving(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function mergeProviderData(i,e){return[...i.filter(s=>!e.some(a=>a.providerId===s.providerId)),...e]}function extractProviderData(i){return i.map(e=>{var{providerId:o}=e,s=__rest$1(e,["providerId"]);return{providerId:o,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function requestStsToken(i,e){const o=await _performFetchWithErrorHandling(i,{},async()=>{const s=querystring({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:c}=i.config,d=_getFinalTarget(i,a,"/v1/token",`key=${c}`),h=await i._getAdditionalHeaders();return h["Content-Type"]="application/x-www-form-urlencoded",FetchProvider.fetch()(d,{method:"POST",headers:h,body:s})});return{accessToken:o.access_token,expiresIn:o.expires_in,refreshToken:o.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StsTokenManager{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_assert$4(e.idToken,"internal-error"),_assert$4(typeof e.idToken<"u","internal-error"),_assert$4(typeof e.refreshToken<"u","internal-error");const o="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):_tokenExpiresIn(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,o)}async getToken(e,o=!1){return _assert$4(!this.accessToken||this.refreshToken,e,"user-token-expired"),!o&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,o){const{accessToken:s,refreshToken:a,expiresIn:c}=await requestStsToken(e,o);this.updateTokensAndExpiration(s,a,Number(c))}updateTokensAndExpiration(e,o,s){this.refreshToken=o||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,o){const{refreshToken:s,accessToken:a,expirationTime:c}=o,d=new StsTokenManager;return s&&(_assert$4(typeof s=="string","internal-error",{appName:e}),d.refreshToken=s),a&&(_assert$4(typeof a=="string","internal-error",{appName:e}),d.accessToken=a),c&&(_assert$4(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new StsTokenManager,this.toJSON())}_performRefresh(){return debugFail("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function assertStringOrUndefined(i,e){_assert$4(typeof i=="string"||typeof i>"u","internal-error",{appName:e})}class UserImpl{constructor(e){var{uid:o,auth:s,stsTokenManager:a}=e,c=__rest$1(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ProactiveRefresh(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=o,this.auth=s,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=c.displayName||null,this.email=c.email||null,this.emailVerified=c.emailVerified||!1,this.phoneNumber=c.phoneNumber||null,this.photoURL=c.photoURL||null,this.isAnonymous=c.isAnonymous||!1,this.tenantId=c.tenantId||null,this.providerData=c.providerData?[...c.providerData]:[],this.metadata=new UserMetadata(c.createdAt||void 0,c.lastLoginAt||void 0)}async getIdToken(e){const o=await _logoutIfInvalidated(this,this.stsTokenManager.getToken(this.auth,e));return _assert$4(o,this.auth,"internal-error"),this.accessToken!==o&&(this.accessToken=o,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),o}getIdTokenResult(e){return getIdTokenResult(this,e)}reload(){return reload(this)}_assign(e){this!==e&&(_assert$4(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(o=>Object.assign({},o)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const o=new UserImpl(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return o.metadata._copy(this.metadata),o}_onReload(e){_assert$4(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,o=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),o&&await _reloadWithoutSaving(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await _logoutIfInvalidated(this,deleteAccount(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,o){var s,a,c,d,h,g,_,j;const b=(s=o.displayName)!==null&&s!==void 0?s:void 0,$=(a=o.email)!==null&&a!==void 0?a:void 0,nt=(c=o.phoneNumber)!==null&&c!==void 0?c:void 0,tt=(d=o.photoURL)!==null&&d!==void 0?d:void 0,it=(h=o.tenantId)!==null&&h!==void 0?h:void 0,ot=(g=o._redirectEventId)!==null&&g!==void 0?g:void 0,_e=(_=o.createdAt)!==null&&_!==void 0?_:void 0,et=(j=o.lastLoginAt)!==null&&j!==void 0?j:void 0,{uid:rt,emailVerified:st,isAnonymous:dt,providerData:ht,stsTokenManager:mt}=o;_assert$4(rt&&mt,e,"internal-error");const ft=StsTokenManager.fromJSON(this.name,mt);_assert$4(typeof rt=="string",e,"internal-error"),assertStringOrUndefined(b,e.name),assertStringOrUndefined($,e.name),_assert$4(typeof st=="boolean",e,"internal-error"),_assert$4(typeof dt=="boolean",e,"internal-error"),assertStringOrUndefined(nt,e.name),assertStringOrUndefined(tt,e.name),assertStringOrUndefined(it,e.name),assertStringOrUndefined(ot,e.name),assertStringOrUndefined(_e,e.name),assertStringOrUndefined(et,e.name);const bt=new UserImpl({uid:rt,auth:e,email:$,emailVerified:st,displayName:b,isAnonymous:dt,photoURL:tt,phoneNumber:nt,tenantId:it,stsTokenManager:ft,createdAt:_e,lastLoginAt:et});return ht&&Array.isArray(ht)&&(bt.providerData=ht.map(vt=>Object.assign({},vt))),ot&&(bt._redirectEventId=ot),bt}static async _fromIdTokenResponse(e,o,s=!1){const a=new StsTokenManager;a.updateFromServerResponse(o);const c=new UserImpl({uid:o.localId,auth:e,stsTokenManager:a,isAnonymous:s});return await _reloadWithoutSaving(c),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const instanceCache=new Map;function _getInstance(i){debugAssert(i instanceof Function,"Expected a class definition");let e=instanceCache.get(i);return e?(debugAssert(e instanceof i,"Instance stored in cache mismatched with class"),e):(e=new i,instanceCache.set(i,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class InMemoryPersistence{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,o){this.storage[e]=o}async _get(e){const o=this.storage[e];return o===void 0?null:o}async _remove(e){delete this.storage[e]}_addListener(e,o){}_removeListener(e,o){}}InMemoryPersistence.type="NONE";const inMemoryPersistence=InMemoryPersistence;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _persistenceKeyName(i,e,o){return`firebase:${i}:${e}:${o}`}class PersistenceUserManager{constructor(e,o,s){this.persistence=e,this.auth=o,this.userKey=s;const{config:a,name:c}=this.auth;this.fullUserKey=_persistenceKeyName(this.userKey,a.apiKey,c),this.fullPersistenceKey=_persistenceKeyName("persistence",a.apiKey,c),this.boundEventHandler=o._onStorageEvent.bind(o),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?UserImpl._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const o=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,o)return this.setCurrentUser(o)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,o,s="authUser"){if(!o.length)return new PersistenceUserManager(_getInstance(inMemoryPersistence),e,s);const a=(await Promise.all(o.map(async _=>{if(await _._isAvailable())return _}))).filter(_=>_);let c=a[0]||_getInstance(inMemoryPersistence);const d=_persistenceKeyName(s,e.config.apiKey,e.name);let h=null;for(const _ of o)try{const j=await _._get(d);if(j){const b=UserImpl._fromJSON(e,j);_!==c&&(h=b),c=_;break}}catch{}const g=a.filter(_=>_._shouldAllowMigration);return!c._shouldAllowMigration||!g.length?new PersistenceUserManager(c,e,s):(c=g[0],h&&await c._set(d,h.toJSON()),await Promise.all(o.map(async _=>{if(_!==c)try{await _._remove(d)}catch{}})),new PersistenceUserManager(c,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getBrowserName(i){const e=i.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(_isIEMobile(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(_isFirefox(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_isBlackBerry(e))return"Blackberry";if(_isWebOS(e))return"Webos";if(_isSafari(e))return"Safari";if((e.includes("chrome/")||_isChromeIOS(e))&&!e.includes("edge/"))return"Chrome";if(_isAndroid(e))return"Android";{const o=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=i.match(o);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function _isFirefox(i=getUA()){return/firefox\//i.test(i)}function _isSafari(i=getUA()){const e=i.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function _isChromeIOS(i=getUA()){return/crios\//i.test(i)}function _isIEMobile(i=getUA()){return/iemobile/i.test(i)}function _isAndroid(i=getUA()){return/android/i.test(i)}function _isBlackBerry(i=getUA()){return/blackberry/i.test(i)}function _isWebOS(i=getUA()){return/webos/i.test(i)}function _isIOS(i=getUA()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function _isIOS7Or8(i=getUA()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(i)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(i)}function _isIOSStandalone(i=getUA()){var e;return _isIOS(i)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function _isIE10(){return isIE()&&document.documentMode===10}function _isMobileBrowser(i=getUA()){return _isIOS(i)||_isAndroid(i)||_isWebOS(i)||_isBlackBerry(i)||/windows phone/i.test(i)||_isIEMobile(i)}function _isIframe(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getClientVersion(i,e=[]){let o;switch(i){case"Browser":o=_getBrowserName(getUA());break;case"Worker":o=`${_getBrowserName(getUA())}-${i}`;break;default:o=i}const s=e.length?e.join(","):"FirebaseCore-web";return`${o}/JsCore/${SDK_VERSION$3}/${s}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function getRecaptchaParams(i){return(await _performApiRequest(i,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function getRecaptchaConfig(i,e){return _performApiRequest(i,"GET","/v2/recaptchaConfig",_addTidIfNecessary(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isV2(i){return i!==void 0&&i.getResponse!==void 0}function isEnterprise(i){return i!==void 0&&i.enterprise!==void 0}class RecaptchaConfig{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(o=>o.provider==="EMAIL_PASSWORD_PROVIDER"&&o.enforcementState!=="OFF")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getScriptParentElement(){var i,e;return(e=(i=document.getElementsByTagName("head"))===null||i===void 0?void 0:i[0])!==null&&e!==void 0?e:document}function _loadJS(i){return new Promise((e,o)=>{const s=document.createElement("script");s.setAttribute("src",i),s.onload=e,s.onerror=a=>{const c=_createError("internal-error");c.customData=a,o(c)},s.type="text/javascript",s.charset="UTF-8",getScriptParentElement().appendChild(s)})}function _generateCallbackName(i){return`__${i}${Math.floor(Math.random()*1e6)}`}const RECAPTCHA_ENTERPRISE_URL="https://www.google.com/recaptcha/enterprise.js?render=",RECAPTCHA_ENTERPRISE_VERIFIER_TYPE="recaptcha-enterprise",FAKE_TOKEN="NO_RECAPTCHA";class RecaptchaEnterpriseVerifier{constructor(e){this.type=RECAPTCHA_ENTERPRISE_VERIFIER_TYPE,this.auth=_castAuth(e)}async verify(e="verify",o=!1){async function s(c){if(!o){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(d,h)=>{getRecaptchaConfig(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const _=new RecaptchaConfig(g);return c.tenantId==null?c._agentRecaptchaConfig=_:c._tenantRecaptchaConfigs[c.tenantId]=_,d(_.siteKey)}}).catch(g=>{h(g)})})}function a(c,d,h){const g=window.grecaptcha;isEnterprise(g)?g.enterprise.ready(()=>{g.enterprise.execute(c,{action:e}).then(_=>{d(_)}).catch(()=>{d(FAKE_TOKEN)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((c,d)=>{s(this.auth).then(h=>{if(!o&&isEnterprise(window.grecaptcha))a(h,c,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}_loadJS(RECAPTCHA_ENTERPRISE_URL+h).then(()=>{a(h,c,d)}).catch(g=>{d(g)})}}).catch(h=>{d(h)})})}}async function injectRecaptchaFields(i,e,o,s=!1){const a=new RecaptchaEnterpriseVerifier(i);let c;try{c=await a.verify(o)}catch{c=await a.verify(o,!0)}const d=Object.assign({},e);return s?Object.assign(d,{captchaResp:c}):Object.assign(d,{captchaResponse:c}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthMiddlewareQueue{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,o){const s=c=>new Promise((d,h)=>{try{const g=e(c);d(g)}catch(g){h(g)}});s.onAbort=o,this.queue.push(s);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const o=[];try{for(const s of this.queue)await s(e),s.onAbort&&o.push(s.onAbort)}catch(s){o.reverse();for(const a of o)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthImpl{constructor(e,o,s,a){this.app=e,this.heartbeatServiceProvider=o,this.appCheckServiceProvider=s,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Subscription$1(this),this.idTokenSubscription=new Subscription$1(this),this.beforeStateQueue=new AuthMiddlewareQueue(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=_DEFAULT_AUTH_ERROR_FACTORY,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion}_initializeWithPersistence(e,o){return o&&(this._popupRedirectResolver=_getInstance(o)),this._initializationPromise=this.queue(async()=>{var s,a;if(!this._deleted&&(this.persistenceManager=await PersistenceUserManager.create(this,e),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(o),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var o;const s=await this.assertedPersistence.getCurrentUser();let a=s,c=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(o=this.redirectUser)===null||o===void 0?void 0:o._redirectEventId,h=a==null?void 0:a._redirectEventId,g=await this.tryRedirectSignIn(e);(!d||d===h)&&(g!=null&&g.user)&&(a=g.user,c=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(c)try{await this.beforeStateQueue.runMiddleware(a)}catch(d){a=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return _assert$4(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let o=null;try{o=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return o}async reloadAndSetCurrentUserOrClear(e){try{await _reloadWithoutSaving(e)}catch(o){if((o==null?void 0:o.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=_getUserLanguage()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const o=e?getModularInstance(e):null;return o&&_assert$4(o.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(o&&o._clone(this))}async _updateCurrentUser(e,o=!1){if(!this._deleted)return e&&_assert$4(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),o||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(_getInstance(e))})}async initializeRecaptchaConfig(){const e=await getRecaptchaConfig(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),o=new RecaptchaConfig(e);this.tenantId==null?this._agentRecaptchaConfig=o:this._tenantRecaptchaConfigs[this.tenantId]=o,o.emailPasswordEnabled&&new RecaptchaEnterpriseVerifier(this).verify()}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ErrorFactory("auth","Firebase",e())}onAuthStateChanged(e,o,s){return this.registerStateListener(this.authStateSubscription,e,o,s)}beforeAuthStateChanged(e,o){return this.beforeStateQueue.pushCallback(e,o)}onIdTokenChanged(e,o,s){return this.registerStateListener(this.idTokenSubscription,e,o,s)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,o){const s=await this.getOrInitRedirectPersistenceManager(o);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const o=e&&_getInstance(e)||this._popupRedirectResolver;_assert$4(o,this,"argument-error"),this.redirectPersistenceManager=await PersistenceUserManager.create(this,[_getInstance(o._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var o,s;return this._isInitialized&&await this.queue(async()=>{}),((o=this._currentUser)===null||o===void 0?void 0:o._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,o;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(o=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&o!==void 0?o:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,o,s,a){if(this._deleted)return()=>{};const c=typeof o=="function"?o:o.next.bind(o),d=this._isInitialized?Promise.resolve():this._initializationPromise;return _assert$4(d,this,"internal-error"),d.then(()=>c(this.currentUser)),typeof o=="function"?e.addObserver(o,s,a):e.addObserver(o)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _assert$4(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_getClientVersion(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const o={"X-Client-Version":this.clientVersion};this.app.options.appId&&(o["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(o["X-Firebase-Client"]=s);const a=await this._getAppCheckToken();return a&&(o["X-Firebase-AppCheck"]=a),o}async _getAppCheckToken(){var e;const o=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return o!=null&&o.error&&_logWarn(`Error while retrieving App Check token: ${o.error}`),o==null?void 0:o.token}}function _castAuth(i){return getModularInstance(i)}let Subscription$1=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=createSubscribe(o=>this.observer=o)}get next(){return _assert$4(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};function _initializeAuthInstance(i,e){const o=(e==null?void 0:e.persistence)||[],s=(Array.isArray(o)?o:[o]).map(_getInstance);e!=null&&e.errorMap&&i._updateErrorMap(e.errorMap),i._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function connectAuthEmulator(i,e,o){const s=_castAuth(i);_assert$4(s._canInitEmulator,s,"emulator-config-failed"),_assert$4(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const a=!!(o!=null&&o.disableWarnings),c=extractProtocol(e),{host:d,port:h}=extractHostAndPort(e),g=h===null?"":`:${h}`;s.config.emulator={url:`${c}//${d}${g}/`},s.settings.appVerificationDisabledForTesting=!0,s.emulatorConfig=Object.freeze({host:d,port:h,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:a})}),a||emitEmulatorWarning()}function extractProtocol(i){const e=i.indexOf(":");return e<0?"":i.substr(0,e+1)}function extractHostAndPort(i){const e=extractProtocol(i),o=/(\/\/)?([^?#/]+)/.exec(i.substr(e.length));if(!o)return{host:"",port:null};const s=o[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(s);if(a){const c=a[1];return{host:c,port:parsePort(s.substr(c.length+1))}}else{const[c,d]=s.split(":");return{host:c,port:parsePort(d)}}}function parsePort(i){if(!i)return null;const e=Number(i);return isNaN(e)?null:e}function emitEmulatorWarning(){function i(){const e=document.createElement("p"),o=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",o.position="fixed",o.width="100%",o.backgroundColor="#ffffff",o.border=".1em solid #000000",o.color="#b50000",o.bottom="0px",o.left="0px",o.margin="0px",o.zIndex="10000",o.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthCredential{constructor(e,o){this.providerId=e,this.signInMethod=o}toJSON(){return debugFail("not implemented")}_getIdTokenResponse(e){return debugFail("not implemented")}_linkToIdToken(e,o){return debugFail("not implemented")}_getReauthenticationResolver(e){return debugFail("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function resetPassword(i,e){return _performApiRequest(i,"POST","/v1/accounts:resetPassword",_addTidIfNecessary(i,e))}async function updateEmailPassword(i,e){return _performApiRequest(i,"POST","/v1/accounts:update",e)}async function applyActionCode$1(i,e){return _performApiRequest(i,"POST","/v1/accounts:update",_addTidIfNecessary(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithPassword(i,e){return _performSignInRequest(i,"POST","/v1/accounts:signInWithPassword",_addTidIfNecessary(i,e))}async function sendOobCode(i,e){return _performApiRequest(i,"POST","/v1/accounts:sendOobCode",_addTidIfNecessary(i,e))}async function sendEmailVerification$1(i,e){return sendOobCode(i,e)}async function sendPasswordResetEmail$1(i,e){return sendOobCode(i,e)}async function sendSignInLinkToEmail$1(i,e){return sendOobCode(i,e)}async function verifyAndChangeEmail(i,e){return sendOobCode(i,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithEmailLink$1(i,e){return _performSignInRequest(i,"POST","/v1/accounts:signInWithEmailLink",_addTidIfNecessary(i,e))}async function signInWithEmailLinkForLinking(i,e){return _performSignInRequest(i,"POST","/v1/accounts:signInWithEmailLink",_addTidIfNecessary(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EmailAuthCredential extends AuthCredential{constructor(e,o,s,a=null){super("password",s),this._email=e,this._password=o,this._tenantId=a}static _fromEmailAndPassword(e,o){return new EmailAuthCredential(e,o,"password")}static _fromEmailAndCode(e,o,s=null){return new EmailAuthCredential(e,o,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const o=typeof e=="string"?JSON.parse(e):e;if(o!=null&&o.email&&(o!=null&&o.password)){if(o.signInMethod==="password")return this._fromEmailAndPassword(o.email,o.password);if(o.signInMethod==="emailLink")return this._fromEmailAndCode(o.email,o.password,o.tenantId)}return null}async _getIdTokenResponse(e){var o;switch(this.signInMethod){case"password":const s={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(!((o=e._getRecaptchaConfig())===null||o===void 0)&&o.emailPasswordEnabled){const a=await injectRecaptchaFields(e,s,"signInWithPassword");return signInWithPassword(e,a)}else return signInWithPassword(e,s).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const c=await injectRecaptchaFields(e,s,"signInWithPassword");return signInWithPassword(e,c)}else return Promise.reject(a)});case"emailLink":return signInWithEmailLink$1(e,{email:this._email,oobCode:this._password});default:_fail(e,"internal-error")}}async _linkToIdToken(e,o){switch(this.signInMethod){case"password":return updateEmailPassword(e,{idToken:o,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return signInWithEmailLinkForLinking(e,{idToken:o,email:this._email,oobCode:this._password});default:_fail(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithIdp(i,e){return _performSignInRequest(i,"POST","/v1/accounts:signInWithIdp",_addTidIfNecessary(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IDP_REQUEST_URI$1="http://localhost";class OAuthCredential extends AuthCredential{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const o=new OAuthCredential(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(o.idToken=e.idToken),e.accessToken&&(o.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(o.nonce=e.nonce),e.pendingToken&&(o.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(o.accessToken=e.oauthToken,o.secret=e.oauthTokenSecret):_fail("argument-error"),o}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const o=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:a}=o,c=__rest$1(o,["providerId","signInMethod"]);if(!s||!a)return null;const d=new OAuthCredential(s,a);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const o=this.buildRequest();return signInWithIdp(e,o)}_linkToIdToken(e,o){const s=this.buildRequest();return s.idToken=o,signInWithIdp(e,s)}_getReauthenticationResolver(e){const o=this.buildRequest();return o.autoCreate=!1,signInWithIdp(e,o)}buildRequest(){const e={requestUri:IDP_REQUEST_URI$1,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const o={};this.idToken&&(o.id_token=this.idToken),this.accessToken&&(o.access_token=this.accessToken),this.secret&&(o.oauth_token_secret=this.secret),o.providerId=this.providerId,this.nonce&&!this.pendingToken&&(o.nonce=this.nonce),e.postBody=querystring(o)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sendPhoneVerificationCode(i,e){return _performApiRequest(i,"POST","/v1/accounts:sendVerificationCode",_addTidIfNecessary(i,e))}async function signInWithPhoneNumber$1(i,e){return _performSignInRequest(i,"POST","/v1/accounts:signInWithPhoneNumber",_addTidIfNecessary(i,e))}async function linkWithPhoneNumber$1(i,e){const o=await _performSignInRequest(i,"POST","/v1/accounts:signInWithPhoneNumber",_addTidIfNecessary(i,e));if(o.temporaryProof)throw _makeTaggedError(i,"account-exists-with-different-credential",o);return o}const VERIFY_PHONE_NUMBER_FOR_EXISTING_ERROR_MAP_={USER_NOT_FOUND:"user-not-found"};async function verifyPhoneNumberForExisting(i,e){const o=Object.assign(Object.assign({},e),{operation:"REAUTH"});return _performSignInRequest(i,"POST","/v1/accounts:signInWithPhoneNumber",_addTidIfNecessary(i,o),VERIFY_PHONE_NUMBER_FOR_EXISTING_ERROR_MAP_)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PhoneAuthCredential extends AuthCredential{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,o){return new PhoneAuthCredential({verificationId:e,verificationCode:o})}static _fromTokenResponse(e,o){return new PhoneAuthCredential({phoneNumber:e,temporaryProof:o})}_getIdTokenResponse(e){return signInWithPhoneNumber$1(e,this._makeVerificationRequest())}_linkToIdToken(e,o){return linkWithPhoneNumber$1(e,Object.assign({idToken:o},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return verifyPhoneNumberForExisting(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:o,verificationId:s,verificationCode:a}=this.params;return e&&o?{temporaryProof:e,phoneNumber:o}:{sessionInfo:s,code:a}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:o,verificationCode:s,phoneNumber:a,temporaryProof:c}=e;return!s&&!o&&!a&&!c?null:new PhoneAuthCredential({verificationId:o,verificationCode:s,phoneNumber:a,temporaryProof:c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function parseMode(i){switch(i){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function parseDeepLink(i){const e=querystringDecode(extractQuerystring(i)).link,o=e?querystringDecode(extractQuerystring(e)).deep_link_id:null,s=querystringDecode(extractQuerystring(i)).deep_link_id;return(s?querystringDecode(extractQuerystring(s)).link:null)||s||o||e||i}class ActionCodeURL{constructor(e){var o,s,a,c,d,h;const g=querystringDecode(extractQuerystring(e)),_=(o=g.apiKey)!==null&&o!==void 0?o:null,j=(s=g.oobCode)!==null&&s!==void 0?s:null,b=parseMode((a=g.mode)!==null&&a!==void 0?a:null);_assert$4(_&&j&&b,"argument-error"),this.apiKey=_,this.operation=b,this.code=j,this.continueUrl=(c=g.continueUrl)!==null&&c!==void 0?c:null,this.languageCode=(d=g.languageCode)!==null&&d!==void 0?d:null,this.tenantId=(h=g.tenantId)!==null&&h!==void 0?h:null}static parseLink(e){const o=parseDeepLink(e);try{return new ActionCodeURL(o)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EmailAuthProvider{constructor(){this.providerId=EmailAuthProvider.PROVIDER_ID}static credential(e,o){return EmailAuthCredential._fromEmailAndPassword(e,o)}static credentialWithLink(e,o){const s=ActionCodeURL.parseLink(o);return _assert$4(s,"argument-error"),EmailAuthCredential._fromEmailAndCode(e,s.code,s.tenantId)}}EmailAuthProvider.PROVIDER_ID="password";EmailAuthProvider.EMAIL_PASSWORD_SIGN_IN_METHOD="password";EmailAuthProvider.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FederatedAuthProvider{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BaseOAuthProvider extends FederatedAuthProvider{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class OAuthProvider extends BaseOAuthProvider{static credentialFromJSON(e){const o=typeof e=="string"?JSON.parse(e):e;return _assert$4("providerId"in o&&"signInMethod"in o,"argument-error"),OAuthCredential._fromParams(o)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return _assert$4(e.idToken||e.accessToken,"argument-error"),OAuthCredential._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return OAuthProvider.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return OAuthProvider.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:o,oauthAccessToken:s,oauthTokenSecret:a,pendingToken:c,nonce:d,providerId:h}=e;if(!s&&!a&&!o&&!c||!h)return null;try{return new OAuthProvider(h)._credential({idToken:o,accessToken:s,nonce:d,pendingToken:c})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FacebookAuthProvider extends BaseOAuthProvider{constructor(){super("facebook.com")}static credential(e){return OAuthCredential._fromParams({providerId:FacebookAuthProvider.PROVIDER_ID,signInMethod:FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return FacebookAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return FacebookAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return FacebookAuthProvider.credential(e.oauthAccessToken)}catch{return null}}}FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD="facebook.com";FacebookAuthProvider.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GoogleAuthProvider extends BaseOAuthProvider{constructor(){super("google.com"),this.addScope("profile")}static credential(e,o){return OAuthCredential._fromParams({providerId:GoogleAuthProvider.PROVIDER_ID,signInMethod:GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:o})}static credentialFromResult(e){return GoogleAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return GoogleAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:o,oauthAccessToken:s}=e;if(!o&&!s)return null;try{return GoogleAuthProvider.credential(o,s)}catch{return null}}}GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD="google.com";GoogleAuthProvider.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GithubAuthProvider extends BaseOAuthProvider{constructor(){super("github.com")}static credential(e){return OAuthCredential._fromParams({providerId:GithubAuthProvider.PROVIDER_ID,signInMethod:GithubAuthProvider.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return GithubAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return GithubAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return GithubAuthProvider.credential(e.oauthAccessToken)}catch{return null}}}GithubAuthProvider.GITHUB_SIGN_IN_METHOD="github.com";GithubAuthProvider.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IDP_REQUEST_URI="http://localhost";class SAMLAuthCredential extends AuthCredential{constructor(e,o){super(e,e),this.pendingToken=o}_getIdTokenResponse(e){const o=this.buildRequest();return signInWithIdp(e,o)}_linkToIdToken(e,o){const s=this.buildRequest();return s.idToken=o,signInWithIdp(e,s)}_getReauthenticationResolver(e){const o=this.buildRequest();return o.autoCreate=!1,signInWithIdp(e,o)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const o=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:a,pendingToken:c}=o;return!s||!a||!c||s!==a?null:new SAMLAuthCredential(s,c)}static _create(e,o){return new SAMLAuthCredential(e,o)}buildRequest(){return{requestUri:IDP_REQUEST_URI,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SAML_PROVIDER_PREFIX="saml.";class SAMLAuthProvider extends FederatedAuthProvider{constructor(e){_assert$4(e.startsWith(SAML_PROVIDER_PREFIX),"argument-error"),super(e)}static credentialFromResult(e){return SAMLAuthProvider.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return SAMLAuthProvider.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const o=SAMLAuthCredential.fromJSON(e);return _assert$4(o,"argument-error"),o}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:o,providerId:s}=e;if(!o||!s)return null;try{return SAMLAuthCredential._create(s,o)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TwitterAuthProvider extends BaseOAuthProvider{constructor(){super("twitter.com")}static credential(e,o){return OAuthCredential._fromParams({providerId:TwitterAuthProvider.PROVIDER_ID,signInMethod:TwitterAuthProvider.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:o})}static credentialFromResult(e){return TwitterAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return TwitterAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:o,oauthTokenSecret:s}=e;if(!o||!s)return null;try{return TwitterAuthProvider.credential(o,s)}catch{return null}}}TwitterAuthProvider.TWITTER_SIGN_IN_METHOD="twitter.com";TwitterAuthProvider.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signUp(i,e){return _performSignInRequest(i,"POST","/v1/accounts:signUp",_addTidIfNecessary(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UserCredentialImpl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,o,s,a=!1){const c=await UserImpl._fromIdTokenResponse(e,s,a),d=providerIdForResponse(s);return new UserCredentialImpl({user:c,providerId:d,_tokenResponse:s,operationType:o})}static async _forOperation(e,o,s){await e._updateTokensIfNecessary(s,!0);const a=providerIdForResponse(s);return new UserCredentialImpl({user:e,providerId:a,_tokenResponse:s,operationType:o})}}function providerIdForResponse(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInAnonymously(i){var e;const o=_castAuth(i);if(await o._initializationPromise,!((e=o.currentUser)===null||e===void 0)&&e.isAnonymous)return new UserCredentialImpl({user:o.currentUser,providerId:null,operationType:"signIn"});const s=await signUp(o,{returnSecureToken:!0}),a=await UserCredentialImpl._fromIdTokenResponse(o,"signIn",s,!0);return await o._updateCurrentUser(a.user),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MultiFactorError extends FirebaseError{constructor(e,o,s,a){var c;super(o.code,o.message),this.operationType=s,this.user=a,Object.setPrototypeOf(this,MultiFactorError.prototype),this.customData={appName:e.name,tenantId:(c=e.tenantId)!==null&&c!==void 0?c:void 0,_serverResponse:o.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,o,s,a){return new MultiFactorError(e,o,s,a)}}function _processCredentialSavingMfaContextIfNecessary(i,e,o,s){return(e==="reauthenticate"?o._getReauthenticationResolver(i):o._getIdTokenResponse(i)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?MultiFactorError._fromErrorAndOperation(i,c,e,s):c})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function providerDataAsNames(i){return new Set(i.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function unlink(i,e){const o=getModularInstance(i);await _assertLinkedStatus(!0,o,e);const{providerUserInfo:s}=await deleteLinkedAccounts(o.auth,{idToken:await o.getIdToken(),deleteProvider:[e]}),a=providerDataAsNames(s||[]);return o.providerData=o.providerData.filter(c=>a.has(c.providerId)),a.has("phone")||(o.phoneNumber=null),await o.auth._persistUserIfCurrent(o),o}async function _link$1(i,e,o=!1){const s=await _logoutIfInvalidated(i,e._linkToIdToken(i.auth,await i.getIdToken()),o);return UserCredentialImpl._forOperation(i,"link",s)}async function _assertLinkedStatus(i,e,o){await _reloadWithoutSaving(e);const s=providerDataAsNames(e.providerData),a=i===!1?"provider-already-linked":"no-such-provider";_assert$4(s.has(o)===i,e.auth,a)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reauthenticate(i,e,o=!1){const{auth:s}=i,a="reauthenticate";try{const c=await _logoutIfInvalidated(i,_processCredentialSavingMfaContextIfNecessary(s,a,e,i),o);_assert$4(c.idToken,s,"internal-error");const d=_parseToken(c.idToken);_assert$4(d,s,"internal-error");const{sub:h}=d;return _assert$4(i.uid===h,s,"user-mismatch"),UserCredentialImpl._forOperation(i,a,c)}catch(c){throw(c==null?void 0:c.code)==="auth/user-not-found"&&_fail(s,"user-mismatch"),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _signInWithCredential(i,e,o=!1){const s="signIn",a=await _processCredentialSavingMfaContextIfNecessary(i,s,e),c=await UserCredentialImpl._fromIdTokenResponse(i,s,a);return o||await i._updateCurrentUser(c.user),c}async function signInWithCredential(i,e){return _signInWithCredential(_castAuth(i),e)}async function linkWithCredential(i,e){const o=getModularInstance(i);return await _assertLinkedStatus(!1,o,e.providerId),_link$1(o,e)}async function reauthenticateWithCredential(i,e){return _reauthenticate(getModularInstance(i),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithCustomToken$1(i,e){return _performSignInRequest(i,"POST","/v1/accounts:signInWithCustomToken",_addTidIfNecessary(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithCustomToken(i,e){const o=_castAuth(i),s=await signInWithCustomToken$1(o,{token:e,returnSecureToken:!0}),a=await UserCredentialImpl._fromIdTokenResponse(o,"signIn",s);return await o._updateCurrentUser(a.user),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MultiFactorInfoImpl{constructor(e,o){this.factorId=e,this.uid=o.mfaEnrollmentId,this.enrollmentTime=new Date(o.enrolledAt).toUTCString(),this.displayName=o.displayName}static _fromServerResponse(e,o){return"phoneInfo"in o?PhoneMultiFactorInfoImpl._fromServerResponse(e,o):"totpInfo"in o?TotpMultiFactorInfoImpl._fromServerResponse(e,o):_fail(e,"internal-error")}}class PhoneMultiFactorInfoImpl extends MultiFactorInfoImpl{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,o){return new PhoneMultiFactorInfoImpl(o)}}class TotpMultiFactorInfoImpl extends MultiFactorInfoImpl{constructor(e){super("totp",e)}static _fromServerResponse(e,o){return new TotpMultiFactorInfoImpl(o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _setActionCodeSettingsOnRequest(i,e,o){var s;_assert$4(((s=o.url)===null||s===void 0?void 0:s.length)>0,i,"invalid-continue-uri"),_assert$4(typeof o.dynamicLinkDomain>"u"||o.dynamicLinkDomain.length>0,i,"invalid-dynamic-link-domain"),e.continueUrl=o.url,e.dynamicLinkDomain=o.dynamicLinkDomain,e.canHandleCodeInApp=o.handleCodeInApp,o.iOS&&(_assert$4(o.iOS.bundleId.length>0,i,"missing-ios-bundle-id"),e.iOSBundleId=o.iOS.bundleId),o.android&&(_assert$4(o.android.packageName.length>0,i,"missing-android-pkg-name"),e.androidInstallApp=o.android.installApp,e.androidMinimumVersionCode=o.android.minimumVersion,e.androidPackageName=o.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sendPasswordResetEmail(i,e,o){var s;const a=_castAuth(i),c={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};if(!((s=a._getRecaptchaConfig())===null||s===void 0)&&s.emailPasswordEnabled){const d=await injectRecaptchaFields(a,c,"getOobCode",!0);o&&_setActionCodeSettingsOnRequest(a,d,o),await sendPasswordResetEmail$1(a,d)}else o&&_setActionCodeSettingsOnRequest(a,c,o),await sendPasswordResetEmail$1(a,c).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const h=await injectRecaptchaFields(a,c,"getOobCode",!0);o&&_setActionCodeSettingsOnRequest(a,h,o),await sendPasswordResetEmail$1(a,h)}else return Promise.reject(d)})}async function confirmPasswordReset(i,e,o){await resetPassword(getModularInstance(i),{oobCode:e,newPassword:o})}async function applyActionCode(i,e){await applyActionCode$1(getModularInstance(i),{oobCode:e})}async function checkActionCode(i,e){const o=getModularInstance(i),s=await resetPassword(o,{oobCode:e}),a=s.requestType;switch(_assert$4(a,o,"internal-error"),a){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":_assert$4(s.newEmail,o,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":_assert$4(s.mfaInfo,o,"internal-error");default:_assert$4(s.email,o,"internal-error")}let c=null;return s.mfaInfo&&(c=MultiFactorInfoImpl._fromServerResponse(_castAuth(o),s.mfaInfo)),{data:{email:(s.requestType==="VERIFY_AND_CHANGE_EMAIL"?s.newEmail:s.email)||null,previousEmail:(s.requestType==="VERIFY_AND_CHANGE_EMAIL"?s.email:s.newEmail)||null,multiFactorInfo:c},operation:a}}async function verifyPasswordResetCode(i,e){const{data:o}=await checkActionCode(getModularInstance(i),e);return o.email}async function createUserWithEmailAndPassword(i,e,o){var s;const a=_castAuth(i),c={returnSecureToken:!0,email:e,password:o,clientType:"CLIENT_TYPE_WEB"};let d;if(!((s=a._getRecaptchaConfig())===null||s===void 0)&&s.emailPasswordEnabled){const _=await injectRecaptchaFields(a,c,"signUpPassword");d=signUp(a,_)}else d=signUp(a,c).catch(async _=>{if(_.code==="auth/missing-recaptcha-token"){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const j=await injectRecaptchaFields(a,c,"signUpPassword");return signUp(a,j)}else return Promise.reject(_)});const h=await d.catch(_=>Promise.reject(_)),g=await UserCredentialImpl._fromIdTokenResponse(a,"signIn",h);return await a._updateCurrentUser(g.user),g}function signInWithEmailAndPassword(i,e,o){return signInWithCredential(getModularInstance(i),EmailAuthProvider.credential(e,o))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sendSignInLinkToEmail(i,e,o){var s;const a=_castAuth(i),c={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function d(h,g){_assert$4(g.handleCodeInApp,a,"argument-error"),g&&_setActionCodeSettingsOnRequest(a,h,g)}if(!((s=a._getRecaptchaConfig())===null||s===void 0)&&s.emailPasswordEnabled){const h=await injectRecaptchaFields(a,c,"getOobCode",!0);d(h,o),await sendSignInLinkToEmail$1(a,h)}else d(c,o),await sendSignInLinkToEmail$1(a,c).catch(async h=>{if(h.code==="auth/missing-recaptcha-token"){console.log("Email link sign-in is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const g=await injectRecaptchaFields(a,c,"getOobCode",!0);d(g,o),await sendSignInLinkToEmail$1(a,g)}else return Promise.reject(h)})}function isSignInWithEmailLink(i,e){const o=ActionCodeURL.parseLink(e);return(o==null?void 0:o.operation)==="EMAIL_SIGNIN"}async function signInWithEmailLink(i,e,o){const s=getModularInstance(i),a=EmailAuthProvider.credentialWithLink(e,o||_getCurrentUrl());return _assert$4(a._tenantId===(s.tenantId||null),s,"tenant-id-mismatch"),signInWithCredential(s,a)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function createAuthUri(i,e){return _performApiRequest(i,"POST","/v1/accounts:createAuthUri",_addTidIfNecessary(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fetchSignInMethodsForEmail(i,e){const o=_isHttpOrHttps$1()?_getCurrentUrl():"http://localhost",s={identifier:e,continueUri:o},{signinMethods:a}=await createAuthUri(getModularInstance(i),s);return a||[]}async function sendEmailVerification(i,e){const o=getModularInstance(i),a={requestType:"VERIFY_EMAIL",idToken:await i.getIdToken()};e&&_setActionCodeSettingsOnRequest(o.auth,a,e);const{email:c}=await sendEmailVerification$1(o.auth,a);c!==i.email&&await i.reload()}async function verifyBeforeUpdateEmail(i,e,o){const s=getModularInstance(i),c={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await i.getIdToken(),newEmail:e};o&&_setActionCodeSettingsOnRequest(s.auth,c,o);const{email:d}=await verifyAndChangeEmail(s.auth,c);d!==i.email&&await i.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function updateProfile$1(i,e){return _performApiRequest(i,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function updateProfile(i,{displayName:e,photoURL:o}){if(e===void 0&&o===void 0)return;const s=getModularInstance(i),c={idToken:await s.getIdToken(),displayName:e,photoUrl:o,returnSecureToken:!0},d=await _logoutIfInvalidated(s,updateProfile$1(s.auth,c));s.displayName=d.displayName||null,s.photoURL=d.photoUrl||null;const h=s.providerData.find(({providerId:g})=>g==="password");h&&(h.displayName=s.displayName,h.photoURL=s.photoURL),await s._updateTokensIfNecessary(d)}function updateEmail(i,e){return updateEmailOrPassword(getModularInstance(i),e,null)}function updatePassword(i,e){return updateEmailOrPassword(getModularInstance(i),null,e)}async function updateEmailOrPassword(i,e,o){const{auth:s}=i,c={idToken:await i.getIdToken(),returnSecureToken:!0};e&&(c.email=e),o&&(c.password=o);const d=await _logoutIfInvalidated(i,updateEmailPassword(s,c));await i._updateTokensIfNecessary(d,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _fromIdTokenResponse(i){var e,o;if(!i)return null;const{providerId:s}=i,a=i.rawUserInfo?JSON.parse(i.rawUserInfo):{},c=i.isNewUser||i.kind==="identitytoolkit#SignupNewUserResponse";if(!s&&(i!=null&&i.idToken)){const d=(o=(e=_parseToken(i.idToken))===null||e===void 0?void 0:e.firebase)===null||o===void 0?void 0:o.sign_in_provider;if(d){const h=d!=="anonymous"&&d!=="custom"?d:null;return new GenericAdditionalUserInfo(c,h)}}if(!s)return null;switch(s){case"facebook.com":return new FacebookAdditionalUserInfo(c,a);case"github.com":return new GithubAdditionalUserInfo(c,a);case"google.com":return new GoogleAdditionalUserInfo(c,a);case"twitter.com":return new TwitterAdditionalUserInfo(c,a,i.screenName||null);case"custom":case"anonymous":return new GenericAdditionalUserInfo(c,null);default:return new GenericAdditionalUserInfo(c,s,a)}}class GenericAdditionalUserInfo{constructor(e,o,s={}){this.isNewUser=e,this.providerId=o,this.profile=s}}class FederatedAdditionalUserInfoWithUsername extends GenericAdditionalUserInfo{constructor(e,o,s,a){super(e,o,s),this.username=a}}class FacebookAdditionalUserInfo extends GenericAdditionalUserInfo{constructor(e,o){super(e,"facebook.com",o)}}class GithubAdditionalUserInfo extends FederatedAdditionalUserInfoWithUsername{constructor(e,o){super(e,"github.com",o,typeof(o==null?void 0:o.login)=="string"?o==null?void 0:o.login:null)}}class GoogleAdditionalUserInfo extends GenericAdditionalUserInfo{constructor(e,o){super(e,"google.com",o)}}class TwitterAdditionalUserInfo extends FederatedAdditionalUserInfoWithUsername{constructor(e,o,s){super(e,"twitter.com",o,s)}}function getAdditionalUserInfo(i){const{user:e,_tokenResponse:o}=i;return e.isAnonymous&&!o?{providerId:null,isNewUser:!1,profile:null}:_fromIdTokenResponse(o)}class MultiFactorSessionImpl{constructor(e,o,s){this.type=e,this.credential=o,this.auth=s}static _fromIdtoken(e,o){return new MultiFactorSessionImpl("enroll",e,o)}static _fromMfaPendingCredential(e){return new MultiFactorSessionImpl("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var o,s;if(e!=null&&e.multiFactorSession){if(!((o=e.multiFactorSession)===null||o===void 0)&&o.pendingCredential)return MultiFactorSessionImpl._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((s=e.multiFactorSession)===null||s===void 0)&&s.idToken)return MultiFactorSessionImpl._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MultiFactorResolverImpl{constructor(e,o,s){this.session=e,this.hints=o,this.signInResolver=s}static _fromError(e,o){const s=_castAuth(e),a=o.customData._serverResponse,c=(a.mfaInfo||[]).map(h=>MultiFactorInfoImpl._fromServerResponse(s,h));_assert$4(a.mfaPendingCredential,s,"internal-error");const d=MultiFactorSessionImpl._fromMfaPendingCredential(a.mfaPendingCredential);return new MultiFactorResolverImpl(d,c,async h=>{const g=await h._process(s,d);delete a.mfaInfo,delete a.mfaPendingCredential;const _=Object.assign(Object.assign({},a),{idToken:g.idToken,refreshToken:g.refreshToken});switch(o.operationType){case"signIn":const j=await UserCredentialImpl._fromIdTokenResponse(s,o.operationType,_);return await s._updateCurrentUser(j.user),j;case"reauthenticate":return _assert$4(o.user,s,"internal-error"),UserCredentialImpl._forOperation(o.user,o.operationType,_);default:_fail(s,"internal-error")}})}async resolveSignIn(e){const o=e;return this.signInResolver(o)}}function getMultiFactorResolver(i,e){var o;const s=getModularInstance(i),a=e;return _assert$4(e.customData.operationType,s,"argument-error"),_assert$4((o=a.customData._serverResponse)===null||o===void 0?void 0:o.mfaPendingCredential,s,"argument-error"),MultiFactorResolverImpl._fromError(s,a)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function startEnrollPhoneMfa(i,e){return _performApiRequest(i,"POST","/v2/accounts/mfaEnrollment:start",_addTidIfNecessary(i,e))}function finalizeEnrollPhoneMfa(i,e){return _performApiRequest(i,"POST","/v2/accounts/mfaEnrollment:finalize",_addTidIfNecessary(i,e))}function withdrawMfa(i,e){return _performApiRequest(i,"POST","/v2/accounts/mfaEnrollment:withdraw",_addTidIfNecessary(i,e))}class MultiFactorUserImpl{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(o=>{o.mfaInfo&&(this.enrolledFactors=o.mfaInfo.map(s=>MultiFactorInfoImpl._fromServerResponse(e.auth,s)))})}static _fromUser(e){return new MultiFactorUserImpl(e)}async getSession(){return MultiFactorSessionImpl._fromIdtoken(await this.user.getIdToken(),this.user.auth)}async enroll(e,o){const s=e,a=await this.getSession(),c=await _logoutIfInvalidated(this.user,s._process(this.user.auth,a,o));return await this.user._updateTokensIfNecessary(c),this.user.reload()}async unenroll(e){const o=typeof e=="string"?e:e.uid,s=await this.user.getIdToken();try{const a=await _logoutIfInvalidated(this.user,withdrawMfa(this.user.auth,{idToken:s,mfaEnrollmentId:o}));this.enrolledFactors=this.enrolledFactors.filter(({uid:c})=>c!==o),await this.user._updateTokensIfNecessary(a),await this.user.reload()}catch(a){throw a}}}const multiFactorUserCache=new WeakMap;function multiFactor(i){const e=getModularInstance(i);return multiFactorUserCache.has(e)||multiFactorUserCache.set(e,MultiFactorUserImpl._fromUser(e)),multiFactorUserCache.get(e)}const STORAGE_AVAILABLE_KEY="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BrowserPersistenceClass{constructor(e,o){this.storageRetriever=e,this.type=o}_isAvailable(){try{return this.storage?(this.storage.setItem(STORAGE_AVAILABLE_KEY,"1"),this.storage.removeItem(STORAGE_AVAILABLE_KEY),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,o){return this.storage.setItem(e,JSON.stringify(o)),Promise.resolve()}_get(e){const o=this.storage.getItem(e);return Promise.resolve(o?JSON.parse(o):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _iframeCannotSyncWebStorage(){const i=getUA();return _isSafari(i)||_isIOS(i)}const _POLLING_INTERVAL_MS$1=1e3,IE10_LOCAL_STORAGE_SYNC_DELAY=10;class BrowserLocalPersistence extends BrowserPersistenceClass{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,o)=>this.onStorageEvent(e,o),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=_iframeCannotSyncWebStorage()&&_isIframe(),this.fallbackToPolling=_isMobileBrowser(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const o of Object.keys(this.listeners)){const s=this.storage.getItem(o),a=this.localCache[o];s!==a&&e(o,a,s)}}onStorageEvent(e,o=!1){if(!e.key){this.forAllChangedKeys((d,h,g)=>{this.notifyListeners(d,g)});return}const s=e.key;if(o?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const d=this.storage.getItem(s);if(e.newValue!==d)e.newValue!==null?this.storage.setItem(s,e.newValue):this.storage.removeItem(s);else if(this.localCache[s]===e.newValue&&!o)return}const a=()=>{const d=this.storage.getItem(s);!o&&this.localCache[s]===d||this.notifyListeners(s,d)},c=this.storage.getItem(s);_isIE10()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,IE10_LOCAL_STORAGE_SYNC_DELAY):a()}notifyListeners(e,o){this.localCache[e]=o;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(o&&JSON.parse(o))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,o,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:o,newValue:s}),!0)})},_POLLING_INTERVAL_MS$1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,o){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(o)}_removeListener(e,o){this.listeners[e]&&(this.listeners[e].delete(o),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,o){await super._set(e,o),this.localCache[e]=JSON.stringify(o)}async _get(e){const o=await super._get(e);return this.localCache[e]=JSON.stringify(o),o}async _remove(e){await super._remove(e),delete this.localCache[e]}}BrowserLocalPersistence.type="LOCAL";const browserLocalPersistence=BrowserLocalPersistence;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BrowserSessionPersistence extends BrowserPersistenceClass{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,o){}_removeListener(e,o){}}BrowserSessionPersistence.type="SESSION";const browserSessionPersistence=BrowserSessionPersistence;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _allSettled(i){return Promise.all(i.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(o){return{fulfilled:!1,reason:o}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Receiver{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const o=this.receivers.find(a=>a.isListeningto(e));if(o)return o;const s=new Receiver(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const o=e,{eventId:s,eventType:a,data:c}=o.data,d=this.handlersMap[a];if(!(d!=null&&d.size))return;o.ports[0].postMessage({status:"ack",eventId:s,eventType:a});const h=Array.from(d).map(async _=>_(o.origin,c)),g=await _allSettled(h);o.ports[0].postMessage({status:"done",eventId:s,eventType:a,response:g})}_subscribe(e,o){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(o)}_unsubscribe(e,o){this.handlersMap[e]&&o&&this.handlersMap[e].delete(o),(!o||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Receiver.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _generateEventId(i="",e=10){let o="";for(let s=0;s<e;s++)o+=Math.floor(Math.random()*10);return i+o}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sender{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,o,s=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let c,d;return new Promise((h,g)=>{const _=_generateEventId("",20);a.port1.start();const j=setTimeout(()=>{g(new Error("unsupported_event"))},s);d={messageChannel:a,onMessage(b){const $=b;if($.data.eventId===_)switch($.data.status){case"ack":clearTimeout(j),c=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),h($.data.response);break;default:clearTimeout(j),clearTimeout(c),g(new Error("invalid_response"));break}}},this.handlers.add(d),a.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:_,data:o},[a.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _window(){return window}function _setWindowLocation(i){_window().location.href=i}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isWorker$1(){return typeof _window().WorkerGlobalScope<"u"&&typeof _window().importScripts=="function"}async function _getActiveServiceWorker(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _getServiceWorkerController(){var i;return((i=navigator==null?void 0:navigator.serviceWorker)===null||i===void 0?void 0:i.controller)||null}function _getWorkerGlobalScope(){return _isWorker$1()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME="firebaseLocalStorageDb",DB_VERSION=1,DB_OBJECTSTORE_NAME="firebaseLocalStorage",DB_DATA_KEYPATH="fbase_key";class DBPromise{constructor(e){this.request=e}toPromise(){return new Promise((e,o)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{o(this.request.error)})})}}function getObjectStore(i,e){return i.transaction([DB_OBJECTSTORE_NAME],e?"readwrite":"readonly").objectStore(DB_OBJECTSTORE_NAME)}function _deleteDatabase(){const i=indexedDB.deleteDatabase(DB_NAME);return new DBPromise(i).toPromise()}function _openDatabase(){const i=indexedDB.open(DB_NAME,DB_VERSION);return new Promise((e,o)=>{i.addEventListener("error",()=>{o(i.error)}),i.addEventListener("upgradeneeded",()=>{const s=i.result;try{s.createObjectStore(DB_OBJECTSTORE_NAME,{keyPath:DB_DATA_KEYPATH})}catch(a){o(a)}}),i.addEventListener("success",async()=>{const s=i.result;s.objectStoreNames.contains(DB_OBJECTSTORE_NAME)?e(s):(s.close(),await _deleteDatabase(),e(await _openDatabase()))})})}async function _putObject(i,e,o){const s=getObjectStore(i,!0).put({[DB_DATA_KEYPATH]:e,value:o});return new DBPromise(s).toPromise()}async function getObject(i,e){const o=getObjectStore(i,!1).get(e),s=await new DBPromise(o).toPromise();return s===void 0?null:s.value}function _deleteObject(i,e){const o=getObjectStore(i,!0).delete(e);return new DBPromise(o).toPromise()}const _POLLING_INTERVAL_MS=800,_TRANSACTION_RETRY_COUNT=3;class IndexedDBLocalPersistence{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await _openDatabase(),this.db)}async _withRetries(e){let o=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(o++>_TRANSACTION_RETRY_COUNT)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _isWorker$1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Receiver._getInstance(_getWorkerGlobalScope()),this.receiver._subscribe("keyChanged",async(e,o)=>({keyProcessed:(await this._poll()).includes(o.key)})),this.receiver._subscribe("ping",async(e,o)=>["keyChanged"])}async initializeSender(){var e,o;if(this.activeServiceWorker=await _getActiveServiceWorker(),!this.activeServiceWorker)return;this.sender=new Sender(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((o=s[0])===null||o===void 0)&&o.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||_getServiceWorkerController()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await _openDatabase();return await _putObject(e,STORAGE_AVAILABLE_KEY,"1"),await _deleteObject(e,STORAGE_AVAILABLE_KEY),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,o){return this._withPendingWrite(async()=>(await this._withRetries(s=>_putObject(s,e,o)),this.localCache[e]=o,this.notifyServiceWorker(e)))}async _get(e){const o=await this._withRetries(s=>getObject(s,e));return this.localCache[e]=o,o}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(o=>_deleteObject(o,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const c=getObjectStore(a,!1).getAll();return new DBPromise(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const o=[],s=new Set;for(const{fbase_key:a,value:c}of e)s.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(c)&&(this.notifyListeners(a,c),o.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!s.has(a)&&(this.notifyListeners(a,null),o.push(a));return o}notifyListeners(e,o){this.localCache[e]=o;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(o)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_POLLING_INTERVAL_MS)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,o){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(o)}_removeListener(e,o){this.listeners[e]&&(this.listeners[e].delete(o),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}IndexedDBLocalPersistence.type="LOCAL";const indexedDBLocalPersistence=IndexedDBLocalPersistence;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function startSignInPhoneMfa(i,e){return _performApiRequest(i,"POST","/v2/accounts/mfaSignIn:start",_addTidIfNecessary(i,e))}function finalizeSignInPhoneMfa(i,e){return _performApiRequest(i,"POST","/v2/accounts/mfaSignIn:finalize",_addTidIfNecessary(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _SOLVE_TIME_MS=500,_EXPIRATION_TIME_MS=6e4,_WIDGET_ID_START=1e12;class MockReCaptcha{constructor(e){this.auth=e,this.counter=_WIDGET_ID_START,this._widgets=new Map}render(e,o){const s=this.counter;return this._widgets.set(s,new MockWidget(e,this.auth.name,o||{})),this.counter++,s}reset(e){var o;const s=e||_WIDGET_ID_START;(o=this._widgets.get(s))===null||o===void 0||o.delete(),this._widgets.delete(s)}getResponse(e){var o;const s=e||_WIDGET_ID_START;return((o=this._widgets.get(s))===null||o===void 0?void 0:o.getResponse())||""}async execute(e){var o;const s=e||_WIDGET_ID_START;return(o=this._widgets.get(s))===null||o===void 0||o.execute(),""}}class MockWidget{constructor(e,o,s){this.params=s,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const a=typeof e=="string"?document.getElementById(e):e;_assert$4(a,"argument-error",{appName:o}),this.container=a,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=generateRandomAlphaNumericString(50);const{callback:e,"expired-callback":o}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,o)try{o()}catch{}this.isVisible&&this.execute()},_EXPIRATION_TIME_MS)},_SOLVE_TIME_MS))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function generateRandomAlphaNumericString(i){const e=[],o="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let s=0;s<i;s++)e.push(o.charAt(Math.floor(Math.random()*o.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _JSLOAD_CALLBACK=_generateCallbackName("rcb"),NETWORK_TIMEOUT_DELAY=new Delay(3e4,6e4),RECAPTCHA_BASE="https://www.google.com/recaptcha/api.js?";class ReCaptchaLoaderImpl{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=_window().grecaptcha)===null||e===void 0)&&e.render)}load(e,o=""){return _assert$4(isHostLanguageValid(o),e,"argument-error"),this.shouldResolveImmediately(o)&&isV2(_window().grecaptcha)?Promise.resolve(_window().grecaptcha):new Promise((s,a)=>{const c=_window().setTimeout(()=>{a(_createError(e,"network-request-failed"))},NETWORK_TIMEOUT_DELAY.get());_window()[_JSLOAD_CALLBACK]=()=>{_window().clearTimeout(c),delete _window()[_JSLOAD_CALLBACK];const h=_window().grecaptcha;if(!h||!isV2(h)){a(_createError(e,"internal-error"));return}const g=h.render;h.render=(_,j)=>{const b=g(_,j);return this.counter++,b},this.hostLanguage=o,s(h)};const d=`${RECAPTCHA_BASE}?${querystring({onload:_JSLOAD_CALLBACK,render:"explicit",hl:o})}`;_loadJS(d).catch(()=>{clearTimeout(c),a(_createError(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var o;return!!(!((o=_window().grecaptcha)===null||o===void 0)&&o.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function isHostLanguageValid(i){return i.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(i)}class MockReCaptchaLoaderImpl{async load(e){return new MockReCaptcha(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RECAPTCHA_VERIFIER_TYPE="recaptcha",DEFAULT_PARAMS={theme:"light",type:"image"};let RecaptchaVerifier$1=class{constructor(e,o=Object.assign({},DEFAULT_PARAMS),s){this.parameters=o,this.type=RECAPTCHA_VERIFIER_TYPE,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=_castAuth(s),this.isInvisible=this.parameters.size==="invisible",_assert$4(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const a=typeof e=="string"?document.getElementById(e):e;_assert$4(a,this.auth,"argument-error"),this.container=a,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new MockReCaptchaLoaderImpl:new ReCaptchaLoaderImpl,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),o=this.getAssertedRecaptcha(),s=o.getResponse(e);return s||new Promise(a=>{const c=d=>{d&&(this.tokenChangeListeners.delete(c),a(d))};this.tokenChangeListeners.add(c),this.isInvisible&&o.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){_assert$4(!this.parameters.sitekey,this.auth,"argument-error"),_assert$4(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),_assert$4(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return o=>{if(this.tokenChangeListeners.forEach(s=>s(o)),typeof e=="function")e(o);else if(typeof e=="string"){const s=_window()[e];typeof s=="function"&&s(o)}}}assertNotDestroyed(){_assert$4(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const o=document.createElement("div");e.appendChild(o),e=o}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){_assert$4(_isHttpOrHttps$1()&&!_isWorker$1(),this.auth,"internal-error"),await domReady(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await getRecaptchaParams(this.auth);_assert$4(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return _assert$4(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function domReady(){let i=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}i=()=>e(),window.addEventListener("load",i)}).catch(e=>{throw i&&window.removeEventListener("load",i),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ConfirmationResultImpl{constructor(e,o){this.verificationId=e,this.onConfirmation=o}confirm(e){const o=PhoneAuthCredential._fromVerification(this.verificationId,e);return this.onConfirmation(o)}}async function signInWithPhoneNumber(i,e,o){const s=_castAuth(i),a=await _verifyPhoneNumber(s,e,getModularInstance(o));return new ConfirmationResultImpl(a,c=>signInWithCredential(s,c))}async function linkWithPhoneNumber(i,e,o){const s=getModularInstance(i);await _assertLinkedStatus(!1,s,"phone");const a=await _verifyPhoneNumber(s.auth,e,getModularInstance(o));return new ConfirmationResultImpl(a,c=>linkWithCredential(s,c))}async function reauthenticateWithPhoneNumber(i,e,o){const s=getModularInstance(i),a=await _verifyPhoneNumber(s.auth,e,getModularInstance(o));return new ConfirmationResultImpl(a,c=>reauthenticateWithCredential(s,c))}async function _verifyPhoneNumber(i,e,o){var s;const a=await o.verify();try{_assert$4(typeof a=="string",i,"argument-error"),_assert$4(o.type===RECAPTCHA_VERIFIER_TYPE,i,"argument-error");let c;if(typeof e=="string"?c={phoneNumber:e}:c=e,"session"in c){const d=c.session;if("phoneNumber"in c)return _assert$4(d.type==="enroll",i,"internal-error"),(await startEnrollPhoneMfa(i,{idToken:d.credential,phoneEnrollmentInfo:{phoneNumber:c.phoneNumber,recaptchaToken:a}})).phoneSessionInfo.sessionInfo;{_assert$4(d.type==="signin",i,"internal-error");const h=((s=c.multiFactorHint)===null||s===void 0?void 0:s.uid)||c.multiFactorUid;return _assert$4(h,i,"missing-multi-factor-info"),(await startSignInPhoneMfa(i,{mfaPendingCredential:d.credential,mfaEnrollmentId:h,phoneSignInInfo:{recaptchaToken:a}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:d}=await sendPhoneVerificationCode(i,{phoneNumber:c.phoneNumber,recaptchaToken:a});return d}}finally{o._reset()}}async function updatePhoneNumber(i,e){await _link$1(getModularInstance(i),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let PhoneAuthProvider$1=class dn{constructor(e){this.providerId=dn.PROVIDER_ID,this.auth=_castAuth(e)}verifyPhoneNumber(e,o){return _verifyPhoneNumber(this.auth,e,getModularInstance(o))}static credential(e,o){return PhoneAuthCredential._fromVerification(e,o)}static credentialFromResult(e){const o=e;return dn.credentialFromTaggedObject(o)}static credentialFromError(e){return dn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:o,temporaryProof:s}=e;return o&&s?PhoneAuthCredential._fromTokenResponse(o,s):null}};PhoneAuthProvider$1.PROVIDER_ID="phone";PhoneAuthProvider$1.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _withDefaultResolver(i,e){return e?_getInstance(e):(_assert$4(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IdpCredential extends AuthCredential{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return signInWithIdp(e,this._buildIdpRequest())}_linkToIdToken(e,o){return signInWithIdp(e,this._buildIdpRequest(o))}_getReauthenticationResolver(e){return signInWithIdp(e,this._buildIdpRequest())}_buildIdpRequest(e){const o={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(o.idToken=e),o}}function _signIn(i){return _signInWithCredential(i.auth,new IdpCredential(i),i.bypassAuthState)}function _reauth(i){const{auth:e,user:o}=i;return _assert$4(o,e,"internal-error"),_reauthenticate(o,new IdpCredential(i),i.bypassAuthState)}async function _link(i){const{auth:e,user:o}=i;return _assert$4(o,e,"internal-error"),_link$1(o,new IdpCredential(i),i.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AbstractPopupRedirectOperation{constructor(e,o,s,a,c=!1){this.auth=e,this.resolver=s,this.user=a,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(o)?o:[o]}execute(){return new Promise(async(e,o)=>{this.pendingPromise={resolve:e,reject:o};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:o,sessionId:s,postBody:a,tenantId:c,error:d,type:h}=e;if(d){this.reject(d);return}const g={auth:this.auth,requestUri:o,sessionId:s,tenantId:c||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(g))}catch(_){this.reject(_)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return _signIn;case"linkViaPopup":case"linkViaRedirect":return _link;case"reauthViaPopup":case"reauthViaRedirect":return _reauth;default:_fail(this.auth,"internal-error")}}resolve(e){debugAssert(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){debugAssert(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _POLL_WINDOW_CLOSE_TIMEOUT=new Delay(2e3,1e4);async function signInWithPopup(i,e,o){const s=_castAuth(i);_assertInstanceOf(i,e,FederatedAuthProvider);const a=_withDefaultResolver(s,o);return new PopupOperation(s,"signInViaPopup",e,a).executeNotNull()}async function reauthenticateWithPopup(i,e,o){const s=getModularInstance(i);_assertInstanceOf(s.auth,e,FederatedAuthProvider);const a=_withDefaultResolver(s.auth,o);return new PopupOperation(s.auth,"reauthViaPopup",e,a,s).executeNotNull()}async function linkWithPopup(i,e,o){const s=getModularInstance(i);_assertInstanceOf(s.auth,e,FederatedAuthProvider);const a=_withDefaultResolver(s.auth,o);return new PopupOperation(s.auth,"linkViaPopup",e,a,s).executeNotNull()}class PopupOperation extends AbstractPopupRedirectOperation{constructor(e,o,s,a,c){super(e,o,a,c),this.provider=s,this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction&&PopupOperation.currentPopupAction.cancel(),PopupOperation.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return _assert$4(e,this.auth,"internal-error"),e}async onExecution(){debugAssert(this.filter.length===1,"Popup operations only handle one event");const e=_generateEventId();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(o=>{this.reject(o)}),this.resolver._isIframeWebStorageSupported(this.auth,o=>{o||this.reject(_createError(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(_createError(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction=null}pollUserCancellation(){const e=()=>{var o,s;if(!((s=(o=this.authWindow)===null||o===void 0?void 0:o.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_createError(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,_POLL_WINDOW_CLOSE_TIMEOUT.get())};e()}}PopupOperation.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PENDING_REDIRECT_KEY="pendingRedirect",redirectOutcomeMap=new Map;class RedirectAction extends AbstractPopupRedirectOperation{constructor(e,o,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],o,void 0,s),this.eventId=null}async execute(){let e=redirectOutcomeMap.get(this.auth._key());if(!e){try{const s=await _getAndClearPendingRedirectStatus(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(o){e=()=>Promise.reject(o)}redirectOutcomeMap.set(this.auth._key(),e)}return this.bypassAuthState||redirectOutcomeMap.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const o=await this.auth._redirectUserForId(e.eventId);if(o)return this.user=o,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _getAndClearPendingRedirectStatus(i,e){const o=pendingRedirectKey(e),s=resolverPersistence(i);if(!await s._isAvailable())return!1;const a=await s._get(o)==="true";return await s._remove(o),a}async function _setPendingRedirectStatus(i,e){return resolverPersistence(i)._set(pendingRedirectKey(e),"true")}function _clearRedirectOutcomes(){redirectOutcomeMap.clear()}function _overrideRedirectResult(i,e){redirectOutcomeMap.set(i._key(),e)}function resolverPersistence(i){return _getInstance(i._redirectPersistence)}function pendingRedirectKey(i){return _persistenceKeyName(PENDING_REDIRECT_KEY,i.config.apiKey,i.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function signInWithRedirect(i,e,o){return _signInWithRedirect(i,e,o)}async function _signInWithRedirect(i,e,o){const s=_castAuth(i);_assertInstanceOf(i,e,FederatedAuthProvider),await s._initializationPromise;const a=_withDefaultResolver(s,o);return await _setPendingRedirectStatus(a,s),a._openRedirect(s,e,"signInViaRedirect")}function reauthenticateWithRedirect(i,e,o){return _reauthenticateWithRedirect(i,e,o)}async function _reauthenticateWithRedirect(i,e,o){const s=getModularInstance(i);_assertInstanceOf(s.auth,e,FederatedAuthProvider),await s.auth._initializationPromise;const a=_withDefaultResolver(s.auth,o);await _setPendingRedirectStatus(a,s.auth);const c=await prepareUserForRedirect(s);return a._openRedirect(s.auth,e,"reauthViaRedirect",c)}function linkWithRedirect(i,e,o){return _linkWithRedirect(i,e,o)}async function _linkWithRedirect(i,e,o){const s=getModularInstance(i);_assertInstanceOf(s.auth,e,FederatedAuthProvider),await s.auth._initializationPromise;const a=_withDefaultResolver(s.auth,o);await _assertLinkedStatus(!1,s,e.providerId),await _setPendingRedirectStatus(a,s.auth);const c=await prepareUserForRedirect(s);return a._openRedirect(s.auth,e,"linkViaRedirect",c)}async function getRedirectResult(i,e){return await _castAuth(i)._initializationPromise,_getRedirectResult(i,e,!1)}async function _getRedirectResult(i,e,o=!1){const s=_castAuth(i),a=_withDefaultResolver(s,e),d=await new RedirectAction(s,a,o).execute();return d&&!o&&(delete d.user._redirectEventId,await s._persistUserIfCurrent(d.user),await s._setRedirectUser(null,e)),d}async function prepareUserForRedirect(i){const e=_generateEventId(`${i.uid}:::`);return i._redirectEventId=e,await i.auth._setRedirectUser(i),await i.auth._persistUserIfCurrent(i),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EVENT_DUPLICATION_CACHE_DURATION_MS=10*60*1e3;class AuthEventManager{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let o=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(o=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!isRedirectEvent(e)||(this.hasHandledPotentialRedirect=!0,o||(this.queuedRedirectEvent=e,o=!0)),o}sendToConsumer(e,o){var s;if(e.error&&!isNullRedirectEvent(e)){const a=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";o.onError(_createError(this.auth,a))}else o.onAuthEvent(e)}isEventForConsumer(e,o){const s=o.eventId===null||!!e.eventId&&e.eventId===o.eventId;return o.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=EVENT_DUPLICATION_CACHE_DURATION_MS&&this.cachedEventUids.clear(),this.cachedEventUids.has(eventUid(e))}saveEventToCache(e){this.cachedEventUids.add(eventUid(e)),this.lastProcessedEventTime=Date.now()}}function eventUid(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(e=>e).join("-")}function isNullRedirectEvent({type:i,error:e}){return i==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function isRedirectEvent(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return isNullRedirectEvent(i);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _getProjectConfig(i,e={}){return _performApiRequest(i,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IP_ADDRESS_REGEX=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,HTTP_REGEX=/^https?/;async function _validateOrigin$1(i){if(i.config.emulator)return;const{authorizedDomains:e}=await _getProjectConfig(i);for(const o of e)try{if(matchDomain(o))return}catch{}_fail(i,"unauthorized-domain")}function matchDomain(i){const e=_getCurrentUrl(),{protocol:o,hostname:s}=new URL(e);if(i.startsWith("chrome-extension://")){const d=new URL(i);return d.hostname===""&&s===""?o==="chrome-extension:"&&i.replace("chrome-extension://","")===e.replace("chrome-extension://",""):o==="chrome-extension:"&&d.hostname===s}if(!HTTP_REGEX.test(o))return!1;if(IP_ADDRESS_REGEX.test(i))return s===i;const a=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NETWORK_TIMEOUT=new Delay(3e4,6e4);function resetUnloadedGapiModules(){const i=_window().___jsl;if(i!=null&&i.H){for(const e of Object.keys(i.H))if(i.H[e].r=i.H[e].r||[],i.H[e].L=i.H[e].L||[],i.H[e].r=[...i.H[e].L],i.CP)for(let o=0;o<i.CP.length;o++)i.CP[o]=null}}function loadGapi(i){return new Promise((e,o)=>{var s,a,c;function d(){resetUnloadedGapiModules(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{resetUnloadedGapiModules(),o(_createError(i,"network-request-failed"))},timeout:NETWORK_TIMEOUT.get()})}if(!((a=(s=_window().gapi)===null||s===void 0?void 0:s.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((c=_window().gapi)===null||c===void 0)&&c.load)d();else{const h=_generateCallbackName("iframefcb");return _window()[h]=()=>{gapi.load?d():o(_createError(i,"network-request-failed"))},_loadJS(`https://apis.google.com/js/api.js?onload=${h}`).catch(g=>o(g))}}).catch(e=>{throw cachedGApiLoader=null,e})}let cachedGApiLoader=null;function _loadGapi(i){return cachedGApiLoader=cachedGApiLoader||loadGapi(i),cachedGApiLoader}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PING_TIMEOUT=new Delay(5e3,15e3),IFRAME_PATH="__/auth/iframe",EMULATED_IFRAME_PATH="emulator/auth/iframe",IFRAME_ATTRIBUTES={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},EID_FROM_APIHOST=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function getIframeUrl(i){const e=i.config;_assert$4(e.authDomain,i,"auth-domain-config-required");const o=e.emulator?_emulatorUrl(e,EMULATED_IFRAME_PATH):`https://${i.config.authDomain}/${IFRAME_PATH}`,s={apiKey:e.apiKey,appName:i.name,v:SDK_VERSION$3},a=EID_FROM_APIHOST.get(i.config.apiHost);a&&(s.eid=a);const c=i._getFrameworks();return c.length&&(s.fw=c.join(",")),`${o}?${querystring(s).slice(1)}`}async function _openIframe(i){const e=await _loadGapi(i),o=_window().gapi;return _assert$4(o,i,"internal-error"),e.open({where:document.body,url:getIframeUrl(i),messageHandlersFilter:o.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:IFRAME_ATTRIBUTES,dontclear:!0},s=>new Promise(async(a,c)=>{await s.restyle({setHideOnLeave:!1});const d=_createError(i,"network-request-failed"),h=_window().setTimeout(()=>{c(d)},PING_TIMEOUT.get());function g(){_window().clearTimeout(h),a(s)}s.ping(g).then(g,()=>{c(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BASE_POPUP_OPTIONS={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},DEFAULT_WIDTH=500,DEFAULT_HEIGHT=600,TARGET_BLANK="_blank",FIREFOX_EMPTY_URL="http://localhost";class AuthPopup{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function _open(i,e,o,s=DEFAULT_WIDTH,a=DEFAULT_HEIGHT){const c=Math.max((window.screen.availHeight-a)/2,0).toString(),d=Math.max((window.screen.availWidth-s)/2,0).toString();let h="";const g=Object.assign(Object.assign({},BASE_POPUP_OPTIONS),{width:s.toString(),height:a.toString(),top:c,left:d}),_=getUA().toLowerCase();o&&(h=_isChromeIOS(_)?TARGET_BLANK:o),_isFirefox(_)&&(e=e||FIREFOX_EMPTY_URL,g.scrollbars="yes");const j=Object.entries(g).reduce(($,[nt,tt])=>`${$}${nt}=${tt},`,"");if(_isIOSStandalone(_)&&h!=="_self")return openAsNewWindowIOS(e||"",h),new AuthPopup(null);const b=window.open(e||"",h,j);_assert$4(b,i,"popup-blocked");try{b.focus()}catch{}return new AuthPopup(b)}function openAsNewWindowIOS(i,e){const o=document.createElement("a");o.href=i,o.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),o.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WIDGET_PATH="__/auth/handler",EMULATOR_WIDGET_PATH="emulator/auth/handler",FIREBASE_APP_CHECK_FRAGMENT_ID=encodeURIComponent("fac");async function _getRedirectUrl(i,e,o,s,a,c){_assert$4(i.config.authDomain,i,"auth-domain-config-required"),_assert$4(i.config.apiKey,i,"invalid-api-key");const d={apiKey:i.config.apiKey,appName:i.name,authType:o,redirectUrl:s,v:SDK_VERSION$3,eventId:a};if(e instanceof FederatedAuthProvider){e.setDefaultLanguage(i.languageCode),d.providerId=e.providerId||"",isEmpty(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[j,b]of Object.entries(c||{}))d[j]=b}if(e instanceof BaseOAuthProvider){const j=e.getScopes().filter(b=>b!=="");j.length>0&&(d.scopes=j.join(","))}i.tenantId&&(d.tid=i.tenantId);const h=d;for(const j of Object.keys(h))h[j]===void 0&&delete h[j];const g=await i._getAppCheckToken(),_=g?`#${FIREBASE_APP_CHECK_FRAGMENT_ID}=${encodeURIComponent(g)}`:"";return`${getHandlerBase(i)}?${querystring(h).slice(1)}${_}`}function getHandlerBase({config:i}){return i.emulator?_emulatorUrl(i,EMULATOR_WIDGET_PATH):`https://${i.authDomain}/${WIDGET_PATH}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WEB_STORAGE_SUPPORT_KEY="webStorageSupport";class BrowserPopupRedirectResolver{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=browserSessionPersistence,this._completeRedirectFn=_getRedirectResult,this._overrideRedirectResult=_overrideRedirectResult}async _openPopup(e,o,s,a){var c;debugAssert((c=this.eventManagers[e._key()])===null||c===void 0?void 0:c.manager,"_initialize() not called before _openPopup()");const d=await _getRedirectUrl(e,o,s,_getCurrentUrl(),a);return _open(e,d,_generateEventId())}async _openRedirect(e,o,s,a){await this._originValidation(e);const c=await _getRedirectUrl(e,o,s,_getCurrentUrl(),a);return _setWindowLocation(c),new Promise(()=>{})}_initialize(e){const o=e._key();if(this.eventManagers[o]){const{manager:a,promise:c}=this.eventManagers[o];return a?Promise.resolve(a):(debugAssert(c,"If manager is not set, promise should be"),c)}const s=this.initAndGetManager(e);return this.eventManagers[o]={promise:s},s.catch(()=>{delete this.eventManagers[o]}),s}async initAndGetManager(e){const o=await _openIframe(e),s=new AuthEventManager(e);return o.register("authEvent",a=>(_assert$4(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:s.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=o,s}_isIframeWebStorageSupported(e,o){this.iframes[e._key()].send(WEB_STORAGE_SUPPORT_KEY,{type:WEB_STORAGE_SUPPORT_KEY},a=>{var c;const d=(c=a==null?void 0:a[0])===null||c===void 0?void 0:c[WEB_STORAGE_SUPPORT_KEY];d!==void 0&&o(!!d),_fail(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const o=e._key();return this.originValidationPromises[o]||(this.originValidationPromises[o]=_validateOrigin$1(e)),this.originValidationPromises[o]}get _shouldInitProactively(){return _isMobileBrowser()||_isSafari()||_isIOS()}}const browserPopupRedirectResolver=BrowserPopupRedirectResolver;class MultiFactorAssertionImpl{constructor(e){this.factorId=e}_process(e,o,s){switch(o.type){case"enroll":return this._finalizeEnroll(e,o.credential,s);case"signin":return this._finalizeSignIn(e,o.credential);default:return debugFail("unexpected MultiFactorSessionType")}}}class PhoneMultiFactorAssertionImpl extends MultiFactorAssertionImpl{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new PhoneMultiFactorAssertionImpl(e)}_finalizeEnroll(e,o,s){return finalizeEnrollPhoneMfa(e,{idToken:o,displayName:s,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,o){return finalizeSignInPhoneMfa(e,{mfaPendingCredential:o,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class PhoneMultiFactorGenerator{constructor(){}static assertion(e){return PhoneMultiFactorAssertionImpl._fromCredential(e)}}PhoneMultiFactorGenerator.FACTOR_ID="phone";var name$5="@firebase/auth",version$5="0.23.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthInterop{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const o=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,o),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const o=this.internalListeners.get(e);o&&(this.internalListeners.delete(e),o(),this.updateProactiveRefresh())}assertAuthConfigured(){_assert$4(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getVersionForPlatform(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function registerAuth(i){_registerComponent(new Component("auth",(e,{options:o})=>{const s=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:d,authDomain:h}=s.options;_assert$4(d&&!d.includes(":"),"invalid-api-key",{appName:s.name});const g={apiKey:d,authDomain:h,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_getClientVersion(i)},_=new AuthImpl(s,a,c,g);return _initializeAuthInstance(_,o),_},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,o,s)=>{e.getProvider("auth-internal").initialize()})),_registerComponent(new Component("auth-internal",e=>{const o=_castAuth(e.getProvider("auth").getImmediate());return(s=>new AuthInterop(s))(o)},"PRIVATE").setInstantiationMode("EXPLICIT")),registerVersion(name$5,version$5,getVersionForPlatform(i)),registerVersion(name$5,version$5,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ID_TOKEN_MAX_AGE=5*60;getExperimentalSetting("authIdTokenMaxAge");registerAuth("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _cordovaWindow(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const REDIRECT_TIMEOUT_MS=2e3;async function _generateHandlerUrl(i,e,o){var s;const{BuildInfo:a}=_cordovaWindow();debugAssert(e.sessionId,"AuthEvent did not contain a session ID");const c=await computeSha256(e.sessionId),d={};return _isIOS()?d.ibi=a.packageName:_isAndroid()?d.apn=a.packageName:_fail(i,"operation-not-supported-in-this-environment"),a.displayName&&(d.appDisplayName=a.displayName),d.sessionId=c,_getRedirectUrl(i,o,e.type,void 0,(s=e.eventId)!==null&&s!==void 0?s:void 0,d)}async function _validateOrigin(i){const{BuildInfo:e}=_cordovaWindow(),o={};_isIOS()?o.iosBundleId=e.packageName:_isAndroid()?o.androidPackageName=e.packageName:_fail(i,"operation-not-supported-in-this-environment"),await _getProjectConfig(i,o)}function _performRedirect(i){const{cordova:e}=_cordovaWindow();return new Promise(o=>{e.plugins.browsertab.isAvailable(s=>{let a=null;s?e.plugins.browsertab.openUrl(i):a=e.InAppBrowser.open(i,_isIOS7Or8()?"_blank":"_system","location=yes"),o(a)})})}async function _waitForAppResume(i,e,o){const{cordova:s}=_cordovaWindow();let a=()=>{};try{await new Promise((c,d)=>{let h=null;function g(){var b;c();const $=(b=s.plugins.browsertab)===null||b===void 0?void 0:b.close;typeof $=="function"&&$(),typeof(o==null?void 0:o.close)=="function"&&o.close()}function _(){h||(h=window.setTimeout(()=>{d(_createError(i,"redirect-cancelled-by-user"))},REDIRECT_TIMEOUT_MS))}function j(){(document==null?void 0:document.visibilityState)==="visible"&&_()}e.addPassiveListener(g),document.addEventListener("resume",_,!1),_isAndroid()&&document.addEventListener("visibilitychange",j,!1),a=()=>{e.removePassiveListener(g),document.removeEventListener("resume",_,!1),document.removeEventListener("visibilitychange",j,!1),h&&window.clearTimeout(h)}})}finally{a()}}function _checkCordovaConfiguration(i){var e,o,s,a,c,d,h,g,_,j;const b=_cordovaWindow();_assert$4(typeof((e=b==null?void 0:b.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",i,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),_assert$4(typeof((o=b==null?void 0:b.BuildInfo)===null||o===void 0?void 0:o.packageName)<"u",i,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),_assert$4(typeof((c=(a=(s=b==null?void 0:b.cordova)===null||s===void 0?void 0:s.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.openUrl)=="function",i,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),_assert$4(typeof((g=(h=(d=b==null?void 0:b.cordova)===null||d===void 0?void 0:d.plugins)===null||h===void 0?void 0:h.browsertab)===null||g===void 0?void 0:g.isAvailable)=="function",i,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),_assert$4(typeof((j=(_=b==null?void 0:b.cordova)===null||_===void 0?void 0:_.InAppBrowser)===null||j===void 0?void 0:j.open)=="function",i,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function computeSha256(i){const e=stringToArrayBuffer(i),o=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(o)).map(a=>a.toString(16).padStart(2,"0")).join("")}function stringToArrayBuffer(i){if(debugAssert(/[0-9a-zA-Z]+/.test(i),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(i);const e=new ArrayBuffer(i.length),o=new Uint8Array(e);for(let s=0;s<i.length;s++)o[s]=i.charCodeAt(s);return o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SESSION_ID_LENGTH=20;class CordovaAuthEventManager extends AuthEventManager{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(o=>o(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function _generateNewEvent(i,e,o=null){return{type:e,eventId:o,urlResponse:null,sessionId:generateSessionId(),postBody:null,tenantId:i.tenantId,error:_createError(i,"no-auth-event")}}function _savePartialEvent(i,e){return storage()._set(persistenceKey(i),e)}async function _getAndRemoveEvent(i){const e=await storage()._get(persistenceKey(i));return e&&await storage()._remove(persistenceKey(i)),e}function _eventFromPartialAndUrl(i,e){var o,s;const a=_getDeepLinkFromCallback(e);if(a.includes("/__/auth/callback")){const c=searchParamsOrEmpty(a),d=c.firebaseError?parseJsonOrNull(decodeURIComponent(c.firebaseError)):null,h=(s=(o=d==null?void 0:d.code)===null||o===void 0?void 0:o.split("auth/"))===null||s===void 0?void 0:s[1],g=h?_createError(h):null;return g?{type:i.type,eventId:i.eventId,tenantId:i.tenantId,error:g,urlResponse:null,sessionId:null,postBody:null}:{type:i.type,eventId:i.eventId,tenantId:i.tenantId,sessionId:i.sessionId,urlResponse:a,postBody:null}}return null}function generateSessionId(){const i=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let o=0;o<SESSION_ID_LENGTH;o++){const s=Math.floor(Math.random()*e.length);i.push(e.charAt(s))}return i.join("")}function storage(){return _getInstance(browserLocalPersistence)}function persistenceKey(i){return _persistenceKeyName("authEvent",i.config.apiKey,i.name)}function parseJsonOrNull(i){try{return JSON.parse(i)}catch{return null}}function _getDeepLinkFromCallback(i){const e=searchParamsOrEmpty(i),o=e.link?decodeURIComponent(e.link):void 0,s=searchParamsOrEmpty(o).link,a=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return searchParamsOrEmpty(a).link||a||s||o||i}function searchParamsOrEmpty(i){if(!(i!=null&&i.includes("?")))return{};const[e,...o]=i.split("?");return querystringDecode(o.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const INITIAL_EVENT_TIMEOUT_MS=500;class CordovaPopupRedirectResolver{constructor(){this._redirectPersistence=browserSessionPersistence,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=_getRedirectResult,this._overrideRedirectResult=_overrideRedirectResult}async _initialize(e){const o=e._key();let s=this.eventManagers.get(o);return s||(s=new CordovaAuthEventManager(e),this.eventManagers.set(o,s),this.attachCallbackListeners(e,s)),s}_openPopup(e){_fail(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,o,s,a){_checkCordovaConfiguration(e);const c=await this._initialize(e);await c.initialized(),c.resetRedirect(),_clearRedirectOutcomes(),await this._originValidation(e);const d=_generateNewEvent(e,s,a);await _savePartialEvent(e,d);const h=await _generateHandlerUrl(e,d,o),g=await _performRedirect(h);return _waitForAppResume(e,c,g)}_isIframeWebStorageSupported(e,o){throw new Error("Method not implemented.")}_originValidation(e){const o=e._key();return this.originValidationPromises[o]||(this.originValidationPromises[o]=_validateOrigin(e)),this.originValidationPromises[o]}attachCallbackListeners(e,o){const{universalLinks:s,handleOpenURL:a,BuildInfo:c}=_cordovaWindow(),d=setTimeout(async()=>{await _getAndRemoveEvent(e),o.onEvent(generateNoEvent())},INITIAL_EVENT_TIMEOUT_MS),h=async j=>{clearTimeout(d);const b=await _getAndRemoveEvent(e);let $=null;b&&(j!=null&&j.url)&&($=_eventFromPartialAndUrl(b,j.url)),o.onEvent($||generateNoEvent())};typeof s<"u"&&typeof s.subscribe=="function"&&s.subscribe(null,h);const g=a,_=`${c.packageName.toLowerCase()}://`;_cordovaWindow().handleOpenURL=async j=>{if(j.toLowerCase().startsWith(_)&&h({url:j}),typeof g=="function")try{g(j)}catch(b){console.error(b)}}}}const cordovaPopupRedirectResolver=CordovaPopupRedirectResolver;function generateNoEvent(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:_createError("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function addFrameworkForLogging(i,e){_castAuth(i)._logFramework(e)}var name$4="@firebase/auth-compat",version$4="0.4.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CORDOVA_ONDEVICEREADY_TIMEOUT_MS=1e3;function _getCurrentScheme(){var i;return((i=self==null?void 0:self.location)===null||i===void 0?void 0:i.protocol)||null}function _isHttpOrHttps(){return _getCurrentScheme()==="http:"||_getCurrentScheme()==="https:"}function _isAndroidOrIosCordovaScheme(i=getUA()){return!!((_getCurrentScheme()==="file:"||_getCurrentScheme()==="ionic:"||_getCurrentScheme()==="capacitor:")&&i.toLowerCase().match(/iphone|ipad|ipod|android/))}function _isNativeEnvironment(){return isReactNative$1()||isNode()}function _isIe11(){return isIE()&&(document==null?void 0:document.documentMode)===11}function _isEdge(i=getUA()){return/Edge\/\d+/.test(i)}function _isLocalStorageNotSynchronized(i=getUA()){return _isIe11()||_isEdge(i)}function _isWebStorageSupported(){try{const i=self.localStorage,e=_generateEventId();if(i)return i.setItem(e,"1"),i.removeItem(e),_isLocalStorageNotSynchronized()?isIndexedDBAvailable():!0}catch{return _isWorker()&&isIndexedDBAvailable()}return!1}function _isWorker(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function _isPopupRedirectSupported(){return(_isHttpOrHttps()||isBrowserExtension()||_isAndroidOrIosCordovaScheme())&&!_isNativeEnvironment()&&_isWebStorageSupported()&&!_isWorker()}function _isLikelyCordova(){return _isAndroidOrIosCordovaScheme()&&typeof document<"u"}async function _isCordova(){return _isLikelyCordova()?new Promise(i=>{const e=setTimeout(()=>{i(!1)},CORDOVA_ONDEVICEREADY_TIMEOUT_MS);document.addEventListener("deviceready",()=>{clearTimeout(e),i(!0)})}):!1}function _getSelfWindow(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Persistence={LOCAL:"local",NONE:"none",SESSION:"session"},_assert$3=_assert$4,PERSISTENCE_KEY="persistence";function _validatePersistenceArgument(i,e){if(_assert$3(Object.values(Persistence).includes(e),i,"invalid-persistence-type"),isReactNative$1()){_assert$3(e!==Persistence.SESSION,i,"unsupported-persistence-type");return}if(isNode()){_assert$3(e===Persistence.NONE,i,"unsupported-persistence-type");return}if(_isWorker()){_assert$3(e===Persistence.NONE||e===Persistence.LOCAL&&isIndexedDBAvailable(),i,"unsupported-persistence-type");return}_assert$3(e===Persistence.NONE||_isWebStorageSupported(),i,"unsupported-persistence-type")}async function _savePersistenceForRedirect(i){await i._initializationPromise;const e=getSessionStorageIfAvailable(),o=_persistenceKeyName(PERSISTENCE_KEY,i.config.apiKey,i.name);e&&e.setItem(o,i._getPersistence())}function _getPersistencesFromRedirect(i,e){const o=getSessionStorageIfAvailable();if(!o)return[];const s=_persistenceKeyName(PERSISTENCE_KEY,i,e);switch(o.getItem(s)){case Persistence.NONE:return[inMemoryPersistence];case Persistence.LOCAL:return[indexedDBLocalPersistence,browserSessionPersistence];case Persistence.SESSION:return[browserSessionPersistence];default:return[]}}function getSessionStorageIfAvailable(){var i;try{return((i=_getSelfWindow())===null||i===void 0?void 0:i.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _assert$2=_assert$4;class CompatPopupRedirectResolver{constructor(){this.browserResolver=_getInstance(browserPopupRedirectResolver),this.cordovaResolver=_getInstance(cordovaPopupRedirectResolver),this.underlyingResolver=null,this._redirectPersistence=browserSessionPersistence,this._completeRedirectFn=_getRedirectResult,this._overrideRedirectResult=_overrideRedirectResult}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,o,s,a){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,o,s,a)}async _openRedirect(e,o,s,a){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,o,s,a)}_isIframeWebStorageSupported(e,o){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,o)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return _isLikelyCordova()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return _assert$2(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await _isCordova();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function unwrap(i){return i.unwrap()}function wrapped(i){return i.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function credentialFromResponse(i){return credentialFromObject(i)}function attachExtraErrorFields(i,e){var o;const s=(o=e.customData)===null||o===void 0?void 0:o._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const a=e;a.resolver=new MultiFactorResolver(i,getMultiFactorResolver(i,e))}else if(s){const a=credentialFromObject(e),c=e;a&&(c.credential=a,c.tenantId=s.tenantId||void 0,c.email=s.email||void 0,c.phoneNumber=s.phoneNumber||void 0)}}function credentialFromObject(i){const{_tokenResponse:e}=i instanceof FirebaseError?i.customData:i;if(!e)return null;if(!(i instanceof FirebaseError)&&"temporaryProof"in e&&"phoneNumber"in e)return PhoneAuthProvider$1.credentialFromResult(i);const o=e.providerId;if(!o||o===ProviderId.PASSWORD)return null;let s;switch(o){case ProviderId.GOOGLE:s=GoogleAuthProvider;break;case ProviderId.FACEBOOK:s=FacebookAuthProvider;break;case ProviderId.GITHUB:s=GithubAuthProvider;break;case ProviderId.TWITTER:s=TwitterAuthProvider;break;default:const{oauthIdToken:a,oauthAccessToken:c,oauthTokenSecret:d,pendingToken:h,nonce:g}=e;return!c&&!d&&!a&&!h?null:h?o.startsWith("saml.")?SAMLAuthCredential._create(o,h):OAuthCredential._fromParams({providerId:o,signInMethod:o,pendingToken:h,idToken:a,accessToken:c}):new OAuthProvider(o).credential({idToken:a,accessToken:c,rawNonce:g})}return i instanceof FirebaseError?s.credentialFromError(i):s.credentialFromResult(i)}function convertCredential(i,e){return e.catch(o=>{throw o instanceof FirebaseError&&attachExtraErrorFields(i,o),o}).then(o=>{const s=o.operationType,a=o.user;return{operationType:s,credential:credentialFromResponse(o),additionalUserInfo:getAdditionalUserInfo(o),user:User.getOrCreate(a)}})}async function convertConfirmationResult(i,e){const o=await e;return{verificationId:o.verificationId,confirm:s=>convertCredential(i,o.confirm(s))}}class MultiFactorResolver{constructor(e,o){this.resolver=o,this.auth=wrapped(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return convertCredential(unwrap(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class User{constructor(e){this._delegate=e,this.multiFactor=multiFactor(e)}static getOrCreate(e){return User.USER_MAP.has(e)||User.USER_MAP.set(e,new User(e)),User.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return convertCredential(this.auth,linkWithCredential(this._delegate,e))}async linkWithPhoneNumber(e,o){return convertConfirmationResult(this.auth,linkWithPhoneNumber(this._delegate,e,o))}async linkWithPopup(e){return convertCredential(this.auth,linkWithPopup(this._delegate,e,CompatPopupRedirectResolver))}async linkWithRedirect(e){return await _savePersistenceForRedirect(_castAuth(this.auth)),linkWithRedirect(this._delegate,e,CompatPopupRedirectResolver)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return convertCredential(this.auth,reauthenticateWithCredential(this._delegate,e))}reauthenticateWithPhoneNumber(e,o){return convertConfirmationResult(this.auth,reauthenticateWithPhoneNumber(this._delegate,e,o))}reauthenticateWithPopup(e){return convertCredential(this.auth,reauthenticateWithPopup(this._delegate,e,CompatPopupRedirectResolver))}async reauthenticateWithRedirect(e){return await _savePersistenceForRedirect(_castAuth(this.auth)),reauthenticateWithRedirect(this._delegate,e,CompatPopupRedirectResolver)}sendEmailVerification(e){return sendEmailVerification(this._delegate,e)}async unlink(e){return await unlink(this._delegate,e),this}updateEmail(e){return updateEmail(this._delegate,e)}updatePassword(e){return updatePassword(this._delegate,e)}updatePhoneNumber(e){return updatePhoneNumber(this._delegate,e)}updateProfile(e){return updateProfile(this._delegate,e)}verifyBeforeUpdateEmail(e,o){return verifyBeforeUpdateEmail(this._delegate,e,o)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}User.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _assert$1=_assert$4;class Auth{constructor(e,o){if(this.app=e,o.isInitialized()){this._delegate=o.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:s}=e.options;_assert$1(s,"invalid-api-key",{appName:e.name}),_assert$1(s,"invalid-api-key",{appName:e.name});const a=typeof window<"u"?CompatPopupRedirectResolver:void 0;this._delegate=o.initialize({options:{persistence:buildPersistenceHierarchy(s,e.name),popupRedirectResolver:a}}),this._delegate._updateErrorMap(debugErrorMap),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?User.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,o){connectAuthEmulator(this._delegate,e,o)}applyActionCode(e){return applyActionCode(this._delegate,e)}checkActionCode(e){return checkActionCode(this._delegate,e)}confirmPasswordReset(e,o){return confirmPasswordReset(this._delegate,e,o)}async createUserWithEmailAndPassword(e,o){return convertCredential(this._delegate,createUserWithEmailAndPassword(this._delegate,e,o))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return fetchSignInMethodsForEmail(this._delegate,e)}isSignInWithEmailLink(e){return isSignInWithEmailLink(this._delegate,e)}async getRedirectResult(){_assert$1(_isPopupRedirectSupported(),this._delegate,"operation-not-supported-in-this-environment");const e=await getRedirectResult(this._delegate,CompatPopupRedirectResolver);return e?convertCredential(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){addFrameworkForLogging(this._delegate,e)}onAuthStateChanged(e,o,s){const{next:a,error:c,complete:d}=wrapObservers(e,o,s);return this._delegate.onAuthStateChanged(a,c,d)}onIdTokenChanged(e,o,s){const{next:a,error:c,complete:d}=wrapObservers(e,o,s);return this._delegate.onIdTokenChanged(a,c,d)}sendSignInLinkToEmail(e,o){return sendSignInLinkToEmail(this._delegate,e,o)}sendPasswordResetEmail(e,o){return sendPasswordResetEmail(this._delegate,e,o||void 0)}async setPersistence(e){_validatePersistenceArgument(this._delegate,e);let o;switch(e){case Persistence.SESSION:o=browserSessionPersistence;break;case Persistence.LOCAL:o=await _getInstance(indexedDBLocalPersistence)._isAvailable()?indexedDBLocalPersistence:browserLocalPersistence;break;case Persistence.NONE:o=inMemoryPersistence;break;default:return _fail("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(o)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return convertCredential(this._delegate,signInAnonymously(this._delegate))}signInWithCredential(e){return convertCredential(this._delegate,signInWithCredential(this._delegate,e))}signInWithCustomToken(e){return convertCredential(this._delegate,signInWithCustomToken(this._delegate,e))}signInWithEmailAndPassword(e,o){return convertCredential(this._delegate,signInWithEmailAndPassword(this._delegate,e,o))}signInWithEmailLink(e,o){return convertCredential(this._delegate,signInWithEmailLink(this._delegate,e,o))}signInWithPhoneNumber(e,o){return convertConfirmationResult(this._delegate,signInWithPhoneNumber(this._delegate,e,o))}async signInWithPopup(e){return _assert$1(_isPopupRedirectSupported(),this._delegate,"operation-not-supported-in-this-environment"),convertCredential(this._delegate,signInWithPopup(this._delegate,e,CompatPopupRedirectResolver))}async signInWithRedirect(e){return _assert$1(_isPopupRedirectSupported(),this._delegate,"operation-not-supported-in-this-environment"),await _savePersistenceForRedirect(this._delegate),signInWithRedirect(this._delegate,e,CompatPopupRedirectResolver)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return verifyPasswordResetCode(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}Auth.Persistence=Persistence;function wrapObservers(i,e,o){let s=i;typeof i!="function"&&({next:s,error:e,complete:o}=i);const a=s;return{next:d=>a(d&&User.getOrCreate(d)),error:e,complete:o}}function buildPersistenceHierarchy(i,e){const o=_getPersistencesFromRedirect(i,e);if(typeof self<"u"&&!o.includes(indexedDBLocalPersistence)&&o.push(indexedDBLocalPersistence),typeof window<"u")for(const s of[browserLocalPersistence,browserSessionPersistence])o.includes(s)||o.push(s);return o.includes(inMemoryPersistence)||o.push(inMemoryPersistence),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PhoneAuthProvider{constructor(){this.providerId="phone",this._delegate=new PhoneAuthProvider$1(unwrap(firebase.auth()))}static credential(e,o){return PhoneAuthProvider$1.credential(e,o)}verifyPhoneNumber(e,o){return this._delegate.verifyPhoneNumber(e,o)}unwrap(){return this._delegate}}PhoneAuthProvider.PHONE_SIGN_IN_METHOD=PhoneAuthProvider$1.PHONE_SIGN_IN_METHOD;PhoneAuthProvider.PROVIDER_ID=PhoneAuthProvider$1.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _assert=_assert$4;class RecaptchaVerifier{constructor(e,o,s=firebase.app()){var a;_assert((a=s.options)===null||a===void 0?void 0:a.apiKey,"invalid-api-key",{appName:s.name}),this._delegate=new RecaptchaVerifier$1(e,o,s.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AUTH_TYPE="auth-compat";function registerAuthCompat(i){i.INTERNAL.registerComponent(new Component(AUTH_TYPE,e=>{const o=e.getProvider("app-compat").getImmediate(),s=e.getProvider("auth");return new Auth(o,s)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:ActionCodeOperation.EMAIL_SIGNIN,PASSWORD_RESET:ActionCodeOperation.PASSWORD_RESET,RECOVER_EMAIL:ActionCodeOperation.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:ActionCodeOperation.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:ActionCodeOperation.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:ActionCodeOperation.VERIFY_EMAIL}},EmailAuthProvider,FacebookAuthProvider,GithubAuthProvider,GoogleAuthProvider,OAuthProvider,SAMLAuthProvider,PhoneAuthProvider,PhoneMultiFactorGenerator,RecaptchaVerifier,TwitterAuthProvider,Auth,AuthCredential,Error:FirebaseError}).setInstantiationMode("LAZY").setMultipleInstances(!1)),i.registerVersion(name$4,version$4)}registerAuthCompat(firebase);const name$3="@firebase/database",version$3="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let SDK_VERSION$2="";function setSDKVersion(i){SDK_VERSION$2=i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DOMStorageWrapper{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,o){o==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),stringify(o))}get(e){const o=this.domStorage_.getItem(this.prefixedName_(e));return o==null?null:jsonEval(o)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MemoryStorage{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,o){o==null?delete this.cache_[e]:this.cache_[e]=o}get(e){return contains(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const createStoragefor=function(i){try{if(typeof window<"u"&&typeof window[i]<"u"){const e=window[i];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new DOMStorageWrapper(e)}}catch{}return new MemoryStorage},PersistentStorage=createStoragefor("localStorage"),SessionStorage=createStoragefor("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logClient$1=new Logger("@firebase/database"),LUIDGenerator=function(){let i=1;return function(){return i++}}(),sha1=function(i){const e=stringToByteArray(i),o=new Sha1;o.update(e);const s=o.digest();return base64.encodeByteArray(s)},buildLogMessage_=function(...i){let e="";for(let o=0;o<i.length;o++){const s=i[o];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=buildLogMessage_.apply(null,s):typeof s=="object"?e+=stringify(s):e+=s,e+=" "}return e};let logger=null,firstLog_=!0;const enableLogging$1=function(i,e){assert(!e||i===!0||i===!1,"Can't turn on custom loggers persistently."),i===!0?(logClient$1.logLevel=LogLevel.VERBOSE,logger=logClient$1.log.bind(logClient$1),e&&SessionStorage.set("logging_enabled",!0)):typeof i=="function"?logger=i:(logger=null,SessionStorage.remove("logging_enabled"))},log=function(...i){if(firstLog_===!0&&(firstLog_=!1,logger===null&&SessionStorage.get("logging_enabled")===!0&&enableLogging$1(!0)),logger){const e=buildLogMessage_.apply(null,i);logger(e)}},logWrapper=function(i){return function(...e){log(i,...e)}},error=function(...i){const e="FIREBASE INTERNAL ERROR: "+buildLogMessage_(...i);logClient$1.error(e)},fatal=function(...i){const e=`FIREBASE FATAL ERROR: ${buildLogMessage_(...i)}`;throw logClient$1.error(e),new Error(e)},warn$1=function(...i){const e="FIREBASE WARNING: "+buildLogMessage_(...i);logClient$1.warn(e)},warnIfPageIsSecure=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&warn$1("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},isInvalidJSONNumber=function(i){return typeof i=="number"&&(i!==i||i===Number.POSITIVE_INFINITY||i===Number.NEGATIVE_INFINITY)},executeWhenDOMReady=function(i){if(document.readyState==="complete")i();else{let e=!1;const o=function(){if(!document.body){setTimeout(o,Math.floor(10));return}e||(e=!0,i())};document.addEventListener?(document.addEventListener("DOMContentLoaded",o,!1),window.addEventListener("load",o,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&o()}),window.attachEvent("onload",o))}},MIN_NAME="[MIN_NAME]",MAX_NAME="[MAX_NAME]",nameCompare=function(i,e){if(i===e)return 0;if(i===MIN_NAME||e===MAX_NAME)return-1;if(e===MIN_NAME||i===MAX_NAME)return 1;{const o=tryParseInt(i),s=tryParseInt(e);return o!==null?s!==null?o-s===0?i.length-e.length:o-s:-1:s!==null?1:i<e?-1:1}},stringCompare=function(i,e){return i===e?0:i<e?-1:1},requireKey=function(i,e){if(e&&i in e)return e[i];throw new Error("Missing required key ("+i+") in object: "+stringify(e))},ObjectToUniqueKey=function(i){if(typeof i!="object"||i===null)return stringify(i);const e=[];for(const s in i)e.push(s);e.sort();let o="{";for(let s=0;s<e.length;s++)s!==0&&(o+=","),o+=stringify(e[s]),o+=":",o+=ObjectToUniqueKey(i[e[s]]);return o+="}",o},splitStringBySize=function(i,e){const o=i.length;if(o<=e)return[i];const s=[];for(let a=0;a<o;a+=e)a+e>o?s.push(i.substring(a,o)):s.push(i.substring(a,a+e));return s};function each(i,e){for(const o in i)i.hasOwnProperty(o)&&e(o,i[o])}const doubleToIEEE754String=function(i){assert(!isInvalidJSONNumber(i),"Invalid JSON number");const e=11,o=52,s=(1<<e-1)-1;let a,c,d,h,g;i===0?(c=0,d=0,a=1/i===-1/0?1:0):(a=i<0,i=Math.abs(i),i>=Math.pow(2,1-s)?(h=Math.min(Math.floor(Math.log(i)/Math.LN2),s),c=h+s,d=Math.round(i*Math.pow(2,o-h)-Math.pow(2,o))):(c=0,d=Math.round(i/Math.pow(2,1-s-o))));const _=[];for(g=o;g;g-=1)_.push(d%2?1:0),d=Math.floor(d/2);for(g=e;g;g-=1)_.push(c%2?1:0),c=Math.floor(c/2);_.push(a?1:0),_.reverse();const j=_.join("");let b="";for(g=0;g<64;g+=8){let $=parseInt(j.substr(g,8),2).toString(16);$.length===1&&($="0"+$),b=b+$}return b.toLowerCase()},isChromeExtensionContentScript=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},isWindowsStoreApp=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function errorForServerCode(i,e){let o="Unknown Error";i==="too_big"?o="The data requested exceeds the maximum size that can be accessed with a single request.":i==="permission_denied"?o="Client doesn't have permission to access the desired data.":i==="unavailable"&&(o="The service is unavailable");const s=new Error(i+" at "+e._path.toString()+": "+o);return s.code=i.toUpperCase(),s}const INTEGER_REGEXP_=new RegExp("^-?(0*)\\d{1,10}$"),INTEGER_32_MIN=-2147483648,INTEGER_32_MAX=2147483647,tryParseInt=function(i){if(INTEGER_REGEXP_.test(i)){const e=Number(i);if(e>=INTEGER_32_MIN&&e<=INTEGER_32_MAX)return e}return null},exceptionGuard=function(i){try{i()}catch(e){setTimeout(()=>{const o=e.stack||"";throw warn$1("Exception was thrown by user callback.",o),e},Math.floor(0))}},beingCrawled=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},setTimeoutNonBlocking=function(i,e){const o=setTimeout(i,e);return typeof o=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(o):typeof o=="object"&&o.unref&&o.unref(),o};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AppCheckTokenProvider{constructor(e,o){this.appName_=e,this.appCheckProvider=o,this.appCheck=o==null?void 0:o.getImmediate({optional:!0}),this.appCheck||o==null||o.get().then(s=>this.appCheck=s)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((o,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(o,s):o(null)},0)})}addTokenChangeListener(e){var o;(o=this.appCheckProvider)===null||o===void 0||o.get().then(s=>s.addTokenListener(e))}notifyForInvalidToken(){warn$1(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FirebaseAuthTokenProvider{constructor(e,o,s){this.appName_=e,this.firebaseOptions_=o,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(a=>this.auth_=a)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(o=>o&&o.code==="auth/token-not-initialized"?(log("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(o)):new Promise((o,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(o,s):o(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(o=>o.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(o=>o.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',warn$1(e)}}class EmulatorTokenProvider{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}EmulatorTokenProvider.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PROTOCOL_VERSION="5",VERSION_PARAM="v",TRANSPORT_SESSION_PARAM="s",REFERER_PARAM="r",FORGE_REF="f",FORGE_DOMAIN_RE=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,LAST_SESSION_PARAM="ls",APPLICATION_ID_PARAM="p",APP_CHECK_TOKEN_PARAM="ac",WEBSOCKET="websocket",LONG_POLLING="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RepoInfo{constructor(e,o,s,a,c=!1,d="",h=!1,g=!1){this.secure=o,this.namespace=s,this.webSocketOnly=a,this.nodeAdmin=c,this.persistenceKey=d,this.includeNamespaceInQueryParams=h,this.isUsingEmulator=g,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=PersistentStorage.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&PersistentStorage.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",o=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${o}`}}function repoInfoNeedsQueryParam(i){return i.host!==i.internalHost||i.isCustomHost()||i.includeNamespaceInQueryParams}function repoInfoConnectionURL(i,e,o){assert(typeof e=="string","typeof type must == string"),assert(typeof o=="object","typeof params must == object");let s;if(e===WEBSOCKET)s=(i.secure?"wss://":"ws://")+i.internalHost+"/.ws?";else if(e===LONG_POLLING)s=(i.secure?"https://":"http://")+i.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);repoInfoNeedsQueryParam(i)&&(o.ns=i.namespace);const a=[];return each(o,(c,d)=>{a.push(c+"="+d)}),s+a.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StatsCollection{constructor(){this.counters_={}}incrementCounter(e,o=1){contains(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=o}get(){return deepCopy(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const collections={},reporters={};function statsManagerGetCollection(i){const e=i.toString();return collections[e]||(collections[e]=new StatsCollection),collections[e]}function statsManagerGetOrCreateReporter(i,e){const o=i.toString();return reporters[o]||(reporters[o]=e()),reporters[o]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PacketReceiver{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,o){this.closeAfterResponse=e,this.onClose=o,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,o){for(this.pendingResponses[e]=o;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let a=0;a<s.length;++a)s[a]&&exceptionGuard(()=>{this.onMessage_(s[a])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FIREBASE_LONGPOLL_START_PARAM="start",FIREBASE_LONGPOLL_CLOSE_COMMAND="close",FIREBASE_LONGPOLL_COMMAND_CB_NAME="pLPCommand",FIREBASE_LONGPOLL_DATA_CB_NAME="pRTLPCB",FIREBASE_LONGPOLL_ID_PARAM="id",FIREBASE_LONGPOLL_PW_PARAM="pw",FIREBASE_LONGPOLL_SERIAL_PARAM="ser",FIREBASE_LONGPOLL_CALLBACK_ID_PARAM="cb",FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM="seg",FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET="ts",FIREBASE_LONGPOLL_DATA_PARAM="d",FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM="dframe",MAX_URL_DATA_SIZE=1870,SEG_HEADER_SIZE=30,MAX_PAYLOAD_SIZE=MAX_URL_DATA_SIZE-SEG_HEADER_SIZE,KEEPALIVE_REQUEST_INTERVAL=25e3,LP_CONNECT_TIMEOUT=3e4;class BrowserPollConnection{constructor(e,o,s,a,c,d,h){this.connId=e,this.repoInfo=o,this.applicationId=s,this.appCheckToken=a,this.authToken=c,this.transportSessionId=d,this.lastSessionId=h,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=logWrapper(e),this.stats_=statsManagerGetCollection(o),this.urlFn=g=>(this.appCheckToken&&(g[APP_CHECK_TOKEN_PARAM]=this.appCheckToken),repoInfoConnectionURL(o,LONG_POLLING,g))}open(e,o){this.curSegmentNum=0,this.onDisconnect_=o,this.myPacketOrderer=new PacketReceiver(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(LP_CONNECT_TIMEOUT)),executeWhenDOMReady(()=>{if(this.isClosed_)return;this.scriptTagHolder=new FirebaseIFrameScriptHolder((...c)=>{const[d,h,g,_,j]=c;if(this.incrementIncomingBytes_(c),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,d===FIREBASE_LONGPOLL_START_PARAM)this.id=h,this.password=g;else if(d===FIREBASE_LONGPOLL_CLOSE_COMMAND)h?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(h,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+d)},(...c)=>{const[d,h]=c;this.incrementIncomingBytes_(c),this.myPacketOrderer.handleResponse(d,h)},()=>{this.onClosed_()},this.urlFn);const s={};s[FIREBASE_LONGPOLL_START_PARAM]="t",s[FIREBASE_LONGPOLL_SERIAL_PARAM]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[FIREBASE_LONGPOLL_CALLBACK_ID_PARAM]=this.scriptTagHolder.uniqueCallbackIdentifier),s[VERSION_PARAM]=PROTOCOL_VERSION,this.transportSessionId&&(s[TRANSPORT_SESSION_PARAM]=this.transportSessionId),this.lastSessionId&&(s[LAST_SESSION_PARAM]=this.lastSessionId),this.applicationId&&(s[APPLICATION_ID_PARAM]=this.applicationId),this.appCheckToken&&(s[APP_CHECK_TOKEN_PARAM]=this.appCheckToken),typeof location<"u"&&location.hostname&&FORGE_DOMAIN_RE.test(location.hostname)&&(s[REFERER_PARAM]=FORGE_REF);const a=this.urlFn(s);this.log_("Connecting via long-poll to "+a),this.scriptTagHolder.addTag(a,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){BrowserPollConnection.forceAllow_=!0}static forceDisallow(){BrowserPollConnection.forceDisallow_=!0}static isAvailable(){return BrowserPollConnection.forceAllow_?!0:!BrowserPollConnection.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!isChromeExtensionContentScript()&&!isWindowsStoreApp()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const o=stringify(e);this.bytesSent+=o.length,this.stats_.incrementCounter("bytes_sent",o.length);const s=base64Encode(o),a=splitStringBySize(s,MAX_PAYLOAD_SIZE);for(let c=0;c<a.length;c++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,a.length,a[c]),this.curSegmentNum++}addDisconnectPingFrame(e,o){this.myDisconnFrame=document.createElement("iframe");const s={};s[FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM]="t",s[FIREBASE_LONGPOLL_ID_PARAM]=e,s[FIREBASE_LONGPOLL_PW_PARAM]=o,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const o=stringify(e).length;this.bytesReceived+=o,this.stats_.incrementCounter("bytes_received",o)}}class FirebaseIFrameScriptHolder{constructor(e,o,s,a){this.onDisconnect=s,this.urlFn=a,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=LUIDGenerator(),window[FIREBASE_LONGPOLL_COMMAND_CB_NAME+this.uniqueCallbackIdentifier]=e,window[FIREBASE_LONGPOLL_DATA_CB_NAME+this.uniqueCallbackIdentifier]=o,this.myIFrame=FirebaseIFrameScriptHolder.createIFrame_();let c="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(c='<script>document.domain="'+document.domain+'";<\/script>');const d="<html><body>"+c+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(d),this.myIFrame.doc.close()}catch(h){log("frame writing exception"),h.stack&&log(h.stack),log(h)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||log("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,o){for(this.myID=e,this.myPW=o,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[FIREBASE_LONGPOLL_ID_PARAM]=this.myID,e[FIREBASE_LONGPOLL_PW_PARAM]=this.myPW,e[FIREBASE_LONGPOLL_SERIAL_PARAM]=this.currentSerial;let o=this.urlFn(e),s="",a=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+SEG_HEADER_SIZE+s.length<=MAX_URL_DATA_SIZE;){const d=this.pendingSegs.shift();s=s+"&"+FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM+a+"="+d.seg+"&"+FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET+a+"="+d.ts+"&"+FIREBASE_LONGPOLL_DATA_PARAM+a+"="+d.d,a++}return o=o+s,this.addLongPollTag_(o,this.currentSerial),!0}else return!1}enqueueSegment(e,o,s){this.pendingSegs.push({seg:e,ts:o,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,o){this.outstandingRequests.add(o);const s=()=>{this.outstandingRequests.delete(o),this.newRequest_()},a=setTimeout(s,Math.floor(KEEPALIVE_REQUEST_INTERVAL)),c=()=>{clearTimeout(a),s()};this.addTag(e,c)}addTag(e,o){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const a=s.readyState;(!a||a==="loaded"||a==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),o())},s.onerror=()=>{log("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WEBSOCKET_MAX_FRAME_SIZE=16384,WEBSOCKET_KEEPALIVE_INTERVAL=45e3;let WebSocketImpl=null;typeof MozWebSocket<"u"?WebSocketImpl=MozWebSocket:typeof WebSocket<"u"&&(WebSocketImpl=WebSocket);class WebSocketConnection{constructor(e,o,s,a,c,d,h){this.connId=e,this.applicationId=s,this.appCheckToken=a,this.authToken=c,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=logWrapper(this.connId),this.stats_=statsManagerGetCollection(o),this.connURL=WebSocketConnection.connectionURL_(o,d,h,a,s),this.nodeAdmin=o.nodeAdmin}static connectionURL_(e,o,s,a,c){const d={};return d[VERSION_PARAM]=PROTOCOL_VERSION,typeof location<"u"&&location.hostname&&FORGE_DOMAIN_RE.test(location.hostname)&&(d[REFERER_PARAM]=FORGE_REF),o&&(d[TRANSPORT_SESSION_PARAM]=o),s&&(d[LAST_SESSION_PARAM]=s),a&&(d[APP_CHECK_TOKEN_PARAM]=a),c&&(d[APPLICATION_ID_PARAM]=c),repoInfoConnectionURL(e,WEBSOCKET,d)}open(e,o){this.onDisconnect=o,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,PersistentStorage.set("previous_websocket_failure",!0);try{let s;isNodeSdk(),this.mySock=new WebSocketImpl(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const a=s.message||s.data;a&&this.log_(a),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const a=s.message||s.data;a&&this.log_(a),this.onClosed_()}}start(){}static forceDisallow(){WebSocketConnection.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const o=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(o);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&WebSocketImpl!==null&&!WebSocketConnection.forceDisallow_}static previouslyFailed(){return PersistentStorage.isInMemoryStorage||PersistentStorage.get("previous_websocket_failure")===!0}markConnectionHealthy(){PersistentStorage.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const o=this.frames.join("");this.frames=null;const s=jsonEval(o);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(assert(this.frames===null,"We already have a frame buffer"),e.length<=6){const o=Number(e);if(!isNaN(o))return this.handleNewFrameCount_(o),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const o=e.data;if(this.bytesReceived+=o.length,this.stats_.incrementCounter("bytes_received",o.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(o);else{const s=this.extractFrameCount_(o);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const o=stringify(e);this.bytesSent+=o.length,this.stats_.incrementCounter("bytes_sent",o.length);const s=splitStringBySize(o,WEBSOCKET_MAX_FRAME_SIZE);s.length>1&&this.sendString_(String(s.length));for(let a=0;a<s.length;a++)this.sendString_(s[a])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(WEBSOCKET_KEEPALIVE_INTERVAL))}sendString_(e){try{this.mySock.send(e)}catch(o){this.log_("Exception thrown from WebSocket.send():",o.message||o.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}WebSocketConnection.responsesRequiredToBeHealthy=2;WebSocketConnection.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TransportManager{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[BrowserPollConnection,WebSocketConnection]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const o=WebSocketConnection&&WebSocketConnection.isAvailable();let s=o&&!WebSocketConnection.previouslyFailed();if(e.webSocketOnly&&(o||warn$1("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[WebSocketConnection];else{const a=this.transports_=[];for(const c of TransportManager.ALL_TRANSPORTS)c&&c.isAvailable()&&a.push(c);TransportManager.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}TransportManager.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UPGRADE_TIMEOUT=6e4,DELAY_BEFORE_SENDING_EXTRA_REQUESTS=5e3,BYTES_SENT_HEALTHY_OVERRIDE=10*1024,BYTES_RECEIVED_HEALTHY_OVERRIDE=100*1024,MESSAGE_TYPE="t",MESSAGE_DATA="d",CONTROL_SHUTDOWN="s",CONTROL_RESET="r",CONTROL_ERROR="e",CONTROL_PONG="o",SWITCH_ACK="a",END_TRANSMISSION="n",PING="p",SERVER_HELLO="h";class Connection{constructor(e,o,s,a,c,d,h,g,_,j){this.id=e,this.repoInfo_=o,this.applicationId_=s,this.appCheckToken_=a,this.authToken_=c,this.onMessage_=d,this.onReady_=h,this.onDisconnect_=g,this.onKill_=_,this.lastSessionId=j,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=logWrapper("c:"+this.id+":"),this.transportManager_=new TransportManager(o),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const o=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(o,s)},Math.floor(0));const a=e.healthyTimeout||0;a>0&&(this.healthyTimeout_=setTimeoutNonBlocking(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>BYTES_RECEIVED_HEALTHY_OVERRIDE?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>BYTES_SENT_HEALTHY_OVERRIDE?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(a)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return o=>{e===this.conn_?this.onConnectionLost_(o):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return o=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(o):e===this.secondaryConn_?this.onSecondaryMessageReceived_(o):this.log_("message on old connection"))}}sendRequest(e){const o={t:"d",d:e};this.sendData_(o)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(MESSAGE_TYPE in e){const o=e[MESSAGE_TYPE];o===SWITCH_ACK?this.upgradeIfSecondaryHealthy_():o===CONTROL_RESET?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):o===CONTROL_PONG&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const o=requireKey("t",e),s=requireKey("d",e);if(o==="c")this.onSecondaryControl_(s);else if(o==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+o)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:PING,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:SWITCH_ACK,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:END_TRANSMISSION,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const o=requireKey("t",e),s=requireKey("d",e);o==="c"?this.onControl_(s):o==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const o=requireKey(MESSAGE_TYPE,e);if(MESSAGE_DATA in e){const s=e[MESSAGE_DATA];if(o===SERVER_HELLO){const a=Object.assign({},s);this.repoInfo_.isUsingEmulator&&(a.h=this.repoInfo_.host),this.onHandshake_(a)}else if(o===END_TRANSMISSION){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let a=0;a<this.pendingDataMessages.length;++a)this.onDataMessage_(this.pendingDataMessages[a]);this.pendingDataMessages=[],this.tryCleanupConnection()}else o===CONTROL_SHUTDOWN?this.onConnectionShutdown_(s):o===CONTROL_RESET?this.onReset_(s):o===CONTROL_ERROR?error("Server Error: "+s):o===CONTROL_PONG?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):error("Unknown control packet command: "+o)}}onHandshake_(e){const o=e.ts,s=e.v,a=e.h;this.sessionId=e.s,this.repoInfo_.host=a,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,o),PROTOCOL_VERSION!==s&&warn$1("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const o=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(o,s),setTimeoutNonBlocking(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(UPGRADE_TIMEOUT))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,o){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(o,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):setTimeoutNonBlocking(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(DELAY_BEFORE_SENDING_EXTRA_REQUESTS))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:PING,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(PersistentStorage.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ServerActions{put(e,o,s,a){}merge(e,o,s,a){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,o,s){}onDisconnectMerge(e,o,s){}onDisconnectCancel(e,o){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EventEmitter{constructor(e){this.allowedEvents_=e,this.listeners_={},assert(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...o){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let a=0;a<s.length;a++)s[a].callback.apply(s[a].context,o)}}on(e,o,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:o,context:s});const a=this.getInitialEvent(e);a&&o.apply(s,a)}off(e,o,s){this.validateEventType_(e);const a=this.listeners_[e]||[];for(let c=0;c<a.length;c++)if(a[c].callback===o&&(!s||s===a[c].context)){a.splice(c,1);return}}validateEventType_(e){assert(this.allowedEvents_.find(o=>o===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OnlineMonitor extends EventEmitter{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!isMobileCordova()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new OnlineMonitor}getInitialEvent(e){return assert(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MAX_PATH_DEPTH=32,MAX_PATH_LENGTH_BYTES=768;class Path{constructor(e,o){if(o===void 0){this.pieces_=e.split("/");let s=0;for(let a=0;a<this.pieces_.length;a++)this.pieces_[a].length>0&&(this.pieces_[s]=this.pieces_[a],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=o}toString(){let e="";for(let o=this.pieceNum_;o<this.pieces_.length;o++)this.pieces_[o]!==""&&(e+="/"+this.pieces_[o]);return e||"/"}}function newEmptyPath(){return new Path("")}function pathGetFront(i){return i.pieceNum_>=i.pieces_.length?null:i.pieces_[i.pieceNum_]}function pathGetLength(i){return i.pieces_.length-i.pieceNum_}function pathPopFront(i){let e=i.pieceNum_;return e<i.pieces_.length&&e++,new Path(i.pieces_,e)}function pathGetBack(i){return i.pieceNum_<i.pieces_.length?i.pieces_[i.pieces_.length-1]:null}function pathToUrlEncodedString(i){let e="";for(let o=i.pieceNum_;o<i.pieces_.length;o++)i.pieces_[o]!==""&&(e+="/"+encodeURIComponent(String(i.pieces_[o])));return e||"/"}function pathSlice(i,e=0){return i.pieces_.slice(i.pieceNum_+e)}function pathParent(i){if(i.pieceNum_>=i.pieces_.length)return null;const e=[];for(let o=i.pieceNum_;o<i.pieces_.length-1;o++)e.push(i.pieces_[o]);return new Path(e,0)}function pathChild(i,e){const o=[];for(let s=i.pieceNum_;s<i.pieces_.length;s++)o.push(i.pieces_[s]);if(e instanceof Path)for(let s=e.pieceNum_;s<e.pieces_.length;s++)o.push(e.pieces_[s]);else{const s=e.split("/");for(let a=0;a<s.length;a++)s[a].length>0&&o.push(s[a])}return new Path(o,0)}function pathIsEmpty(i){return i.pieceNum_>=i.pieces_.length}function newRelativePath(i,e){const o=pathGetFront(i),s=pathGetFront(e);if(o===null)return e;if(o===s)return newRelativePath(pathPopFront(i),pathPopFront(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+i+")")}function pathCompare(i,e){const o=pathSlice(i,0),s=pathSlice(e,0);for(let a=0;a<o.length&&a<s.length;a++){const c=nameCompare(o[a],s[a]);if(c!==0)return c}return o.length===s.length?0:o.length<s.length?-1:1}function pathEquals(i,e){if(pathGetLength(i)!==pathGetLength(e))return!1;for(let o=i.pieceNum_,s=e.pieceNum_;o<=i.pieces_.length;o++,s++)if(i.pieces_[o]!==e.pieces_[s])return!1;return!0}function pathContains(i,e){let o=i.pieceNum_,s=e.pieceNum_;if(pathGetLength(i)>pathGetLength(e))return!1;for(;o<i.pieces_.length;){if(i.pieces_[o]!==e.pieces_[s])return!1;++o,++s}return!0}class ValidationPath{constructor(e,o){this.errorPrefix_=o,this.parts_=pathSlice(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=stringLength(this.parts_[s]);validationPathCheckValid(this)}}function validationPathPush(i,e){i.parts_.length>0&&(i.byteLength_+=1),i.parts_.push(e),i.byteLength_+=stringLength(e),validationPathCheckValid(i)}function validationPathPop(i){const e=i.parts_.pop();i.byteLength_-=stringLength(e),i.parts_.length>0&&(i.byteLength_-=1)}function validationPathCheckValid(i){if(i.byteLength_>MAX_PATH_LENGTH_BYTES)throw new Error(i.errorPrefix_+"has a key path longer than "+MAX_PATH_LENGTH_BYTES+" bytes ("+i.byteLength_+").");if(i.parts_.length>MAX_PATH_DEPTH)throw new Error(i.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+MAX_PATH_DEPTH+") or object contains a cycle "+validationPathToErrorString(i))}function validationPathToErrorString(i){return i.parts_.length===0?"":"in property '"+i.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VisibilityMonitor extends EventEmitter{constructor(){super(["visible"]);let e,o;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(o="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(o="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(o="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(o="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,o&&document.addEventListener(o,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}static getInstance(){return new VisibilityMonitor}getInitialEvent(e){return assert(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RECONNECT_MIN_DELAY=1e3,RECONNECT_MAX_DELAY_DEFAULT=60*5*1e3,RECONNECT_MAX_DELAY_FOR_ADMINS=30*1e3,RECONNECT_DELAY_MULTIPLIER=1.3,RECONNECT_DELAY_RESET_TIMEOUT=3e4,SERVER_KILL_INTERRUPT_REASON="server_kill",INVALID_TOKEN_THRESHOLD=3;class PersistentConnection extends ServerActions{constructor(e,o,s,a,c,d,h,g){if(super(),this.repoInfo_=e,this.applicationId_=o,this.onDataUpdate_=s,this.onConnectStatus_=a,this.onServerInfoUpdate_=c,this.authTokenProvider_=d,this.appCheckTokenProvider_=h,this.authOverride_=g,this.id=PersistentConnection.nextPersistentConnectionId_++,this.log_=logWrapper("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=RECONNECT_MIN_DELAY,this.maxReconnectDelay_=RECONNECT_MAX_DELAY_DEFAULT,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,g&&!isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");VisibilityMonitor.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&OnlineMonitor.getInstance().on("online",this.onOnline_,this)}sendRequest(e,o,s){const a=++this.requestNumber_,c={r:a,a:e,b:o};this.log_(stringify(c)),assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(c),s&&(this.requestCBHash_[a]=s)}get(e){this.initConnection_();const o=new Deferred,a={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:d=>{const h=d.d;d.s==="ok"?o.resolve(h):o.reject(h)}};this.outstandingGets_.push(a),this.outstandingGetCount_++;const c=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(c),o.promise}listen(e,o,s,a){this.initConnection_();const c=e._queryIdentifier,d=e._path.toString();this.log_("Listen called for "+d+" "+c),this.listens.has(d)||this.listens.set(d,new Map),assert(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),assert(!this.listens.get(d).has(c),"listen() called twice for same path/queryId.");const h={onComplete:a,hashFn:o,query:e,tag:s};this.listens.get(d).set(c,h),this.connected_&&this.sendListen_(h)}sendGet_(e){const o=this.outstandingGets_[e];this.sendRequest("g",o.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),o.onComplete&&o.onComplete(s)})}sendListen_(e){const o=e.query,s=o._path.toString(),a=o._queryIdentifier;this.log_("Listen on "+s+" for "+a);const c={p:s},d="q";e.tag&&(c.q=o._queryObject,c.t=e.tag),c.h=e.hashFn(),this.sendRequest(d,c,h=>{const g=h.d,_=h.s;PersistentConnection.warnOnListenWarnings_(g,o),(this.listens.get(s)&&this.listens.get(s).get(a))===e&&(this.log_("listen response",h),_!=="ok"&&this.removeListen_(s,a),e.onComplete&&e.onComplete(_,g))})}static warnOnListenWarnings_(e,o){if(e&&typeof e=="object"&&contains(e,"w")){const s=safeGet(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const a='".indexOn": "'+o._queryParams.getIndex().toString()+'"',c=o._path.toString();warn$1(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${a} at ${c} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||isAdmin(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=RECONNECT_MAX_DELAY_FOR_ADMINS)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,o=isValidFormat(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(o,s,a=>{const c=a.s,d=a.d||"error";this.authToken_===e&&(c==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(c,d))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const o=e.s,s=e.d||"error";o==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(o,s)})}unlisten(e,o){const s=e._path.toString(),a=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+a),assert(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,a)&&this.connected_&&this.sendUnlisten_(s,a,e._queryObject,o)}sendUnlisten_(e,o,s,a){this.log_("Unlisten on "+e+" for "+o);const c={p:e},d="n";a&&(c.q=s,c.t=a),this.sendRequest(d,c)}onDisconnectPut(e,o,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,o,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:o,onComplete:s})}onDisconnectMerge(e,o,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,o,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:o,onComplete:s})}onDisconnectCancel(e,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,o):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:o})}sendOnDisconnect_(e,o,s,a){const c={p:o,d:s};this.log_("onDisconnect "+e,c),this.sendRequest(e,c,d=>{a&&setTimeout(()=>{a(d.s,d.d)},Math.floor(0))})}put(e,o,s,a){this.putInternal("p",e,o,s,a)}merge(e,o,s,a){this.putInternal("m",e,o,s,a)}putInternal(e,o,s,a,c){this.initConnection_();const d={p:o,d:s};c!==void 0&&(d.h=c),this.outstandingPuts_.push({action:e,request:d,onComplete:a}),this.outstandingPutCount_++;const h=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(h):this.log_("Buffering put: "+o)}sendPut_(e){const o=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,a=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(o,s,c=>{this.log_(o+" response",c),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),a&&a(c.s,c.d)})}reportStats(e){if(this.connected_){const o={c:e};this.log_("reportStats",o),this.sendRequest("s",o,s=>{if(s.s!=="ok"){const c=s.d;this.log_("reportStats","Error sending stats: "+c)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+stringify(e));const o=e.r,s=this.requestCBHash_[o];s&&(delete this.requestCBHash_[o],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,o){this.log_("handleServerMessage",e,o),e==="d"?this.onDataUpdate_(o.p,o.d,!1,o.t):e==="m"?this.onDataUpdate_(o.p,o.d,!0,o.t):e==="c"?this.onListenRevoked_(o.p,o.q):e==="ac"?this.onAuthRevoked_(o.s,o.d):e==="apc"?this.onAppCheckRevoked_(o.s,o.d):e==="sd"?this.onSecurityDebugPacket_(o):error("Unrecognized action received from server: "+stringify(e)+`
Are you using the latest client?`)}onReady_(e,o){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=o,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>RECONNECT_DELAY_RESET_TIMEOUT&&(this.reconnectDelay_=RECONNECT_MIN_DELAY),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let o=Math.max(0,this.reconnectDelay_-e);o=Math.random()*o,this.log_("Trying to reconnect in "+o+"ms"),this.scheduleConnect_(o),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*RECONNECT_DELAY_MULTIPLIER)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),o=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),a=this.id+":"+PersistentConnection.nextConnectionId_++,c=this.lastSessionId;let d=!1,h=null;const g=function(){h?h.close():(d=!0,s())},_=function(b){assert(h,"sendRequest call when we're not connected not allowed."),h.sendRequest(b)};this.realtime_={close:g,sendRequest:_};const j=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[b,$]=await Promise.all([this.authTokenProvider_.getToken(j),this.appCheckTokenProvider_.getToken(j)]);d?log("getToken() completed but was canceled"):(log("getToken() completed. Creating connection."),this.authToken_=b&&b.accessToken,this.appCheckToken_=$&&$.token,h=new Connection(a,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,o,s,nt=>{warn$1(nt+" ("+this.repoInfo_.toString()+")"),this.interrupt(SERVER_KILL_INTERRUPT_REASON)},c))}catch(b){this.log_("Failed to get token: "+b),d||(this.repoInfo_.nodeAdmin&&warn$1(b),g())}}}interrupt(e){log("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){log("Resuming connection for reason: "+e),delete this.interruptReasons_[e],isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const o=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:o})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const o=this.outstandingPuts_[e];o&&"h"in o.request&&o.queued&&(o.onComplete&&o.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,o){let s;o?s=o.map(c=>ObjectToUniqueKey(c)).join("$"):s="default";const a=this.removeListen_(e,s);a&&a.onComplete&&a.onComplete("permission_denied")}removeListen_(e,o){const s=new Path(e).toString();let a;if(this.listens.has(s)){const c=this.listens.get(s);a=c.get(o),c.delete(o),c.size===0&&this.listens.delete(s)}else a=void 0;return a}onAuthRevoked_(e,o){log("Auth token revoked: "+e+"/"+o),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=INVALID_TOKEN_THRESHOLD&&(this.reconnectDelay_=RECONNECT_MAX_DELAY_FOR_ADMINS,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,o){log("App check token revoked: "+e+"/"+o),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=INVALID_TOKEN_THRESHOLD&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const o of e.values())this.sendListen_(o);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let o="js";e["sdk."+o+"."+SDK_VERSION$2.replace(/\./g,"-")]=1,isMobileCordova()?e["framework.cordova"]=1:isReactNative$1()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=OnlineMonitor.getInstance().currentlyOnline();return isEmpty(this.interruptReasons_)&&e}}PersistentConnection.nextPersistentConnectionId_=0;PersistentConnection.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NamedNode{constructor(e,o){this.name=e,this.node=o}static Wrap(e,o){return new NamedNode(e,o)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Index{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,o){const s=new NamedNode(MIN_NAME,e),a=new NamedNode(MIN_NAME,o);return this.compare(s,a)!==0}minPost(){return NamedNode.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __EMPTY_NODE;class KeyIndex extends Index{static get __EMPTY_NODE(){return __EMPTY_NODE}static set __EMPTY_NODE(e){__EMPTY_NODE=e}compare(e,o){return nameCompare(e.name,o.name)}isDefinedOn(e){throw assertionError("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,o){return!1}minPost(){return NamedNode.MIN}maxPost(){return new NamedNode(MAX_NAME,__EMPTY_NODE)}makePost(e,o){return assert(typeof e=="string","KeyIndex indexValue must always be a string."),new NamedNode(e,__EMPTY_NODE)}toString(){return".key"}}const KEY_INDEX=new KeyIndex;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SortedMapIterator{constructor(e,o,s,a,c=null){this.isReverse_=a,this.resultGenerator_=c,this.nodeStack_=[];let d=1;for(;!e.isEmpty();)if(e=e,d=o?s(e.key,o):1,a&&(d*=-1),d<0)this.isReverse_?e=e.left:e=e.right;else if(d===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),o;if(this.resultGenerator_?o=this.resultGenerator_(e.key,e.value):o={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return o}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class LLRBNode{constructor(e,o,s,a,c){this.key=e,this.value=o,this.color=s??LLRBNode.RED,this.left=a??SortedMap.EMPTY_NODE,this.right=c??SortedMap.EMPTY_NODE}copy(e,o,s,a,c){return new LLRBNode(e??this.key,o??this.value,s??this.color,a??this.left,c??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,o,s){let a=this;const c=s(e,a.key);return c<0?a=a.copy(null,null,null,a.left.insert(e,o,s),null):c===0?a=a.copy(null,o,null,null,null):a=a.copy(null,null,null,null,a.right.insert(e,o,s)),a.fixUp_()}removeMin_(){if(this.left.isEmpty())return SortedMap.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,o){let s,a;if(s=this,o(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,o),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),o(e,s.key)===0){if(s.right.isEmpty())return SortedMap.EMPTY_NODE;a=s.right.min_(),s=s.copy(a.key,a.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,o))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),o=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,o)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}LLRBNode.RED=!0;LLRBNode.BLACK=!1;class LLRBEmptyNode{copy(e,o,s,a,c){return this}insert(e,o,s){return new LLRBNode(e,o,null)}remove(e,o){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class SortedMap{constructor(e,o=SortedMap.EMPTY_NODE){this.comparator_=e,this.root_=o}insert(e,o){return new SortedMap(this.comparator_,this.root_.insert(e,o,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))}remove(e){return new SortedMap(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))}get(e){let o,s=this.root_;for(;!s.isEmpty();){if(o=this.comparator_(e,s.key),o===0)return s.value;o<0?s=s.left:o>0&&(s=s.right)}return null}getPredecessorKey(e){let o,s=this.root_,a=null;for(;!s.isEmpty();)if(o=this.comparator_(e,s.key),o===0){if(s.left.isEmpty())return a?a.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else o<0?s=s.left:o>0&&(a=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new SortedMapIterator(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,o){return new SortedMapIterator(this.root_,e,this.comparator_,!1,o)}getReverseIteratorFrom(e,o){return new SortedMapIterator(this.root_,e,this.comparator_,!0,o)}getReverseIterator(e){return new SortedMapIterator(this.root_,null,this.comparator_,!0,e)}}SortedMap.EMPTY_NODE=new LLRBEmptyNode;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NAME_ONLY_COMPARATOR(i,e){return nameCompare(i.name,e.name)}function NAME_COMPARATOR(i,e){return nameCompare(i,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let MAX_NODE$2;function setMaxNode$1(i){MAX_NODE$2=i}const priorityHashText=function(i){return typeof i=="number"?"number:"+doubleToIEEE754String(i):"string:"+i},validatePriorityNode=function(i){if(i.isLeafNode()){const e=i.val();assert(typeof e=="string"||typeof e=="number"||typeof e=="object"&&contains(e,".sv"),"Priority must be a string or number.")}else assert(i===MAX_NODE$2||i.isEmpty(),"priority of unexpected type.");assert(i===MAX_NODE$2||i.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __childrenNodeConstructor;class LeafNode{constructor(e,o=LeafNode.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=o,this.lazyHash_=null,assert(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),validatePriorityNode(this.priorityNode_)}static set __childrenNodeConstructor(e){__childrenNodeConstructor=e}static get __childrenNodeConstructor(){return __childrenNodeConstructor}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new LeafNode(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:LeafNode.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return pathIsEmpty(e)?this:pathGetFront(e)===".priority"?this.priorityNode_:LeafNode.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,o){return null}updateImmediateChild(e,o){return e===".priority"?this.updatePriority(o):o.isEmpty()&&e!==".priority"?this:LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,o).updatePriority(this.priorityNode_)}updateChild(e,o){const s=pathGetFront(e);return s===null?o:o.isEmpty()&&s!==".priority"?this:(assert(s!==".priority"||pathGetLength(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateChild(pathPopFront(e),o)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,o){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+priorityHashText(this.priorityNode_.val())+":");const o=typeof this.value_;e+=o+":",o==="number"?e+=doubleToIEEE754String(this.value_):e+=this.value_,this.lazyHash_=sha1(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===LeafNode.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof LeafNode.__childrenNodeConstructor?-1:(assert(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const o=typeof e.value_,s=typeof this.value_,a=LeafNode.VALUE_TYPE_ORDER.indexOf(o),c=LeafNode.VALUE_TYPE_ORDER.indexOf(s);return assert(a>=0,"Unknown leaf type: "+o),assert(c>=0,"Unknown leaf type: "+s),a===c?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:c-a}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const o=e;return this.value_===o.value_&&this.priorityNode_.equals(o.priorityNode_)}else return!1}}LeafNode.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nodeFromJSON$1,MAX_NODE$1;function setNodeFromJSON(i){nodeFromJSON$1=i}function setMaxNode(i){MAX_NODE$1=i}class PriorityIndex extends Index{compare(e,o){const s=e.node.getPriority(),a=o.node.getPriority(),c=s.compareTo(a);return c===0?nameCompare(e.name,o.name):c}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,o){return!e.getPriority().equals(o.getPriority())}minPost(){return NamedNode.MIN}maxPost(){return new NamedNode(MAX_NAME,new LeafNode("[PRIORITY-POST]",MAX_NODE$1))}makePost(e,o){const s=nodeFromJSON$1(e);return new NamedNode(o,new LeafNode("[PRIORITY-POST]",s))}toString(){return".priority"}}const PRIORITY_INDEX=new PriorityIndex;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LOG_2=Math.log(2);class Base12Num{constructor(e){const o=c=>parseInt(Math.log(c)/LOG_2,10),s=c=>parseInt(Array(c+1).join("1"),2);this.count=o(e+1),this.current_=this.count-1;const a=s(this.count);this.bits_=e+1&a}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const buildChildSet=function(i,e,o,s){i.sort(e);const a=function(g,_){const j=_-g;let b,$;if(j===0)return null;if(j===1)return b=i[g],$=o?o(b):b,new LLRBNode($,b.node,LLRBNode.BLACK,null,null);{const nt=parseInt(j/2,10)+g,tt=a(g,nt),it=a(nt+1,_);return b=i[nt],$=o?o(b):b,new LLRBNode($,b.node,LLRBNode.BLACK,tt,it)}},c=function(g){let _=null,j=null,b=i.length;const $=function(tt,it){const ot=b-tt,_e=b;b-=tt;const et=a(ot+1,_e),rt=i[ot],st=o?o(rt):rt;nt(new LLRBNode(st,rt.node,it,null,et))},nt=function(tt){_?(_.left=tt,_=tt):(j=tt,_=tt)};for(let tt=0;tt<g.count;++tt){const it=g.nextBitIsOne(),ot=Math.pow(2,g.count-(tt+1));it?$(ot,LLRBNode.BLACK):($(ot,LLRBNode.BLACK),$(ot,LLRBNode.RED))}return j},d=new Base12Num(i.length),h=c(d);return new SortedMap(s||e,h)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _defaultIndexMap;const fallbackObject={};class IndexMap{constructor(e,o){this.indexes_=e,this.indexSet_=o}static get Default(){return assert(fallbackObject&&PRIORITY_INDEX,"ChildrenNode.ts has not been loaded"),_defaultIndexMap=_defaultIndexMap||new IndexMap({".priority":fallbackObject},{".priority":PRIORITY_INDEX}),_defaultIndexMap}get(e){const o=safeGet(this.indexes_,e);if(!o)throw new Error("No index defined for "+e);return o instanceof SortedMap?o:null}hasIndex(e){return contains(this.indexSet_,e.toString())}addIndex(e,o){assert(e!==KEY_INDEX,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let a=!1;const c=o.getIterator(NamedNode.Wrap);let d=c.getNext();for(;d;)a=a||e.isDefinedOn(d.node),s.push(d),d=c.getNext();let h;a?h=buildChildSet(s,e.getCompare()):h=fallbackObject;const g=e.toString(),_=Object.assign({},this.indexSet_);_[g]=e;const j=Object.assign({},this.indexes_);return j[g]=h,new IndexMap(j,_)}addToIndexes(e,o){const s=map(this.indexes_,(a,c)=>{const d=safeGet(this.indexSet_,c);if(assert(d,"Missing index implementation for "+c),a===fallbackObject)if(d.isDefinedOn(e.node)){const h=[],g=o.getIterator(NamedNode.Wrap);let _=g.getNext();for(;_;)_.name!==e.name&&h.push(_),_=g.getNext();return h.push(e),buildChildSet(h,d.getCompare())}else return fallbackObject;else{const h=o.get(e.name);let g=a;return h&&(g=g.remove(new NamedNode(e.name,h))),g.insert(e,e.node)}});return new IndexMap(s,this.indexSet_)}removeFromIndexes(e,o){const s=map(this.indexes_,a=>{if(a===fallbackObject)return a;{const c=o.get(e.name);return c?a.remove(new NamedNode(e.name,c)):a}});return new IndexMap(s,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let EMPTY_NODE;class ChildrenNode{constructor(e,o,s){this.children_=e,this.priorityNode_=o,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&validatePriorityNode(this.priorityNode_),this.children_.isEmpty()&&assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return EMPTY_NODE||(EMPTY_NODE=new ChildrenNode(new SortedMap(NAME_COMPARATOR),null,IndexMap.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||EMPTY_NODE}updatePriority(e){return this.children_.isEmpty()?this:new ChildrenNode(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const o=this.children_.get(e);return o===null?EMPTY_NODE:o}}getChild(e){const o=pathGetFront(e);return o===null?this:this.getImmediateChild(o).getChild(pathPopFront(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,o){if(assert(o,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(o);{const s=new NamedNode(e,o);let a,c;o.isEmpty()?(a=this.children_.remove(e),c=this.indexMap_.removeFromIndexes(s,this.children_)):(a=this.children_.insert(e,o),c=this.indexMap_.addToIndexes(s,this.children_));const d=a.isEmpty()?EMPTY_NODE:this.priorityNode_;return new ChildrenNode(a,d,c)}}updateChild(e,o){const s=pathGetFront(e);if(s===null)return o;{assert(pathGetFront(e)!==".priority"||pathGetLength(e)===1,".priority must be the last token in a path");const a=this.getImmediateChild(s).updateChild(pathPopFront(e),o);return this.updateImmediateChild(s,a)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const o={};let s=0,a=0,c=!0;if(this.forEachChild(PRIORITY_INDEX,(d,h)=>{o[d]=h.val(e),s++,c&&ChildrenNode.INTEGER_REGEXP_.test(d)?a=Math.max(a,Number(d)):c=!1}),!e&&c&&a<2*s){const d=[];for(const h in o)d[h]=o[h];return d}else return e&&!this.getPriority().isEmpty()&&(o[".priority"]=this.getPriority().val()),o}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+priorityHashText(this.getPriority().val())+":"),this.forEachChild(PRIORITY_INDEX,(o,s)=>{const a=s.hash();a!==""&&(e+=":"+o+":"+a)}),this.lazyHash_=e===""?"":sha1(e)}return this.lazyHash_}getPredecessorChildName(e,o,s){const a=this.resolveIndex_(s);if(a){const c=a.getPredecessorKey(new NamedNode(e,o));return c?c.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const o=this.resolveIndex_(e);if(o){const s=o.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const o=this.getFirstChildName(e);return o?new NamedNode(o,this.children_.get(o)):null}getLastChildName(e){const o=this.resolveIndex_(e);if(o){const s=o.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const o=this.getLastChildName(e);return o?new NamedNode(o,this.children_.get(o)):null}forEachChild(e,o){const s=this.resolveIndex_(e);return s?s.inorderTraversal(a=>o(a.name,a.node)):this.children_.inorderTraversal(o)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,o){const s=this.resolveIndex_(o);if(s)return s.getIteratorFrom(e,a=>a);{const a=this.children_.getIteratorFrom(e.name,NamedNode.Wrap);let c=a.peek();for(;c!=null&&o.compare(c,e)<0;)a.getNext(),c=a.peek();return a}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,o){const s=this.resolveIndex_(o);if(s)return s.getReverseIteratorFrom(e,a=>a);{const a=this.children_.getReverseIteratorFrom(e.name,NamedNode.Wrap);let c=a.peek();for(;c!=null&&o.compare(c,e)>0;)a.getNext(),c=a.peek();return a}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===MAX_NODE?-1:0}withIndex(e){if(e===KEY_INDEX||this.indexMap_.hasIndex(e))return this;{const o=this.indexMap_.addIndex(e,this.children_);return new ChildrenNode(this.children_,this.priorityNode_,o)}}isIndexed(e){return e===KEY_INDEX||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const o=e;if(this.getPriority().equals(o.getPriority()))if(this.children_.count()===o.children_.count()){const s=this.getIterator(PRIORITY_INDEX),a=o.getIterator(PRIORITY_INDEX);let c=s.getNext(),d=a.getNext();for(;c&&d;){if(c.name!==d.name||!c.node.equals(d.node))return!1;c=s.getNext(),d=a.getNext()}return c===null&&d===null}else return!1;else return!1}}resolveIndex_(e){return e===KEY_INDEX?null:this.indexMap_.get(e.toString())}}ChildrenNode.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class MaxNode extends ChildrenNode{constructor(){super(new SortedMap(NAME_COMPARATOR),ChildrenNode.EMPTY_NODE,IndexMap.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ChildrenNode.EMPTY_NODE}isEmpty(){return!1}}const MAX_NODE=new MaxNode;Object.defineProperties(NamedNode,{MIN:{value:new NamedNode(MIN_NAME,ChildrenNode.EMPTY_NODE)},MAX:{value:new NamedNode(MAX_NAME,MAX_NODE)}});KeyIndex.__EMPTY_NODE=ChildrenNode.EMPTY_NODE;LeafNode.__childrenNodeConstructor=ChildrenNode;setMaxNode$1(MAX_NODE);setMaxNode(MAX_NODE);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const USE_HINZE=!0;function nodeFromJSON(i,e=null){if(i===null)return ChildrenNode.EMPTY_NODE;if(typeof i=="object"&&".priority"in i&&(e=i[".priority"]),assert(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof i=="object"&&".value"in i&&i[".value"]!==null&&(i=i[".value"]),typeof i!="object"||".sv"in i){const o=i;return new LeafNode(o,nodeFromJSON(e))}if(!(i instanceof Array)&&USE_HINZE){const o=[];let s=!1;if(each(i,(d,h)=>{if(d.substring(0,1)!=="."){const g=nodeFromJSON(h);g.isEmpty()||(s=s||!g.getPriority().isEmpty(),o.push(new NamedNode(d,g)))}}),o.length===0)return ChildrenNode.EMPTY_NODE;const c=buildChildSet(o,NAME_ONLY_COMPARATOR,d=>d.name,NAME_COMPARATOR);if(s){const d=buildChildSet(o,PRIORITY_INDEX.getCompare());return new ChildrenNode(c,nodeFromJSON(e),new IndexMap({".priority":d},{".priority":PRIORITY_INDEX}))}else return new ChildrenNode(c,nodeFromJSON(e),IndexMap.Default)}else{let o=ChildrenNode.EMPTY_NODE;return each(i,(s,a)=>{if(contains(i,s)&&s.substring(0,1)!=="."){const c=nodeFromJSON(a);(c.isLeafNode()||!c.isEmpty())&&(o=o.updateImmediateChild(s,c))}}),o.updatePriority(nodeFromJSON(e))}}setNodeFromJSON(nodeFromJSON);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PathIndex extends Index{constructor(e){super(),this.indexPath_=e,assert(!pathIsEmpty(e)&&pathGetFront(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,o){const s=this.extractChild(e.node),a=this.extractChild(o.node),c=s.compareTo(a);return c===0?nameCompare(e.name,o.name):c}makePost(e,o){const s=nodeFromJSON(e),a=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,s);return new NamedNode(o,a)}maxPost(){const e=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,MAX_NODE);return new NamedNode(MAX_NAME,e)}toString(){return pathSlice(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ValueIndex extends Index{compare(e,o){const s=e.node.compareTo(o.node);return s===0?nameCompare(e.name,o.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,o){return!e.equals(o)}minPost(){return NamedNode.MIN}maxPost(){return NamedNode.MAX}makePost(e,o){const s=nodeFromJSON(e);return new NamedNode(o,s)}toString(){return".value"}}const VALUE_INDEX=new ValueIndex;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function changeValue(i){return{type:"value",snapshotNode:i}}function changeChildAdded(i,e){return{type:"child_added",snapshotNode:e,childName:i}}function changeChildRemoved(i,e){return{type:"child_removed",snapshotNode:e,childName:i}}function changeChildChanged(i,e,o){return{type:"child_changed",snapshotNode:e,childName:i,oldSnap:o}}function changeChildMoved(i,e){return{type:"child_moved",snapshotNode:e,childName:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IndexedFilter{constructor(e){this.index_=e}updateChild(e,o,s,a,c,d){assert(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const h=e.getImmediateChild(o);return h.getChild(a).equals(s.getChild(a))&&h.isEmpty()===s.isEmpty()||(d!=null&&(s.isEmpty()?e.hasChild(o)?d.trackChildChange(changeChildRemoved(o,h)):assert(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):h.isEmpty()?d.trackChildChange(changeChildAdded(o,s)):d.trackChildChange(changeChildChanged(o,s,h))),e.isLeafNode()&&s.isEmpty())?e:e.updateImmediateChild(o,s).withIndex(this.index_)}updateFullNode(e,o,s){return s!=null&&(e.isLeafNode()||e.forEachChild(PRIORITY_INDEX,(a,c)=>{o.hasChild(a)||s.trackChildChange(changeChildRemoved(a,c))}),o.isLeafNode()||o.forEachChild(PRIORITY_INDEX,(a,c)=>{if(e.hasChild(a)){const d=e.getImmediateChild(a);d.equals(c)||s.trackChildChange(changeChildChanged(a,c,d))}else s.trackChildChange(changeChildAdded(a,c))})),o.withIndex(this.index_)}updatePriority(e,o){return e.isEmpty()?ChildrenNode.EMPTY_NODE:e.updatePriority(o)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RangedFilter{constructor(e){this.indexedFilter_=new IndexedFilter(e.getIndex()),this.index_=e.getIndex(),this.startPost_=RangedFilter.getStartPost_(e),this.endPost_=RangedFilter.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const o=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,s=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return o&&s}updateChild(e,o,s,a,c,d){return this.matches(new NamedNode(o,s))||(s=ChildrenNode.EMPTY_NODE),this.indexedFilter_.updateChild(e,o,s,a,c,d)}updateFullNode(e,o,s){o.isLeafNode()&&(o=ChildrenNode.EMPTY_NODE);let a=o.withIndex(this.index_);a=a.updatePriority(ChildrenNode.EMPTY_NODE);const c=this;return o.forEachChild(PRIORITY_INDEX,(d,h)=>{c.matches(new NamedNode(d,h))||(a=a.updateImmediateChild(d,ChildrenNode.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,a,s)}updatePriority(e,o){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const o=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),o)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const o=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),o)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LimitedFilter{constructor(e){this.withinDirectionalStart=o=>this.reverse_?this.withinEndPost(o):this.withinStartPost(o),this.withinDirectionalEnd=o=>this.reverse_?this.withinStartPost(o):this.withinEndPost(o),this.withinStartPost=o=>{const s=this.index_.compare(this.rangedFilter_.getStartPost(),o);return this.startIsInclusive_?s<=0:s<0},this.withinEndPost=o=>{const s=this.index_.compare(o,this.rangedFilter_.getEndPost());return this.endIsInclusive_?s<=0:s<0},this.rangedFilter_=new RangedFilter(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,o,s,a,c,d){return this.rangedFilter_.matches(new NamedNode(o,s))||(s=ChildrenNode.EMPTY_NODE),e.getImmediateChild(o).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,o,s,a,c,d):this.fullLimitUpdateChild_(e,o,s,c,d)}updateFullNode(e,o,s){let a;if(o.isLeafNode()||o.isEmpty())a=ChildrenNode.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<o.numChildren()&&o.isIndexed(this.index_)){a=ChildrenNode.EMPTY_NODE.withIndex(this.index_);let c;this.reverse_?c=o.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):c=o.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let d=0;for(;c.hasNext()&&d<this.limit_;){const h=c.getNext();if(this.withinDirectionalStart(h))if(this.withinDirectionalEnd(h))a=a.updateImmediateChild(h.name,h.node),d++;else break;else continue}}else{a=o.withIndex(this.index_),a=a.updatePriority(ChildrenNode.EMPTY_NODE);let c;this.reverse_?c=a.getReverseIterator(this.index_):c=a.getIterator(this.index_);let d=0;for(;c.hasNext();){const h=c.getNext();d<this.limit_&&this.withinDirectionalStart(h)&&this.withinDirectionalEnd(h)?d++:a=a.updateImmediateChild(h.name,ChildrenNode.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,a,s)}updatePriority(e,o){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,o,s,a,c){let d;if(this.reverse_){const b=this.index_.getCompare();d=($,nt)=>b(nt,$)}else d=this.index_.getCompare();const h=e;assert(h.numChildren()===this.limit_,"");const g=new NamedNode(o,s),_=this.reverse_?h.getFirstChild(this.index_):h.getLastChild(this.index_),j=this.rangedFilter_.matches(g);if(h.hasChild(o)){const b=h.getImmediateChild(o);let $=a.getChildAfterChild(this.index_,_,this.reverse_);for(;$!=null&&($.name===o||h.hasChild($.name));)$=a.getChildAfterChild(this.index_,$,this.reverse_);const nt=$==null?1:d($,g);if(j&&!s.isEmpty()&&nt>=0)return c!=null&&c.trackChildChange(changeChildChanged(o,s,b)),h.updateImmediateChild(o,s);{c!=null&&c.trackChildChange(changeChildRemoved(o,b));const it=h.updateImmediateChild(o,ChildrenNode.EMPTY_NODE);return $!=null&&this.rangedFilter_.matches($)?(c!=null&&c.trackChildChange(changeChildAdded($.name,$.node)),it.updateImmediateChild($.name,$.node)):it}}else return s.isEmpty()?e:j&&d(_,g)>=0?(c!=null&&(c.trackChildChange(changeChildRemoved(_.name,_.node)),c.trackChildChange(changeChildAdded(o,s))),h.updateImmediateChild(o,s).updateImmediateChild(_.name,ChildrenNode.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QueryParams{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=PRIORITY_INDEX}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:MIN_NAME}hasEnd(){return this.endSet_}getIndexEndValue(){return assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:MAX_NAME}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return assert(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===PRIORITY_INDEX}copy(){const e=new QueryParams;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function queryParamsGetNodeFilter(i){return i.loadsAllData()?new IndexedFilter(i.getIndex()):i.hasLimit()?new LimitedFilter(i):new RangedFilter(i)}function queryParamsLimitToFirst(i,e){const o=i.copy();return o.limitSet_=!0,o.limit_=e,o.viewFrom_="l",o}function queryParamsLimitToLast(i,e){const o=i.copy();return o.limitSet_=!0,o.limit_=e,o.viewFrom_="r",o}function queryParamsStartAt(i,e,o){const s=i.copy();return s.startSet_=!0,e===void 0&&(e=null),s.indexStartValue_=e,o!=null?(s.startNameSet_=!0,s.indexStartName_=o):(s.startNameSet_=!1,s.indexStartName_=""),s}function queryParamsStartAfter(i,e,o){let s;return i.index_===KEY_INDEX||o?s=queryParamsStartAt(i,e,o):s=queryParamsStartAt(i,e,MAX_NAME),s.startAfterSet_=!0,s}function queryParamsEndAt(i,e,o){const s=i.copy();return s.endSet_=!0,e===void 0&&(e=null),s.indexEndValue_=e,o!==void 0?(s.endNameSet_=!0,s.indexEndName_=o):(s.endNameSet_=!1,s.indexEndName_=""),s}function queryParamsEndBefore(i,e,o){let s;return i.index_===KEY_INDEX||o?s=queryParamsEndAt(i,e,o):s=queryParamsEndAt(i,e,MIN_NAME),s.endBeforeSet_=!0,s}function queryParamsOrderBy(i,e){const o=i.copy();return o.index_=e,o}function queryParamsToRestQueryStringParameters(i){const e={};if(i.isDefault())return e;let o;if(i.index_===PRIORITY_INDEX?o="$priority":i.index_===VALUE_INDEX?o="$value":i.index_===KEY_INDEX?o="$key":(assert(i.index_ instanceof PathIndex,"Unrecognized index type!"),o=i.index_.toString()),e.orderBy=stringify(o),i.startSet_){const s=i.startAfterSet_?"startAfter":"startAt";e[s]=stringify(i.indexStartValue_),i.startNameSet_&&(e[s]+=","+stringify(i.indexStartName_))}if(i.endSet_){const s=i.endBeforeSet_?"endBefore":"endAt";e[s]=stringify(i.indexEndValue_),i.endNameSet_&&(e[s]+=","+stringify(i.indexEndName_))}return i.limitSet_&&(i.isViewFromLeft()?e.limitToFirst=i.limit_:e.limitToLast=i.limit_),e}function queryParamsGetQueryObject(i){const e={};if(i.startSet_&&(e.sp=i.indexStartValue_,i.startNameSet_&&(e.sn=i.indexStartName_),e.sin=!i.startAfterSet_),i.endSet_&&(e.ep=i.indexEndValue_,i.endNameSet_&&(e.en=i.indexEndName_),e.ein=!i.endBeforeSet_),i.limitSet_){e.l=i.limit_;let o=i.viewFrom_;o===""&&(i.isViewFromLeft()?o="l":o="r"),e.vf=o}return i.index_!==PRIORITY_INDEX&&(e.i=i.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ReadonlyRestClient extends ServerActions{constructor(e,o,s,a){super(),this.repoInfo_=e,this.onDataUpdate_=o,this.authTokenProvider_=s,this.appCheckTokenProvider_=a,this.log_=logWrapper("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,o){return o!==void 0?"tag$"+o:(assert(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,o,s,a){const c=e._path.toString();this.log_("Listen called for "+c+" "+e._queryIdentifier);const d=ReadonlyRestClient.getListenId_(e,s),h={};this.listens_[d]=h;const g=queryParamsToRestQueryStringParameters(e._queryParams);this.restRequest_(c+".json",g,(_,j)=>{let b=j;if(_===404&&(b=null,_=null),_===null&&this.onDataUpdate_(c,b,!1,s),safeGet(this.listens_,d)===h){let $;_?_===401?$="permission_denied":$="rest_error:"+_:$="ok",a($,null)}})}unlisten(e,o){const s=ReadonlyRestClient.getListenId_(e,o);delete this.listens_[s]}get(e){const o=queryParamsToRestQueryStringParameters(e._queryParams),s=e._path.toString(),a=new Deferred;return this.restRequest_(s+".json",o,(c,d)=>{let h=d;c===404&&(h=null,c=null),c===null?(this.onDataUpdate_(s,h,!1,null),a.resolve(h)):a.reject(new Error(h))}),a.promise}refreshAuthToken(e){}restRequest_(e,o={},s){return o.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([a,c])=>{a&&a.accessToken&&(o.auth=a.accessToken),c&&c.token&&(o.ac=c.token);const d=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+querystring(o);this.log_("Sending REST request for "+d);const h=new XMLHttpRequest;h.onreadystatechange=()=>{if(s&&h.readyState===4){this.log_("REST Response for "+d+" received. status:",h.status,"response:",h.responseText);let g=null;if(h.status>=200&&h.status<300){try{g=jsonEval(h.responseText)}catch{warn$1("Failed to parse JSON response for "+d+": "+h.responseText)}s(null,g)}else h.status!==401&&h.status!==404&&warn$1("Got unsuccessful REST response for "+d+" Status: "+h.status),s(h.status);s=null}},h.open("GET",d,!0),h.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SnapshotHolder{constructor(){this.rootNode_=ChildrenNode.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,o){this.rootNode_=this.rootNode_.updateChild(e,o)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function newSparseSnapshotTree(){return{value:null,children:new Map}}function sparseSnapshotTreeRemember(i,e,o){if(pathIsEmpty(e))i.value=o,i.children.clear();else if(i.value!==null)i.value=i.value.updateChild(e,o);else{const s=pathGetFront(e);i.children.has(s)||i.children.set(s,newSparseSnapshotTree());const a=i.children.get(s);e=pathPopFront(e),sparseSnapshotTreeRemember(a,e,o)}}function sparseSnapshotTreeForget(i,e){if(pathIsEmpty(e))return i.value=null,i.children.clear(),!0;if(i.value!==null){if(i.value.isLeafNode())return!1;{const o=i.value;return i.value=null,o.forEachChild(PRIORITY_INDEX,(s,a)=>{sparseSnapshotTreeRemember(i,new Path(s),a)}),sparseSnapshotTreeForget(i,e)}}else if(i.children.size>0){const o=pathGetFront(e);return e=pathPopFront(e),i.children.has(o)&&sparseSnapshotTreeForget(i.children.get(o),e)&&i.children.delete(o),i.children.size===0}else return!0}function sparseSnapshotTreeForEachTree(i,e,o){i.value!==null?o(e,i.value):sparseSnapshotTreeForEachChild(i,(s,a)=>{const c=new Path(e.toString()+"/"+s);sparseSnapshotTreeForEachTree(a,c,o)})}function sparseSnapshotTreeForEachChild(i,e){i.children.forEach((o,s)=>{e(s,o)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StatsListener{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),o=Object.assign({},e);return this.last_&&each(this.last_,(s,a)=>{o[s]=o[s]-a}),this.last_=e,o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FIRST_STATS_MIN_TIME=10*1e3,FIRST_STATS_MAX_TIME=30*1e3,REPORT_STATS_INTERVAL=5*60*1e3;class StatsReporter{constructor(e,o){this.server_=o,this.statsToReport_={},this.statsListener_=new StatsListener(e);const s=FIRST_STATS_MIN_TIME+(FIRST_STATS_MAX_TIME-FIRST_STATS_MIN_TIME)*Math.random();setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),o={};let s=!1;each(e,(a,c)=>{c>0&&contains(this.statsToReport_,a)&&(o[a]=c,s=!0)}),s&&this.server_.reportStats(o),setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(Math.random()*2*REPORT_STATS_INTERVAL))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var OperationType;(function(i){i[i.OVERWRITE=0]="OVERWRITE",i[i.MERGE=1]="MERGE",i[i.ACK_USER_WRITE=2]="ACK_USER_WRITE",i[i.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(OperationType||(OperationType={}));function newOperationSourceUser(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function newOperationSourceServer(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function newOperationSourceServerTaggedQuery(i){return{fromUser:!1,fromServer:!0,queryId:i,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AckUserWrite{constructor(e,o,s){this.path=e,this.affectedTree=o,this.revert=s,this.type=OperationType.ACK_USER_WRITE,this.source=newOperationSourceUser()}operationForChild(e){if(pathIsEmpty(this.path)){if(this.affectedTree.value!=null)return assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const o=this.affectedTree.subtree(new Path(e));return new AckUserWrite(newEmptyPath(),o,this.revert)}}else return assert(pathGetFront(this.path)===e,"operationForChild called for unrelated child."),new AckUserWrite(pathPopFront(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ListenComplete{constructor(e,o){this.source=e,this.path=o,this.type=OperationType.LISTEN_COMPLETE}operationForChild(e){return pathIsEmpty(this.path)?new ListenComplete(this.source,newEmptyPath()):new ListenComplete(this.source,pathPopFront(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Overwrite{constructor(e,o,s){this.source=e,this.path=o,this.snap=s,this.type=OperationType.OVERWRITE}operationForChild(e){return pathIsEmpty(this.path)?new Overwrite(this.source,newEmptyPath(),this.snap.getImmediateChild(e)):new Overwrite(this.source,pathPopFront(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Merge{constructor(e,o,s){this.source=e,this.path=o,this.children=s,this.type=OperationType.MERGE}operationForChild(e){if(pathIsEmpty(this.path)){const o=this.children.subtree(new Path(e));return o.isEmpty()?null:o.value?new Overwrite(this.source,newEmptyPath(),o.value):new Merge(this.source,newEmptyPath(),o)}else return assert(pathGetFront(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Merge(this.source,pathPopFront(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CacheNode{constructor(e,o,s){this.node_=e,this.fullyInitialized_=o,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(pathIsEmpty(e))return this.isFullyInitialized()&&!this.filtered_;const o=pathGetFront(e);return this.isCompleteForChild(o)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EventGenerator{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function eventGeneratorGenerateEventsForChanges(i,e,o,s){const a=[],c=[];return e.forEach(d=>{d.type==="child_changed"&&i.index_.indexedValueChanged(d.oldSnap,d.snapshotNode)&&c.push(changeChildMoved(d.childName,d.snapshotNode))}),eventGeneratorGenerateEventsForType(i,a,"child_removed",e,s,o),eventGeneratorGenerateEventsForType(i,a,"child_added",e,s,o),eventGeneratorGenerateEventsForType(i,a,"child_moved",c,s,o),eventGeneratorGenerateEventsForType(i,a,"child_changed",e,s,o),eventGeneratorGenerateEventsForType(i,a,"value",e,s,o),a}function eventGeneratorGenerateEventsForType(i,e,o,s,a,c){const d=s.filter(h=>h.type===o);d.sort((h,g)=>eventGeneratorCompareChanges(i,h,g)),d.forEach(h=>{const g=eventGeneratorMaterializeSingleChange(i,h,c);a.forEach(_=>{_.respondsTo(h.type)&&e.push(_.createEvent(g,i.query_))})})}function eventGeneratorMaterializeSingleChange(i,e,o){return e.type==="value"||e.type==="child_removed"||(e.prevName=o.getPredecessorChildName(e.childName,e.snapshotNode,i.index_)),e}function eventGeneratorCompareChanges(i,e,o){if(e.childName==null||o.childName==null)throw assertionError("Should only compare child_ events.");const s=new NamedNode(e.childName,e.snapshotNode),a=new NamedNode(o.childName,o.snapshotNode);return i.index_.compare(s,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function newViewCache(i,e){return{eventCache:i,serverCache:e}}function viewCacheUpdateEventSnap(i,e,o,s){return newViewCache(new CacheNode(e,o,s),i.serverCache)}function viewCacheUpdateServerSnap(i,e,o,s){return newViewCache(i.eventCache,new CacheNode(e,o,s))}function viewCacheGetCompleteEventSnap(i){return i.eventCache.isFullyInitialized()?i.eventCache.getNode():null}function viewCacheGetCompleteServerSnap(i){return i.serverCache.isFullyInitialized()?i.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let emptyChildrenSingleton;const EmptyChildren=()=>(emptyChildrenSingleton||(emptyChildrenSingleton=new SortedMap(stringCompare)),emptyChildrenSingleton);class ImmutableTree{constructor(e,o=EmptyChildren()){this.value=e,this.children=o}static fromObject(e){let o=new ImmutableTree(null);return each(e,(s,a)=>{o=o.set(new Path(s),a)}),o}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,o){if(this.value!=null&&o(this.value))return{path:newEmptyPath(),value:this.value};if(pathIsEmpty(e))return null;{const s=pathGetFront(e),a=this.children.get(s);if(a!==null){const c=a.findRootMostMatchingPathAndValue(pathPopFront(e),o);return c!=null?{path:pathChild(new Path(s),c.path),value:c.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(pathIsEmpty(e))return this;{const o=pathGetFront(e),s=this.children.get(o);return s!==null?s.subtree(pathPopFront(e)):new ImmutableTree(null)}}set(e,o){if(pathIsEmpty(e))return new ImmutableTree(o,this.children);{const s=pathGetFront(e),c=(this.children.get(s)||new ImmutableTree(null)).set(pathPopFront(e),o),d=this.children.insert(s,c);return new ImmutableTree(this.value,d)}}remove(e){if(pathIsEmpty(e))return this.children.isEmpty()?new ImmutableTree(null):new ImmutableTree(null,this.children);{const o=pathGetFront(e),s=this.children.get(o);if(s){const a=s.remove(pathPopFront(e));let c;return a.isEmpty()?c=this.children.remove(o):c=this.children.insert(o,a),this.value===null&&c.isEmpty()?new ImmutableTree(null):new ImmutableTree(this.value,c)}else return this}}get(e){if(pathIsEmpty(e))return this.value;{const o=pathGetFront(e),s=this.children.get(o);return s?s.get(pathPopFront(e)):null}}setTree(e,o){if(pathIsEmpty(e))return o;{const s=pathGetFront(e),c=(this.children.get(s)||new ImmutableTree(null)).setTree(pathPopFront(e),o);let d;return c.isEmpty()?d=this.children.remove(s):d=this.children.insert(s,c),new ImmutableTree(this.value,d)}}fold(e){return this.fold_(newEmptyPath(),e)}fold_(e,o){const s={};return this.children.inorderTraversal((a,c)=>{s[a]=c.fold_(pathChild(e,a),o)}),o(e,this.value,s)}findOnPath(e,o){return this.findOnPath_(e,newEmptyPath(),o)}findOnPath_(e,o,s){const a=this.value?s(o,this.value):!1;if(a)return a;if(pathIsEmpty(e))return null;{const c=pathGetFront(e),d=this.children.get(c);return d?d.findOnPath_(pathPopFront(e),pathChild(o,c),s):null}}foreachOnPath(e,o){return this.foreachOnPath_(e,newEmptyPath(),o)}foreachOnPath_(e,o,s){if(pathIsEmpty(e))return this;{this.value&&s(o,this.value);const a=pathGetFront(e),c=this.children.get(a);return c?c.foreachOnPath_(pathPopFront(e),pathChild(o,a),s):new ImmutableTree(null)}}foreach(e){this.foreach_(newEmptyPath(),e)}foreach_(e,o){this.children.inorderTraversal((s,a)=>{a.foreach_(pathChild(e,s),o)}),this.value&&o(e,this.value)}foreachChild(e){this.children.inorderTraversal((o,s)=>{s.value&&e(o,s.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CompoundWrite{constructor(e){this.writeTree_=e}static empty(){return new CompoundWrite(new ImmutableTree(null))}}function compoundWriteAddWrite(i,e,o){if(pathIsEmpty(e))return new CompoundWrite(new ImmutableTree(o));{const s=i.writeTree_.findRootMostValueAndPath(e);if(s!=null){const a=s.path;let c=s.value;const d=newRelativePath(a,e);return c=c.updateChild(d,o),new CompoundWrite(i.writeTree_.set(a,c))}else{const a=new ImmutableTree(o),c=i.writeTree_.setTree(e,a);return new CompoundWrite(c)}}}function compoundWriteAddWrites(i,e,o){let s=i;return each(o,(a,c)=>{s=compoundWriteAddWrite(s,pathChild(e,a),c)}),s}function compoundWriteRemoveWrite(i,e){if(pathIsEmpty(e))return CompoundWrite.empty();{const o=i.writeTree_.setTree(e,new ImmutableTree(null));return new CompoundWrite(o)}}function compoundWriteHasCompleteWrite(i,e){return compoundWriteGetCompleteNode(i,e)!=null}function compoundWriteGetCompleteNode(i,e){const o=i.writeTree_.findRootMostValueAndPath(e);return o!=null?i.writeTree_.get(o.path).getChild(newRelativePath(o.path,e)):null}function compoundWriteGetCompleteChildren(i){const e=[],o=i.writeTree_.value;return o!=null?o.isLeafNode()||o.forEachChild(PRIORITY_INDEX,(s,a)=>{e.push(new NamedNode(s,a))}):i.writeTree_.children.inorderTraversal((s,a)=>{a.value!=null&&e.push(new NamedNode(s,a.value))}),e}function compoundWriteChildCompoundWrite(i,e){if(pathIsEmpty(e))return i;{const o=compoundWriteGetCompleteNode(i,e);return o!=null?new CompoundWrite(new ImmutableTree(o)):new CompoundWrite(i.writeTree_.subtree(e))}}function compoundWriteIsEmpty(i){return i.writeTree_.isEmpty()}function compoundWriteApply(i,e){return applySubtreeWrite(newEmptyPath(),i.writeTree_,e)}function applySubtreeWrite(i,e,o){if(e.value!=null)return o.updateChild(i,e.value);{let s=null;return e.children.inorderTraversal((a,c)=>{a===".priority"?(assert(c.value!==null,"Priority writes must always be leaf nodes"),s=c.value):o=applySubtreeWrite(pathChild(i,a),c,o)}),!o.getChild(i).isEmpty()&&s!==null&&(o=o.updateChild(pathChild(i,".priority"),s)),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function writeTreeChildWrites(i,e){return newWriteTreeRef(e,i)}function writeTreeAddOverwrite(i,e,o,s,a){assert(s>i.lastWriteId,"Stacking an older write on top of newer ones"),a===void 0&&(a=!0),i.allWrites.push({path:e,snap:o,writeId:s,visible:a}),a&&(i.visibleWrites=compoundWriteAddWrite(i.visibleWrites,e,o)),i.lastWriteId=s}function writeTreeAddMerge(i,e,o,s){assert(s>i.lastWriteId,"Stacking an older merge on top of newer ones"),i.allWrites.push({path:e,children:o,writeId:s,visible:!0}),i.visibleWrites=compoundWriteAddWrites(i.visibleWrites,e,o),i.lastWriteId=s}function writeTreeGetWrite(i,e){for(let o=0;o<i.allWrites.length;o++){const s=i.allWrites[o];if(s.writeId===e)return s}return null}function writeTreeRemoveWrite(i,e){const o=i.allWrites.findIndex(h=>h.writeId===e);assert(o>=0,"removeWrite called with nonexistent writeId.");const s=i.allWrites[o];i.allWrites.splice(o,1);let a=s.visible,c=!1,d=i.allWrites.length-1;for(;a&&d>=0;){const h=i.allWrites[d];h.visible&&(d>=o&&writeTreeRecordContainsPath_(h,s.path)?a=!1:pathContains(s.path,h.path)&&(c=!0)),d--}if(a){if(c)return writeTreeResetTree_(i),!0;if(s.snap)i.visibleWrites=compoundWriteRemoveWrite(i.visibleWrites,s.path);else{const h=s.children;each(h,g=>{i.visibleWrites=compoundWriteRemoveWrite(i.visibleWrites,pathChild(s.path,g))})}return!0}else return!1}function writeTreeRecordContainsPath_(i,e){if(i.snap)return pathContains(i.path,e);for(const o in i.children)if(i.children.hasOwnProperty(o)&&pathContains(pathChild(i.path,o),e))return!0;return!1}function writeTreeResetTree_(i){i.visibleWrites=writeTreeLayerTree_(i.allWrites,writeTreeDefaultFilter_,newEmptyPath()),i.allWrites.length>0?i.lastWriteId=i.allWrites[i.allWrites.length-1].writeId:i.lastWriteId=-1}function writeTreeDefaultFilter_(i){return i.visible}function writeTreeLayerTree_(i,e,o){let s=CompoundWrite.empty();for(let a=0;a<i.length;++a){const c=i[a];if(e(c)){const d=c.path;let h;if(c.snap)pathContains(o,d)?(h=newRelativePath(o,d),s=compoundWriteAddWrite(s,h,c.snap)):pathContains(d,o)&&(h=newRelativePath(d,o),s=compoundWriteAddWrite(s,newEmptyPath(),c.snap.getChild(h)));else if(c.children){if(pathContains(o,d))h=newRelativePath(o,d),s=compoundWriteAddWrites(s,h,c.children);else if(pathContains(d,o))if(h=newRelativePath(d,o),pathIsEmpty(h))s=compoundWriteAddWrites(s,newEmptyPath(),c.children);else{const g=safeGet(c.children,pathGetFront(h));if(g){const _=g.getChild(pathPopFront(h));s=compoundWriteAddWrite(s,newEmptyPath(),_)}}}else throw assertionError("WriteRecord should have .snap or .children")}}return s}function writeTreeCalcCompleteEventCache(i,e,o,s,a){if(!s&&!a){const c=compoundWriteGetCompleteNode(i.visibleWrites,e);if(c!=null)return c;{const d=compoundWriteChildCompoundWrite(i.visibleWrites,e);if(compoundWriteIsEmpty(d))return o;if(o==null&&!compoundWriteHasCompleteWrite(d,newEmptyPath()))return null;{const h=o||ChildrenNode.EMPTY_NODE;return compoundWriteApply(d,h)}}}else{const c=compoundWriteChildCompoundWrite(i.visibleWrites,e);if(!a&&compoundWriteIsEmpty(c))return o;if(!a&&o==null&&!compoundWriteHasCompleteWrite(c,newEmptyPath()))return null;{const d=function(_){return(_.visible||a)&&(!s||!~s.indexOf(_.writeId))&&(pathContains(_.path,e)||pathContains(e,_.path))},h=writeTreeLayerTree_(i.allWrites,d,e),g=o||ChildrenNode.EMPTY_NODE;return compoundWriteApply(h,g)}}}function writeTreeCalcCompleteEventChildren(i,e,o){let s=ChildrenNode.EMPTY_NODE;const a=compoundWriteGetCompleteNode(i.visibleWrites,e);if(a)return a.isLeafNode()||a.forEachChild(PRIORITY_INDEX,(c,d)=>{s=s.updateImmediateChild(c,d)}),s;if(o){const c=compoundWriteChildCompoundWrite(i.visibleWrites,e);return o.forEachChild(PRIORITY_INDEX,(d,h)=>{const g=compoundWriteApply(compoundWriteChildCompoundWrite(c,new Path(d)),h);s=s.updateImmediateChild(d,g)}),compoundWriteGetCompleteChildren(c).forEach(d=>{s=s.updateImmediateChild(d.name,d.node)}),s}else{const c=compoundWriteChildCompoundWrite(i.visibleWrites,e);return compoundWriteGetCompleteChildren(c).forEach(d=>{s=s.updateImmediateChild(d.name,d.node)}),s}}function writeTreeCalcEventCacheAfterServerOverwrite(i,e,o,s,a){assert(s||a,"Either existingEventSnap or existingServerSnap must exist");const c=pathChild(e,o);if(compoundWriteHasCompleteWrite(i.visibleWrites,c))return null;{const d=compoundWriteChildCompoundWrite(i.visibleWrites,c);return compoundWriteIsEmpty(d)?a.getChild(o):compoundWriteApply(d,a.getChild(o))}}function writeTreeCalcCompleteChild(i,e,o,s){const a=pathChild(e,o),c=compoundWriteGetCompleteNode(i.visibleWrites,a);if(c!=null)return c;if(s.isCompleteForChild(o)){const d=compoundWriteChildCompoundWrite(i.visibleWrites,a);return compoundWriteApply(d,s.getNode().getImmediateChild(o))}else return null}function writeTreeShadowingWrite(i,e){return compoundWriteGetCompleteNode(i.visibleWrites,e)}function writeTreeCalcIndexedSlice(i,e,o,s,a,c,d){let h;const g=compoundWriteChildCompoundWrite(i.visibleWrites,e),_=compoundWriteGetCompleteNode(g,newEmptyPath());if(_!=null)h=_;else if(o!=null)h=compoundWriteApply(g,o);else return[];if(h=h.withIndex(d),!h.isEmpty()&&!h.isLeafNode()){const j=[],b=d.getCompare(),$=c?h.getReverseIteratorFrom(s,d):h.getIteratorFrom(s,d);let nt=$.getNext();for(;nt&&j.length<a;)b(nt,s)!==0&&j.push(nt),nt=$.getNext();return j}else return[]}function newWriteTree(){return{visibleWrites:CompoundWrite.empty(),allWrites:[],lastWriteId:-1}}function writeTreeRefCalcCompleteEventCache(i,e,o,s){return writeTreeCalcCompleteEventCache(i.writeTree,i.treePath,e,o,s)}function writeTreeRefCalcCompleteEventChildren(i,e){return writeTreeCalcCompleteEventChildren(i.writeTree,i.treePath,e)}function writeTreeRefCalcEventCacheAfterServerOverwrite(i,e,o,s){return writeTreeCalcEventCacheAfterServerOverwrite(i.writeTree,i.treePath,e,o,s)}function writeTreeRefShadowingWrite(i,e){return writeTreeShadowingWrite(i.writeTree,pathChild(i.treePath,e))}function writeTreeRefCalcIndexedSlice(i,e,o,s,a,c){return writeTreeCalcIndexedSlice(i.writeTree,i.treePath,e,o,s,a,c)}function writeTreeRefCalcCompleteChild(i,e,o){return writeTreeCalcCompleteChild(i.writeTree,i.treePath,e,o)}function writeTreeRefChild(i,e){return newWriteTreeRef(pathChild(i.treePath,e),i.writeTree)}function newWriteTreeRef(i,e){return{treePath:i,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ChildChangeAccumulator{constructor(){this.changeMap=new Map}trackChildChange(e){const o=e.type,s=e.childName;assert(o==="child_added"||o==="child_changed"||o==="child_removed","Only child changes supported for tracking"),assert(s!==".priority","Only non-priority child changes can be tracked.");const a=this.changeMap.get(s);if(a){const c=a.type;if(o==="child_added"&&c==="child_removed")this.changeMap.set(s,changeChildChanged(s,e.snapshotNode,a.snapshotNode));else if(o==="child_removed"&&c==="child_added")this.changeMap.delete(s);else if(o==="child_removed"&&c==="child_changed")this.changeMap.set(s,changeChildRemoved(s,a.oldSnap));else if(o==="child_changed"&&c==="child_added")this.changeMap.set(s,changeChildAdded(s,e.snapshotNode));else if(o==="child_changed"&&c==="child_changed")this.changeMap.set(s,changeChildChanged(s,e.snapshotNode,a.oldSnap));else throw assertionError("Illegal combination of changes: "+e+" occurred after "+a)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NoCompleteChildSource_{getCompleteChild(e){return null}getChildAfterChild(e,o,s){return null}}const NO_COMPLETE_CHILD_SOURCE=new NoCompleteChildSource_;class WriteTreeCompleteChildSource{constructor(e,o,s=null){this.writes_=e,this.viewCache_=o,this.optCompleteServerCache_=s}getCompleteChild(e){const o=this.viewCache_.eventCache;if(o.isCompleteForChild(e))return o.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new CacheNode(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return writeTreeRefCalcCompleteChild(this.writes_,e,s)}}getChildAfterChild(e,o,s){const a=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:viewCacheGetCompleteServerSnap(this.viewCache_),c=writeTreeRefCalcIndexedSlice(this.writes_,a,o,1,s,e);return c.length===0?null:c[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function newViewProcessor(i){return{filter:i}}function viewProcessorAssertIndexed(i,e){assert(e.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),assert(e.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed")}function viewProcessorApplyOperation(i,e,o,s,a){const c=new ChildChangeAccumulator;let d,h;if(o.type===OperationType.OVERWRITE){const _=o;_.source.fromUser?d=viewProcessorApplyUserOverwrite(i,e,_.path,_.snap,s,a,c):(assert(_.source.fromServer,"Unknown source."),h=_.source.tagged||e.serverCache.isFiltered()&&!pathIsEmpty(_.path),d=viewProcessorApplyServerOverwrite(i,e,_.path,_.snap,s,a,h,c))}else if(o.type===OperationType.MERGE){const _=o;_.source.fromUser?d=viewProcessorApplyUserMerge(i,e,_.path,_.children,s,a,c):(assert(_.source.fromServer,"Unknown source."),h=_.source.tagged||e.serverCache.isFiltered(),d=viewProcessorApplyServerMerge(i,e,_.path,_.children,s,a,h,c))}else if(o.type===OperationType.ACK_USER_WRITE){const _=o;_.revert?d=viewProcessorRevertUserWrite(i,e,_.path,s,a,c):d=viewProcessorAckUserWrite(i,e,_.path,_.affectedTree,s,a,c)}else if(o.type===OperationType.LISTEN_COMPLETE)d=viewProcessorListenComplete(i,e,o.path,s,c);else throw assertionError("Unknown operation type: "+o.type);const g=c.getChanges();return viewProcessorMaybeAddValueEvent(e,d,g),{viewCache:d,changes:g}}function viewProcessorMaybeAddValueEvent(i,e,o){const s=e.eventCache;if(s.isFullyInitialized()){const a=s.getNode().isLeafNode()||s.getNode().isEmpty(),c=viewCacheGetCompleteEventSnap(i);(o.length>0||!i.eventCache.isFullyInitialized()||a&&!s.getNode().equals(c)||!s.getNode().getPriority().equals(c.getPriority()))&&o.push(changeValue(viewCacheGetCompleteEventSnap(e)))}}function viewProcessorGenerateEventCacheAfterServerEvent(i,e,o,s,a,c){const d=e.eventCache;if(writeTreeRefShadowingWrite(s,o)!=null)return e;{let h,g;if(pathIsEmpty(o))if(assert(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const _=viewCacheGetCompleteServerSnap(e),j=_ instanceof ChildrenNode?_:ChildrenNode.EMPTY_NODE,b=writeTreeRefCalcCompleteEventChildren(s,j);h=i.filter.updateFullNode(e.eventCache.getNode(),b,c)}else{const _=writeTreeRefCalcCompleteEventCache(s,viewCacheGetCompleteServerSnap(e));h=i.filter.updateFullNode(e.eventCache.getNode(),_,c)}else{const _=pathGetFront(o);if(_===".priority"){assert(pathGetLength(o)===1,"Can't have a priority with additional path components");const j=d.getNode();g=e.serverCache.getNode();const b=writeTreeRefCalcEventCacheAfterServerOverwrite(s,o,j,g);b!=null?h=i.filter.updatePriority(j,b):h=d.getNode()}else{const j=pathPopFront(o);let b;if(d.isCompleteForChild(_)){g=e.serverCache.getNode();const $=writeTreeRefCalcEventCacheAfterServerOverwrite(s,o,d.getNode(),g);$!=null?b=d.getNode().getImmediateChild(_).updateChild(j,$):b=d.getNode().getImmediateChild(_)}else b=writeTreeRefCalcCompleteChild(s,_,e.serverCache);b!=null?h=i.filter.updateChild(d.getNode(),_,b,j,a,c):h=d.getNode()}}return viewCacheUpdateEventSnap(e,h,d.isFullyInitialized()||pathIsEmpty(o),i.filter.filtersNodes())}}function viewProcessorApplyServerOverwrite(i,e,o,s,a,c,d,h){const g=e.serverCache;let _;const j=d?i.filter:i.filter.getIndexedFilter();if(pathIsEmpty(o))_=j.updateFullNode(g.getNode(),s,null);else if(j.filtersNodes()&&!g.isFiltered()){const nt=g.getNode().updateChild(o,s);_=j.updateFullNode(g.getNode(),nt,null)}else{const nt=pathGetFront(o);if(!g.isCompleteForPath(o)&&pathGetLength(o)>1)return e;const tt=pathPopFront(o),ot=g.getNode().getImmediateChild(nt).updateChild(tt,s);nt===".priority"?_=j.updatePriority(g.getNode(),ot):_=j.updateChild(g.getNode(),nt,ot,tt,NO_COMPLETE_CHILD_SOURCE,null)}const b=viewCacheUpdateServerSnap(e,_,g.isFullyInitialized()||pathIsEmpty(o),j.filtersNodes()),$=new WriteTreeCompleteChildSource(a,b,c);return viewProcessorGenerateEventCacheAfterServerEvent(i,b,o,a,$,h)}function viewProcessorApplyUserOverwrite(i,e,o,s,a,c,d){const h=e.eventCache;let g,_;const j=new WriteTreeCompleteChildSource(a,e,c);if(pathIsEmpty(o))_=i.filter.updateFullNode(e.eventCache.getNode(),s,d),g=viewCacheUpdateEventSnap(e,_,!0,i.filter.filtersNodes());else{const b=pathGetFront(o);if(b===".priority")_=i.filter.updatePriority(e.eventCache.getNode(),s),g=viewCacheUpdateEventSnap(e,_,h.isFullyInitialized(),h.isFiltered());else{const $=pathPopFront(o),nt=h.getNode().getImmediateChild(b);let tt;if(pathIsEmpty($))tt=s;else{const it=j.getCompleteChild(b);it!=null?pathGetBack($)===".priority"&&it.getChild(pathParent($)).isEmpty()?tt=it:tt=it.updateChild($,s):tt=ChildrenNode.EMPTY_NODE}if(nt.equals(tt))g=e;else{const it=i.filter.updateChild(h.getNode(),b,tt,$,j,d);g=viewCacheUpdateEventSnap(e,it,h.isFullyInitialized(),i.filter.filtersNodes())}}}return g}function viewProcessorCacheHasChild(i,e){return i.eventCache.isCompleteForChild(e)}function viewProcessorApplyUserMerge(i,e,o,s,a,c,d){let h=e;return s.foreach((g,_)=>{const j=pathChild(o,g);viewProcessorCacheHasChild(e,pathGetFront(j))&&(h=viewProcessorApplyUserOverwrite(i,h,j,_,a,c,d))}),s.foreach((g,_)=>{const j=pathChild(o,g);viewProcessorCacheHasChild(e,pathGetFront(j))||(h=viewProcessorApplyUserOverwrite(i,h,j,_,a,c,d))}),h}function viewProcessorApplyMerge(i,e,o){return o.foreach((s,a)=>{e=e.updateChild(s,a)}),e}function viewProcessorApplyServerMerge(i,e,o,s,a,c,d,h){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let g=e,_;pathIsEmpty(o)?_=s:_=new ImmutableTree(null).setTree(o,s);const j=e.serverCache.getNode();return _.children.inorderTraversal((b,$)=>{if(j.hasChild(b)){const nt=e.serverCache.getNode().getImmediateChild(b),tt=viewProcessorApplyMerge(i,nt,$);g=viewProcessorApplyServerOverwrite(i,g,new Path(b),tt,a,c,d,h)}}),_.children.inorderTraversal((b,$)=>{const nt=!e.serverCache.isCompleteForChild(b)&&$.value===null;if(!j.hasChild(b)&&!nt){const tt=e.serverCache.getNode().getImmediateChild(b),it=viewProcessorApplyMerge(i,tt,$);g=viewProcessorApplyServerOverwrite(i,g,new Path(b),it,a,c,d,h)}}),g}function viewProcessorAckUserWrite(i,e,o,s,a,c,d){if(writeTreeRefShadowingWrite(a,o)!=null)return e;const h=e.serverCache.isFiltered(),g=e.serverCache;if(s.value!=null){if(pathIsEmpty(o)&&g.isFullyInitialized()||g.isCompleteForPath(o))return viewProcessorApplyServerOverwrite(i,e,o,g.getNode().getChild(o),a,c,h,d);if(pathIsEmpty(o)){let _=new ImmutableTree(null);return g.getNode().forEachChild(KEY_INDEX,(j,b)=>{_=_.set(new Path(j),b)}),viewProcessorApplyServerMerge(i,e,o,_,a,c,h,d)}else return e}else{let _=new ImmutableTree(null);return s.foreach((j,b)=>{const $=pathChild(o,j);g.isCompleteForPath($)&&(_=_.set(j,g.getNode().getChild($)))}),viewProcessorApplyServerMerge(i,e,o,_,a,c,h,d)}}function viewProcessorListenComplete(i,e,o,s,a){const c=e.serverCache,d=viewCacheUpdateServerSnap(e,c.getNode(),c.isFullyInitialized()||pathIsEmpty(o),c.isFiltered());return viewProcessorGenerateEventCacheAfterServerEvent(i,d,o,s,NO_COMPLETE_CHILD_SOURCE,a)}function viewProcessorRevertUserWrite(i,e,o,s,a,c){let d;if(writeTreeRefShadowingWrite(s,o)!=null)return e;{const h=new WriteTreeCompleteChildSource(s,e,a),g=e.eventCache.getNode();let _;if(pathIsEmpty(o)||pathGetFront(o)===".priority"){let j;if(e.serverCache.isFullyInitialized())j=writeTreeRefCalcCompleteEventCache(s,viewCacheGetCompleteServerSnap(e));else{const b=e.serverCache.getNode();assert(b instanceof ChildrenNode,"serverChildren would be complete if leaf node"),j=writeTreeRefCalcCompleteEventChildren(s,b)}j=j,_=i.filter.updateFullNode(g,j,c)}else{const j=pathGetFront(o);let b=writeTreeRefCalcCompleteChild(s,j,e.serverCache);b==null&&e.serverCache.isCompleteForChild(j)&&(b=g.getImmediateChild(j)),b!=null?_=i.filter.updateChild(g,j,b,pathPopFront(o),h,c):e.eventCache.getNode().hasChild(j)?_=i.filter.updateChild(g,j,ChildrenNode.EMPTY_NODE,pathPopFront(o),h,c):_=g,_.isEmpty()&&e.serverCache.isFullyInitialized()&&(d=writeTreeRefCalcCompleteEventCache(s,viewCacheGetCompleteServerSnap(e)),d.isLeafNode()&&(_=i.filter.updateFullNode(_,d,c)))}return d=e.serverCache.isFullyInitialized()||writeTreeRefShadowingWrite(s,newEmptyPath())!=null,viewCacheUpdateEventSnap(e,_,d,i.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class View{constructor(e,o){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,a=new IndexedFilter(s.getIndex()),c=queryParamsGetNodeFilter(s);this.processor_=newViewProcessor(c);const d=o.serverCache,h=o.eventCache,g=a.updateFullNode(ChildrenNode.EMPTY_NODE,d.getNode(),null),_=c.updateFullNode(ChildrenNode.EMPTY_NODE,h.getNode(),null),j=new CacheNode(g,d.isFullyInitialized(),a.filtersNodes()),b=new CacheNode(_,h.isFullyInitialized(),c.filtersNodes());this.viewCache_=newViewCache(b,j),this.eventGenerator_=new EventGenerator(this.query_)}get query(){return this.query_}}function viewGetServerCache(i){return i.viewCache_.serverCache.getNode()}function viewGetCompleteNode(i){return viewCacheGetCompleteEventSnap(i.viewCache_)}function viewGetCompleteServerCache(i,e){const o=viewCacheGetCompleteServerSnap(i.viewCache_);return o&&(i.query._queryParams.loadsAllData()||!pathIsEmpty(e)&&!o.getImmediateChild(pathGetFront(e)).isEmpty())?o.getChild(e):null}function viewIsEmpty(i){return i.eventRegistrations_.length===0}function viewAddEventRegistration(i,e){i.eventRegistrations_.push(e)}function viewRemoveEventRegistration(i,e,o){const s=[];if(o){assert(e==null,"A cancel should cancel all event registrations.");const a=i.query._path;i.eventRegistrations_.forEach(c=>{const d=c.createCancelEvent(o,a);d&&s.push(d)})}if(e){let a=[];for(let c=0;c<i.eventRegistrations_.length;++c){const d=i.eventRegistrations_[c];if(!d.matches(e))a.push(d);else if(e.hasAnyCallback()){a=a.concat(i.eventRegistrations_.slice(c+1));break}}i.eventRegistrations_=a}else i.eventRegistrations_=[];return s}function viewApplyOperation(i,e,o,s){e.type===OperationType.MERGE&&e.source.queryId!==null&&(assert(viewCacheGetCompleteServerSnap(i.viewCache_),"We should always have a full cache before handling merges"),assert(viewCacheGetCompleteEventSnap(i.viewCache_),"Missing event cache, even though we have a server cache"));const a=i.viewCache_,c=viewProcessorApplyOperation(i.processor_,a,e,o,s);return viewProcessorAssertIndexed(i.processor_,c.viewCache),assert(c.viewCache.serverCache.isFullyInitialized()||!a.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),i.viewCache_=c.viewCache,viewGenerateEventsForChanges_(i,c.changes,c.viewCache.eventCache.getNode(),null)}function viewGetInitialEvents(i,e){const o=i.viewCache_.eventCache,s=[];return o.getNode().isLeafNode()||o.getNode().forEachChild(PRIORITY_INDEX,(c,d)=>{s.push(changeChildAdded(c,d))}),o.isFullyInitialized()&&s.push(changeValue(o.getNode())),viewGenerateEventsForChanges_(i,s,o.getNode(),e)}function viewGenerateEventsForChanges_(i,e,o,s){const a=s?[s]:i.eventRegistrations_;return eventGeneratorGenerateEventsForChanges(i.eventGenerator_,e,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let referenceConstructor$1;class SyncPoint{constructor(){this.views=new Map}}function syncPointSetReferenceConstructor(i){assert(!referenceConstructor$1,"__referenceConstructor has already been defined"),referenceConstructor$1=i}function syncPointGetReferenceConstructor(){return assert(referenceConstructor$1,"Reference.ts has not been loaded"),referenceConstructor$1}function syncPointIsEmpty(i){return i.views.size===0}function syncPointApplyOperation(i,e,o,s){const a=e.source.queryId;if(a!==null){const c=i.views.get(a);return assert(c!=null,"SyncTree gave us an op for an invalid query."),viewApplyOperation(c,e,o,s)}else{let c=[];for(const d of i.views.values())c=c.concat(viewApplyOperation(d,e,o,s));return c}}function syncPointGetView(i,e,o,s,a){const c=e._queryIdentifier,d=i.views.get(c);if(!d){let h=writeTreeRefCalcCompleteEventCache(o,a?s:null),g=!1;h?g=!0:s instanceof ChildrenNode?(h=writeTreeRefCalcCompleteEventChildren(o,s),g=!1):(h=ChildrenNode.EMPTY_NODE,g=!1);const _=newViewCache(new CacheNode(h,g,!1),new CacheNode(s,a,!1));return new View(e,_)}return d}function syncPointAddEventRegistration(i,e,o,s,a,c){const d=syncPointGetView(i,e,s,a,c);return i.views.has(e._queryIdentifier)||i.views.set(e._queryIdentifier,d),viewAddEventRegistration(d,o),viewGetInitialEvents(d,o)}function syncPointRemoveEventRegistration(i,e,o,s){const a=e._queryIdentifier,c=[];let d=[];const h=syncPointHasCompleteView(i);if(a==="default")for(const[g,_]of i.views.entries())d=d.concat(viewRemoveEventRegistration(_,o,s)),viewIsEmpty(_)&&(i.views.delete(g),_.query._queryParams.loadsAllData()||c.push(_.query));else{const g=i.views.get(a);g&&(d=d.concat(viewRemoveEventRegistration(g,o,s)),viewIsEmpty(g)&&(i.views.delete(a),g.query._queryParams.loadsAllData()||c.push(g.query)))}return h&&!syncPointHasCompleteView(i)&&c.push(new(syncPointGetReferenceConstructor())(e._repo,e._path)),{removed:c,events:d}}function syncPointGetQueryViews(i){const e=[];for(const o of i.views.values())o.query._queryParams.loadsAllData()||e.push(o);return e}function syncPointGetCompleteServerCache(i,e){let o=null;for(const s of i.views.values())o=o||viewGetCompleteServerCache(s,e);return o}function syncPointViewForQuery(i,e){if(e._queryParams.loadsAllData())return syncPointGetCompleteView(i);{const s=e._queryIdentifier;return i.views.get(s)}}function syncPointViewExistsForQuery(i,e){return syncPointViewForQuery(i,e)!=null}function syncPointHasCompleteView(i){return syncPointGetCompleteView(i)!=null}function syncPointGetCompleteView(i){for(const e of i.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let referenceConstructor;function syncTreeSetReferenceConstructor(i){assert(!referenceConstructor,"__referenceConstructor has already been defined"),referenceConstructor=i}function syncTreeGetReferenceConstructor(){return assert(referenceConstructor,"Reference.ts has not been loaded"),referenceConstructor}let syncTreeNextQueryTag_=1;class SyncTree{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ImmutableTree(null),this.pendingWriteTree_=newWriteTree(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function syncTreeApplyUserOverwrite(i,e,o,s,a){return writeTreeAddOverwrite(i.pendingWriteTree_,e,o,s,a),a?syncTreeApplyOperationToSyncPoints_(i,new Overwrite(newOperationSourceUser(),e,o)):[]}function syncTreeApplyUserMerge(i,e,o,s){writeTreeAddMerge(i.pendingWriteTree_,e,o,s);const a=ImmutableTree.fromObject(o);return syncTreeApplyOperationToSyncPoints_(i,new Merge(newOperationSourceUser(),e,a))}function syncTreeAckUserWrite(i,e,o=!1){const s=writeTreeGetWrite(i.pendingWriteTree_,e);if(writeTreeRemoveWrite(i.pendingWriteTree_,e)){let c=new ImmutableTree(null);return s.snap!=null?c=c.set(newEmptyPath(),!0):each(s.children,d=>{c=c.set(new Path(d),!0)}),syncTreeApplyOperationToSyncPoints_(i,new AckUserWrite(s.path,c,o))}else return[]}function syncTreeApplyServerOverwrite(i,e,o){return syncTreeApplyOperationToSyncPoints_(i,new Overwrite(newOperationSourceServer(),e,o))}function syncTreeApplyServerMerge(i,e,o){const s=ImmutableTree.fromObject(o);return syncTreeApplyOperationToSyncPoints_(i,new Merge(newOperationSourceServer(),e,s))}function syncTreeApplyListenComplete(i,e){return syncTreeApplyOperationToSyncPoints_(i,new ListenComplete(newOperationSourceServer(),e))}function syncTreeApplyTaggedListenComplete(i,e,o){const s=syncTreeQueryKeyForTag_(i,o);if(s){const a=syncTreeParseQueryKey_(s),c=a.path,d=a.queryId,h=newRelativePath(c,e),g=new ListenComplete(newOperationSourceServerTaggedQuery(d),h);return syncTreeApplyTaggedOperation_(i,c,g)}else return[]}function syncTreeRemoveEventRegistration(i,e,o,s,a=!1){const c=e._path,d=i.syncPointTree_.get(c);let h=[];if(d&&(e._queryIdentifier==="default"||syncPointViewExistsForQuery(d,e))){const g=syncPointRemoveEventRegistration(d,e,o,s);syncPointIsEmpty(d)&&(i.syncPointTree_=i.syncPointTree_.remove(c));const _=g.removed;if(h=g.events,!a){const j=_.findIndex($=>$._queryParams.loadsAllData())!==-1,b=i.syncPointTree_.findOnPath(c,($,nt)=>syncPointHasCompleteView(nt));if(j&&!b){const $=i.syncPointTree_.subtree(c);if(!$.isEmpty()){const nt=syncTreeCollectDistinctViewsForSubTree_($);for(let tt=0;tt<nt.length;++tt){const it=nt[tt],ot=it.query,_e=syncTreeCreateListenerForView_(i,it);i.listenProvider_.startListening(syncTreeQueryForListening_(ot),syncTreeTagForQuery(i,ot),_e.hashFn,_e.onComplete)}}}!b&&_.length>0&&!s&&(j?i.listenProvider_.stopListening(syncTreeQueryForListening_(e),null):_.forEach($=>{const nt=i.queryToTagMap.get(syncTreeMakeQueryKey_($));i.listenProvider_.stopListening(syncTreeQueryForListening_($),nt)}))}syncTreeRemoveTags_(i,_)}return h}function syncTreeApplyTaggedQueryOverwrite(i,e,o,s){const a=syncTreeQueryKeyForTag_(i,s);if(a!=null){const c=syncTreeParseQueryKey_(a),d=c.path,h=c.queryId,g=newRelativePath(d,e),_=new Overwrite(newOperationSourceServerTaggedQuery(h),g,o);return syncTreeApplyTaggedOperation_(i,d,_)}else return[]}function syncTreeApplyTaggedQueryMerge(i,e,o,s){const a=syncTreeQueryKeyForTag_(i,s);if(a){const c=syncTreeParseQueryKey_(a),d=c.path,h=c.queryId,g=newRelativePath(d,e),_=ImmutableTree.fromObject(o),j=new Merge(newOperationSourceServerTaggedQuery(h),g,_);return syncTreeApplyTaggedOperation_(i,d,j)}else return[]}function syncTreeAddEventRegistration(i,e,o,s=!1){const a=e._path;let c=null,d=!1;i.syncPointTree_.foreachOnPath(a,($,nt)=>{const tt=newRelativePath($,a);c=c||syncPointGetCompleteServerCache(nt,tt),d=d||syncPointHasCompleteView(nt)});let h=i.syncPointTree_.get(a);h?(d=d||syncPointHasCompleteView(h),c=c||syncPointGetCompleteServerCache(h,newEmptyPath())):(h=new SyncPoint,i.syncPointTree_=i.syncPointTree_.set(a,h));let g;c!=null?g=!0:(g=!1,c=ChildrenNode.EMPTY_NODE,i.syncPointTree_.subtree(a).foreachChild((nt,tt)=>{const it=syncPointGetCompleteServerCache(tt,newEmptyPath());it&&(c=c.updateImmediateChild(nt,it))}));const _=syncPointViewExistsForQuery(h,e);if(!_&&!e._queryParams.loadsAllData()){const $=syncTreeMakeQueryKey_(e);assert(!i.queryToTagMap.has($),"View does not exist, but we have a tag");const nt=syncTreeGetNextQueryTag_();i.queryToTagMap.set($,nt),i.tagToQueryMap.set(nt,$)}const j=writeTreeChildWrites(i.pendingWriteTree_,a);let b=syncPointAddEventRegistration(h,e,o,j,c,g);if(!_&&!d&&!s){const $=syncPointViewForQuery(h,e);b=b.concat(syncTreeSetupListener_(i,e,$))}return b}function syncTreeCalcCompleteEventCache(i,e,o){const a=i.pendingWriteTree_,c=i.syncPointTree_.findOnPath(e,(d,h)=>{const g=newRelativePath(d,e),_=syncPointGetCompleteServerCache(h,g);if(_)return _});return writeTreeCalcCompleteEventCache(a,e,c,o,!0)}function syncTreeGetServerValue(i,e){const o=e._path;let s=null;i.syncPointTree_.foreachOnPath(o,(_,j)=>{const b=newRelativePath(_,o);s=s||syncPointGetCompleteServerCache(j,b)});let a=i.syncPointTree_.get(o);a?s=s||syncPointGetCompleteServerCache(a,newEmptyPath()):(a=new SyncPoint,i.syncPointTree_=i.syncPointTree_.set(o,a));const c=s!=null,d=c?new CacheNode(s,!0,!1):null,h=writeTreeChildWrites(i.pendingWriteTree_,e._path),g=syncPointGetView(a,e,h,c?d.getNode():ChildrenNode.EMPTY_NODE,c);return viewGetCompleteNode(g)}function syncTreeApplyOperationToSyncPoints_(i,e){return syncTreeApplyOperationHelper_(e,i.syncPointTree_,null,writeTreeChildWrites(i.pendingWriteTree_,newEmptyPath()))}function syncTreeApplyOperationHelper_(i,e,o,s){if(pathIsEmpty(i.path))return syncTreeApplyOperationDescendantsHelper_(i,e,o,s);{const a=e.get(newEmptyPath());o==null&&a!=null&&(o=syncPointGetCompleteServerCache(a,newEmptyPath()));let c=[];const d=pathGetFront(i.path),h=i.operationForChild(d),g=e.children.get(d);if(g&&h){const _=o?o.getImmediateChild(d):null,j=writeTreeRefChild(s,d);c=c.concat(syncTreeApplyOperationHelper_(h,g,_,j))}return a&&(c=c.concat(syncPointApplyOperation(a,i,s,o))),c}}function syncTreeApplyOperationDescendantsHelper_(i,e,o,s){const a=e.get(newEmptyPath());o==null&&a!=null&&(o=syncPointGetCompleteServerCache(a,newEmptyPath()));let c=[];return e.children.inorderTraversal((d,h)=>{const g=o?o.getImmediateChild(d):null,_=writeTreeRefChild(s,d),j=i.operationForChild(d);j&&(c=c.concat(syncTreeApplyOperationDescendantsHelper_(j,h,g,_)))}),a&&(c=c.concat(syncPointApplyOperation(a,i,s,o))),c}function syncTreeCreateListenerForView_(i,e){const o=e.query,s=syncTreeTagForQuery(i,o);return{hashFn:()=>(viewGetServerCache(e)||ChildrenNode.EMPTY_NODE).hash(),onComplete:a=>{if(a==="ok")return s?syncTreeApplyTaggedListenComplete(i,o._path,s):syncTreeApplyListenComplete(i,o._path);{const c=errorForServerCode(a,o);return syncTreeRemoveEventRegistration(i,o,null,c)}}}}function syncTreeTagForQuery(i,e){const o=syncTreeMakeQueryKey_(e);return i.queryToTagMap.get(o)}function syncTreeMakeQueryKey_(i){return i._path.toString()+"$"+i._queryIdentifier}function syncTreeQueryKeyForTag_(i,e){return i.tagToQueryMap.get(e)}function syncTreeParseQueryKey_(i){const e=i.indexOf("$");return assert(e!==-1&&e<i.length-1,"Bad queryKey."),{queryId:i.substr(e+1),path:new Path(i.substr(0,e))}}function syncTreeApplyTaggedOperation_(i,e,o){const s=i.syncPointTree_.get(e);assert(s,"Missing sync point for query tag that we're tracking");const a=writeTreeChildWrites(i.pendingWriteTree_,e);return syncPointApplyOperation(s,o,a,null)}function syncTreeCollectDistinctViewsForSubTree_(i){return i.fold((e,o,s)=>{if(o&&syncPointHasCompleteView(o))return[syncPointGetCompleteView(o)];{let a=[];return o&&(a=syncPointGetQueryViews(o)),each(s,(c,d)=>{a=a.concat(d)}),a}})}function syncTreeQueryForListening_(i){return i._queryParams.loadsAllData()&&!i._queryParams.isDefault()?new(syncTreeGetReferenceConstructor())(i._repo,i._path):i}function syncTreeRemoveTags_(i,e){for(let o=0;o<e.length;++o){const s=e[o];if(!s._queryParams.loadsAllData()){const a=syncTreeMakeQueryKey_(s),c=i.queryToTagMap.get(a);i.queryToTagMap.delete(a),i.tagToQueryMap.delete(c)}}}function syncTreeGetNextQueryTag_(){return syncTreeNextQueryTag_++}function syncTreeSetupListener_(i,e,o){const s=e._path,a=syncTreeTagForQuery(i,e),c=syncTreeCreateListenerForView_(i,o),d=i.listenProvider_.startListening(syncTreeQueryForListening_(e),a,c.hashFn,c.onComplete),h=i.syncPointTree_.subtree(s);if(a)assert(!syncPointHasCompleteView(h.value),"If we're adding a query, it shouldn't be shadowed");else{const g=h.fold((_,j,b)=>{if(!pathIsEmpty(_)&&j&&syncPointHasCompleteView(j))return[syncPointGetCompleteView(j).query];{let $=[];return j&&($=$.concat(syncPointGetQueryViews(j).map(nt=>nt.query))),each(b,(nt,tt)=>{$=$.concat(tt)}),$}});for(let _=0;_<g.length;++_){const j=g[_];i.listenProvider_.stopListening(syncTreeQueryForListening_(j),syncTreeTagForQuery(i,j))}}return d}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ExistingValueProvider{constructor(e){this.node_=e}getImmediateChild(e){const o=this.node_.getImmediateChild(e);return new ExistingValueProvider(o)}node(){return this.node_}}class DeferredValueProvider{constructor(e,o){this.syncTree_=e,this.path_=o}getImmediateChild(e){const o=pathChild(this.path_,e);return new DeferredValueProvider(this.syncTree_,o)}node(){return syncTreeCalcCompleteEventCache(this.syncTree_,this.path_)}}const generateWithValues=function(i){return i=i||{},i.timestamp=i.timestamp||new Date().getTime(),i},resolveDeferredLeafValue=function(i,e,o){if(!i||typeof i!="object")return i;if(assert(".sv"in i,"Unexpected leaf node or priority contents"),typeof i[".sv"]=="string")return resolveScalarDeferredValue(i[".sv"],e,o);if(typeof i[".sv"]=="object")return resolveComplexDeferredValue(i[".sv"],e);assert(!1,"Unexpected server value: "+JSON.stringify(i,null,2))},resolveScalarDeferredValue=function(i,e,o){switch(i){case"timestamp":return o.timestamp;default:assert(!1,"Unexpected server value: "+i)}},resolveComplexDeferredValue=function(i,e,o){i.hasOwnProperty("increment")||assert(!1,"Unexpected server value: "+JSON.stringify(i,null,2));const s=i.increment;typeof s!="number"&&assert(!1,"Unexpected increment value: "+s);const a=e.node();if(assert(a!==null&&typeof a<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!a.isLeafNode())return s;const d=a.getValue();return typeof d!="number"?s:d+s},resolveDeferredValueTree=function(i,e,o,s){return resolveDeferredValue(e,new DeferredValueProvider(o,i),s)},resolveDeferredValueSnapshot=function(i,e,o){return resolveDeferredValue(i,new ExistingValueProvider(e),o)};function resolveDeferredValue(i,e,o){const s=i.getPriority().val(),a=resolveDeferredLeafValue(s,e.getImmediateChild(".priority"),o);let c;if(i.isLeafNode()){const d=i,h=resolveDeferredLeafValue(d.getValue(),e,o);return h!==d.getValue()||a!==d.getPriority().val()?new LeafNode(h,nodeFromJSON(a)):i}else{const d=i;return c=d,a!==d.getPriority().val()&&(c=c.updatePriority(new LeafNode(a))),d.forEachChild(PRIORITY_INDEX,(h,g)=>{const _=resolveDeferredValue(g,e.getImmediateChild(h),o);_!==g&&(c=c.updateImmediateChild(h,_))}),c}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tree{constructor(e="",o=null,s={children:{},childCount:0}){this.name=e,this.parent=o,this.node=s}}function treeSubTree(i,e){let o=e instanceof Path?e:new Path(e),s=i,a=pathGetFront(o);for(;a!==null;){const c=safeGet(s.node.children,a)||{children:{},childCount:0};s=new Tree(a,s,c),o=pathPopFront(o),a=pathGetFront(o)}return s}function treeGetValue(i){return i.node.value}function treeSetValue(i,e){i.node.value=e,treeUpdateParents(i)}function treeHasChildren(i){return i.node.childCount>0}function treeIsEmpty(i){return treeGetValue(i)===void 0&&!treeHasChildren(i)}function treeForEachChild(i,e){each(i.node.children,(o,s)=>{e(new Tree(o,i,s))})}function treeForEachDescendant(i,e,o,s){o&&!s&&e(i),treeForEachChild(i,a=>{treeForEachDescendant(a,e,!0,s)}),o&&s&&e(i)}function treeForEachAncestor(i,e,o){let s=o?i:i.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function treeGetPath(i){return new Path(i.parent===null?i.name:treeGetPath(i.parent)+"/"+i.name)}function treeUpdateParents(i){i.parent!==null&&treeUpdateChild(i.parent,i.name,i)}function treeUpdateChild(i,e,o){const s=treeIsEmpty(o),a=contains(i.node.children,e);s&&a?(delete i.node.children[e],i.node.childCount--,treeUpdateParents(i)):!s&&!a&&(i.node.children[e]=o.node,i.node.childCount++,treeUpdateParents(i))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const INVALID_KEY_REGEX_=/[\[\].#$\/\u0000-\u001F\u007F]/,INVALID_PATH_REGEX_=/[\[\].#$\u0000-\u001F\u007F]/,MAX_LEAF_SIZE_=10*1024*1024,isValidKey=function(i){return typeof i=="string"&&i.length!==0&&!INVALID_KEY_REGEX_.test(i)},isValidPathString=function(i){return typeof i=="string"&&i.length!==0&&!INVALID_PATH_REGEX_.test(i)},isValidRootPathString=function(i){return i&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),isValidPathString(i)},isValidPriority=function(i){return i===null||typeof i=="string"||typeof i=="number"&&!isInvalidJSONNumber(i)||i&&typeof i=="object"&&contains(i,".sv")},validateFirebaseDataArg=function(i,e,o,s){s&&e===void 0||validateFirebaseData(errorPrefix(i,"value"),e,o)},validateFirebaseData=function(i,e,o){const s=o instanceof Path?new ValidationPath(o,i):o;if(e===void 0)throw new Error(i+"contains undefined "+validationPathToErrorString(s));if(typeof e=="function")throw new Error(i+"contains a function "+validationPathToErrorString(s)+" with contents = "+e.toString());if(isInvalidJSONNumber(e))throw new Error(i+"contains "+e.toString()+" "+validationPathToErrorString(s));if(typeof e=="string"&&e.length>MAX_LEAF_SIZE_/3&&stringLength(e)>MAX_LEAF_SIZE_)throw new Error(i+"contains a string greater than "+MAX_LEAF_SIZE_+" utf8 bytes "+validationPathToErrorString(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let a=!1,c=!1;if(each(e,(d,h)=>{if(d===".value")a=!0;else if(d!==".priority"&&d!==".sv"&&(c=!0,!isValidKey(d)))throw new Error(i+" contains an invalid key ("+d+") "+validationPathToErrorString(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);validationPathPush(s,d),validateFirebaseData(i,h,s),validationPathPop(s)}),a&&c)throw new Error(i+' contains ".value" child '+validationPathToErrorString(s)+" in addition to actual children.")}},validateFirebaseMergePaths=function(i,e){let o,s;for(o=0;o<e.length;o++){s=e[o];const c=pathSlice(s);for(let d=0;d<c.length;d++)if(!(c[d]===".priority"&&d===c.length-1)){if(!isValidKey(c[d]))throw new Error(i+"contains an invalid key ("+c[d]+") in path "+s.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(pathCompare);let a=null;for(o=0;o<e.length;o++){if(s=e[o],a!==null&&pathContains(a,s))throw new Error(i+"contains a path "+a.toString()+" that is ancestor of another path "+s.toString());a=s}},validateFirebaseMergeDataArg=function(i,e,o,s){if(s&&e===void 0)return;const a=errorPrefix(i,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(a+" must be an object containing the children to replace.");const c=[];each(e,(d,h)=>{const g=new Path(d);if(validateFirebaseData(a,h,pathChild(o,g)),pathGetBack(g)===".priority"&&!isValidPriority(h))throw new Error(a+"contains an invalid value for '"+g.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");c.push(g)}),validateFirebaseMergePaths(a,c)},validatePriority=function(i,e,o){if(!(o&&e===void 0)){if(isInvalidJSONNumber(e))throw new Error(errorPrefix(i,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!isValidPriority(e))throw new Error(errorPrefix(i,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},validateKey=function(i,e,o,s){if(!(s&&o===void 0)&&!isValidKey(o))throw new Error(errorPrefix(i,e)+'was an invalid key = "'+o+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},validatePathString=function(i,e,o,s){if(!(s&&o===void 0)&&!isValidPathString(o))throw new Error(errorPrefix(i,e)+'was an invalid path = "'+o+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},validateRootPathString=function(i,e,o,s){o&&(o=o.replace(/^\/*\.info(\/|$)/,"/")),validatePathString(i,e,o,s)},validateWritablePath=function(i,e){if(pathGetFront(e)===".info")throw new Error(i+" failed = Can't modify data under /.info/")},validateUrl=function(i,e){const o=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!isValidKey(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||o.length!==0&&!isValidRootPathString(o))throw new Error(errorPrefix(i,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EventQueue{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function eventQueueQueueEvents(i,e){let o=null;for(let s=0;s<e.length;s++){const a=e[s],c=a.getPath();o!==null&&!pathEquals(c,o.path)&&(i.eventLists_.push(o),o=null),o===null&&(o={events:[],path:c}),o.events.push(a)}o&&i.eventLists_.push(o)}function eventQueueRaiseEventsAtPath(i,e,o){eventQueueQueueEvents(i,o),eventQueueRaiseQueuedEventsMatchingPredicate(i,s=>pathEquals(s,e))}function eventQueueRaiseEventsForChangedPath(i,e,o){eventQueueQueueEvents(i,o),eventQueueRaiseQueuedEventsMatchingPredicate(i,s=>pathContains(s,e)||pathContains(e,s))}function eventQueueRaiseQueuedEventsMatchingPredicate(i,e){i.recursionDepth_++;let o=!0;for(let s=0;s<i.eventLists_.length;s++){const a=i.eventLists_[s];if(a){const c=a.path;e(c)?(eventListRaise(i.eventLists_[s]),i.eventLists_[s]=null):o=!1}}o&&(i.eventLists_=[]),i.recursionDepth_--}function eventListRaise(i){for(let e=0;e<i.events.length;e++){const o=i.events[e];if(o!==null){i.events[e]=null;const s=o.getEventRunner();logger&&log("event: "+o.toString()),exceptionGuard(s)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const INTERRUPT_REASON="repo_interrupt",MAX_TRANSACTION_RETRIES=25;class Repo{constructor(e,o,s,a){this.repoInfo_=e,this.forceRestClient_=o,this.authTokenProvider_=s,this.appCheckProvider_=a,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new EventQueue,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=newSparseSnapshotTree(),this.transactionQueueTree_=new Tree,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function repoStart(i,e,o){if(i.stats_=statsManagerGetCollection(i.repoInfo_),i.forceRestClient_||beingCrawled())i.server_=new ReadonlyRestClient(i.repoInfo_,(s,a,c,d)=>{repoOnDataUpdate(i,s,a,c,d)},i.authTokenProvider_,i.appCheckProvider_),setTimeout(()=>repoOnConnectStatus(i,!0),0);else{if(typeof o<"u"&&o!==null){if(typeof o!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{stringify(o)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}i.persistentConnection_=new PersistentConnection(i.repoInfo_,e,(s,a,c,d)=>{repoOnDataUpdate(i,s,a,c,d)},s=>{repoOnConnectStatus(i,s)},s=>{repoOnServerInfoUpdate(i,s)},i.authTokenProvider_,i.appCheckProvider_,o),i.server_=i.persistentConnection_}i.authTokenProvider_.addTokenChangeListener(s=>{i.server_.refreshAuthToken(s)}),i.appCheckProvider_.addTokenChangeListener(s=>{i.server_.refreshAppCheckToken(s.token)}),i.statsReporter_=statsManagerGetOrCreateReporter(i.repoInfo_,()=>new StatsReporter(i.stats_,i.server_)),i.infoData_=new SnapshotHolder,i.infoSyncTree_=new SyncTree({startListening:(s,a,c,d)=>{let h=[];const g=i.infoData_.getNode(s._path);return g.isEmpty()||(h=syncTreeApplyServerOverwrite(i.infoSyncTree_,s._path,g),setTimeout(()=>{d("ok")},0)),h},stopListening:()=>{}}),repoUpdateInfo(i,"connected",!1),i.serverSyncTree_=new SyncTree({startListening:(s,a,c,d)=>(i.server_.listen(s,c,a,(h,g)=>{const _=d(h,g);eventQueueRaiseEventsForChangedPath(i.eventQueue_,s._path,_)}),[]),stopListening:(s,a)=>{i.server_.unlisten(s,a)}})}function repoServerTime(i){const o=i.infoData_.getNode(new Path(".info/serverTimeOffset")).val()||0;return new Date().getTime()+o}function repoGenerateServerValues(i){return generateWithValues({timestamp:repoServerTime(i)})}function repoOnDataUpdate(i,e,o,s,a){i.dataUpdateCount++;const c=new Path(e);o=i.interceptServerDataCallback_?i.interceptServerDataCallback_(e,o):o;let d=[];if(a)if(s){const g=map(o,_=>nodeFromJSON(_));d=syncTreeApplyTaggedQueryMerge(i.serverSyncTree_,c,g,a)}else{const g=nodeFromJSON(o);d=syncTreeApplyTaggedQueryOverwrite(i.serverSyncTree_,c,g,a)}else if(s){const g=map(o,_=>nodeFromJSON(_));d=syncTreeApplyServerMerge(i.serverSyncTree_,c,g)}else{const g=nodeFromJSON(o);d=syncTreeApplyServerOverwrite(i.serverSyncTree_,c,g)}let h=c;d.length>0&&(h=repoRerunTransactions(i,c)),eventQueueRaiseEventsForChangedPath(i.eventQueue_,h,d)}function repoOnConnectStatus(i,e){repoUpdateInfo(i,"connected",e),e===!1&&repoRunOnDisconnectEvents(i)}function repoOnServerInfoUpdate(i,e){each(e,(o,s)=>{repoUpdateInfo(i,o,s)})}function repoUpdateInfo(i,e,o){const s=new Path("/.info/"+e),a=nodeFromJSON(o);i.infoData_.updateSnapshot(s,a);const c=syncTreeApplyServerOverwrite(i.infoSyncTree_,s,a);eventQueueRaiseEventsForChangedPath(i.eventQueue_,s,c)}function repoGetNextWriteId(i){return i.nextWriteId_++}function repoGetValue(i,e,o){const s=syncTreeGetServerValue(i.serverSyncTree_,e);return s!=null?Promise.resolve(s):i.server_.get(e).then(a=>{const c=nodeFromJSON(a).withIndex(e._queryParams.getIndex());syncTreeAddEventRegistration(i.serverSyncTree_,e,o,!0);let d;if(e._queryParams.loadsAllData())d=syncTreeApplyServerOverwrite(i.serverSyncTree_,e._path,c);else{const h=syncTreeTagForQuery(i.serverSyncTree_,e);d=syncTreeApplyTaggedQueryOverwrite(i.serverSyncTree_,e._path,c,h)}return eventQueueRaiseEventsForChangedPath(i.eventQueue_,e._path,d),syncTreeRemoveEventRegistration(i.serverSyncTree_,e,o,null,!0),c},a=>(repoLog(i,"get for query "+stringify(e)+" failed: "+a),Promise.reject(new Error(a))))}function repoSetWithPriority(i,e,o,s,a){repoLog(i,"set",{path:e.toString(),value:o,priority:s});const c=repoGenerateServerValues(i),d=nodeFromJSON(o,s),h=syncTreeCalcCompleteEventCache(i.serverSyncTree_,e),g=resolveDeferredValueSnapshot(d,h,c),_=repoGetNextWriteId(i),j=syncTreeApplyUserOverwrite(i.serverSyncTree_,e,g,_,!0);eventQueueQueueEvents(i.eventQueue_,j),i.server_.put(e.toString(),d.val(!0),($,nt)=>{const tt=$==="ok";tt||warn$1("set at "+e+" failed: "+$);const it=syncTreeAckUserWrite(i.serverSyncTree_,_,!tt);eventQueueRaiseEventsForChangedPath(i.eventQueue_,e,it),repoCallOnCompleteCallback(i,a,$,nt)});const b=repoAbortTransactions(i,e);repoRerunTransactions(i,b),eventQueueRaiseEventsForChangedPath(i.eventQueue_,b,[])}function repoUpdate(i,e,o,s){repoLog(i,"update",{path:e.toString(),value:o});let a=!0;const c=repoGenerateServerValues(i),d={};if(each(o,(h,g)=>{a=!1,d[h]=resolveDeferredValueTree(pathChild(e,h),nodeFromJSON(g),i.serverSyncTree_,c)}),a)log("update() called with empty data.  Don't do anything."),repoCallOnCompleteCallback(i,s,"ok",void 0);else{const h=repoGetNextWriteId(i),g=syncTreeApplyUserMerge(i.serverSyncTree_,e,d,h);eventQueueQueueEvents(i.eventQueue_,g),i.server_.merge(e.toString(),o,(_,j)=>{const b=_==="ok";b||warn$1("update at "+e+" failed: "+_);const $=syncTreeAckUserWrite(i.serverSyncTree_,h,!b),nt=$.length>0?repoRerunTransactions(i,e):e;eventQueueRaiseEventsForChangedPath(i.eventQueue_,nt,$),repoCallOnCompleteCallback(i,s,_,j)}),each(o,_=>{const j=repoAbortTransactions(i,pathChild(e,_));repoRerunTransactions(i,j)}),eventQueueRaiseEventsForChangedPath(i.eventQueue_,e,[])}}function repoRunOnDisconnectEvents(i){repoLog(i,"onDisconnectEvents");const e=repoGenerateServerValues(i),o=newSparseSnapshotTree();sparseSnapshotTreeForEachTree(i.onDisconnect_,newEmptyPath(),(a,c)=>{const d=resolveDeferredValueTree(a,c,i.serverSyncTree_,e);sparseSnapshotTreeRemember(o,a,d)});let s=[];sparseSnapshotTreeForEachTree(o,newEmptyPath(),(a,c)=>{s=s.concat(syncTreeApplyServerOverwrite(i.serverSyncTree_,a,c));const d=repoAbortTransactions(i,a);repoRerunTransactions(i,d)}),i.onDisconnect_=newSparseSnapshotTree(),eventQueueRaiseEventsForChangedPath(i.eventQueue_,newEmptyPath(),s)}function repoOnDisconnectCancel(i,e,o){i.server_.onDisconnectCancel(e.toString(),(s,a)=>{s==="ok"&&sparseSnapshotTreeForget(i.onDisconnect_,e),repoCallOnCompleteCallback(i,o,s,a)})}function repoOnDisconnectSet(i,e,o,s){const a=nodeFromJSON(o);i.server_.onDisconnectPut(e.toString(),a.val(!0),(c,d)=>{c==="ok"&&sparseSnapshotTreeRemember(i.onDisconnect_,e,a),repoCallOnCompleteCallback(i,s,c,d)})}function repoOnDisconnectSetWithPriority(i,e,o,s,a){const c=nodeFromJSON(o,s);i.server_.onDisconnectPut(e.toString(),c.val(!0),(d,h)=>{d==="ok"&&sparseSnapshotTreeRemember(i.onDisconnect_,e,c),repoCallOnCompleteCallback(i,a,d,h)})}function repoOnDisconnectUpdate(i,e,o,s){if(isEmpty(o)){log("onDisconnect().update() called with empty data.  Don't do anything."),repoCallOnCompleteCallback(i,s,"ok",void 0);return}i.server_.onDisconnectMerge(e.toString(),o,(a,c)=>{a==="ok"&&each(o,(d,h)=>{const g=nodeFromJSON(h);sparseSnapshotTreeRemember(i.onDisconnect_,pathChild(e,d),g)}),repoCallOnCompleteCallback(i,s,a,c)})}function repoAddEventCallbackForQuery(i,e,o){let s;pathGetFront(e._path)===".info"?s=syncTreeAddEventRegistration(i.infoSyncTree_,e,o):s=syncTreeAddEventRegistration(i.serverSyncTree_,e,o),eventQueueRaiseEventsAtPath(i.eventQueue_,e._path,s)}function repoRemoveEventCallbackForQuery(i,e,o){let s;pathGetFront(e._path)===".info"?s=syncTreeRemoveEventRegistration(i.infoSyncTree_,e,o):s=syncTreeRemoveEventRegistration(i.serverSyncTree_,e,o),eventQueueRaiseEventsAtPath(i.eventQueue_,e._path,s)}function repoInterrupt(i){i.persistentConnection_&&i.persistentConnection_.interrupt(INTERRUPT_REASON)}function repoResume(i){i.persistentConnection_&&i.persistentConnection_.resume(INTERRUPT_REASON)}function repoLog(i,...e){let o="";i.persistentConnection_&&(o=i.persistentConnection_.id+":"),log(o,...e)}function repoCallOnCompleteCallback(i,e,o,s){e&&exceptionGuard(()=>{if(o==="ok")e(null);else{const a=(o||"error").toUpperCase();let c=a;s&&(c+=": "+s);const d=new Error(c);d.code=a,e(d)}})}function repoStartTransaction(i,e,o,s,a,c){repoLog(i,"transaction on "+e);const d={path:e,update:o,onComplete:s,status:null,order:LUIDGenerator(),applyLocally:c,retryCount:0,unwatcher:a,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},h=repoGetLatestState(i,e,void 0);d.currentInputSnapshot=h;const g=d.update(h.val());if(g===void 0)d.unwatcher(),d.currentOutputSnapshotRaw=null,d.currentOutputSnapshotResolved=null,d.onComplete&&d.onComplete(null,!1,d.currentInputSnapshot);else{validateFirebaseData("transaction failed: Data returned ",g,d.path),d.status=0;const _=treeSubTree(i.transactionQueueTree_,e),j=treeGetValue(_)||[];j.push(d),treeSetValue(_,j);let b;typeof g=="object"&&g!==null&&contains(g,".priority")?(b=safeGet(g,".priority"),assert(isValidPriority(b),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):b=(syncTreeCalcCompleteEventCache(i.serverSyncTree_,e)||ChildrenNode.EMPTY_NODE).getPriority().val();const $=repoGenerateServerValues(i),nt=nodeFromJSON(g,b),tt=resolveDeferredValueSnapshot(nt,h,$);d.currentOutputSnapshotRaw=nt,d.currentOutputSnapshotResolved=tt,d.currentWriteId=repoGetNextWriteId(i);const it=syncTreeApplyUserOverwrite(i.serverSyncTree_,e,tt,d.currentWriteId,d.applyLocally);eventQueueRaiseEventsForChangedPath(i.eventQueue_,e,it),repoSendReadyTransactions(i,i.transactionQueueTree_)}}function repoGetLatestState(i,e,o){return syncTreeCalcCompleteEventCache(i.serverSyncTree_,e,o)||ChildrenNode.EMPTY_NODE}function repoSendReadyTransactions(i,e=i.transactionQueueTree_){if(e||repoPruneCompletedTransactionsBelowNode(i,e),treeGetValue(e)){const o=repoBuildTransactionQueue(i,e);assert(o.length>0,"Sending zero length transaction queue"),o.every(a=>a.status===0)&&repoSendTransactionQueue(i,treeGetPath(e),o)}else treeHasChildren(e)&&treeForEachChild(e,o=>{repoSendReadyTransactions(i,o)})}function repoSendTransactionQueue(i,e,o){const s=o.map(_=>_.currentWriteId),a=repoGetLatestState(i,e,s);let c=a;const d=a.hash();for(let _=0;_<o.length;_++){const j=o[_];assert(j.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),j.status=1,j.retryCount++;const b=newRelativePath(e,j.path);c=c.updateChild(b,j.currentOutputSnapshotRaw)}const h=c.val(!0),g=e;i.server_.put(g.toString(),h,_=>{repoLog(i,"transaction put response",{path:g.toString(),status:_});let j=[];if(_==="ok"){const b=[];for(let $=0;$<o.length;$++)o[$].status=2,j=j.concat(syncTreeAckUserWrite(i.serverSyncTree_,o[$].currentWriteId)),o[$].onComplete&&b.push(()=>o[$].onComplete(null,!0,o[$].currentOutputSnapshotResolved)),o[$].unwatcher();repoPruneCompletedTransactionsBelowNode(i,treeSubTree(i.transactionQueueTree_,e)),repoSendReadyTransactions(i,i.transactionQueueTree_),eventQueueRaiseEventsForChangedPath(i.eventQueue_,e,j);for(let $=0;$<b.length;$++)exceptionGuard(b[$])}else{if(_==="datastale")for(let b=0;b<o.length;b++)o[b].status===3?o[b].status=4:o[b].status=0;else{warn$1("transaction at "+g.toString()+" failed: "+_);for(let b=0;b<o.length;b++)o[b].status=4,o[b].abortReason=_}repoRerunTransactions(i,e)}},d)}function repoRerunTransactions(i,e){const o=repoGetAncestorTransactionNode(i,e),s=treeGetPath(o),a=repoBuildTransactionQueue(i,o);return repoRerunTransactionQueue(i,a,s),s}function repoRerunTransactionQueue(i,e,o){if(e.length===0)return;const s=[];let a=[];const d=e.filter(h=>h.status===0).map(h=>h.currentWriteId);for(let h=0;h<e.length;h++){const g=e[h],_=newRelativePath(o,g.path);let j=!1,b;if(assert(_!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),g.status===4)j=!0,b=g.abortReason,a=a.concat(syncTreeAckUserWrite(i.serverSyncTree_,g.currentWriteId,!0));else if(g.status===0)if(g.retryCount>=MAX_TRANSACTION_RETRIES)j=!0,b="maxretry",a=a.concat(syncTreeAckUserWrite(i.serverSyncTree_,g.currentWriteId,!0));else{const $=repoGetLatestState(i,g.path,d);g.currentInputSnapshot=$;const nt=e[h].update($.val());if(nt!==void 0){validateFirebaseData("transaction failed: Data returned ",nt,g.path);let tt=nodeFromJSON(nt);typeof nt=="object"&&nt!=null&&contains(nt,".priority")||(tt=tt.updatePriority($.getPriority()));const ot=g.currentWriteId,_e=repoGenerateServerValues(i),et=resolveDeferredValueSnapshot(tt,$,_e);g.currentOutputSnapshotRaw=tt,g.currentOutputSnapshotResolved=et,g.currentWriteId=repoGetNextWriteId(i),d.splice(d.indexOf(ot),1),a=a.concat(syncTreeApplyUserOverwrite(i.serverSyncTree_,g.path,et,g.currentWriteId,g.applyLocally)),a=a.concat(syncTreeAckUserWrite(i.serverSyncTree_,ot,!0))}else j=!0,b="nodata",a=a.concat(syncTreeAckUserWrite(i.serverSyncTree_,g.currentWriteId,!0))}eventQueueRaiseEventsForChangedPath(i.eventQueue_,o,a),a=[],j&&(e[h].status=2,function($){setTimeout($,Math.floor(0))}(e[h].unwatcher),e[h].onComplete&&(b==="nodata"?s.push(()=>e[h].onComplete(null,!1,e[h].currentInputSnapshot)):s.push(()=>e[h].onComplete(new Error(b),!1,null))))}repoPruneCompletedTransactionsBelowNode(i,i.transactionQueueTree_);for(let h=0;h<s.length;h++)exceptionGuard(s[h]);repoSendReadyTransactions(i,i.transactionQueueTree_)}function repoGetAncestorTransactionNode(i,e){let o,s=i.transactionQueueTree_;for(o=pathGetFront(e);o!==null&&treeGetValue(s)===void 0;)s=treeSubTree(s,o),e=pathPopFront(e),o=pathGetFront(e);return s}function repoBuildTransactionQueue(i,e){const o=[];return repoAggregateTransactionQueuesForNode(i,e,o),o.sort((s,a)=>s.order-a.order),o}function repoAggregateTransactionQueuesForNode(i,e,o){const s=treeGetValue(e);if(s)for(let a=0;a<s.length;a++)o.push(s[a]);treeForEachChild(e,a=>{repoAggregateTransactionQueuesForNode(i,a,o)})}function repoPruneCompletedTransactionsBelowNode(i,e){const o=treeGetValue(e);if(o){let s=0;for(let a=0;a<o.length;a++)o[a].status!==2&&(o[s]=o[a],s++);o.length=s,treeSetValue(e,o.length>0?o:void 0)}treeForEachChild(e,s=>{repoPruneCompletedTransactionsBelowNode(i,s)})}function repoAbortTransactions(i,e){const o=treeGetPath(repoGetAncestorTransactionNode(i,e)),s=treeSubTree(i.transactionQueueTree_,e);return treeForEachAncestor(s,a=>{repoAbortTransactionsOnNode(i,a)}),repoAbortTransactionsOnNode(i,s),treeForEachDescendant(s,a=>{repoAbortTransactionsOnNode(i,a)}),o}function repoAbortTransactionsOnNode(i,e){const o=treeGetValue(e);if(o){const s=[];let a=[],c=-1;for(let d=0;d<o.length;d++)o[d].status===3||(o[d].status===1?(assert(c===d-1,"All SENT items should be at beginning of queue."),c=d,o[d].status=3,o[d].abortReason="set"):(assert(o[d].status===0,"Unexpected transaction status in abort"),o[d].unwatcher(),a=a.concat(syncTreeAckUserWrite(i.serverSyncTree_,o[d].currentWriteId,!0)),o[d].onComplete&&s.push(o[d].onComplete.bind(null,new Error("set"),!1,null))));c===-1?treeSetValue(e,void 0):o.length=c+1,eventQueueRaiseEventsForChangedPath(i.eventQueue_,treeGetPath(e),a);for(let d=0;d<s.length;d++)exceptionGuard(s[d])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function decodePath(i){let e="";const o=i.split("/");for(let s=0;s<o.length;s++)if(o[s].length>0){let a=o[s];try{a=decodeURIComponent(a.replace(/\+/g," "))}catch{}e+="/"+a}return e}function decodeQuery(i){const e={};i.charAt(0)==="?"&&(i=i.substring(1));for(const o of i.split("&")){if(o.length===0)continue;const s=o.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):warn$1(`Invalid query segment '${o}' in query '${i}'`)}return e}const parseRepoInfo=function(i,e){const o=parseDatabaseURL(i),s=o.namespace;o.domain==="firebase.com"&&fatal(o.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&o.domain!=="localhost"&&fatal("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),o.secure||warnIfPageIsSecure();const a=o.scheme==="ws"||o.scheme==="wss";return{repoInfo:new RepoInfo(o.host,o.secure,s,a,e,"",s!==o.subdomain),path:new Path(o.pathString)}},parseDatabaseURL=function(i){let e="",o="",s="",a="",c="",d=!0,h="https",g=443;if(typeof i=="string"){let _=i.indexOf("//");_>=0&&(h=i.substring(0,_-1),i=i.substring(_+2));let j=i.indexOf("/");j===-1&&(j=i.length);let b=i.indexOf("?");b===-1&&(b=i.length),e=i.substring(0,Math.min(j,b)),j<b&&(a=decodePath(i.substring(j,b)));const $=decodeQuery(i.substring(Math.min(i.length,b)));_=e.indexOf(":"),_>=0?(d=h==="https"||h==="wss",g=parseInt(e.substring(_+1),10)):_=e.length;const nt=e.slice(0,_);if(nt.toLowerCase()==="localhost")o="localhost";else if(nt.split(".").length<=2)o=nt;else{const tt=e.indexOf(".");s=e.substring(0,tt).toLowerCase(),o=e.substring(tt+1),c=s}"ns"in $&&(c=$.ns)}return{host:e,port:g,domain:o,subdomain:s,secure:d,scheme:h,pathString:a,namespace:c}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PUSH_CHARS="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",nextPushId=function(){let i=0;const e=[];return function(o){const s=o===i;i=o;let a;const c=new Array(8);for(a=7;a>=0;a--)c[a]=PUSH_CHARS.charAt(o%64),o=Math.floor(o/64);assert(o===0,"Cannot push at time == 0");let d=c.join("");if(s){for(a=11;a>=0&&e[a]===63;a--)e[a]=0;e[a]++}else for(a=0;a<12;a++)e[a]=Math.floor(Math.random()*64);for(a=0;a<12;a++)d+=PUSH_CHARS.charAt(e[a]);return assert(d.length===20,"nextPushId: Length should be 20."),d}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DataEvent{constructor(e,o,s,a){this.eventType=e,this.eventRegistration=o,this.snapshot=s,this.prevName=a}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+stringify(this.snapshot.exportVal())}}class CancelEvent{constructor(e,o,s){this.eventRegistration=e,this.error=o,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CallbackContext{constructor(e,o){this.snapshotCallback=e,this.cancelCallback=o}onValue(e,o){this.snapshotCallback.call(null,e,o)}onCancel(e){return assert(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let OnDisconnect$1=class{constructor(e,o){this._repo=e,this._path=o}cancel(){const e=new Deferred;return repoOnDisconnectCancel(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){validateWritablePath("OnDisconnect.remove",this._path);const e=new Deferred;return repoOnDisconnectSet(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){validateWritablePath("OnDisconnect.set",this._path),validateFirebaseDataArg("OnDisconnect.set",e,this._path,!1);const o=new Deferred;return repoOnDisconnectSet(this._repo,this._path,e,o.wrapCallback(()=>{})),o.promise}setWithPriority(e,o){validateWritablePath("OnDisconnect.setWithPriority",this._path),validateFirebaseDataArg("OnDisconnect.setWithPriority",e,this._path,!1),validatePriority("OnDisconnect.setWithPriority",o,!1);const s=new Deferred;return repoOnDisconnectSetWithPriority(this._repo,this._path,e,o,s.wrapCallback(()=>{})),s.promise}update(e){validateWritablePath("OnDisconnect.update",this._path),validateFirebaseMergeDataArg("OnDisconnect.update",e,this._path,!1);const o=new Deferred;return repoOnDisconnectUpdate(this._repo,this._path,e,o.wrapCallback(()=>{})),o.promise}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QueryImpl{constructor(e,o,s,a){this._repo=e,this._path=o,this._queryParams=s,this._orderByCalled=a}get key(){return pathIsEmpty(this._path)?null:pathGetBack(this._path)}get ref(){return new ReferenceImpl(this._repo,this._path)}get _queryIdentifier(){const e=queryParamsGetQueryObject(this._queryParams),o=ObjectToUniqueKey(e);return o==="{}"?"default":o}get _queryObject(){return queryParamsGetQueryObject(this._queryParams)}isEqual(e){if(e=getModularInstance(e),!(e instanceof QueryImpl))return!1;const o=this._repo===e._repo,s=pathEquals(this._path,e._path),a=this._queryIdentifier===e._queryIdentifier;return o&&s&&a}toJSON(){return this.toString()}toString(){return this._repo.toString()+pathToUrlEncodedString(this._path)}}function validateNoPreviousOrderByCall(i,e){if(i._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function validateQueryEndpoints(i){let e=null,o=null;if(i.hasStart()&&(e=i.getIndexStartValue()),i.hasEnd()&&(o=i.getIndexEndValue()),i.getIndex()===KEY_INDEX){const s="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",a="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(i.hasStart()){if(i.getIndexStartName()!==MIN_NAME)throw new Error(s);if(typeof e!="string")throw new Error(a)}if(i.hasEnd()){if(i.getIndexEndName()!==MAX_NAME)throw new Error(s);if(typeof o!="string")throw new Error(a)}}else if(i.getIndex()===PRIORITY_INDEX){if(e!=null&&!isValidPriority(e)||o!=null&&!isValidPriority(o))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(assert(i.getIndex()instanceof PathIndex||i.getIndex()===VALUE_INDEX,"unknown index type."),e!=null&&typeof e=="object"||o!=null&&typeof o=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function validateLimit(i){if(i.hasStart()&&i.hasEnd()&&i.hasLimit()&&!i.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class ReferenceImpl extends QueryImpl{constructor(e,o){super(e,o,new QueryParams,!1)}get parent(){const e=pathParent(this._path);return e===null?null:new ReferenceImpl(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}let DataSnapshot$1=class hn{constructor(e,o,s){this._node=e,this.ref=o,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const o=new Path(e),s=child$1(this.ref,e);return new hn(this._node.getChild(o),s,PRIORITY_INDEX)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(s,a)=>e(new hn(a,child$1(this.ref,s),PRIORITY_INDEX)))}hasChild(e){const o=new Path(e);return!this._node.getChild(o).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function ref$2(i,e){return i=getModularInstance(i),i._checkNotDeleted("ref"),e!==void 0?child$1(i._root,e):i._root}function refFromURL$1(i,e){i=getModularInstance(i),i._checkNotDeleted("refFromURL");const o=parseRepoInfo(e,i._repo.repoInfo_.nodeAdmin);validateUrl("refFromURL",o);const s=o.repoInfo;return!i._repo.repoInfo_.isCustomHost()&&s.host!==i._repo.repoInfo_.host&&fatal("refFromURL: Host name does not match the current database: (found "+s.host+" but expected "+i._repo.repoInfo_.host+")"),ref$2(i,o.path.toString())}function child$1(i,e){return i=getModularInstance(i),pathGetFront(i._path)===null?validateRootPathString("child","path",e,!1):validatePathString("child","path",e,!1),new ReferenceImpl(i._repo,pathChild(i._path,e))}function push(i,e){i=getModularInstance(i),validateWritablePath("push",i._path),validateFirebaseDataArg("push",e,i._path,!0);const o=repoServerTime(i._repo),s=nextPushId(o),a=child$1(i,s),c=child$1(i,s);let d;return e!=null?d=set$1(c,e).then(()=>c):d=Promise.resolve(c),a.then=d.then.bind(d),a.catch=d.then.bind(d,void 0),a}function remove(i){return validateWritablePath("remove",i._path),set$1(i,null)}function set$1(i,e){i=getModularInstance(i),validateWritablePath("set",i._path),validateFirebaseDataArg("set",e,i._path,!1);const o=new Deferred;return repoSetWithPriority(i._repo,i._path,e,null,o.wrapCallback(()=>{})),o.promise}function setPriority(i,e){i=getModularInstance(i),validateWritablePath("setPriority",i._path),validatePriority("setPriority",e,!1);const o=new Deferred;return repoSetWithPriority(i._repo,pathChild(i._path,".priority"),e,null,o.wrapCallback(()=>{})),o.promise}function setWithPriority(i,e,o){if(validateWritablePath("setWithPriority",i._path),validateFirebaseDataArg("setWithPriority",e,i._path,!1),validatePriority("setWithPriority",o,!1),i.key===".length"||i.key===".keys")throw"setWithPriority failed: "+i.key+" is a read-only object.";const s=new Deferred;return repoSetWithPriority(i._repo,i._path,e,o,s.wrapCallback(()=>{})),s.promise}function update(i,e){validateFirebaseMergeDataArg("update",e,i._path,!1);const o=new Deferred;return repoUpdate(i._repo,i._path,e,o.wrapCallback(()=>{})),o.promise}function get$1(i){i=getModularInstance(i);const e=new CallbackContext(()=>{}),o=new ValueEventRegistration(e);return repoGetValue(i._repo,i,o).then(s=>new DataSnapshot$1(s,new ReferenceImpl(i._repo,i._path),i._queryParams.getIndex()))}class ValueEventRegistration{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,o){const s=o._queryParams.getIndex();return new DataEvent("value",this,new DataSnapshot$1(e.snapshotNode,new ReferenceImpl(o._repo,o._path),s))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,o){return this.callbackContext.hasCancelCallback?new CancelEvent(this,e,o):null}matches(e){return e instanceof ValueEventRegistration?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class ChildEventRegistration{constructor(e,o){this.eventType=e,this.callbackContext=o}respondsTo(e){let o=e==="children_added"?"child_added":e;return o=o==="children_removed"?"child_removed":o,this.eventType===o}createCancelEvent(e,o){return this.callbackContext.hasCancelCallback?new CancelEvent(this,e,o):null}createEvent(e,o){assert(e.childName!=null,"Child events should have a childName.");const s=child$1(new ReferenceImpl(o._repo,o._path),e.childName),a=o._queryParams.getIndex();return new DataEvent(e.type,this,new DataSnapshot$1(e.snapshotNode,s,a),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof ChildEventRegistration?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function addEventListener$1(i,e,o,s,a){let c;if(typeof s=="object"&&(c=void 0,a=s),typeof s=="function"&&(c=s),a&&a.onlyOnce){const g=o,_=(j,b)=>{repoRemoveEventCallbackForQuery(i._repo,i,h),g(j,b)};_.userCallback=o.userCallback,_.context=o.context,o=_}const d=new CallbackContext(o,c||void 0),h=e==="value"?new ValueEventRegistration(d):new ChildEventRegistration(e,d);return repoAddEventCallbackForQuery(i._repo,i,h),()=>repoRemoveEventCallbackForQuery(i._repo,i,h)}function onValue(i,e,o,s){return addEventListener$1(i,"value",e,o,s)}function onChildAdded(i,e,o,s){return addEventListener$1(i,"child_added",e,o,s)}function onChildChanged(i,e,o,s){return addEventListener$1(i,"child_changed",e,o,s)}function onChildMoved(i,e,o,s){return addEventListener$1(i,"child_moved",e,o,s)}function onChildRemoved(i,e,o,s){return addEventListener$1(i,"child_removed",e,o,s)}function off(i,e,o){let s=null;const a=o?new CallbackContext(o):null;e==="value"?s=new ValueEventRegistration(a):e&&(s=new ChildEventRegistration(e,a)),repoRemoveEventCallbackForQuery(i._repo,i,s)}class QueryConstraint{}class QueryEndAtConstraint extends QueryConstraint{constructor(e,o){super(),this._value=e,this._key=o}_apply(e){validateFirebaseDataArg("endAt",this._value,e._path,!0);const o=queryParamsEndAt(e._queryParams,this._value,this._key);if(validateLimit(o),validateQueryEndpoints(o),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new QueryImpl(e._repo,e._path,o,e._orderByCalled)}}function endAt(i,e){return validateKey("endAt","key",e,!0),new QueryEndAtConstraint(i,e)}class QueryEndBeforeConstraint extends QueryConstraint{constructor(e,o){super(),this._value=e,this._key=o}_apply(e){validateFirebaseDataArg("endBefore",this._value,e._path,!1);const o=queryParamsEndBefore(e._queryParams,this._value,this._key);if(validateLimit(o),validateQueryEndpoints(o),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new QueryImpl(e._repo,e._path,o,e._orderByCalled)}}function endBefore(i,e){return validateKey("endBefore","key",e,!0),new QueryEndBeforeConstraint(i,e)}class QueryStartAtConstraint extends QueryConstraint{constructor(e,o){super(),this._value=e,this._key=o}_apply(e){validateFirebaseDataArg("startAt",this._value,e._path,!0);const o=queryParamsStartAt(e._queryParams,this._value,this._key);if(validateLimit(o),validateQueryEndpoints(o),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new QueryImpl(e._repo,e._path,o,e._orderByCalled)}}function startAt(i=null,e){return validateKey("startAt","key",e,!0),new QueryStartAtConstraint(i,e)}class QueryStartAfterConstraint extends QueryConstraint{constructor(e,o){super(),this._value=e,this._key=o}_apply(e){validateFirebaseDataArg("startAfter",this._value,e._path,!1);const o=queryParamsStartAfter(e._queryParams,this._value,this._key);if(validateLimit(o),validateQueryEndpoints(o),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new QueryImpl(e._repo,e._path,o,e._orderByCalled)}}function startAfter(i,e){return validateKey("startAfter","key",e,!0),new QueryStartAfterConstraint(i,e)}class QueryLimitToFirstConstraint extends QueryConstraint{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new QueryImpl(e._repo,e._path,queryParamsLimitToFirst(e._queryParams,this._limit),e._orderByCalled)}}function limitToFirst(i){if(typeof i!="number"||Math.floor(i)!==i||i<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new QueryLimitToFirstConstraint(i)}class QueryLimitToLastConstraint extends QueryConstraint{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new QueryImpl(e._repo,e._path,queryParamsLimitToLast(e._queryParams,this._limit),e._orderByCalled)}}function limitToLast(i){if(typeof i!="number"||Math.floor(i)!==i||i<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new QueryLimitToLastConstraint(i)}class QueryOrderByChildConstraint extends QueryConstraint{constructor(e){super(),this._path=e}_apply(e){validateNoPreviousOrderByCall(e,"orderByChild");const o=new Path(this._path);if(pathIsEmpty(o))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const s=new PathIndex(o),a=queryParamsOrderBy(e._queryParams,s);return validateQueryEndpoints(a),new QueryImpl(e._repo,e._path,a,!0)}}function orderByChild(i){if(i==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(i==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(i==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return validatePathString("orderByChild","path",i,!1),new QueryOrderByChildConstraint(i)}class QueryOrderByKeyConstraint extends QueryConstraint{_apply(e){validateNoPreviousOrderByCall(e,"orderByKey");const o=queryParamsOrderBy(e._queryParams,KEY_INDEX);return validateQueryEndpoints(o),new QueryImpl(e._repo,e._path,o,!0)}}function orderByKey(){return new QueryOrderByKeyConstraint}class QueryOrderByPriorityConstraint extends QueryConstraint{_apply(e){validateNoPreviousOrderByCall(e,"orderByPriority");const o=queryParamsOrderBy(e._queryParams,PRIORITY_INDEX);return validateQueryEndpoints(o),new QueryImpl(e._repo,e._path,o,!0)}}function orderByPriority(){return new QueryOrderByPriorityConstraint}class QueryOrderByValueConstraint extends QueryConstraint{_apply(e){validateNoPreviousOrderByCall(e,"orderByValue");const o=queryParamsOrderBy(e._queryParams,VALUE_INDEX);return validateQueryEndpoints(o),new QueryImpl(e._repo,e._path,o,!0)}}function orderByValue(){return new QueryOrderByValueConstraint}class QueryEqualToValueConstraint extends QueryConstraint{constructor(e,o){super(),this._value=e,this._key=o}_apply(e){if(validateFirebaseDataArg("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new QueryEndAtConstraint(this._value,this._key)._apply(new QueryStartAtConstraint(this._value,this._key)._apply(e))}}function equalTo(i,e){return validateKey("equalTo","key",e,!0),new QueryEqualToValueConstraint(i,e)}function query(i,...e){let o=getModularInstance(i);for(const s of e)o=s._apply(o);return o}syncPointSetReferenceConstructor(ReferenceImpl);syncTreeSetReferenceConstructor(ReferenceImpl);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FIREBASE_DATABASE_EMULATOR_HOST_VAR="FIREBASE_DATABASE_EMULATOR_HOST",repos={};let useRestClient=!1;function repoManagerApplyEmulatorSettings(i,e,o,s){i.repoInfo_=new RepoInfo(`${e}:${o}`,!1,i.repoInfo_.namespace,i.repoInfo_.webSocketOnly,i.repoInfo_.nodeAdmin,i.repoInfo_.persistenceKey,i.repoInfo_.includeNamespaceInQueryParams,!0),s&&(i.authTokenProvider_=s)}function repoManagerDatabaseFromApp(i,e,o,s,a){let c=s||i.options.databaseURL;c===void 0&&(i.options.projectId||fatal("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),log("Using default host for project ",i.options.projectId),c=`${i.options.projectId}-default-rtdb.firebaseio.com`);let d=parseRepoInfo(c,a),h=d.repoInfo,g,_;typeof process<"u"&&process.env&&(_=process.env[FIREBASE_DATABASE_EMULATOR_HOST_VAR]),_?(g=!0,c=`http://${_}?ns=${h.namespace}`,d=parseRepoInfo(c,a),h=d.repoInfo):g=!d.repoInfo.secure;const j=a&&g?new EmulatorTokenProvider(EmulatorTokenProvider.OWNER):new FirebaseAuthTokenProvider(i.name,i.options,e);validateUrl("Invalid Firebase Database URL",d),pathIsEmpty(d.path)||fatal("Database URL must point to the root of a Firebase Database (not including a child path).");const b=repoManagerCreateRepo(h,i,j,new AppCheckTokenProvider(i.name,o));return new Database$1(b,i)}function repoManagerDeleteRepo(i,e){const o=repos[e];(!o||o[i.key]!==i)&&fatal(`Database ${e}(${i.repoInfo_}) has already been deleted.`),repoInterrupt(i),delete o[i.key]}function repoManagerCreateRepo(i,e,o,s){let a=repos[e.name];a||(a={},repos[e.name]=a);let c=a[i.toURLString()];return c&&fatal("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),c=new Repo(i,useRestClient,o,s),a[i.toURLString()]=c,c}let Database$1=class{constructor(e,o){this._repoInternal=e,this.app=o,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(repoStart(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ReferenceImpl(this._repo,newEmptyPath())),this._rootInternal}_delete(){return this._rootInternal!==null&&(repoManagerDeleteRepo(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&fatal("Cannot call "+e+" on a deleted database.")}};function checkTransportInit(){TransportManager.IS_TRANSPORT_INITIALIZED&&warn$1("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function forceWebSockets(){checkTransportInit(),BrowserPollConnection.forceDisallow()}function forceLongPolling(){checkTransportInit(),WebSocketConnection.forceDisallow(),BrowserPollConnection.forceAllow()}function connectDatabaseEmulator(i,e,o,s={}){i=getModularInstance(i),i._checkNotDeleted("useEmulator"),i._instanceStarted&&fatal("Cannot call useEmulator() after instance has already been initialized.");const a=i._repoInternal;let c;if(a.repoInfo_.nodeAdmin)s.mockUserToken&&fatal('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),c=new EmulatorTokenProvider(EmulatorTokenProvider.OWNER);else if(s.mockUserToken){const d=typeof s.mockUserToken=="string"?s.mockUserToken:createMockUserToken(s.mockUserToken,i.app.options.projectId);c=new EmulatorTokenProvider(d)}repoManagerApplyEmulatorSettings(a,e,o,c)}function goOffline(i){i=getModularInstance(i),i._checkNotDeleted("goOffline"),repoInterrupt(i._repo)}function goOnline(i){i=getModularInstance(i),i._checkNotDeleted("goOnline"),repoResume(i._repo)}function enableLogging(i,e){enableLogging$1(i,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerDatabase$1(i){setSDKVersion(SDK_VERSION$3),_registerComponent(new Component("database",(e,{instanceIdentifier:o})=>{const s=e.getProvider("app").getImmediate(),a=e.getProvider("auth-internal"),c=e.getProvider("app-check-internal");return repoManagerDatabaseFromApp(s,a,c,o)},"PUBLIC").setMultipleInstances(!0)),registerVersion(name$3,version$3,i),registerVersion(name$3,version$3,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SERVER_TIMESTAMP={".sv":"timestamp"};function serverTimestamp(){return SERVER_TIMESTAMP}function increment(i){return{".sv":{increment:i}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TransactionResult$1=class{constructor(e,o){this.committed=e,this.snapshot=o}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function runTransaction(i,e,o){var s;if(i=getModularInstance(i),validateWritablePath("Reference.transaction",i._path),i.key===".length"||i.key===".keys")throw"Reference.transaction failed: "+i.key+" is a read-only object.";const a=(s=o==null?void 0:o.applyLocally)!==null&&s!==void 0?s:!0,c=new Deferred,d=(g,_,j)=>{let b=null;g?c.reject(g):(b=new DataSnapshot$1(j,new ReferenceImpl(i._repo,i._path),PRIORITY_INDEX),c.resolve(new TransactionResult$1(_,b)))},h=onValue(i,()=>{});return repoStartTransaction(i._repo,i._path,e,d,h,a),c.promise}PersistentConnection.prototype.simpleListen=function(i,e){this.sendRequest("q",{p:i},e)};PersistentConnection.prototype.echo=function(i,e){this.sendRequest("echo",{d:i},e)};registerDatabase$1();const name$2="@firebase/database-compat",version$2="0.3.4";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logClient=new Logger("@firebase/database-compat"),warn=function(i){const e="FIREBASE WARNING: "+i;logClient.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const validateBoolean=function(i,e,o,s){if(!(s&&o===void 0)&&typeof o!="boolean")throw new Error(errorPrefix(i,e)+"must be a boolean.")},validateEventType=function(i,e,o){if(!(o&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(errorPrefix(i,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OnDisconnect{constructor(e){this._delegate=e}cancel(e){validateArgCount("OnDisconnect.cancel",0,1,arguments.length),validateCallback("OnDisconnect.cancel","onComplete",e,!0);const o=this._delegate.cancel();return e&&o.then(()=>e(null),s=>e(s)),o}remove(e){validateArgCount("OnDisconnect.remove",0,1,arguments.length),validateCallback("OnDisconnect.remove","onComplete",e,!0);const o=this._delegate.remove();return e&&o.then(()=>e(null),s=>e(s)),o}set(e,o){validateArgCount("OnDisconnect.set",1,2,arguments.length),validateCallback("OnDisconnect.set","onComplete",o,!0);const s=this._delegate.set(e);return o&&s.then(()=>o(null),a=>o(a)),s}setWithPriority(e,o,s){validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),validateCallback("OnDisconnect.setWithPriority","onComplete",s,!0);const a=this._delegate.setWithPriority(e,o);return s&&a.then(()=>s(null),c=>s(c)),a}update(e,o){if(validateArgCount("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const a={};for(let c=0;c<e.length;++c)a[""+c]=e[c];e=a,warn("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}validateCallback("OnDisconnect.update","onComplete",o,!0);const s=this._delegate.update(e);return o&&s.then(()=>o(null),a=>o(a)),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TransactionResult{constructor(e,o){this.committed=e,this.snapshot=o}toJSON(){return validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DataSnapshot{constructor(e,o){this._database=e,this._delegate=o}val(){return validateArgCount("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return validateArgCount("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return validateArgCount("DataSnapshot.child",0,1,arguments.length),e=String(e),validatePathString("DataSnapshot.child","path",e,!1),new DataSnapshot(this._database,this._delegate.child(e))}hasChild(e){return validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),validatePathString("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return validateArgCount("DataSnapshot.forEach",1,1,arguments.length),validateCallback("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(o=>e(new DataSnapshot(this._database,o)))}hasChildren(){return validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return validateArgCount("DataSnapshot.ref",0,0,arguments.length),new Reference$1(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Query{constructor(e,o){this.database=e,this._delegate=o}on(e,o,s,a){var c;validateArgCount("Query.on",2,4,arguments.length),validateCallback("Query.on","callback",o,!1);const d=Query.getCancelAndContextArgs_("Query.on",s,a),h=(_,j)=>{o.call(d.context,new DataSnapshot(this.database,_),j)};h.userCallback=o,h.context=d.context;const g=(c=d.cancel)===null||c===void 0?void 0:c.bind(d.context);switch(e){case"value":return onValue(this._delegate,h,g),o;case"child_added":return onChildAdded(this._delegate,h,g),o;case"child_removed":return onChildRemoved(this._delegate,h,g),o;case"child_changed":return onChildChanged(this._delegate,h,g),o;case"child_moved":return onChildMoved(this._delegate,h,g),o;default:throw new Error(errorPrefix("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,o,s){if(validateArgCount("Query.off",0,3,arguments.length),validateEventType("Query.off",e,!0),validateCallback("Query.off","callback",o,!0),validateContextObject("Query.off","context",s,!0),o){const a=()=>{};a.userCallback=o,a.context=s,off(this._delegate,e,a)}else off(this._delegate,e)}get(){return get$1(this._delegate).then(e=>new DataSnapshot(this.database,e))}once(e,o,s,a){validateArgCount("Query.once",1,4,arguments.length),validateCallback("Query.once","callback",o,!0);const c=Query.getCancelAndContextArgs_("Query.once",s,a),d=new Deferred,h=(_,j)=>{const b=new DataSnapshot(this.database,_);o&&o.call(c.context,b,j),d.resolve(b)};h.userCallback=o,h.context=c.context;const g=_=>{c.cancel&&c.cancel.call(c.context,_),d.reject(_)};switch(e){case"value":onValue(this._delegate,h,g,{onlyOnce:!0});break;case"child_added":onChildAdded(this._delegate,h,g,{onlyOnce:!0});break;case"child_removed":onChildRemoved(this._delegate,h,g,{onlyOnce:!0});break;case"child_changed":onChildChanged(this._delegate,h,g,{onlyOnce:!0});break;case"child_moved":onChildMoved(this._delegate,h,g,{onlyOnce:!0});break;default:throw new Error(errorPrefix("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return d.promise}limitToFirst(e){return validateArgCount("Query.limitToFirst",1,1,arguments.length),new Query(this.database,query(this._delegate,limitToFirst(e)))}limitToLast(e){return validateArgCount("Query.limitToLast",1,1,arguments.length),new Query(this.database,query(this._delegate,limitToLast(e)))}orderByChild(e){return validateArgCount("Query.orderByChild",1,1,arguments.length),new Query(this.database,query(this._delegate,orderByChild(e)))}orderByKey(){return validateArgCount("Query.orderByKey",0,0,arguments.length),new Query(this.database,query(this._delegate,orderByKey()))}orderByPriority(){return validateArgCount("Query.orderByPriority",0,0,arguments.length),new Query(this.database,query(this._delegate,orderByPriority()))}orderByValue(){return validateArgCount("Query.orderByValue",0,0,arguments.length),new Query(this.database,query(this._delegate,orderByValue()))}startAt(e=null,o){return validateArgCount("Query.startAt",0,2,arguments.length),new Query(this.database,query(this._delegate,startAt(e,o)))}startAfter(e=null,o){return validateArgCount("Query.startAfter",0,2,arguments.length),new Query(this.database,query(this._delegate,startAfter(e,o)))}endAt(e=null,o){return validateArgCount("Query.endAt",0,2,arguments.length),new Query(this.database,query(this._delegate,endAt(e,o)))}endBefore(e=null,o){return validateArgCount("Query.endBefore",0,2,arguments.length),new Query(this.database,query(this._delegate,endBefore(e,o)))}equalTo(e,o){return validateArgCount("Query.equalTo",1,2,arguments.length),new Query(this.database,query(this._delegate,equalTo(e,o)))}toString(){return validateArgCount("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return validateArgCount("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(validateArgCount("Query.isEqual",1,1,arguments.length),!(e instanceof Query)){const o="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(o)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,o,s){const a={cancel:void 0,context:void 0};if(o&&s)a.cancel=o,validateCallback(e,"cancel",a.cancel,!0),a.context=s,validateContextObject(e,"context",a.context,!0);else if(o)if(typeof o=="object"&&o!==null)a.context=o;else if(typeof o=="function")a.cancel=o;else throw new Error(errorPrefix(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return a}get ref(){return new Reference$1(this.database,new ReferenceImpl(this._delegate._repo,this._delegate._path))}}let Reference$1=class cn extends Query{constructor(e,o){super(e,new QueryImpl(o._repo,o._path,new QueryParams,!1)),this.database=e,this._delegate=o}getKey(){return validateArgCount("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return validateArgCount("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new cn(this.database,child$1(this._delegate,e))}getParent(){validateArgCount("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new cn(this.database,e):null}getRoot(){return validateArgCount("Reference.root",0,0,arguments.length),new cn(this.database,this._delegate.root)}set(e,o){validateArgCount("Reference.set",1,2,arguments.length),validateCallback("Reference.set","onComplete",o,!0);const s=set$1(this._delegate,e);return o&&s.then(()=>o(null),a=>o(a)),s}update(e,o){if(validateArgCount("Reference.update",1,2,arguments.length),Array.isArray(e)){const a={};for(let c=0;c<e.length;++c)a[""+c]=e[c];e=a,warn("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}validateWritablePath("Reference.update",this._delegate._path),validateCallback("Reference.update","onComplete",o,!0);const s=update(this._delegate,e);return o&&s.then(()=>o(null),a=>o(a)),s}setWithPriority(e,o,s){validateArgCount("Reference.setWithPriority",2,3,arguments.length),validateCallback("Reference.setWithPriority","onComplete",s,!0);const a=setWithPriority(this._delegate,e,o);return s&&a.then(()=>s(null),c=>s(c)),a}remove(e){validateArgCount("Reference.remove",0,1,arguments.length),validateCallback("Reference.remove","onComplete",e,!0);const o=remove(this._delegate);return e&&o.then(()=>e(null),s=>e(s)),o}transaction(e,o,s){validateArgCount("Reference.transaction",1,3,arguments.length),validateCallback("Reference.transaction","transactionUpdate",e,!1),validateCallback("Reference.transaction","onComplete",o,!0),validateBoolean("Reference.transaction","applyLocally",s,!0);const a=runTransaction(this._delegate,e,{applyLocally:s}).then(c=>new TransactionResult(c.committed,new DataSnapshot(this.database,c.snapshot)));return o&&a.then(c=>o(null,c.committed,c.snapshot),c=>o(c,!1,null)),a}setPriority(e,o){validateArgCount("Reference.setPriority",1,2,arguments.length),validateCallback("Reference.setPriority","onComplete",o,!0);const s=setPriority(this._delegate,e);return o&&s.then(()=>o(null),a=>o(a)),s}push(e,o){validateArgCount("Reference.push",0,2,arguments.length),validateCallback("Reference.push","onComplete",o,!0);const s=push(this._delegate,e),a=s.then(d=>new cn(this.database,d));o&&a.then(()=>o(null),d=>o(d));const c=new cn(this.database,s);return c.then=a.then.bind(a),c.catch=a.catch.bind(a,void 0),c}onDisconnect(){return validateWritablePath("Reference.onDisconnect",this._delegate._path),new OnDisconnect(new OnDisconnect$1(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Database{constructor(e,o){this._delegate=e,this.app=o,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets,forceLongPolling}}useEmulator(e,o,s={}){connectDatabaseEmulator(this._delegate,e,o,s)}ref(e){if(validateArgCount("database.ref",0,1,arguments.length),e instanceof Reference$1){const o=refFromURL$1(this._delegate,e.toString());return new Reference$1(this,o)}else{const o=ref$2(this._delegate,e);return new Reference$1(this,o)}}refFromURL(e){validateArgCount("database.refFromURL",1,1,arguments.length);const s=refFromURL$1(this._delegate,e);return new Reference$1(this,s)}goOffline(){return validateArgCount("database.goOffline",0,0,arguments.length),goOffline(this._delegate)}goOnline(){return validateArgCount("database.goOnline",0,0,arguments.length),goOnline(this._delegate)}}Database.ServerValue={TIMESTAMP:serverTimestamp(),increment:i=>increment(i)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function initStandalone({app:i,url:e,version:o,customAuthImpl:s,namespace:a,nodeAdmin:c=!1}){setSDKVersion(o);const d=new Provider("auth-internal",new ComponentContainer("database-standalone"));return d.setComponent(new Component("auth-internal",()=>s,"PRIVATE")),{instance:new Database(repoManagerDatabaseFromApp(i,d,void 0,e,c),i),namespace:a}}var INTERNAL=Object.freeze({__proto__:null,initStandalone});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ServerValue=Database.ServerValue;function registerDatabase(i){i.INTERNAL.registerComponent(new Component("database-compat",(e,{instanceIdentifier:o})=>{const s=e.getProvider("app-compat").getImmediate(),a=e.getProvider("database").getImmediate({identifier:o});return new Database(a,s)},"PUBLIC").setServiceProps({Reference:Reference$1,Query,Database,DataSnapshot,enableLogging,INTERNAL,ServerValue}).setMultipleInstances(!0)),i.registerVersion(name$2,version$2)}registerDatabase(firebase);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_HOST="firebasestorage.googleapis.com",CONFIG_STORAGE_BUCKET_KEY="storageBucket",DEFAULT_MAX_OPERATION_RETRY_TIME=2*60*1e3,DEFAULT_MAX_UPLOAD_RETRY_TIME=10*60*1e3,DEFAULT_MIN_SLEEP_TIME_MILLIS=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StorageError extends FirebaseError{constructor(e,o,s=0){super(prependCode(e),`Firebase Storage: ${o} (${prependCode(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,StorageError.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return prependCode(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var StorageErrorCode;(function(i){i.UNKNOWN="unknown",i.OBJECT_NOT_FOUND="object-not-found",i.BUCKET_NOT_FOUND="bucket-not-found",i.PROJECT_NOT_FOUND="project-not-found",i.QUOTA_EXCEEDED="quota-exceeded",i.UNAUTHENTICATED="unauthenticated",i.UNAUTHORIZED="unauthorized",i.UNAUTHORIZED_APP="unauthorized-app",i.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",i.INVALID_CHECKSUM="invalid-checksum",i.CANCELED="canceled",i.INVALID_EVENT_NAME="invalid-event-name",i.INVALID_URL="invalid-url",i.INVALID_DEFAULT_BUCKET="invalid-default-bucket",i.NO_DEFAULT_BUCKET="no-default-bucket",i.CANNOT_SLICE_BLOB="cannot-slice-blob",i.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",i.NO_DOWNLOAD_URL="no-download-url",i.INVALID_ARGUMENT="invalid-argument",i.INVALID_ARGUMENT_COUNT="invalid-argument-count",i.APP_DELETED="app-deleted",i.INVALID_ROOT_OPERATION="invalid-root-operation",i.INVALID_FORMAT="invalid-format",i.INTERNAL_ERROR="internal-error",i.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(StorageErrorCode||(StorageErrorCode={}));function prependCode(i){return"storage/"+i}function unknown(){const i="An unknown error occurred, please check the error payload for server response.";return new StorageError(StorageErrorCode.UNKNOWN,i)}function objectNotFound(i){return new StorageError(StorageErrorCode.OBJECT_NOT_FOUND,"Object '"+i+"' does not exist.")}function quotaExceeded(i){return new StorageError(StorageErrorCode.QUOTA_EXCEEDED,"Quota for bucket '"+i+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function unauthenticated(){const i="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new StorageError(StorageErrorCode.UNAUTHENTICATED,i)}function unauthorizedApp(){return new StorageError(StorageErrorCode.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function unauthorized(i){return new StorageError(StorageErrorCode.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")}function retryLimitExceeded(){return new StorageError(StorageErrorCode.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function canceled(){return new StorageError(StorageErrorCode.CANCELED,"User canceled the upload/download.")}function invalidUrl(i){return new StorageError(StorageErrorCode.INVALID_URL,"Invalid URL '"+i+"'.")}function invalidDefaultBucket(i){return new StorageError(StorageErrorCode.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.")}function noDefaultBucket(){return new StorageError(StorageErrorCode.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+CONFIG_STORAGE_BUCKET_KEY+"' property when initializing the app?")}function cannotSliceBlob(){return new StorageError(StorageErrorCode.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function serverFileWrongSize(){return new StorageError(StorageErrorCode.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function noDownloadURL(){return new StorageError(StorageErrorCode.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function missingPolyFill(i){return new StorageError(StorageErrorCode.UNSUPPORTED_ENVIRONMENT,`${i} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function invalidArgument(i){return new StorageError(StorageErrorCode.INVALID_ARGUMENT,i)}function appDeleted(){return new StorageError(StorageErrorCode.APP_DELETED,"The Firebase app was deleted.")}function invalidRootOperation(i){return new StorageError(StorageErrorCode.INVALID_ROOT_OPERATION,"The operation '"+i+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function invalidFormat(i,e){return new StorageError(StorageErrorCode.INVALID_FORMAT,"String does not match format '"+i+"': "+e)}function internalError(i){throw new StorageError(StorageErrorCode.INTERNAL_ERROR,"Internal error: "+i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Location{constructor(e,o){this.bucket=e,this.path_=o}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,o){let s;try{s=Location.makeFromUrl(e,o)}catch{return new Location(e,"")}if(s.path==="")return s;throw invalidDefaultBucket(e)}static makeFromUrl(e,o){let s=null;const a="([A-Za-z0-9.\\-_]+)";function c(st){st.path.charAt(st.path.length-1)==="/"&&(st.path_=st.path_.slice(0,-1))}const d="(/(.*))?$",h=new RegExp("^gs://"+a+d,"i"),g={bucket:1,path:3};function _(st){st.path_=decodeURIComponent(st.path)}const j="v[A-Za-z0-9_]+",b=o.replace(/[.]/g,"\\."),$="(/([^?#]*).*)?$",nt=new RegExp(`^https?://${b}/${j}/b/${a}/o${$}`,"i"),tt={bucket:1,path:3},it=o===DEFAULT_HOST?"(?:storage.googleapis.com|storage.cloud.google.com)":o,ot="([^?#]*)",_e=new RegExp(`^https?://${it}/${a}/${ot}`,"i"),rt=[{regex:h,indices:g,postModify:c},{regex:nt,indices:tt,postModify:_},{regex:_e,indices:{bucket:1,path:2},postModify:_}];for(let st=0;st<rt.length;st++){const dt=rt[st],ht=dt.regex.exec(e);if(ht){const mt=ht[dt.indices.bucket];let ft=ht[dt.indices.path];ft||(ft=""),s=new Location(mt,ft),dt.postModify(s);break}}if(s==null)throw invalidUrl(e);return s}}class FailRequest{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function start(i,e,o){let s=1,a=null,c=null,d=!1,h=0;function g(){return h===2}let _=!1;function j(...ot){_||(_=!0,e.apply(null,ot))}function b(ot){a=setTimeout(()=>{a=null,i(nt,g())},ot)}function $(){c&&clearTimeout(c)}function nt(ot,..._e){if(_){$();return}if(ot){$(),j.call(null,ot,..._e);return}if(g()||d){$(),j.call(null,ot,..._e);return}s<64&&(s*=2);let rt;h===1?(h=2,rt=0):rt=(s+Math.random())*1e3,b(rt)}let tt=!1;function it(ot){tt||(tt=!0,$(),!_&&(a!==null?(ot||(h=2),clearTimeout(a),b(0)):ot||(h=1)))}return b(0),c=setTimeout(()=>{d=!0,it(!0)},o),it}function stop(i){i(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isJustDef(i){return i!==void 0}function isFunction$1(i){return typeof i=="function"}function isNonArrayObject(i){return typeof i=="object"&&!Array.isArray(i)}function isString$2(i){return typeof i=="string"||i instanceof String}function isNativeBlob(i){return isNativeBlobDefined()&&i instanceof Blob}function isNativeBlobDefined(){return typeof Blob<"u"&&!isNode()}function validateNumber(i,e,o,s){if(s<e)throw invalidArgument(`Invalid value for '${i}'. Expected ${e} or greater.`);if(s>o)throw invalidArgument(`Invalid value for '${i}'. Expected ${o} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function makeUrl(i,e,o){let s=e;return o==null&&(s=`https://${e}`),`${o}://${s}/v0${i}`}function makeQueryString(i){const e=encodeURIComponent;let o="?";for(const s in i)if(i.hasOwnProperty(s)){const a=e(s)+"="+e(i[s]);o=o+a+"&"}return o=o.slice(0,-1),o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ErrorCode;(function(i){i[i.NO_ERROR=0]="NO_ERROR",i[i.NETWORK_ERROR=1]="NETWORK_ERROR",i[i.ABORT=2]="ABORT"})(ErrorCode||(ErrorCode={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isRetryStatusCode(i,e){const o=i>=500&&i<600,a=[408,429].indexOf(i)!==-1,c=e.indexOf(i)!==-1;return o||a||c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NetworkRequest{constructor(e,o,s,a,c,d,h,g,_,j,b,$=!0){this.url_=e,this.method_=o,this.headers_=s,this.body_=a,this.successCodes_=c,this.additionalRetryCodes_=d,this.callback_=h,this.errorCallback_=g,this.timeout_=_,this.progressCallback_=j,this.connectionFactory_=b,this.retry=$,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((nt,tt)=>{this.resolve_=nt,this.reject_=tt,this.start_()})}start_(){const e=(s,a)=>{if(a){s(!1,new RequestEndStatus(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const d=h=>{const g=h.loaded,_=h.lengthComputable?h.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,_)};this.progressCallback_!==null&&c.addUploadProgressListener(d),c.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&c.removeUploadProgressListener(d),this.pendingConnection_=null;const h=c.getErrorCode()===ErrorCode.NO_ERROR,g=c.getStatus();if(!h||isRetryStatusCode(g,this.additionalRetryCodes_)&&this.retry){const j=c.getErrorCode()===ErrorCode.ABORT;s(!1,new RequestEndStatus(!1,null,j));return}const _=this.successCodes_.indexOf(g)!==-1;s(!0,new RequestEndStatus(_,c))})},o=(s,a)=>{const c=this.resolve_,d=this.reject_,h=a.connection;if(a.wasSuccessCode)try{const g=this.callback_(h,h.getResponse());isJustDef(g)?c(g):c()}catch(g){d(g)}else if(h!==null){const g=unknown();g.serverResponse=h.getErrorText(),this.errorCallback_?d(this.errorCallback_(h,g)):d(g)}else if(a.canceled){const g=this.appDelete_?appDeleted():canceled();d(g)}else{const g=retryLimitExceeded();d(g)}};this.canceled_?o(!1,new RequestEndStatus(!1,null,!0)):this.backoffId_=start(e,o,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&stop(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class RequestEndStatus{constructor(e,o,s){this.wasSuccessCode=e,this.connection=o,this.canceled=!!s}}function addAuthHeader_(i,e){e!==null&&e.length>0&&(i.Authorization="Firebase "+e)}function addVersionHeader_(i,e){i["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function addGmpidHeader_(i,e){e&&(i["X-Firebase-GMPID"]=e)}function addAppCheckHeader_(i,e){e!==null&&(i["X-Firebase-AppCheck"]=e)}function makeRequest(i,e,o,s,a,c,d=!0){const h=makeQueryString(i.urlParams),g=i.url+h,_=Object.assign({},i.headers);return addGmpidHeader_(_,e),addAuthHeader_(_,o),addVersionHeader_(_,c),addAppCheckHeader_(_,s),new NetworkRequest(g,i.method,_,i.body,i.successCodes,i.additionalRetryCodes,i.handler,i.errorHandler,i.timeout,i.progressCallback,a,d)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getBlobBuilder(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function getBlob$1(...i){const e=getBlobBuilder();if(e!==void 0){const o=new e;for(let s=0;s<i.length;s++)o.append(i[s]);return o.getBlob()}else{if(isNativeBlobDefined())return new Blob(i);throw new StorageError(StorageErrorCode.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function sliceBlob(i,e,o){return i.webkitSlice?i.webkitSlice(e,o):i.mozSlice?i.mozSlice(e,o):i.slice?i.slice(e,o):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function decodeBase64(i){if(typeof atob>"u")throw missingPolyFill("base-64");return atob(i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const StringFormat={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class StringData{constructor(e,o){this.data=e,this.contentType=o||null}}function dataFromString(i,e){switch(i){case StringFormat.RAW:return new StringData(utf8Bytes_(e));case StringFormat.BASE64:case StringFormat.BASE64URL:return new StringData(base64Bytes_(i,e));case StringFormat.DATA_URL:return new StringData(dataURLBytes_(e),dataURLContentType_(e))}throw unknown()}function utf8Bytes_(i){const e=[];for(let o=0;o<i.length;o++){let s=i.charCodeAt(o);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(o<i.length-1&&(i.charCodeAt(o+1)&64512)===56320))e.push(239,191,189);else{const c=s,d=i.charCodeAt(++o);s=65536|(c&1023)<<10|d&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function percentEncodedBytes_(i){let e;try{e=decodeURIComponent(i)}catch{throw invalidFormat(StringFormat.DATA_URL,"Malformed data URL.")}return utf8Bytes_(e)}function base64Bytes_(i,e){switch(i){case StringFormat.BASE64:{const a=e.indexOf("-")!==-1,c=e.indexOf("_")!==-1;if(a||c)throw invalidFormat(i,"Invalid character '"+(a?"-":"_")+"' found: is it base64url encoded?");break}case StringFormat.BASE64URL:{const a=e.indexOf("+")!==-1,c=e.indexOf("/")!==-1;if(a||c)throw invalidFormat(i,"Invalid character '"+(a?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let o;try{o=decodeBase64(e)}catch(a){throw a.message.includes("polyfill")?a:invalidFormat(i,"Invalid character found")}const s=new Uint8Array(o.length);for(let a=0;a<o.length;a++)s[a]=o.charCodeAt(a);return s}class DataURLParts{constructor(e){this.base64=!1,this.contentType=null;const o=e.match(/^data:([^,]+)?,/);if(o===null)throw invalidFormat(StringFormat.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=o[1]||null;s!=null&&(this.base64=endsWith(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function dataURLBytes_(i){const e=new DataURLParts(i);return e.base64?base64Bytes_(StringFormat.BASE64,e.rest):percentEncodedBytes_(e.rest)}function dataURLContentType_(i){return new DataURLParts(i).contentType}function endsWith(i,e){return i.length>=e.length?i.substring(i.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FbsBlob{constructor(e,o){let s=0,a="";isNativeBlob(e)?(this.data_=e,s=e.size,a=e.type):e instanceof ArrayBuffer?(o?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(o?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=a}size(){return this.size_}type(){return this.type_}slice(e,o){if(isNativeBlob(this.data_)){const s=this.data_,a=sliceBlob(s,e,o);return a===null?null:new FbsBlob(a)}else{const s=new Uint8Array(this.data_.buffer,e,o-e);return new FbsBlob(s,!0)}}static getBlob(...e){if(isNativeBlobDefined()){const o=e.map(s=>s instanceof FbsBlob?s.data_:s);return new FbsBlob(getBlob$1.apply(null,o))}else{const o=e.map(d=>isString$2(d)?dataFromString(StringFormat.RAW,d).data:d.data_);let s=0;o.forEach(d=>{s+=d.byteLength});const a=new Uint8Array(s);let c=0;return o.forEach(d=>{for(let h=0;h<d.length;h++)a[c++]=d[h]}),new FbsBlob(a,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jsonObjectOrNull(i){let e;try{e=JSON.parse(i)}catch{return null}return isNonArrayObject(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function parent$1(i){if(i.length===0)return null;const e=i.lastIndexOf("/");return e===-1?"":i.slice(0,e)}function child(i,e){const o=e.split("/").filter(s=>s.length>0).join("/");return i.length===0?o:i+"/"+o}function lastComponent(i){const e=i.lastIndexOf("/",i.length-2);return e===-1?i:i.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function noXform_(i,e){return e}class Mapping{constructor(e,o,s,a){this.server=e,this.local=o||e,this.writable=!!s,this.xform=a||noXform_}}let mappings_=null;function xformPath(i){return!isString$2(i)||i.length<2?i:lastComponent(i)}function getMappings(){if(mappings_)return mappings_;const i=[];i.push(new Mapping("bucket")),i.push(new Mapping("generation")),i.push(new Mapping("metageneration")),i.push(new Mapping("name","fullPath",!0));function e(c,d){return xformPath(d)}const o=new Mapping("name");o.xform=e,i.push(o);function s(c,d){return d!==void 0?Number(d):d}const a=new Mapping("size");return a.xform=s,i.push(a),i.push(new Mapping("timeCreated")),i.push(new Mapping("updated")),i.push(new Mapping("md5Hash",null,!0)),i.push(new Mapping("cacheControl",null,!0)),i.push(new Mapping("contentDisposition",null,!0)),i.push(new Mapping("contentEncoding",null,!0)),i.push(new Mapping("contentLanguage",null,!0)),i.push(new Mapping("contentType",null,!0)),i.push(new Mapping("metadata","customMetadata",!0)),mappings_=i,mappings_}function addRef(i,e){function o(){const s=i.bucket,a=i.fullPath,c=new Location(s,a);return e._makeStorageReference(c)}Object.defineProperty(i,"ref",{get:o})}function fromResource(i,e,o){const s={};s.type="file";const a=o.length;for(let c=0;c<a;c++){const d=o[c];s[d.local]=d.xform(s,e[d.server])}return addRef(s,i),s}function fromResourceString(i,e,o){const s=jsonObjectOrNull(e);return s===null?null:fromResource(i,s,o)}function downloadUrlFromResourceString(i,e,o,s){const a=jsonObjectOrNull(e);if(a===null||!isString$2(a.downloadTokens))return null;const c=a.downloadTokens;if(c.length===0)return null;const d=encodeURIComponent;return c.split(",").map(_=>{const j=i.bucket,b=i.fullPath,$="/b/"+d(j)+"/o/"+d(b),nt=makeUrl($,o,s),tt=makeQueryString({alt:"media",token:_});return nt+tt})[0]}function toResourceString(i,e){const o={},s=e.length;for(let a=0;a<s;a++){const c=e[a];c.writable&&(o[c.server]=i[c.local])}return JSON.stringify(o)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PREFIXES_KEY="prefixes",ITEMS_KEY="items";function fromBackendResponse(i,e,o){const s={prefixes:[],items:[],nextPageToken:o.nextPageToken};if(o[PREFIXES_KEY])for(const a of o[PREFIXES_KEY]){const c=a.replace(/\/$/,""),d=i._makeStorageReference(new Location(e,c));s.prefixes.push(d)}if(o[ITEMS_KEY])for(const a of o[ITEMS_KEY]){const c=i._makeStorageReference(new Location(e,a.name));s.items.push(c)}return s}function fromResponseString(i,e,o){const s=jsonObjectOrNull(o);return s===null?null:fromBackendResponse(i,e,s)}class RequestInfo{constructor(e,o,s,a){this.url=e,this.method=o,this.handler=s,this.timeout=a,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function handlerCheck(i){if(!i)throw unknown()}function metadataHandler(i,e){function o(s,a){const c=fromResourceString(i,a,e);return handlerCheck(c!==null),c}return o}function listHandler(i,e){function o(s,a){const c=fromResponseString(i,e,a);return handlerCheck(c!==null),c}return o}function downloadUrlHandler(i,e){function o(s,a){const c=fromResourceString(i,a,e);return handlerCheck(c!==null),downloadUrlFromResourceString(c,a,i.host,i._protocol)}return o}function sharedErrorHandler(i){function e(o,s){let a;return o.getStatus()===401?o.getErrorText().includes("Firebase App Check token is invalid")?a=unauthorizedApp():a=unauthenticated():o.getStatus()===402?a=quotaExceeded(i.bucket):o.getStatus()===403?a=unauthorized(i.path):a=s,a.status=o.getStatus(),a.serverResponse=s.serverResponse,a}return e}function objectErrorHandler(i){const e=sharedErrorHandler(i);function o(s,a){let c=e(s,a);return s.getStatus()===404&&(c=objectNotFound(i.path)),c.serverResponse=a.serverResponse,c}return o}function getMetadata$2(i,e,o){const s=e.fullServerUrl(),a=makeUrl(s,i.host,i._protocol),c="GET",d=i.maxOperationRetryTime,h=new RequestInfo(a,c,metadataHandler(i,o),d);return h.errorHandler=objectErrorHandler(e),h}function list$2(i,e,o,s,a){const c={};e.isRoot?c.prefix="":c.prefix=e.path+"/",o&&o.length>0&&(c.delimiter=o),s&&(c.pageToken=s),a&&(c.maxResults=a);const d=e.bucketOnlyServerUrl(),h=makeUrl(d,i.host,i._protocol),g="GET",_=i.maxOperationRetryTime,j=new RequestInfo(h,g,listHandler(i,e.bucket),_);return j.urlParams=c,j.errorHandler=sharedErrorHandler(e),j}function getDownloadUrl(i,e,o){const s=e.fullServerUrl(),a=makeUrl(s,i.host,i._protocol),c="GET",d=i.maxOperationRetryTime,h=new RequestInfo(a,c,downloadUrlHandler(i,o),d);return h.errorHandler=objectErrorHandler(e),h}function updateMetadata$2(i,e,o,s){const a=e.fullServerUrl(),c=makeUrl(a,i.host,i._protocol),d="PATCH",h=toResourceString(o,s),g={"Content-Type":"application/json; charset=utf-8"},_=i.maxOperationRetryTime,j=new RequestInfo(c,d,metadataHandler(i,s),_);return j.headers=g,j.body=h,j.errorHandler=objectErrorHandler(e),j}function deleteObject$2(i,e){const o=e.fullServerUrl(),s=makeUrl(o,i.host,i._protocol),a="DELETE",c=i.maxOperationRetryTime;function d(g,_){}const h=new RequestInfo(s,a,d,c);return h.successCodes=[200,204],h.errorHandler=objectErrorHandler(e),h}function determineContentType_(i,e){return i&&i.contentType||e&&e.type()||"application/octet-stream"}function metadataForUpload_(i,e,o){const s=Object.assign({},o);return s.fullPath=i.path,s.size=e.size(),s.contentType||(s.contentType=determineContentType_(null,e)),s}function multipartUpload(i,e,o,s,a){const c=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function h(){let rt="";for(let st=0;st<2;st++)rt=rt+Math.random().toString().slice(2);return rt}const g=h();d["Content-Type"]="multipart/related; boundary="+g;const _=metadataForUpload_(e,s,a),j=toResourceString(_,o),b="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+j+`\r
--`+g+`\r
Content-Type: `+_.contentType+`\r
\r
`,$=`\r
--`+g+"--",nt=FbsBlob.getBlob(b,s,$);if(nt===null)throw cannotSliceBlob();const tt={name:_.fullPath},it=makeUrl(c,i.host,i._protocol),ot="POST",_e=i.maxUploadRetryTime,et=new RequestInfo(it,ot,metadataHandler(i,o),_e);return et.urlParams=tt,et.headers=d,et.body=nt.uploadData(),et.errorHandler=sharedErrorHandler(e),et}class ResumableUploadStatus{constructor(e,o,s,a){this.current=e,this.total=o,this.finalized=!!s,this.metadata=a||null}}function checkResumeHeader_(i,e){let o=null;try{o=i.getResponseHeader("X-Goog-Upload-Status")}catch{handlerCheck(!1)}return handlerCheck(!!o&&(e||["active"]).indexOf(o)!==-1),o}function createResumableUpload(i,e,o,s,a){const c=e.bucketOnlyServerUrl(),d=metadataForUpload_(e,s,a),h={name:d.fullPath},g=makeUrl(c,i.host,i._protocol),_="POST",j={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${s.size()}`,"X-Goog-Upload-Header-Content-Type":d.contentType,"Content-Type":"application/json; charset=utf-8"},b=toResourceString(d,o),$=i.maxUploadRetryTime;function nt(it){checkResumeHeader_(it);let ot;try{ot=it.getResponseHeader("X-Goog-Upload-URL")}catch{handlerCheck(!1)}return handlerCheck(isString$2(ot)),ot}const tt=new RequestInfo(g,_,nt,$);return tt.urlParams=h,tt.headers=j,tt.body=b,tt.errorHandler=sharedErrorHandler(e),tt}function getResumableUploadStatus(i,e,o,s){const a={"X-Goog-Upload-Command":"query"};function c(_){const j=checkResumeHeader_(_,["active","final"]);let b=null;try{b=_.getResponseHeader("X-Goog-Upload-Size-Received")}catch{handlerCheck(!1)}b||handlerCheck(!1);const $=Number(b);return handlerCheck(!isNaN($)),new ResumableUploadStatus($,s.size(),j==="final")}const d="POST",h=i.maxUploadRetryTime,g=new RequestInfo(o,d,c,h);return g.headers=a,g.errorHandler=sharedErrorHandler(e),g}const RESUMABLE_UPLOAD_CHUNK_SIZE=256*1024;function continueResumableUpload(i,e,o,s,a,c,d,h){const g=new ResumableUploadStatus(0,0);if(d?(g.current=d.current,g.total=d.total):(g.current=0,g.total=s.size()),s.size()!==g.total)throw serverFileWrongSize();const _=g.total-g.current;let j=_;a>0&&(j=Math.min(j,a));const b=g.current,$=b+j;let nt="";j===0?nt="finalize":_===j?nt="upload, finalize":nt="upload";const tt={"X-Goog-Upload-Command":nt,"X-Goog-Upload-Offset":`${g.current}`},it=s.slice(b,$);if(it===null)throw cannotSliceBlob();function ot(st,dt){const ht=checkResumeHeader_(st,["active","final"]),mt=g.current+j,ft=s.size();let bt;return ht==="final"?bt=metadataHandler(e,c)(st,dt):bt=null,new ResumableUploadStatus(mt,ft,ht==="final",bt)}const _e="POST",et=e.maxUploadRetryTime,rt=new RequestInfo(o,_e,ot,et);return rt.headers=tt,rt.body=it.uploadData(),rt.progressCallback=h||null,rt.errorHandler=sharedErrorHandler(i),rt}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TaskEvent={STATE_CHANGED:"state_changed"},TaskState={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function taskStateFromInternalTaskState(i){switch(i){case"running":case"pausing":case"canceling":return TaskState.RUNNING;case"paused":return TaskState.PAUSED;case"success":return TaskState.SUCCESS;case"canceled":return TaskState.CANCELED;case"error":return TaskState.ERROR;default:return TaskState.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Observer{constructor(e,o,s){if(isFunction$1(e)||o!=null||s!=null)this.next=e,this.error=o??void 0,this.complete=s??void 0;else{const c=e;this.next=c.next,this.error=c.error,this.complete=c.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function async(i){return(...e)=>{Promise.resolve().then(()=>i(...e))}}class XhrConnection{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ErrorCode.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ErrorCode.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ErrorCode.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,o,s,a){if(this.sent_)throw internalError("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(o,e,!0),a!==void 0)for(const c in a)a.hasOwnProperty(c)&&this.xhr_.setRequestHeader(c,a[c].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw internalError("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw internalError("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw internalError("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw internalError("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class XhrTextConnection extends XhrConnection{initXhr(){this.xhr_.responseType="text"}}function newTextConnection(){return new XhrTextConnection}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UploadTask{constructor(e,o,s=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=o,this._metadata=s,this._mappings=getMappings(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=a=>{if(this._request=void 0,this._chunkMultiplier=1,a._codeEquals(StorageErrorCode.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const c=this.isExponentialBackoffExpired();if(isRetryStatusCode(a.status,[]))if(c)a=retryLimitExceeded();else{this.sleepTime=Math.max(this.sleepTime*2,DEFAULT_MIN_SLEEP_TIME_MILLIS),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=a,this._transition("error")}},this._metadataErrorHandler=a=>{this._request=void 0,a._codeEquals(StorageErrorCode.CANCELED)?this.completeTransitions_():(this._error=a,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((a,c)=>{this._resolve=a,this._reject=c,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return o=>this._updateProgress(e+o)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([o,s])=>{switch(this._state){case"running":e(o,s);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,o)=>{const s=createResumableUpload(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),a=this._ref.storage._makeRequest(s,newTextConnection,e,o);this._request=a,a.getPromise().then(c=>{this._request=void 0,this._uploadUrl=c,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((o,s)=>{const a=getResumableUploadStatus(this._ref.storage,this._ref._location,e,this._blob),c=this._ref.storage._makeRequest(a,newTextConnection,o,s);this._request=c,c.getPromise().then(d=>{d=d,this._request=void 0,this._updateProgress(d.current),this._needToFetchStatus=!1,d.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=RESUMABLE_UPLOAD_CHUNK_SIZE*this._chunkMultiplier,o=new ResumableUploadStatus(this._transferred,this._blob.size()),s=this._uploadUrl;this._resolveToken((a,c)=>{let d;try{d=continueResumableUpload(this._ref._location,this._ref.storage,s,this._blob,e,this._mappings,o,this._makeProgressCallback())}catch(g){this._error=g,this._transition("error");return}const h=this._ref.storage._makeRequest(d,newTextConnection,a,c,!1);this._request=h,h.getPromise().then(g=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(g.current),g.finalized?(this._metadata=g.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){RESUMABLE_UPLOAD_CHUNK_SIZE*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,o)=>{const s=getMetadata$2(this._ref.storage,this._ref._location,this._mappings),a=this._ref.storage._makeRequest(s,newTextConnection,e,o);this._request=a,a.getPromise().then(c=>{this._request=void 0,this._metadata=c,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,o)=>{const s=multipartUpload(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),a=this._ref.storage._makeRequest(s,newTextConnection,e,o);this._request=a,a.getPromise().then(c=>{this._request=void 0,this._metadata=c,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const o=this._transferred;this._transferred=e,this._transferred!==o&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const o=this._state==="paused";this._state=e,o&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=canceled(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=taskStateFromInternalTaskState(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,o,s,a){const c=new Observer(o||void 0,s||void 0,a||void 0);return this._addObserver(c),()=>{this._removeObserver(c)}}then(e,o){return this._promise.then(e,o)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const o=this._observers.indexOf(e);o!==-1&&this._observers.splice(o,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(o=>{this._notifyObserver(o)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(taskStateFromInternalTaskState(this._state)){case TaskState.SUCCESS:async(this._resolve.bind(null,this.snapshot))();break;case TaskState.CANCELED:case TaskState.ERROR:const o=this._reject;async(o.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(taskStateFromInternalTaskState(this._state)){case TaskState.RUNNING:case TaskState.PAUSED:e.next&&async(e.next.bind(e,this.snapshot))();break;case TaskState.SUCCESS:e.complete&&async(e.complete.bind(e))();break;case TaskState.CANCELED:case TaskState.ERROR:e.error&&async(e.error.bind(e,this._error))();break;default:e.error&&async(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Reference{constructor(e,o){this._service=e,o instanceof Location?this._location=o:this._location=Location.makeFromUrl(o,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,o){return new Reference(e,o)}get root(){const e=new Location(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return lastComponent(this._location.path)}get storage(){return this._service}get parent(){const e=parent$1(this._location.path);if(e===null)return null;const o=new Location(this._location.bucket,e);return new Reference(this._service,o)}_throwIfRoot(e){if(this._location.path==="")throw invalidRootOperation(e)}}function uploadBytesResumable$1(i,e,o){return i._throwIfRoot("uploadBytesResumable"),new UploadTask(i,new FbsBlob(e),o)}function listAll$1(i){const e={prefixes:[],items:[]};return listAllHelper(i,e).then(()=>e)}async function listAllHelper(i,e,o){const a=await list$1(i,{pageToken:o});e.prefixes.push(...a.prefixes),e.items.push(...a.items),a.nextPageToken!=null&&await listAllHelper(i,e,a.nextPageToken)}function list$1(i,e){e!=null&&typeof e.maxResults=="number"&&validateNumber("options.maxResults",1,1e3,e.maxResults);const o=e||{},s=list$2(i.storage,i._location,"/",o.pageToken,o.maxResults);return i.storage.makeRequestWithTokens(s,newTextConnection)}function getMetadata$1(i){i._throwIfRoot("getMetadata");const e=getMetadata$2(i.storage,i._location,getMappings());return i.storage.makeRequestWithTokens(e,newTextConnection)}function updateMetadata$1(i,e){i._throwIfRoot("updateMetadata");const o=updateMetadata$2(i.storage,i._location,e,getMappings());return i.storage.makeRequestWithTokens(o,newTextConnection)}function getDownloadURL$1(i){i._throwIfRoot("getDownloadURL");const e=getDownloadUrl(i.storage,i._location,getMappings());return i.storage.makeRequestWithTokens(e,newTextConnection).then(o=>{if(o===null)throw noDownloadURL();return o})}function deleteObject$1(i){i._throwIfRoot("deleteObject");const e=deleteObject$2(i.storage,i._location);return i.storage.makeRequestWithTokens(e,newTextConnection)}function _getChild$1(i,e){const o=child(i._location.path,e),s=new Location(i._location.bucket,o);return new Reference(i.storage,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isUrl$1(i){return/^[A-Za-z]+:\/\//.test(i)}function refFromURL(i,e){return new Reference(i,e)}function refFromPath(i,e){if(i instanceof FirebaseStorageImpl){const o=i;if(o._bucket==null)throw noDefaultBucket();const s=new Reference(o,o._bucket);return e!=null?refFromPath(s,e):s}else return e!==void 0?_getChild$1(i,e):i}function ref$1(i,e){if(e&&isUrl$1(e)){if(i instanceof FirebaseStorageImpl)return refFromURL(i,e);throw invalidArgument("To use ref(service, url), the first argument must be a Storage instance.")}else return refFromPath(i,e)}function extractBucket(i,e){const o=e==null?void 0:e[CONFIG_STORAGE_BUCKET_KEY];return o==null?null:Location.makeFromBucketSpec(o,i)}function connectStorageEmulator$1(i,e,o,s={}){i.host=`${e}:${o}`,i._protocol="http";const{mockUserToken:a}=s;a&&(i._overrideAuthToken=typeof a=="string"?a:createMockUserToken(a,i.app.options.projectId))}class FirebaseStorageImpl{constructor(e,o,s,a,c){this.app=e,this._authProvider=o,this._appCheckProvider=s,this._url=a,this._firebaseVersion=c,this._bucket=null,this._host=DEFAULT_HOST,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=DEFAULT_MAX_OPERATION_RETRY_TIME,this._maxUploadRetryTime=DEFAULT_MAX_UPLOAD_RETRY_TIME,this._requests=new Set,a!=null?this._bucket=Location.makeFromBucketSpec(a,this._host):this._bucket=extractBucket(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Location.makeFromBucketSpec(this._url,e):this._bucket=extractBucket(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){validateNumber("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){validateNumber("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const o=await e.getToken();if(o!==null)return o.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Reference(this,e)}_makeRequest(e,o,s,a,c=!0){if(this._deleted)return new FailRequest(appDeleted());{const d=makeRequest(e,this._appId,s,a,o,this._firebaseVersion,c);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,o){const[s,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,o,s,a).getPromise()}}const name$1="@firebase/storage",version$1="0.11.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const STORAGE_TYPE$1="storage";function uploadBytesResumable(i,e,o){return i=getModularInstance(i),uploadBytesResumable$1(i,e,o)}function getMetadata(i){return i=getModularInstance(i),getMetadata$1(i)}function updateMetadata(i,e){return i=getModularInstance(i),updateMetadata$1(i,e)}function list(i,e){return i=getModularInstance(i),list$1(i,e)}function listAll(i){return i=getModularInstance(i),listAll$1(i)}function getDownloadURL(i){return i=getModularInstance(i),getDownloadURL$1(i)}function deleteObject(i){return i=getModularInstance(i),deleteObject$1(i)}function ref(i,e){return i=getModularInstance(i),ref$1(i,e)}function _getChild(i,e){return _getChild$1(i,e)}function connectStorageEmulator(i,e,o,s={}){connectStorageEmulator$1(i,e,o,s)}function factory$1(i,{instanceIdentifier:e}){const o=i.getProvider("app").getImmediate(),s=i.getProvider("auth-internal"),a=i.getProvider("app-check-internal");return new FirebaseStorageImpl(o,s,a,e,SDK_VERSION$3)}function registerStorage$1(){_registerComponent(new Component(STORAGE_TYPE$1,factory$1,"PUBLIC").setMultipleInstances(!0)),registerVersion(name$1,version$1,""),registerVersion(name$1,version$1,"esm2017")}registerStorage$1();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UploadTaskSnapshotCompat{constructor(e,o,s){this._delegate=e,this.task=o,this.ref=s}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UploadTaskCompat{constructor(e,o){this._delegate=e,this._ref=o,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new UploadTaskSnapshotCompat(this._delegate.snapshot,this,this._ref)}then(e,o){return this._delegate.then(s=>{if(e)return e(new UploadTaskSnapshotCompat(s,this,this._ref))},o)}on(e,o,s,a){let c;return o&&(typeof o=="function"?c=d=>o(new UploadTaskSnapshotCompat(d,this,this._ref)):c={next:o.next?d=>o.next(new UploadTaskSnapshotCompat(d,this,this._ref)):void 0,complete:o.complete||void 0,error:o.error||void 0}),this._delegate.on(e,c,s||void 0,a||void 0)}}class ListResultCompat{constructor(e,o){this._delegate=e,this._service=o}get prefixes(){return this._delegate.prefixes.map(e=>new ReferenceCompat(e,this._service))}get items(){return this._delegate.items.map(e=>new ReferenceCompat(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ReferenceCompat{constructor(e,o){this._delegate=e,this.storage=o}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const o=_getChild(this._delegate,e);return new ReferenceCompat(o,this.storage)}get root(){return new ReferenceCompat(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return e==null?null:new ReferenceCompat(e,this.storage)}put(e,o){return this._throwIfRoot("put"),new UploadTaskCompat(uploadBytesResumable(this._delegate,e,o),this)}putString(e,o=StringFormat.RAW,s){this._throwIfRoot("putString");const a=dataFromString(o,e),c=Object.assign({},s);return c.contentType==null&&a.contentType!=null&&(c.contentType=a.contentType),new UploadTaskCompat(new UploadTask(this._delegate,new FbsBlob(a.data,!0),c),this)}listAll(){return listAll(this._delegate).then(e=>new ListResultCompat(e,this.storage))}list(e){return list(this._delegate,e||void 0).then(o=>new ListResultCompat(o,this.storage))}getMetadata(){return getMetadata(this._delegate)}updateMetadata(e){return updateMetadata(this._delegate,e)}getDownloadURL(){return getDownloadURL(this._delegate)}delete(){return this._throwIfRoot("delete"),deleteObject(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw invalidRootOperation(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StorageServiceCompat{constructor(e,o){this.app=e,this._delegate=o}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(isUrl(e))throw invalidArgument("ref() expected a child path but got a URL, use refFromURL instead.");return new ReferenceCompat(ref(this._delegate,e),this)}refFromURL(e){if(!isUrl(e))throw invalidArgument("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Location.makeFromUrl(e,this._delegate.host)}catch{throw invalidArgument("refFromUrl() expected a valid full URL but got an invalid one.")}return new ReferenceCompat(ref(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,o,s={}){connectStorageEmulator(this._delegate,e,o,s)}}function isUrl(i){return/^[A-Za-z]+:\/\//.test(i)}const name="@firebase/storage-compat",version="0.3.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const STORAGE_TYPE="storage-compat";function factory(i,{instanceIdentifier:e}){const o=i.getProvider("app-compat").getImmediate(),s=i.getProvider("storage").getImmediate({identifier:e});return new StorageServiceCompat(o,s)}function registerStorage(i){const e={TaskState,TaskEvent,StringFormat,Storage:StorageServiceCompat,Reference:ReferenceCompat};i.INTERNAL.registerComponent(new Component(STORAGE_TYPE,factory,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),i.registerVersion(name,version)}registerStorage(firebase);const firebaseConfig={apiKey:"AIzaSyBzKwHZ5Qa4NfxeBUn5-KoymCUI1Z0EyXE",authDomain:"pixpair.firebaseapp.com",databaseURL:"https://pixpair-default-rtdb.firebaseio.com",projectId:"pixpair",storageBucket:"pixpair.appspot.com",messagingSenderId:"743134014753",appId:"1:743134014753:web:da56b2391f4eb69a63a260",measurementId:"G-08ST8X93R2"};firebase.apps.length||firebase.initializeApp(firebaseConfig);const auth=firebase.auth(),database=firebase.database(),AuthScreen=({onCreateSession:i,onJoinSession:e,onSignOut:o})=>{const[s,a]=reactExports.useState(""),[c,d]=reactExports.useState(""),[h,g]=reactExports.useState(!1),[_,j]=reactExports.useState(null),[b,$]=reactExports.useState(!1);reactExports.useEffect(()=>{try{const et=new URLSearchParams(window.location.search).get("sessionId");et&&firebase.auth().currentUser?nt(et):et&&localStorage.setItem("pendingSessionId",et)}catch(_e){console.error("Error in session URL processing:",_e),j("Could not process session information from URL.")}},[]),reactExports.useEffect(()=>{try{const _e=localStorage.getItem("pendingSessionId"),et=firebase.auth().currentUser;_e&&et&&(nt(_e),localStorage.removeItem("pendingSessionId"))}catch(_e){console.error("Error checking pending session:",_e)}},[firebase.auth().currentUser]);const nt=async _e=>{if(_e)try{if(j(null),$(!0),!(await firebase.database().ref(`sessions/${_e}`).once("value")).val()){j("Session not found. Please check the ID and try again.");return}const st=firebase.auth().currentUser,dt=st==null?void 0:st.uid;if(!dt){j("You must be signed in to join a session.");return}await firebase.database().ref(`sessions/${_e}/members/${dt}`).set({joinedAt:firebase.database.ServerValue.TIMESTAMP}),typeof e=="function"&&e(_e)}catch(et){console.error("Error joining session:",et),j("Failed to join session. Please try again.")}finally{$(!1)}},tt=async _e=>{_e.preventDefault(),j(null),$(!0);try{if(h?await firebase.auth().createUserWithEmailAndPassword(s,c):await firebase.auth().signInWithEmailAndPassword(s,c),!firebase.auth().currentUser)throw new Error("Authentication succeeded but user is not available.")}catch(et){console.error("Authentication error:",et),j(et.message||"Authentication failed. Please try again.")}finally{$(!1)}},it=async()=>{j(null),$(!0);try{const _e=new firebase.auth.GoogleAuthProvider;if(await firebase.auth().signInWithPopup(_e),!firebase.auth().currentUser)throw new Error("Google authentication succeeded but user is not available.")}catch(_e){console.error("Google auth error:",_e),j(_e.message||"Google sign-in failed. Please try again.")}finally{$(!1)}},ot=async()=>{j(null),$(!0);try{const _e=await firebase.auth().signInAnonymously();if(console.log("Anonymous authentication successful",_e),await new Promise(rt=>setTimeout(rt,1e3)),!firebase.auth().currentUser)throw new Error("Anonymous authentication succeeded but user is not available.")}catch(_e){console.error("Anonymous auth error:",_e),_e.message.includes("PERMISSION_DENIED")?j("Database permission denied. Please check Firebase rules."):j(_e.message||"Guest sign-in failed. Please try again.")}finally{$(!1)}};return jsxRuntimeExports.jsxs("div",{className:"auth-screen",children:[jsxRuntimeExports.jsx("div",{className:"auth-header",children:jsxRuntimeExports.jsx("h1",{children:"PixCrab"})}),jsxRuntimeExports.jsxs("div",{className:"auth-container",children:[_&&jsxRuntimeExports.jsx("div",{className:"error",children:_}),jsxRuntimeExports.jsxs("div",{className:"auth-options",children:[jsxRuntimeExports.jsx("button",{className:"btn btn-google rainbow-button w-full",onClick:it,disabled:b,"aria-label":"Continue with Google",children:"Continue with Google"}),jsxRuntimeExports.jsx("button",{className:"btn btn-text",onClick:ot,disabled:b,"aria-label":"Continue as Guest",children:"Continue as Guest"}),jsxRuntimeExports.jsx("div",{className:"auth-separator",children:jsxRuntimeExports.jsx("span",{children:"or"})})]}),jsxRuntimeExports.jsxs("form",{onSubmit:tt,children:[jsxRuntimeExports.jsx("h2",{children:h?"Create Account":"Sign In"}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"email",children:"Email"}),jsxRuntimeExports.jsx("input",{type:"email",id:"email",name:"email",value:s,onChange:_e=>a(_e.target.value),required:!0,autoComplete:"email","aria-required":"true"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"password",children:"Password"}),jsxRuntimeExports.jsx("input",{type:"password",id:"password",name:"password",value:c,onChange:_e=>d(_e.target.value),required:!0,autoComplete:h?"new-password":"current-password","aria-required":"true"})]}),jsxRuntimeExports.jsx("button",{type:"submit",className:"auth-form-button",disabled:b,children:h?"Sign Up":"Sign In"})]}),jsxRuntimeExports.jsx("button",{className:"btn btn-secondary",onClick:()=>g(!h),disabled:b,children:h?"Already have an account? Sign In":"Need an account? Sign Up"})]})]})},SessionSetup=({onCreateSession:i,onJoinSession:e,onSignOut:o,onViewAlbum:s,initialSessionId:a})=>{const[c,d]=reactExports.useState(""),[h,g]=reactExports.useState(null),[_,j]=reactExports.useState(null),[b,$]=reactExports.useState(""),[nt,tt]=reactExports.useState(null),it=reactExports.useRef(null);reactExports.useEffect(()=>{a&&et(a)},[a]),reactExports.useEffect(()=>{_&&it.current&&rt(_)},[_]),reactExports.useEffect(()=>{const dt=auth.onAuthStateChanged(ht=>tt(ht));return()=>dt()},[]);const ot=async()=>{try{g(null),$("");const dt=firebase.auth().currentUser;if(!dt){setTimeout(()=>{const ht=firebase.auth().currentUser;if(!ht){g("Authentication required. Please sign in before creating a session.");return}_e(ht)},1e3);return}_e(dt)}catch(dt){console.error("Error creating session:",dt),g("Failed to create session. Please try again.")}},_e=async dt=>{try{const ht=Math.random().toString(36).substring(2,8).toUpperCase(),mt=dt.uid;await firebase.database().ref(`/sessions/${ht}`).set({id:ht,owner:mt,created:firebase.database.ServerValue.TIMESTAMP,status:"active"}),await firebase.database().ref(`/sessions/${ht}/members/${mt}`).set(!0),console.log("Session created successfully:",ht),j(ht),typeof i=="function"&&i(ht)}catch(ht){console.error("Error in session creation:",ht),ht.message.includes("PERMISSION_DENIED")?g("Database permission denied. Please check Firebase rules."):g("Failed to create session. Please try again.")}},et=async dt=>{try{g(null),$("");const ht=dt||c;if(!ht){g("Please enter a session ID");return}const mt=firebase.auth().currentUser;if(!mt){g("Authentication required. Please sign in before joining a session.");return}if(!(await firebase.database().ref(`sessions/${ht}`).once("value")).val()){g("Session not found. Please check the ID and try again.");return}const vt=mt.uid;await firebase.database().ref(`sessions/${ht}/members/${vt}`).set({joinedAt:firebase.database.ServerValue.TIMESTAMP}),j(ht),typeof e=="function"&&e(ht)}catch(ht){console.error("Error joining session:",ht),g("Failed to join session. Please try again.")}},rt=dt=>{if(it.current){it.current.innerHTML="";const ht=`${window.location.origin}${window.location.pathname}?sessionId=${dt}`;try{new QRCode(it.current,{text:ht,width:256,height:256,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H})}catch(mt){console.error("Error generating QR code:",mt),it.current&&(it.current.innerHTML='<p style="color: red;">Failed to generate QR code</p>')}}},st=()=>{_&&navigator.clipboard.writeText(_).then(()=>{$("Copied!"),setTimeout(()=>$(""),2e3)}).catch(dt=>{console.error("Failed to copy:",dt),$("Failed to copy")})};return jsxRuntimeExports.jsxs("div",{className:"session-setup pt-20",children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold mt-4",children:nt?nt.isAnonymous?"Hi Crabbie":`Hi ${(nt.displayName||nt.email.split("@")[0]).split(" ")[0]}`:"Welcome"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 mt-2",children:"Create a new session or join an existing one"}),h&&jsxRuntimeExports.jsx("div",{className:"error",children:h}),jsxRuntimeExports.jsxs("div",{className:"session-actions",children:[jsxRuntimeExports.jsx("div",{className:"w-full flex justify-center",children:jsxRuntimeExports.jsx("button",{className:"btn btn-primary rainbow-button",onClick:ot,"aria-label":"Create New Session",style:{width:"100%",maxWidth:"20rem"},children:"Create New Session"})}),jsxRuntimeExports.jsxs("div",{className:"session-join w-full flex flex-col items-center",children:[jsxRuntimeExports.jsx("label",{htmlFor:"sessionId",className:"sr-only",children:"Enter Session ID"}),jsxRuntimeExports.jsx("div",{className:"w-full max-w-xs",children:jsxRuntimeExports.jsx("input",{id:"sessionId",name:"sessionId",type:"text",placeholder:"Enter Session ID",value:c,onChange:dt=>d(dt.target.value),autoComplete:"off","aria-label":"Session ID",className:"w-full p-2 border rounded"})}),jsxRuntimeExports.jsx("div",{className:"w-full flex justify-center",children:jsxRuntimeExports.jsx("button",{className:"album-button w-full max-w-xs",onClick:()=>et(),"aria-label":"Join Session",children:"Join Session"})})]}),jsxRuntimeExports.jsx("div",{className:"w-full flex justify-center mt-4",children:jsxRuntimeExports.jsx("button",{className:"album-button w-full max-w-xs",onClick:s,"aria-label":"View Photo Album",children:"View Photo Album"})})]}),_&&jsxRuntimeExports.jsxs("div",{className:"session-info",children:[jsxRuntimeExports.jsxs("div",{className:"session-id-container",children:[jsxRuntimeExports.jsx("span",{className:"session-id-label",children:"Session ID:"}),jsxRuntimeExports.jsx("span",{className:"session-id",children:_}),jsxRuntimeExports.jsx("button",{className:"btn btn-icon",onClick:st,title:"Copy Session ID","aria-label":"Copy Session ID",children:"Copy"}),b&&jsxRuntimeExports.jsx("span",{className:"copy-status","aria-live":"polite",children:b})]}),jsxRuntimeExports.jsx("p",{children:"Scan this QR code to join the session:"}),jsxRuntimeExports.jsx("div",{className:"qr-code-container",ref:it,"aria-label":"QR code to join session"})]}),jsxRuntimeExports.jsx("button",{className:"btn btn-text",onClick:o,"aria-label":"Sign Out",children:"Sign Out"})]})};function isObject$2(i){return Object.prototype.toString.call(i)==="[object Object]"}function isRecord(i){return isObject$2(i)||Array.isArray(i)}function canUseDOM(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function areOptionsEqual(i,e){const o=Object.keys(i),s=Object.keys(e);if(o.length!==s.length)return!1;const a=JSON.stringify(Object.keys(i.breakpoints||{})),c=JSON.stringify(Object.keys(e.breakpoints||{}));return a!==c?!1:o.every(d=>{const h=i[d],g=e[d];return typeof h=="function"?`${h}`==`${g}`:!isRecord(h)||!isRecord(g)?h===g:areOptionsEqual(h,g)})}function sortAndMapPluginToOptions(i){return i.concat().sort((e,o)=>e.name>o.name?1:-1).map(e=>e.options)}function arePluginsEqual(i,e){if(i.length!==e.length)return!1;const o=sortAndMapPluginToOptions(i),s=sortAndMapPluginToOptions(e);return o.every((a,c)=>{const d=s[c];return areOptionsEqual(a,d)})}function isNumber$1(i){return typeof i=="number"}function isString$1(i){return typeof i=="string"}function isBoolean(i){return typeof i=="boolean"}function isObject$1(i){return Object.prototype.toString.call(i)==="[object Object]"}function mathAbs(i){return Math.abs(i)}function mathSign(i){return Math.sign(i)}function deltaAbs(i,e){return mathAbs(i-e)}function factorAbs(i,e){if(i===0||e===0||mathAbs(i)<=mathAbs(e))return 0;const o=deltaAbs(mathAbs(i),mathAbs(e));return mathAbs(o/i)}function roundToTwoDecimals(i){return Math.round(i*100)/100}function arrayKeys(i){return objectKeys(i).map(Number)}function arrayLast(i){return i[arrayLastIndex(i)]}function arrayLastIndex(i){return Math.max(0,i.length-1)}function arrayIsLastIndex(i,e){return e===arrayLastIndex(i)}function arrayFromNumber(i,e=0){return Array.from(Array(i),(o,s)=>e+s)}function objectKeys(i){return Object.keys(i)}function objectsMergeDeep(i,e){return[i,e].reduce((o,s)=>(objectKeys(s).forEach(a=>{const c=o[a],d=s[a],h=isObject$1(c)&&isObject$1(d);o[a]=h?objectsMergeDeep(c,d):d}),o),{})}function isMouseEvent(i,e){return typeof e.MouseEvent<"u"&&i instanceof e.MouseEvent}function Alignment(i,e){const o={start:s,center:a,end:c};function s(){return 0}function a(g){return c(g)/2}function c(g){return e-g}function d(g,_){return isString$1(i)?o[i](g):i(e,g,_)}return{measure:d}}function EventStore(){let i=[];function e(a,c,d,h={passive:!0}){let g;if("addEventListener"in a)a.addEventListener(c,d,h),g=()=>a.removeEventListener(c,d,h);else{const _=a;_.addListener(d),g=()=>_.removeListener(d)}return i.push(g),s}function o(){i=i.filter(a=>a())}const s={add:e,clear:o};return s}function Animations(i,e,o,s){const a=EventStore(),c=1e3/60;let d=null,h=0,g=0;function _(){a.add(i,"visibilitychange",()=>{i.hidden&&tt()})}function j(){nt(),a.clear()}function b(ot){if(!g)return;d||(d=ot,o(),o());const _e=ot-d;for(d=ot,h+=_e;h>=c;)o(),h-=c;const et=h/c;s(et),g&&(g=e.requestAnimationFrame(b))}function $(){g||(g=e.requestAnimationFrame(b))}function nt(){e.cancelAnimationFrame(g),d=null,h=0,g=0}function tt(){d=null,h=0}return{init:_,destroy:j,start:$,stop:nt,update:o,render:s}}function Axis(i,e){const o=e==="rtl",s=i==="y",a=s?"y":"x",c=s?"x":"y",d=!s&&o?-1:1,h=j(),g=b();function _(tt){const{height:it,width:ot}=tt;return s?it:ot}function j(){return s?"top":o?"right":"left"}function b(){return s?"bottom":o?"left":"right"}function $(tt){return tt*d}return{scroll:a,cross:c,startEdge:h,endEdge:g,measureSize:_,direction:$}}function Limit(i=0,e=0){const o=mathAbs(i-e);function s(_){return _<i}function a(_){return _>e}function c(_){return s(_)||a(_)}function d(_){return c(_)?s(_)?i:e:_}function h(_){return o?_-o*Math.ceil((_-e)/o):_}return{length:o,max:e,min:i,constrain:d,reachedAny:c,reachedMax:a,reachedMin:s,removeOffset:h}}function Counter(i,e,o){const{constrain:s}=Limit(0,i),a=i+1;let c=d(e);function d($){return o?mathAbs((a+$)%a):s($)}function h(){return c}function g($){return c=d($),b}function _($){return j().set(h()+$)}function j(){return Counter(i,h(),o)}const b={get:h,set:g,add:_,clone:j};return b}function DragHandler(i,e,o,s,a,c,d,h,g,_,j,b,$,nt,tt,it,ot,_e,et){const{cross:rt,direction:st}=i,dt=["INPUT","SELECT","TEXTAREA"],ht={passive:!1},mt=EventStore(),ft=EventStore(),bt=Limit(50,225).constrain(nt.measure(20)),vt={mouse:300,touch:400},Et={mouse:500,touch:600},It=tt?43:25;let Rt=!1,Dt=0,Ft=0,Gt=!1,Ht=!1,St=!1,xt=!1;function $t(ct){if(!et)return;function Ct(Tt){(isBoolean(et)||et(ct,Tt))&&lt(Tt)}const Pt=e;mt.add(Pt,"dragstart",Tt=>Tt.preventDefault(),ht).add(Pt,"touchmove",()=>{},ht).add(Pt,"touchend",()=>{}).add(Pt,"touchstart",Ct).add(Pt,"mousedown",Ct).add(Pt,"touchcancel",wt).add(Pt,"contextmenu",wt).add(Pt,"click",jt,!0)}function _t(){mt.clear(),ft.clear()}function ut(){const ct=xt?o:e;ft.add(ct,"touchmove",Mt,ht).add(ct,"touchend",wt).add(ct,"mousemove",Mt,ht).add(ct,"mouseup",wt)}function gt(ct){const Ct=ct.nodeName||"";return dt.includes(Ct)}function yt(){return(tt?Et:vt)[xt?"mouse":"touch"]}function kt(ct,Ct){const Pt=b.add(mathSign(ct)*-1),Tt=j.byDistance(ct,!tt).distance;return tt||mathAbs(ct)<bt?Tt:ot&&Ct?Tt*.5:j.byIndex(Pt.get(),0).distance}function lt(ct){const Ct=isMouseEvent(ct,s);xt=Ct,St=tt&&Ct&&!ct.buttons&&Rt,Rt=deltaAbs(a.get(),d.get())>=2,!(Ct&&ct.button!==0)&&(gt(ct.target)||(Gt=!0,c.pointerDown(ct),_.useFriction(0).useDuration(0),a.set(d),ut(),Dt=c.readPoint(ct),Ft=c.readPoint(ct,rt),$.emit("pointerDown")))}function Mt(ct){if(!isMouseEvent(ct,s)&&ct.touches.length>=2)return wt(ct);const Pt=c.readPoint(ct),Tt=c.readPoint(ct,rt),Ut=deltaAbs(Pt,Dt),Ot=deltaAbs(Tt,Ft);if(!Ht&&!xt&&(!ct.cancelable||(Ht=Ut>Ot,!Ht)))return wt(ct);const Vt=c.pointerMove(ct);Ut>it&&(St=!0),_.useFriction(.3).useDuration(.75),h.start(),a.add(st(Vt)),ct.preventDefault()}function wt(ct){const Pt=j.byDistance(0,!1).index!==b.get(),Tt=c.pointerUp(ct)*yt(),Ut=kt(st(Tt),Pt),Ot=factorAbs(Tt,Ut),Vt=It-10*Ot,Jt=_e+Ot/50;Ht=!1,Gt=!1,ft.clear(),_.useDuration(Vt).useFriction(Jt),g.distance(Ut,!tt),xt=!1,$.emit("pointerUp")}function jt(ct){St&&(ct.stopPropagation(),ct.preventDefault(),St=!1)}function at(){return Gt}return{init:$t,destroy:_t,pointerDown:at}}function DragTracker(i,e){let s,a;function c(b){return b.timeStamp}function d(b,$){const tt=`client${($||i.scroll)==="x"?"X":"Y"}`;return(isMouseEvent(b,e)?b:b.touches[0])[tt]}function h(b){return s=b,a=b,d(b)}function g(b){const $=d(b)-d(a),nt=c(b)-c(s)>170;return a=b,nt&&(s=b),$}function _(b){if(!s||!a)return 0;const $=d(a)-d(s),nt=c(b)-c(s),tt=c(b)-c(a)>170,it=$/nt;return nt&&!tt&&mathAbs(it)>.1?it:0}return{pointerDown:h,pointerMove:g,pointerUp:_,readPoint:d}}function NodeRects(){function i(o){const{offsetTop:s,offsetLeft:a,offsetWidth:c,offsetHeight:d}=o;return{top:s,right:a+c,bottom:s+d,left:a,width:c,height:d}}return{measure:i}}function PercentOfView(i){function e(s){return i*(s/100)}return{measure:e}}function ResizeHandler(i,e,o,s,a,c,d){const h=[i].concat(s);let g,_,j=[],b=!1;function $(ot){return a.measureSize(d.measure(ot))}function nt(ot){if(!c)return;_=$(i),j=s.map($);function _e(et){for(const rt of et){if(b)return;const st=rt.target===i,dt=s.indexOf(rt.target),ht=st?_:j[dt],mt=$(st?i:s[dt]);if(mathAbs(mt-ht)>=.5){ot.reInit(),e.emit("resize");break}}}g=new ResizeObserver(et=>{(isBoolean(c)||c(ot,et))&&_e(et)}),o.requestAnimationFrame(()=>{h.forEach(et=>g.observe(et))})}function tt(){b=!0,g&&g.disconnect()}return{init:nt,destroy:tt}}function ScrollBody(i,e,o,s,a,c){let d=0,h=0,g=a,_=c,j=i.get(),b=0;function $(){const ht=s.get()-i.get(),mt=!g;let ft=0;return mt?(d=0,o.set(s),i.set(s),ft=ht):(o.set(i),d+=ht/g,d*=_,j+=d,i.add(d),ft=j-b),h=mathSign(ft),b=j,dt}function nt(){const ht=s.get()-e.get();return mathAbs(ht)<.001}function tt(){return g}function it(){return h}function ot(){return d}function _e(){return rt(a)}function et(){return st(c)}function rt(ht){return g=ht,dt}function st(ht){return _=ht,dt}const dt={direction:it,duration:tt,velocity:ot,seek:$,settled:nt,useBaseFriction:et,useBaseDuration:_e,useFriction:st,useDuration:rt};return dt}function ScrollBounds(i,e,o,s,a){const c=a.measure(10),d=a.measure(50),h=Limit(.1,.99);let g=!1;function _(){return!(g||!i.reachedAny(o.get())||!i.reachedAny(e.get()))}function j(nt){if(!_())return;const tt=i.reachedMin(e.get())?"min":"max",it=mathAbs(i[tt]-e.get()),ot=o.get()-e.get(),_e=h.constrain(it/d);o.subtract(ot*_e),!nt&&mathAbs(ot)<c&&(o.set(i.constrain(o.get())),s.useDuration(25).useBaseFriction())}function b(nt){g=!nt}return{shouldConstrain:_,constrain:j,toggleActive:b}}function ScrollContain(i,e,o,s,a){const c=Limit(-e+i,0),d=b(),h=j(),g=$();function _(tt,it){return deltaAbs(tt,it)<=1}function j(){const tt=d[0],it=arrayLast(d),ot=d.lastIndexOf(tt),_e=d.indexOf(it)+1;return Limit(ot,_e)}function b(){return o.map((tt,it)=>{const{min:ot,max:_e}=c,et=c.constrain(tt),rt=!it,st=arrayIsLastIndex(o,it);return rt?_e:st||_(ot,et)?ot:_(_e,et)?_e:et}).map(tt=>parseFloat(tt.toFixed(3)))}function $(){if(e<=i+a)return[c.max];if(s==="keepSnaps")return d;const{min:tt,max:it}=h;return d.slice(tt,it)}return{snapsContained:g,scrollContainLimit:h}}function ScrollLimit(i,e,o){const s=e[0],a=o?s-i:arrayLast(e);return{limit:Limit(a,s)}}function ScrollLooper(i,e,o,s){const c=e.min+.1,d=e.max+.1,{reachedMin:h,reachedMax:g}=Limit(c,d);function _($){return $===1?g(o.get()):$===-1?h(o.get()):!1}function j($){if(!_($))return;const nt=i*($*-1);s.forEach(tt=>tt.add(nt))}return{loop:j}}function ScrollProgress(i){const{max:e,length:o}=i;function s(c){const d=c-e;return o?d/-o:0}return{get:s}}function ScrollSnaps(i,e,o,s,a){const{startEdge:c,endEdge:d}=i,{groupSlides:h}=a,g=b().map(e.measure),_=$(),j=nt();function b(){return h(s).map(it=>arrayLast(it)[d]-it[0][c]).map(mathAbs)}function $(){return s.map(it=>o[c]-it[c]).map(it=>-mathAbs(it))}function nt(){return h(_).map(it=>it[0]).map((it,ot)=>it+g[ot])}return{snaps:_,snapsAligned:j}}function SlideRegistry(i,e,o,s,a,c){const{groupSlides:d}=a,{min:h,max:g}=s,_=j();function j(){const $=d(c),nt=!i||e==="keepSnaps";return o.length===1?[c]:nt?$:$.slice(h,g).map((tt,it,ot)=>{const _e=!it,et=arrayIsLastIndex(ot,it);if(_e){const rt=arrayLast(ot[0])+1;return arrayFromNumber(rt)}if(et){const rt=arrayLastIndex(c)-arrayLast(ot)[0]+1;return arrayFromNumber(rt,arrayLast(ot)[0])}return tt})}return{slideRegistry:_}}function ScrollTarget(i,e,o,s,a){const{reachedAny:c,removeOffset:d,constrain:h}=s;function g(tt){return tt.concat().sort((it,ot)=>mathAbs(it)-mathAbs(ot))[0]}function _(tt){const it=i?d(tt):h(tt),ot=e.map((et,rt)=>({diff:j(et-it,0),index:rt})).sort((et,rt)=>mathAbs(et.diff)-mathAbs(rt.diff)),{index:_e}=ot[0];return{index:_e,distance:it}}function j(tt,it){const ot=[tt,tt+o,tt-o];if(!i)return tt;if(!it)return g(ot);const _e=ot.filter(et=>mathSign(et)===it);return _e.length?g(_e):arrayLast(ot)-o}function b(tt,it){const ot=e[tt]-a.get(),_e=j(ot,it);return{index:tt,distance:_e}}function $(tt,it){const ot=a.get()+tt,{index:_e,distance:et}=_(ot),rt=!i&&c(ot);if(!it||rt)return{index:_e,distance:tt};const st=e[_e]-et,dt=tt+j(st,0);return{index:_e,distance:dt}}return{byDistance:$,byIndex:b,shortcut:j}}function ScrollTo(i,e,o,s,a,c,d){function h(b){const $=b.distance,nt=b.index!==e.get();c.add($),$&&(s.duration()?i.start():(i.update(),i.render(1),i.update())),nt&&(o.set(e.get()),e.set(b.index),d.emit("select"))}function g(b,$){const nt=a.byDistance(b,$);h(nt)}function _(b,$){const nt=e.clone().set(b),tt=a.byIndex(nt.get(),$);h(tt)}return{distance:g,index:_}}function SlideFocus(i,e,o,s,a,c,d,h){const g={passive:!0,capture:!0};let _=0;function j(nt){if(!h)return;function tt(it){if(new Date().getTime()-_>10)return;d.emit("slideFocusStart"),i.scrollLeft=0;const et=o.findIndex(rt=>rt.includes(it));isNumber$1(et)&&(a.useDuration(0),s.index(et,0),d.emit("slideFocus"))}c.add(document,"keydown",b,!1),e.forEach((it,ot)=>{c.add(it,"focus",_e=>{(isBoolean(h)||h(nt,_e))&&tt(ot)},g)})}function b(nt){nt.code==="Tab"&&(_=new Date().getTime())}return{init:j}}function Vector1D(i){let e=i;function o(){return e}function s(g){e=d(g)}function a(g){e+=d(g)}function c(g){e-=d(g)}function d(g){return isNumber$1(g)?g:g.get()}return{get:o,set:s,add:a,subtract:c}}function Translate(i,e){const o=i.scroll==="x"?d:h,s=e.style;let a=null,c=!1;function d($){return`translate3d(${$}px,0px,0px)`}function h($){return`translate3d(0px,${$}px,0px)`}function g($){if(c)return;const nt=roundToTwoDecimals(i.direction($));nt!==a&&(s.transform=o(nt),a=nt)}function _($){c=!$}function j(){c||(s.transform="",e.getAttribute("style")||e.removeAttribute("style"))}return{clear:j,to:g,toggleActive:_}}function SlideLooper(i,e,o,s,a,c,d,h,g){const j=arrayKeys(a),b=arrayKeys(a).reverse(),$=_e().concat(et());function nt(mt,ft){return mt.reduce((bt,vt)=>bt-a[vt],ft)}function tt(mt,ft){return mt.reduce((bt,vt)=>nt(bt,ft)>0?bt.concat([vt]):bt,[])}function it(mt){return c.map((ft,bt)=>({start:ft-s[bt]+.5+mt,end:ft+e-.5+mt}))}function ot(mt,ft,bt){const vt=it(ft);return mt.map(Et=>{const It=bt?0:-o,Rt=bt?o:0,Dt=bt?"end":"start",Ft=vt[Et][Dt];return{index:Et,loopPoint:Ft,slideLocation:Vector1D(-1),translate:Translate(i,g[Et]),target:()=>h.get()>Ft?It:Rt}})}function _e(){const mt=d[0],ft=tt(b,mt);return ot(ft,o,!1)}function et(){const mt=e-d[0]-1,ft=tt(j,mt);return ot(ft,-o,!0)}function rt(){return $.every(({index:mt})=>{const ft=j.filter(bt=>bt!==mt);return nt(ft,e)<=.1})}function st(){$.forEach(mt=>{const{target:ft,translate:bt,slideLocation:vt}=mt,Et=ft();Et!==vt.get()&&(bt.to(Et),vt.set(Et))})}function dt(){$.forEach(mt=>mt.translate.clear())}return{canLoop:rt,clear:dt,loop:st,loopPoints:$}}function SlidesHandler(i,e,o){let s,a=!1;function c(g){if(!o)return;function _(j){for(const b of j)if(b.type==="childList"){g.reInit(),e.emit("slidesChanged");break}}s=new MutationObserver(j=>{a||(isBoolean(o)||o(g,j))&&_(j)}),s.observe(i,{childList:!0})}function d(){s&&s.disconnect(),a=!0}return{init:c,destroy:d}}function SlidesInView(i,e,o,s){const a={};let c=null,d=null,h,g=!1;function _(){h=new IntersectionObserver(tt=>{g||(tt.forEach(it=>{const ot=e.indexOf(it.target);a[ot]=it}),c=null,d=null,o.emit("slidesInView"))},{root:i.parentElement,threshold:s}),e.forEach(tt=>h.observe(tt))}function j(){h&&h.disconnect(),g=!0}function b(tt){return objectKeys(a).reduce((it,ot)=>{const _e=parseInt(ot),{isIntersecting:et}=a[_e];return(tt&&et||!tt&&!et)&&it.push(_e),it},[])}function $(tt=!0){if(tt&&c)return c;if(!tt&&d)return d;const it=b(tt);return tt&&(c=it),tt||(d=it),it}return{init:_,destroy:j,get:$}}function SlideSizes(i,e,o,s,a,c){const{measureSize:d,startEdge:h,endEdge:g}=i,_=o[0]&&a,j=tt(),b=it(),$=o.map(d),nt=ot();function tt(){if(!_)return 0;const et=o[0];return mathAbs(e[h]-et[h])}function it(){if(!_)return 0;const et=c.getComputedStyle(arrayLast(s));return parseFloat(et.getPropertyValue(`margin-${g}`))}function ot(){return o.map((et,rt,st)=>{const dt=!rt,ht=arrayIsLastIndex(st,rt);return dt?$[rt]+j:ht?$[rt]+b:st[rt+1][h]-et[h]}).map(mathAbs)}return{slideSizes:$,slideSizesWithGaps:nt,startGap:j,endGap:b}}function SlidesToScroll(i,e,o,s,a,c,d,h,g){const{startEdge:_,endEdge:j,direction:b}=i,$=isNumber$1(o);function nt(_e,et){return arrayKeys(_e).filter(rt=>rt%et===0).map(rt=>_e.slice(rt,rt+et))}function tt(_e){return _e.length?arrayKeys(_e).reduce((et,rt,st)=>{const dt=arrayLast(et)||0,ht=dt===0,mt=rt===arrayLastIndex(_e),ft=a[_]-c[dt][_],bt=a[_]-c[rt][j],vt=!s&&ht?b(d):0,Et=!s&&mt?b(h):0,It=mathAbs(bt-Et-(ft+vt));return st&&It>e+g&&et.push(rt),mt&&et.push(_e.length),et},[]).map((et,rt,st)=>{const dt=Math.max(st[rt-1]||0);return _e.slice(dt,et)}):[]}function it(_e){return $?nt(_e,o):tt(_e)}return{groupSlides:it}}function Engine(i,e,o,s,a,c,d){const{align:h,axis:g,direction:_,startIndex:j,loop:b,duration:$,dragFree:nt,dragThreshold:tt,inViewThreshold:it,slidesToScroll:ot,skipSnaps:_e,containScroll:et,watchResize:rt,watchSlides:st,watchDrag:dt,watchFocus:ht}=c,mt=2,ft=NodeRects(),bt=ft.measure(e),vt=o.map(ft.measure),Et=Axis(g,_),It=Et.measureSize(bt),Rt=PercentOfView(It),Dt=Alignment(h,It),Ft=!b&&!!et,Gt=b||!!et,{slideSizes:Ht,slideSizesWithGaps:St,startGap:xt,endGap:$t}=SlideSizes(Et,bt,vt,o,Gt,a),_t=SlidesToScroll(Et,It,ot,b,bt,vt,xt,$t,mt),{snaps:ut,snapsAligned:gt}=ScrollSnaps(Et,Dt,bt,vt,_t),yt=-arrayLast(ut)+arrayLast(St),{snapsContained:kt,scrollContainLimit:lt}=ScrollContain(It,yt,gt,et,mt),Mt=Ft?kt:gt,{limit:wt}=ScrollLimit(yt,Mt,b),jt=Counter(arrayLastIndex(Mt),j,b),at=jt.clone(),pt=arrayKeys(o),ct=({dragHandler:Yt,scrollBody:tn,scrollBounds:on,options:{loop:qt}})=>{qt||on.constrain(Yt.pointerDown()),tn.seek()},Ct=({scrollBody:Yt,translate:tn,location:on,offsetLocation:qt,previousLocation:en,scrollLooper:nn,slideLooper:an,dragHandler:rn,animation:sn,eventHandler:ln,scrollBounds:un,options:{loop:fn}},pn)=>{const mn=Yt.settled(),_n=!un.shouldConstrain(),gn=fn?mn:mn&&_n,vn=gn&&!rn.pointerDown();vn&&sn.stop();const yn=on.get()*pn+en.get()*(1-pn);qt.set(yn),fn&&(nn.loop(Yt.direction()),an.loop()),tn.to(qt.get()),vn&&ln.emit("settle"),gn||ln.emit("scroll")},Pt=Animations(s,a,()=>ct(Xt),Yt=>Ct(Xt,Yt)),Tt=.68,Ut=Mt[jt.get()],Ot=Vector1D(Ut),Vt=Vector1D(Ut),Jt=Vector1D(Ut),Nt=Vector1D(Ut),Lt=ScrollBody(Ot,Jt,Vt,Nt,$,Tt),zt=ScrollTarget(b,Mt,yt,wt,Nt),Kt=ScrollTo(Pt,jt,at,Lt,zt,Nt,d),Bt=ScrollProgress(wt),Wt=EventStore(),At=SlidesInView(e,o,d,it),{slideRegistry:Qt}=SlideRegistry(Ft,et,Mt,lt,_t,pt),Zt=SlideFocus(i,o,Qt,Kt,Lt,Wt,d,ht),Xt={ownerDocument:s,ownerWindow:a,eventHandler:d,containerRect:bt,slideRects:vt,animation:Pt,axis:Et,dragHandler:DragHandler(Et,i,s,a,Nt,DragTracker(Et,a),Ot,Pt,Kt,Lt,zt,jt,d,Rt,nt,tt,_e,Tt,dt),eventStore:Wt,percentOfView:Rt,index:jt,indexPrevious:at,limit:wt,location:Ot,offsetLocation:Jt,previousLocation:Vt,options:c,resizeHandler:ResizeHandler(e,d,a,o,Et,rt,ft),scrollBody:Lt,scrollBounds:ScrollBounds(wt,Jt,Nt,Lt,Rt),scrollLooper:ScrollLooper(yt,wt,Jt,[Ot,Jt,Vt,Nt]),scrollProgress:Bt,scrollSnapList:Mt.map(Bt.get),scrollSnaps:Mt,scrollTarget:zt,scrollTo:Kt,slideLooper:SlideLooper(Et,It,yt,Ht,St,ut,Mt,Jt,o),slideFocus:Zt,slidesHandler:SlidesHandler(e,d,st),slidesInView:At,slideIndexes:pt,slideRegistry:Qt,slidesToScroll:_t,target:Nt,translate:Translate(Et,e)};return Xt}function EventHandler(){let i={},e;function o(_){e=_}function s(_){return i[_]||[]}function a(_){return s(_).forEach(j=>j(e,_)),g}function c(_,j){return i[_]=s(_).concat([j]),g}function d(_,j){return i[_]=s(_).filter(b=>b!==j),g}function h(){i={}}const g={init:o,emit:a,off:d,on:c,clear:h};return g}const defaultOptions={align:"center",axis:"x",container:null,slides:null,containScroll:"trimSnaps",direction:"ltr",slidesToScroll:1,inViewThreshold:0,breakpoints:{},dragFree:!1,dragThreshold:10,loop:!1,skipSnaps:!1,duration:25,startIndex:0,active:!0,watchDrag:!0,watchResize:!0,watchSlides:!0,watchFocus:!0};function OptionsHandler(i){function e(c,d){return objectsMergeDeep(c,d||{})}function o(c){const d=c.breakpoints||{},h=objectKeys(d).filter(g=>i.matchMedia(g).matches).map(g=>d[g]).reduce((g,_)=>e(g,_),{});return e(c,h)}function s(c){return c.map(d=>objectKeys(d.breakpoints||{})).reduce((d,h)=>d.concat(h),[]).map(i.matchMedia)}return{mergeOptions:e,optionsAtMedia:o,optionsMediaQueries:s}}function PluginsHandler(i){let e=[];function o(c,d){return e=d.filter(({options:h})=>i.optionsAtMedia(h).active!==!1),e.forEach(h=>h.init(c,i)),d.reduce((h,g)=>Object.assign(h,{[g.name]:g}),{})}function s(){e=e.filter(c=>c.destroy())}return{init:o,destroy:s}}function EmblaCarousel(i,e,o){const s=i.ownerDocument,a=s.defaultView,c=OptionsHandler(a),d=PluginsHandler(c),h=EventStore(),g=EventHandler(),{mergeOptions:_,optionsAtMedia:j,optionsMediaQueries:b}=c,{on:$,off:nt,emit:tt}=g,it=Et;let ot=!1,_e,et=_(defaultOptions,EmblaCarousel.globalOptions),rt=_(et),st=[],dt,ht,mt;function ft(){const{container:pt,slides:ct}=rt;ht=(isString$1(pt)?i.querySelector(pt):pt)||i.children[0];const Pt=isString$1(ct)?ht.querySelectorAll(ct):ct;mt=[].slice.call(Pt||ht.children)}function bt(pt){const ct=Engine(i,ht,mt,s,a,pt,g);if(pt.loop&&!ct.slideLooper.canLoop()){const Ct=Object.assign({},pt,{loop:!1});return bt(Ct)}return ct}function vt(pt,ct){ot||(et=_(et,pt),rt=j(et),st=ct||st,ft(),_e=bt(rt),b([et,...st.map(({options:Ct})=>Ct)]).forEach(Ct=>h.add(Ct,"change",Et)),rt.active&&(_e.translate.to(_e.location.get()),_e.animation.init(),_e.slidesInView.init(),_e.slideFocus.init(at),_e.eventHandler.init(at),_e.resizeHandler.init(at),_e.slidesHandler.init(at),_e.options.loop&&_e.slideLooper.loop(),ht.offsetParent&&mt.length&&_e.dragHandler.init(at),dt=d.init(at,st)))}function Et(pt,ct){const Ct=_t();It(),vt(_({startIndex:Ct},pt),ct),g.emit("reInit")}function It(){_e.dragHandler.destroy(),_e.eventStore.clear(),_e.translate.clear(),_e.slideLooper.clear(),_e.resizeHandler.destroy(),_e.slidesHandler.destroy(),_e.slidesInView.destroy(),_e.animation.destroy(),d.destroy(),h.clear()}function Rt(){ot||(ot=!0,h.clear(),It(),g.emit("destroy"),g.clear())}function Dt(pt,ct,Ct){!rt.active||ot||(_e.scrollBody.useBaseFriction().useDuration(ct===!0?0:rt.duration),_e.scrollTo.index(pt,Ct||0))}function Ft(pt){const ct=_e.index.add(1).get();Dt(ct,pt,-1)}function Gt(pt){const ct=_e.index.add(-1).get();Dt(ct,pt,1)}function Ht(){return _e.index.add(1).get()!==_t()}function St(){return _e.index.add(-1).get()!==_t()}function xt(){return _e.scrollSnapList}function $t(){return _e.scrollProgress.get(_e.offsetLocation.get())}function _t(){return _e.index.get()}function ut(){return _e.indexPrevious.get()}function gt(){return _e.slidesInView.get()}function yt(){return _e.slidesInView.get(!1)}function kt(){return dt}function lt(){return _e}function Mt(){return i}function wt(){return ht}function jt(){return mt}const at={canScrollNext:Ht,canScrollPrev:St,containerNode:wt,internalEngine:lt,destroy:Rt,off:nt,on:$,emit:tt,plugins:kt,previousScrollSnap:ut,reInit:it,rootNode:Mt,scrollNext:Ft,scrollPrev:Gt,scrollProgress:$t,scrollSnapList:xt,scrollTo:Dt,selectedScrollSnap:_t,slideNodes:jt,slidesInView:gt,slidesNotInView:yt};return vt(e,o),setTimeout(()=>g.emit("init"),0),at}EmblaCarousel.globalOptions=void 0;function useEmblaCarousel(i={},e=[]){const o=reactExports.useRef(i),s=reactExports.useRef(e),[a,c]=reactExports.useState(),[d,h]=reactExports.useState(),g=reactExports.useCallback(()=>{a&&a.reInit(o.current,s.current)},[a]);return reactExports.useEffect(()=>{areOptionsEqual(o.current,i)||(o.current=i,g())},[i,g]),reactExports.useEffect(()=>{arePluginsEqual(s.current,e)||(s.current=e,g())},[e,g]),reactExports.useEffect(()=>{if(canUseDOM()&&d){EmblaCarousel.globalOptions=useEmblaCarousel.globalOptions;const _=EmblaCarousel(d,o.current,s.current);return c(_),()=>_.destroy()}else c(void 0)},[d,c]),[h,a]}useEmblaCarousel.globalOptions=void 0;const Logo=()=>jsxRuntimeExports.jsx("div",{className:"logo-container",children:jsxRuntimeExports.jsx("img",{src:"https://firebasestorage.googleapis.com/v0/b/pixpair.firebasestorage.app/o/crab5.svg?alt=media&token=93592dde-03d2-4140-bf36-c4cb0ca39f85",alt:"PixCrab logo",className:"logo-image"})});class AppUtils{static debugLog(e){this.info(e)}static info(e){const o=typeof e=="string"&&e.length>100?e.substring(0,97)+"...":e;console.log(`[PixCrab] ${o}`);const s=document.getElementById("debugConsole");if(s){const a=new Date,c=a.toLocaleTimeString()+"."+a.getMilliseconds().toString().padStart(3,"0"),d=document.createElement("div");d.textContent=`[${c}] ${o}`,s.appendChild(d),s.scrollTop=s.scrollHeight}}static showToast(e,o=3e3){const s=document.getElementById("toast");if(!s){console.error("Toast element missing!");return}s.textContent=e,s.classList.remove("hidden"),s.style.display="block",s.style.opacity="1",s.style.transform="translateX(-50%) translateY(0)",window._toastHideTimeout&&clearTimeout(window._toastHideTimeout),window._toastHideTimeout=setTimeout(()=>{s.classList.add("hidden")},o)}static formatSessionId(e){return e?e.length===6?`${e.slice(0,3)}-${e.slice(3)}`:e:""}static async capturePhoto(e){return new Promise((o,s)=>{try{if(!e||!(e instanceof HTMLVideoElement)){s(new Error("Invalid video element"));return}const a=document.createElement("canvas"),c=e.videoWidth/e.videoHeight,d=2160,h=Math.round(d/c);a.width=d,a.height=h,a.getContext("2d").drawImage(e,0,0,d,h);const _=a.toDataURL("image/jpeg",.92);AppUtils.debugLog(`Photo captured: ${Math.round(d)}x${Math.round(h)}`),o(_)}catch(a){AppUtils.debugLog(`Error capturing photo: ${a.message}`),s(a)}})}static async generateSafeSessionId(){const e="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let o="";if(window.crypto&&window.crypto.getRandomValues){const s=new Uint8Array(6);window.crypto.getRandomValues(s);for(let a=0;a<6;a++)o+=e.charAt(s[a]%e.length)}else for(let s=0;s<6;s++)o+=e.charAt(Math.floor(Math.random()*e.length));return o}static copyToClipboard(e){if(!e)return Promise.reject(new Error("No text to copy"));if(navigator.clipboard&&navigator.clipboard.writeText)return navigator.clipboard.writeText(e).then(()=>(AppUtils.debugLog("Text copied to clipboard"),AppUtils.showToast("Copied to clipboard"),!0)).catch(o=>(AppUtils.debugLog(`Clipboard write failed: ${o.message}`),!1));try{const o=document.createElement("textarea");o.value=e,o.style.position="fixed",o.style.opacity="0",document.body.appendChild(o),o.select();const s=document.execCommand("copy");return document.body.removeChild(o),s?(AppUtils.showToast("Copied to clipboard"),Promise.resolve(!0)):Promise.reject(new Error("execCommand copy failed"))}catch(o){return Promise.reject(o)}}static isMobileDevice(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}static generateQRCode(e,o,s={}){if(typeof QRCode>"u")throw new Error("QRCode library not loaded");return new QRCode(e,{text:o,width:s.width||184,height:s.height||184,colorDark:s.colorDark||"#4831D4",colorLight:s.colorLight||"#ffffff",correctLevel:QRCode.CorrectLevel.H})}static initToastListeners(){console.log("Toast system using direct method calls instead of events")}}const PhotoModal=({imageUrl:i,photo:e,onClose:o})=>{if(reactExports.useEffect(()=>{const c=d=>{d.key==="Escape"&&o()};return document.addEventListener("keydown",c),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",c),document.body.style.overflow="auto"}},[o]),AppUtils.info(`MODAL: PhotoModal render, imageUrl exists: ${!!i}`),!i)return null;const s=e!=null&&e.timestamp?new Date(e.timestamp).toLocaleString():"",a=(e==null?void 0:e.participantIds)&&e.participantIds.length>1;return jsxRuntimeExports.jsx("div",{className:"photo-modal fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-[9999]",onClick:o,style:{pointerEvents:"auto"},children:jsxRuntimeExports.jsxs("div",{className:"relative max-w-[90vw] max-h-[90vh]",onClick:c=>c.stopPropagation(),children:[jsxRuntimeExports.jsx("img",{src:i,alt:"Full size view",className:"max-w-full max-h-[90vh] object-contain shadow-lg"}),s&&jsxRuntimeExports.jsxs("div",{className:"absolute bottom-4 left-4 bg-black bg-opacity-50 text-white px-3 py-1 rounded text-sm",children:[s,a&&jsxRuntimeExports.jsx("span",{className:"ml-2 bg-purple-500 text-white text-xs px-1 py-0.5 rounded",children:"Shared Photo"})]}),jsxRuntimeExports.jsx("button",{onClick:o,className:"close-modal-button absolute top-2 right-2 text-white rounded-full hover:bg-red-600 transition-colors","aria-label":"Close modal",style:{backgroundColor:"rgba(0, 0, 0, 0.7)",border:"0px none rgb(255, 255, 255)",borderRadius:"50%",padding:"4px 12px",width:"36px",height:"36px"},children:"✕"})]})})},emblaStyles={carousel:"overflow-hidden",container:"flex",slide:"flex-shrink-0 min-w-0 mx-1 rounded"},CameraScreen=({sessionId:i,onExitSession:e,onSignOut:o})=>{const[s,a]=reactExports.useState(null),[c,d]=reactExports.useState(!1),[h,g]=reactExports.useState([]),[_,j]=reactExports.useState(!1),[b,$]=reactExports.useState(null),[nt,tt]=reactExports.useState({}),[it,ot]=reactExports.useState(0),[_e,et]=reactExports.useState(""),[rt,st]=reactExports.useState([]),[dt,ht]=reactExports.useState(!1),[mt,ft]=reactExports.useState([]),[bt,vt]=reactExports.useState(null);console.log(`💾 DEBUG: Current thumbnails in carousel: ${mt.length}`);const[Et]=useEmblaCarousel({loop:!1,align:"start",containScroll:"trimSnaps"}),It=reactExports.useRef(null),Rt=reactExports.useRef(null),Dt=reactExports.useRef(null);reactExports.useEffect(()=>{if(!i){console.log("No session ID provided, exiting session"),Ft(),typeof e=="function"&&e();return}},[i,e]),reactExports.useEffect(()=>{var pt;function at(){const ct=window.visualViewport?window.visualViewport.height:window.innerHeight;document.documentElement.style.setProperty("--viewport-height",`${ct}px`),console.log("📏 Updated viewport height:",ct)}return at(),(pt=window.visualViewport)==null||pt.addEventListener("resize",at),window.addEventListener("resize",at),()=>{var ct;(ct=window.visualViewport)==null||ct.removeEventListener("resize",at),window.removeEventListener("resize",at)}},[]),reactExports.useEffect(()=>{var at;console.log("🔍 BUTTON RENDER CONDITIONS:",{cameraReady:c,uploading:_,countdown:b,participantCount:it,disabled:!c||_||b!==null||it<2,videoRef:Rt.current?"exists":"null",videoSrcObject:(at=Rt.current)!=null&&at.srcObject?"stream active":"no stream"})},[c,_,b,it]),reactExports.useEffect(()=>()=>{console.log("🎥 CameraScreen unmounting - stopping camera"),Ft();const at=document.getElementById("slideContainer");at&&(console.log("🧹 DEBUG: Removing legacy slideContainer on unmount"),at.remove());const pt=document.getElementById("hintText");pt&&(console.log("🧹 DEBUG: Removing legacy hintText on unmount"),pt.remove()),It.current&&clearInterval(It.current)},[]),reactExports.useEffect(()=>{var at,pt,ct,Ct,Pt;console.log("🎥 CAMERA READY STATE CHANGED:",c),console.log("🎥 DEBUG: Camera state details:",{ready:c,videoRef:Rt.current?"exists":"null",videoSrcObject:(at=Rt.current)!=null&&at.srcObject?"stream active":"no stream",videoWidth:((pt=Rt.current)==null?void 0:pt.videoWidth)||"unknown",videoHeight:((ct=Rt.current)==null?void 0:ct.videoHeight)||"unknown",tracks:((Pt=(Ct=Rt.current)==null?void 0:Ct.srcObject)==null?void 0:Pt.getTracks().length)||0})},[c]),reactExports.useEffect(()=>{if(!i)return;console.log("📊 DEBUG: Setting up Firebase listeners for session:",i),Ft(),xt();const at=firebase.auth().currentUser;if(at){const Nt=at.uid,Lt=at.isAnonymous,zt=at.displayName||(Lt?"Guest User":at.email||"Unknown");console.log(`📊 DEBUG: Adding current user to participants: ${Nt}, isAnonymous: ${Lt}`),database.ref(`sessions/${i}/participants/${Nt}`).set({connected:!0,lastSeen:firebase.database.ServerValue.TIMESTAMP,displayName:zt,photoURL:at.photoURL||null,isAnonymous:Lt}),database.ref(`sessions/${i}/members/${Nt}`).set({isAnonymous:Lt,joinTime:firebase.database.ServerValue.TIMESTAMP})}const pt=database.ref(`sessions/${i}`);pt.once("value",Nt=>{console.log("📊 DEBUG: Initial session data check:",JSON.stringify(Nt.val()));const Lt=Nt.val();if(Lt){const zt=Object.keys(Lt);console.log("📊 DEBUG: Session exists with fields:",zt)}else console.log("📊 DEBUG: Session does not exist")}),console.log("📊 DEBUG: Setting up all Firebase listeners for path:",`sessions/${i}`);const ct=database.ref(".info/connected"),Ct=database.ref(`sessions/${i}/photos`),Pt=database.ref(`sessions/${i}/combinedPhotos`),Tt=()=>{const Nt=firebase.auth().currentUser;Nt?Nt.isAnonymous?(console.log("📊 DEBUG: Guest user, only loading session photos"),Ut()):(console.log("📊 DEBUG: Authenticated user, loading all user photos"),Ot(Nt.uid)):(console.log("📊 DEBUG: No authenticated user, only loading session photos"),Ut())},Ut=()=>{Pt.on("child_added",Nt=>{const Lt={id:Nt.key,...Nt.val()};console.log("📊 DEBUG: New combined photo in session:",Nt.key),st(zt=>zt.some(Kt=>Kt.id===Lt.id)?zt:[...zt,Lt])})},Ot=Nt=>{console.log("📊 DEBUG: Loading persistent photos for user:",Nt),Ut(),database.ref(`users/${Nt}/combinedPhotos`).on("value",Lt=>{const zt=Lt.val()||{},Kt=Object.entries(zt).map(([Bt,Wt])=>({id:Bt,...Wt}));console.log(`📊 DEBUG: Loaded ${Kt.length} persistent photos for user`),st(Bt=>[...Bt.filter(At=>!Kt.some(Qt=>Qt.id===At.id)),...Kt].sort((At,Qt)=>(Qt.timestamp||0)-(At.timestamp||0)))})};Tt(),firebase.auth().onAuthStateChanged(Nt=>{console.log("📊 DEBUG: Auth state changed, reloading photos"),Tt()}),console.log("📊 DEBUG: Setting up child_added listener for photos"),Ct.on("child_added",Nt=>{const Lt={id:Nt.key,...Nt.val()};console.log("📊 DEBUG: New photo detected in Firebase -",Nt.key,"with timestamp:",Lt.timestamp),g(zt=>(console.log("📊 DEBUG: Updating photosTaken state, current count:",zt.length),[...zt,Lt]))},Nt=>{console.error("📊 DEBUG: Error in child_added listener:",Nt)}),console.log("📊 DEBUG: Testing Firebase write permission..."),pt.child("test").set({test:"write-test",timestamp:Date.now()}).then(()=>(console.log("📊 DEBUG: Firebase test write successful"),pt.child("test").once("value"))).then(Nt=>{console.log("📊 DEBUG: Firebase test read successful:",Nt.val())}).catch(Nt=>{console.error("📊 DEBUG: Firebase permission error:",Nt.message)}),ct.on("value",Nt=>{Nt.val()===!0?console.log("📊 DEBUG: Connected to Firebase"):console.log("📊 DEBUG: Disconnected from Firebase")}),console.log("📊 DEBUG: Setting up value listener for combined photos"),Pt.on("value",Nt=>{try{const Lt=Nt.val()||{};AppUtils.info(`combinedPhotos state changed: ${Object.keys(Lt).length} photos`);const zt=Object.entries(Lt).map(([Wt,At])=>({id:Wt,...At})).sort((Wt,At)=>(At.timestamp||0)-(Wt.timestamp||0)),Kt=zt.filter(Wt=>Wt.isCombined).length,Bt=zt.length-Kt;if(AppUtils.info(`Photo breakdown - ${Kt} combined, ${Bt} individual`),zt.length>0){AppUtils.info(`First photo: id=${zt[0].id}, combined=${zt[0].isCombined}`);const Wt=zt.filter(At=>At.isCombined).map(At=>At.thumbnailUrl||At.url||"").filter(At=>At&&At.length>0);console.log(`🔄 DEBUG: Found ${Wt.length} combined photo thumbnails for carousel`),Wt.length>0&&ft(At=>{const Qt=[...At];let Zt=!1;return Wt.forEach(Xt=>{Qt.includes(Xt)||(console.log("🔄 DEBUG: Adding combined photo thumbnail to carousel"),Qt.push(Xt),Zt=!0)}),console.log(`🔄 DEBUG: Carousel now has ${Qt.length} thumbnails after update`),Zt?Qt:At})}st(zt)}catch(Lt){console.error("Error in combined photos listener:",Lt)}}),Ct.on("value",Nt=>{console.log("📊 DEBUG: Photos value event triggered");const Lt=Nt.val()||{};console.log("📊 DEBUG: Photos participants count:",Object.keys(Lt).length);const zt=[];Object.entries(Lt).forEach(([Kt,Bt])=>{console.log(`📊 DEBUG: Processing photos for user ${Kt}`),typeof Bt=="object"&&(Bt.dataUrl?(console.log(`📊 DEBUG: Found legacy format photo for user ${Kt}`),zt.push({userId:Kt,dataUrl:Bt.dataUrl,timestamp:Bt.timestamp})):(console.log(`📊 DEBUG: Found ${Object.keys(Bt).length} photos for user ${Kt}`),Object.entries(Bt).forEach(([Wt,At])=>{At&&At.dataUrl&&(console.log(`📊 DEBUG: Processing photo ${Wt} for user ${Kt}`),zt.push({userId:Kt,photoId:Wt,...At}))})))}),zt.sort((Kt,Bt)=>(Bt.timestamp||0)-(Kt.timestamp||0)),console.log(`📊 DEBUG: Processed ${zt.length} individual photos from ${Object.keys(Lt).length} participants`)},Nt=>{console.error("📊 DEBUG: Error in value listener:",Nt)}),console.log("📊 DEBUG: Setting up participants listener");const Vt=database.ref(`sessions/${i}/participants`);Vt.on("value",Nt=>{const Lt=Nt.val()||{};console.log("📊 DEBUG: Participants updated:",JSON.stringify(Lt)),tt(Lt),ot(Object.keys(Lt).length)}),console.log("📊 DEBUG: Setting up capture time listener");const Jt=database.ref(`sessions/${i}/capture`);return Jt.on("value",Nt=>{const Lt=Nt.val();console.log("📊 DEBUG: Capture data update:",JSON.stringify(Lt)),Lt&&Lt.captureTime?(console.log("📊 DEBUG: Valid capture time received, starting countdown"),St(Lt.captureTime)):console.log("📊 DEBUG: No valid capture time in the data")}),()=>{console.log("🧹 DEBUG: Cleaning up Firebase listeners and camera"),Ft(),pt.off(),Ct.off(),Pt.off(),ct.off(),Vt.off(),Jt.off(),It.current&&clearInterval(It.current),console.log("🧹 DEBUG: All listeners removed")}},[i]);const Ft=()=>{Rt.current&&Rt.current.srcObject?(console.log("🎥 STOPPING CAMERA"),Rt.current.srcObject.getTracks().forEach(pt=>{console.log(`🎥 Stopping track: ${pt.kind}, enabled: ${pt.enabled}`),pt.stop()}),Rt.current.srcObject=null,d(!1),console.log("🎥 CAMERA STOPPED")):console.log("🎥 No camera stream to stop")},Gt=()=>{i&&navigator.clipboard.writeText(i).then(()=>{et("Copied!"),setTimeout(()=>et(""),2e3)}).catch(at=>{console.error("Failed to copy:",at),et("Failed to copy")})},Ht=async()=>{var at;console.log("📸 DEBUG: initiateCapture function called");try{console.log("📸 DEBUG: Measuring network latency...");const pt=Date.now();await database.ref(".info/serverTimeOffset").once("value");const Ct=Date.now()-pt;console.log(`📸 DEBUG: Network latency measured: ${Ct}ms`);const Pt=Math.max(1e3,Ct*2);console.log(`📸 DEBUG: Calculated buffer time: ${Pt}ms`);const Tt=Date.now()+3e3+Pt;console.log(`📸 DEBUG: Set capture time to: ${new Date(Tt).toISOString()}`),console.log("📸 DEBUG: Saving capture data to Firebase..."),await database.ref(`sessions/${i}/capture`).set({captureTime:Tt,initiatedBy:((at=firebase.auth().currentUser)==null?void 0:at.uid)||"anonymous",initiated:firebase.database.ServerValue.TIMESTAMP,approximateLatency:Ct}),console.log(`📸 DEBUG: Capture data saved successfully! Starting countdown for time: ${new Date(Tt).toISOString()} (buffer: ${Pt}ms)`),St(Tt)}catch(pt){console.error("❌ ERROR in initiateCapture:",pt),a("Failed to initiate synchronized capture.")}},St=at=>{console.log("📸 DEBUG: startCountdown function called with captureTime:",at);try{It.current&&(console.log("📸 DEBUG: Clearing existing countdown interval"),clearInterval(It.current));const pt=Date.now(),ct=at-pt;if(console.log(`📸 DEBUG: Time until capture: ${ct}ms`),ct<=0){console.log("📸 DEBUG: Capture time already passed, aborting countdown");return}console.log(`📸 DEBUG: Starting countdown for capture at ${new Date(at).toISOString()}`);const Ct=Math.ceil(ct/1e3);console.log(`📸 DEBUG: Initial countdown value: ${Ct}`),$(Ct),console.log("📸 DEBUG: Setting up countdown interval"),It.current=setInterval(()=>{try{const Pt=at-Date.now(),Tt=Math.ceil(Pt/1e3);console.log(`📸 DEBUG: Countdown tick - ${Tt}s remaining`),Tt===2&&!c&&(console.log("📸 DEBUG: 2 seconds left, ensuring camera is ready"),Rt.current&&Rt.current.srcObject?(console.log("📸 DEBUG: Video element appears ready but cameraReady is false, forcing ready"),d(!0)):(console.log("📸 DEBUG: Attempting to re-initialize camera"),xt())),$(Ut=>{try{return Tt<=0||Ut<=1?(console.log("📸 DEBUG: Countdown reached zero, clearing interval and taking photo"),clearInterval(It.current),!c&&Rt.current&&Rt.current.srcObject?(console.log("📸 DEBUG: Forcing camera ready before photo capture"),d(!0),setTimeout(()=>$t(),100)):$t(),null):Tt}catch(Ot){return console.error("❌ ERROR in countdown state update:",Ot),clearInterval(It.current),null}})}catch(Pt){console.error("❌ ERROR in countdown interval:",Pt),clearInterval(It.current)}},100),console.log("📸 DEBUG: Setting safety timeout for",ct+500,"ms"),setTimeout(()=>{try{It.current&&(console.log("📸 DEBUG: Safety timeout triggered - clearing countdown"),clearInterval(It.current),$(null))}catch(Pt){console.error("❌ ERROR in safety timeout:",Pt)}},ct+500)}catch(pt){console.error("❌ ERROR in startCountdown:",pt),a("Failed to start countdown timer.")}},xt=async()=>{console.log("🎥 STARTING CAMERA INITIALIZATION");try{if(c){console.log("🎥 DEBUG: Camera is already ready, no need to initialize again");return}const at=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:!1});if(console.log("🎥 CAMERA STREAM OBTAINED:",at?"success":"failed","tracks:",at.getTracks().length),Rt.current){Rt.current.srcObject=at,console.log("🎥 ASSIGNED STREAM TO VIDEO ELEMENT");const pt=at.getVideoTracks();console.log("🎥 DEBUG: Video tracks:",pt.length),pt.forEach(ct=>{console.log("🎥 DEBUG: Track details:",{kind:ct.kind,id:ct.id,enabled:ct.enabled,readyState:ct.readyState,muted:ct.muted}),ct.addEventListener("ended",()=>{console.log("🎥 DEBUG: Video track ended"),d(!1)})}),Rt.current.onloadedmetadata=()=>{console.log("🎥 VIDEO METADATA LOADED, SETTING CAMERA READY"),console.log("🎥 DEBUG: Video dimensions after metadata loaded:",{width:Rt.current.videoWidth,height:Rt.current.videoHeight}),d(!0)}}else console.error("🎥 VIDEO REF IS NULL"),at.getTracks().forEach(pt=>pt.stop())}catch(at){console.error("🎥 ERROR ACCESSING CAMERA:",at),a("Could not access camera. Please check permissions.")}},$t=async()=>{if(console.log("📸 DEBUG: takePhoto function called"),!c||_){if(console.log(`📸 DEBUG: Cannot take photo - cameraReady: ${c}, uploading: ${_}`),!c&&Rt.current&&Rt.current.srcObject){console.log("📸 DEBUG: Attempting to recover camera ready state...");const at=Rt.current.srcObject.getVideoTracks();if(console.log("📸 DEBUG: Video tracks status:",at.map(pt=>({kind:pt.kind,enabled:pt.enabled,readyState:pt.readyState}))),at.length>0&&at[0].readyState==="live"&&Rt.current.videoWidth>0){console.log("📸 DEBUG: Video appears ready but cameraReady state is false, forcing ready state"),d(!0),setTimeout(()=>{console.log("📸 DEBUG: Retrying takePhoto after recovery attempt"),ut()},500);return}}console.log("📸 DEBUG: Cannot recover camera state, aborting photo capture");return}await ut()},_t=(at,pt)=>{console.log("🔍 DEBUG: Performing direct check of Firebase photos structure"),database.ref(`sessions/${at}/photos`).once("value").then(ct=>{const Ct=ct.val();if(console.log("🔍 DEBUG: Direct Firebase check - Session photos data:","[data omitted]"),!Ct)console.log("🔍 DEBUG: No photos found in this session");else{Ct[pt]?console.log(`🔍 DEBUG: Found photo for user ${pt}: [data omitted]`):console.log(`🔍 DEBUG: No photo found for user ${pt} in the session`);const Pt=Object.keys(Ct);console.log(`🔍 DEBUG: Participants with photos: ${Pt.length}`),console.log("🔍 DEBUG: Participant IDs with photos:",Pt)}}).catch(ct=>{console.error("🔍 DEBUG: Error checking Firebase photos:",ct)})},ut=async()=>{console.log("📸 DEBUG: Starting actual photo capture implementation");try{console.log("📸 DEBUG: Starting photo capture process"),j(!0),a(null);const at=Rt.current,pt=Dt.current;if(!at||!pt)throw console.error("📸 DEBUG: Video or canvas reference is null"),new Error("Video or canvas reference is missing");if(!at.videoWidth||!at.videoHeight)throw console.error("📸 DEBUG: Video dimensions are invalid:",at.videoWidth,at.videoHeight),new Error("Video not ready for capture");console.log(`📸 DEBUG: Video dimensions: ${at.videoWidth}x${at.videoHeight}`),pt.width=at.videoWidth,pt.height=at.videoHeight,console.log("📸 DEBUG: Drawing video frame to canvas"),pt.getContext("2d").drawImage(at,0,0),console.log("📸 DEBUG: Converting canvas to data URL");const Ct=pt.toDataURL("image/jpeg",.8);console.log(`📸 DEBUG: Data URL generated, length: ${Ct.length} characters [dataUrl omitted]`);const Pt=firebase.auth().currentUser;if(!Pt)throw console.error("❌ ERROR: No authenticated user found when trying to save photo"),new Error("You must be signed in to take photos");const Tt=Pt.uid;console.log(`📸 DEBUG: Current user ID: ${Tt}`),console.log("📸 DEBUG: Saving photo to Firebase..."),console.log("📸 DEBUG: Session ID:",i),console.log("📸 DEBUG: Building reference path:",`sessions/${i}/photos/${Tt}`),await database.ref(`sessions/${i}/photos/${Tt}`).push().set({dataUrl:Ct,timestamp:firebase.database.ServerValue.TIMESTAMP}),setTimeout(()=>{_t(i,Tt),console.log("📸 DEBUG: Attempting to call checkAndCreateCombinedPhoto."),gt(i)},1500)}catch(at){console.error("❌ ERROR in takePhoto:",at),a("Failed to take photo. Please try again.")}finally{j(!1),console.log("📸 DEBUG: Photo capture process completed")}},gt=at=>{if(console.log("🔄 DEBUG: checkAndCreateCombinedPhoto called"),console.log(`🔄 DEBUG: Current session ID for check: ${at}`),!at){console.log("🔄 DEBUG: No session ID provided, skipping combined photo check");return}if(!Dt.current){console.error("🔄 ERROR: Canvas reference is not available for creating combined photo");return}console.log(`🔄 DEBUG: Canvas dimensions: ${Dt.current.width}x${Dt.current.height}`);const pt=firebase.auth().currentUser;if(!pt){console.error("🔄 ERROR: No authenticated user for combined photo check.");return}const ct=pt.uid,Ct=pt.isAnonymous;console.log(`🔄 DEBUG: Current user: ID=${ct}, isAnonymous=${Ct}`);const Pt=Date.now(),Tt=database.ref(`sessions/${at}/participants`);console.log(`🔄 DEBUG: Fetching participants data from Firebase path: ${Tt.toString()}`),Tt.once("value").then(Ut=>{const Ot=Ut.val()||{},Vt=Object.keys(Ot);console.log(`🔄 DEBUG: Found ${Vt.length} participants in the session:`,Vt);const Jt=Vt.map(Nt=>database.ref(`sessions/${at}/participants/${Nt}`).once("value"));Promise.all(Jt).then(Nt=>{const Lt={};Nt.forEach(Kt=>{if(Kt.exists()){const Bt=Kt.key,Wt=Kt.val();Lt[Bt]=Wt}}),console.log("🔄 DEBUG: Participant details:",JSON.stringify(Lt));const zt=database.ref(`sessions/${at}/photos`);console.log(`🔄 DEBUG: Checking photos at Firebase path: ${zt.toString()}`),zt.once("value").then(async Kt=>{console.log(`🔄 DEBUG: Successfully retrieved photos data from Firebase (${Date.now()-Pt}ms)`);const Bt=Kt.val()||{},Wt=Object.keys(Bt);console.log(`🔄 DEBUG: Found photos from ${Wt.length} participants:`,Wt);const At={};for(const qt of Wt){const en=Bt[qt];if(en.dataUrl)console.log(`🔄 DEBUG: Using legacy format photo for user ${qt}`),At[qt]=en;else{const nn=Object.entries(en);if(nn.length===0)continue;nn.sort((sn,ln)=>(ln[1].timestamp||0)-(sn[1].timestamp||0));const[an,rn]=nn[0];console.log(`🔄 DEBUG: Using latest photo ${an} for user ${qt} from ${nn.length} photos`),At[qt]=rn}}console.log("🔄 DEBUG: Latest photos data structure:",JSON.stringify(Object.keys(At).map(qt=>({id:qt,hasDataUrl:!!At[qt].dataUrl,dataUrlLength:At[qt].dataUrl?At[qt].dataUrl.length:0,timestamp:At[qt].timestamp}))));const Qt=Object.entries(At).every(([qt,en])=>en&&en.dataUrl);if(console.log(`🔄 DEBUG: All photos valid and contain dataUrl: ${Qt}`),!Qt){console.error("🔄 ERROR: Some photos are missing dataUrl property");return}if(Wt.length<2){console.log("🔄 DEBUG: Not enough photos to create a combined photo yet");return}console.log("🔄 DEBUG: Checking for existing combined photos with these participants");const Zt=database.ref(`sessions/${at}/combinedPhotos`);console.log(`🔄 DEBUG: Checking combined photos at Firebase path: ${Zt.toString()}`);const Xt={};for(const qt of Wt)Xt[qt]={uid:qt,isAnonymous:!0},Lt[qt]&&(Lt[qt].isAnonymous!==void 0?Xt[qt].isAnonymous=Lt[qt].isAnonymous:Lt[qt].displayName==="Guest"&&(Xt[qt].isAnonymous=!0)),qt===ct&&(Xt[qt].isAnonymous=Ct);console.log("🔄 DEBUG: Participant authentication state:",JSON.stringify(Xt));const Yt=Wt.filter(qt=>Xt[qt]&&!Xt[qt].isAnonymous);console.log("🔄 DEBUG: Authenticated participants:",Yt);let tn=!1,on="";if(Yt.length>0)if(!Ct&&Yt.includes(ct))if(Yt.length===1)tn=!0,on="Only authenticated user";else{const qt=Yt.sort()[0];tn=ct===qt,on=`Lowest authenticated UID (${qt})`}else tn=!1,on="Guest user with authenticated participants present";else{const qt=Wt.sort()[0];tn=ct===qt,on=`All guests, using lowest UID (${qt})`}if(console.log(`🔄 DEBUG: Should create combined photo: ${tn}, Reason: ${on}`),!tn){console.log("🔄 DEBUG: This device should NOT create the combined photo, skipping creation");return}Zt.once("value").then(qt=>{console.log(`🔄 DEBUG: Successfully retrieved combined photos data from Firebase (${Date.now()-Pt}ms)`);const en=qt.val()||{};if(console.log(`🔄 DEBUG: Found ${Object.keys(en).length} existing combined photos`),Object.values(en).some(rn=>{if(!rn.participantIds)return console.log("🔄 DEBUG: Found a combined photo without participantIds field"),!1;const sn=rn.participantIds.length===Wt.length,ln=Wt.every(un=>rn.participantIds.includes(un));return sn&&ln&&console.log("🔄 DEBUG: Found existing combined photo with same participants:",JSON.stringify({participantIds:rn.participantIds,timestamp:rn.timestamp})),sn&&ln})){console.log("🔄 DEBUG: A combined photo with these participants already exists, skipping creation");return}console.log("🔄 DEBUG: No existing combined photo found with these participants, creating new one"),console.log("🔄 DEBUG: Creating combined photo from participant photos"),yt(at,At,Wt,{mergedBy:ct,mergerIsAnonymous:Ct}).then(rn=>{const sn=Date.now()-Pt;rn?(console.log(`🔄 DEBUG: Successfully created combined photo with ID: ${rn} (total time: ${sn}ms)`),et(`Combined photo saved by ${Ct?"guest":"authenticated"} user!`),setTimeout(()=>et(""),3e3)):console.log(`🔄 DEBUG: Failed to create combined photo (total time: ${sn}ms)`)}).catch(rn=>{console.error("🔄 ERROR in createCombinedPhoto promise:",rn)})}).catch(qt=>{console.error("🔄 ERROR checking existing combined photos:",qt)})}).catch(Kt=>{console.error("🔄 ERROR checking for photos:",Kt)})}).catch(Nt=>{console.error("🔄 ERROR fetching participant details:",Nt)})}).catch(Ut=>{console.error("🔄 ERROR fetching participants:",Ut)})},yt=async(at,pt,ct,Ct)=>{var Pt,Tt;console.log("🔄 DEBUG: Create combined photo called with session ID:",at);try{console.log("🔄 DEBUG: Creating combined photo for",ct.length,"participants"),console.log("🔄 DEBUG: Participant IDs:",JSON.stringify(ct)),console.log("🔄 DEBUG: Merger info:",JSON.stringify(Ct));const Ut=ct.map(At=>{console.log(`🔄 DEBUG: Processing photo from participant ${At}`);const Qt=pt[At];return console.log("🔄 DEBUG: Photo data structure:",JSON.stringify({hasDataUrl:!!Qt.dataUrl,dataUrlLength:Qt.dataUrl?Qt.dataUrl.length:0,timestamp:Qt.timestamp})),Qt.dataUrl||console.error(`🔄 ERROR: Missing dataUrl for photo from participant ${At}`),Qt.dataUrl});console.log("🔄 DEBUG: Extracted data URLs for all participants");const Ot=Dt.current;if(!Ot)throw new Error("Canvas reference is not available");console.log(`🔄 DEBUG: Canvas dimensions before setup: ${Ot.width}x${Ot.height}`);const Vt=Ot.getContext("2d");if(!Vt)throw new Error("Could not get canvas 2D context");console.log("🔄 DEBUG: Canvas 2D context obtained successfully"),console.log("🔄 DEBUG: Loading images from data URLs");const Jt=Ut.map((At,Qt)=>new Promise((Zt,Xt)=>{console.log(`🔄 DEBUG: Creating image object for URL ${Qt+1}`);const Yt=new Image;Yt.crossOrigin="anonymous",Yt.onload=()=>{console.log(`🔄 DEBUG: Image ${Qt+1} loaded successfully: ${Yt.width}x${Yt.height}`),Zt(Yt)},Yt.onerror=tn=>{console.error(`🔄 ERROR: Failed to load image ${Qt+1}:`,tn),Xt(new Error(`Failed to load image ${Qt+1}`))},console.log(`🔄 DEBUG: Setting source for image ${Qt+1}`),Yt.src=At}));console.log(`🔄 DEBUG: Waiting for all ${Jt.length} images to load`);const Nt=await Promise.all(Jt);console.log(`🔄 DEBUG: All ${Nt.length} images loaded successfully`),Nt.forEach((At,Qt)=>{console.log(`🔄 DEBUG: Image ${Qt+1} dimensions: ${At.width}x${At.height}`)}),console.log("🔄 DEBUG: Using vertical stacking layout (first photo on top, second on bottom)");const Lt=2160,zt=1920,Kt=Lt/zt;console.log(`🔄 DEBUG: Using fixed dimensions: ${Lt}x${zt} per image`),console.log(`🔄 DEBUG: Setting canvas dimensions to: ${Lt}x${zt*2}`),console.log("🛠️ DEBUG: canvasRef.current:",Dt.current),console.log("🛠️ DEBUG: canvas element id/class:",(Pt=Dt.current)==null?void 0:Pt.id,(Tt=Dt.current)==null?void 0:Tt.className),console.log("🛠️ DEBUG: pre-set dimensions:",Ot.width,Ot.height),Ot.width=Lt,Ot.height=zt*2,console.log("🔄 DEBUG: Clearing canvas with black background"),Vt.fillStyle="#000",Vt.fillRect(0,0,Ot.width,Ot.height),Nt.forEach((At,Qt)=>{const Zt=At.width/At.height;let Xt,Yt,tn,on;Zt>Kt?(on=At.height,tn=At.height*Kt,Xt=(At.width-tn)/2,Yt=0,console.log(`🔄 DEBUG: Image ${Qt+1} is wider, cropping sides: sourceX=${Xt}, sourceWidth=${tn}`)):(tn=At.width,on=At.width/Kt,Xt=0,Yt=(At.height-on)/2,console.log(`🔄 DEBUG: Image ${Qt+1} is taller, cropping top/bottom: sourceY=${Yt}, sourceHeight=${on}`));const qt=0,en=Qt*zt;console.log(`🔄 DEBUG: Drawing image ${Qt+1}: source(${Xt},${Yt},${tn},${on}) -> dest(${qt},${en},${Lt},${zt})`);try{Vt.drawImage(At,Xt,Yt,tn,on,qt,en,Lt,zt),console.log(`🔄 DEBUG: Successfully drew image ${Qt+1}`)}catch(nn){throw console.error(`🔄 ERROR: Failed to draw image ${Qt+1}:`,nn),nn}}),console.log("🔄 DEBUG: Adding watermark");try{Vt.font="bold 48px Arial",Vt.fillStyle="rgba(255, 255, 255, 0.7)",Vt.textAlign="right",Vt.textBaseline="bottom",Vt.fillText("PixCrab",Ot.width-40,Ot.height-40),console.log("🔄 DEBUG: Successfully added watermark")}catch(At){console.error("🔄 ERROR: Failed to add watermark:",At)}console.log("🔄 DEBUG: Converting canvas to data URL");let Bt;try{Bt=Ot.toDataURL("image/jpeg",.95),console.log(`🔄 DEBUG: Combined photo created, data URL length: ${Bt.length}`),ft(At=>[...At,Bt])}catch(At){throw console.error("🔄 ERROR: Failed to convert canvas to data URL:",At),At}console.log("🔄 DEBUG: Generating thumbnail");let Wt="";try{const At=document.createElement("canvas"),Qt=At.getContext("2d"),Zt=270,Xt=480;At.width=Zt,At.height=Xt;const Yt=new Image;await new Promise((ln,un)=>{Yt.onload=ln,Yt.onerror=un,Yt.src=Bt}),console.log(`🔄 DEBUG: Temporary image for thumbnail loaded: ${Yt.width}x${Yt.height}`);const tn=Yt.width,on=Yt.height,qt=tn/on,en=Zt/Xt;let nn,an,rn,sn;qt>en?(an=Xt,nn=an*qt,rn=(Zt-nn)/2,sn=0):(nn=Zt,an=nn/qt,rn=0,sn=(Xt-an)/2),console.log(`🔄 DEBUG: Drawing thumbnail with source dimensions: ${tn}x${on}, target: ${Zt}x${Xt}, draw dimensions: ${nn}x${an} at ${rn},${sn}`),Qt.drawImage(Yt,rn,sn,nn,an),Wt=At.toDataURL("image/jpeg",.9),console.log(`📸 DEBUG: Thumbnail created, data URL length: ${Wt.length}`)}catch(At){console.error("🔄 ERROR: Failed to generate thumbnail:",At)}console.log("🔄 DEBUG: Saving combined photo to Firebase");try{let At=firebase.database().ref().push().key;console.log(`🔄 DEBUG: Generated Firebase key: ${At}`);const Qt=database.ref(`sessions/${at}/combinedPhotos/${At}`);if(console.log(`🔄 DEBUG: Created Firebase reference at: sessions/${at}/combinedPhotos/${At}`),!Bt)throw new Error("Combined photo data URL is missing");console.log(`🔄 DEBUG: dataUrl length: ${Bt.length}, thumbnailDataUrl length: ${(Wt==null?void 0:Wt.length)||0}`);const Zt={url:combinedPhotoUrl,thumbnailUrl:Wt,dataUrl:combinedPhotoDataUrl,width:combinedCanvasWidth,height:combinedCanvasHeight,timestamp:firebase.database.ServerValue.TIMESTAMP,isCombined:!0,sessionId:at,creatorId:userId,participantIds:ct,combinationInfo:Ct},Xt={isCombined:!0,participantIds:ct,width:combinedCanvasWidth,height:combinedCanvasHeight,thumbnailUrl:Wt,dataUrl:combinedPhotoDataUrl};At=await lt(combinedPhotoUrl,Zt,Xt),At?(console.log(`✅ Successfully created and saved combined photo with ID: ${At}`),AppUtils.info(`COMBINED: Successfully created and saved combined photo with ID: ${At}`)):console.error("Failed to save combined photo");const Yt=[],tn=[];for(const en of ct)participantAuthState[en]&&!participantAuthState[en].isAnonymous?Yt.push(en):tn.push(en);console.log(`🔄 DEBUG: Auth participants: ${Yt.length}, Guest participants: ${tn.length}`);const qt=await(await fetch(Bt)).blob();if(Yt.length>0){console.log("🔄 DEBUG: At least one participant is authenticated, storing in their account");for(const en of Yt)try{const nn=`users/${en}/combined/${At}.jpg`;console.log(`🔄 DEBUG: Storing photo for auth user ${en} at path: ${nn}`);const sn=await(await firebase.storage().ref(nn).put(qt)).ref.getDownloadURL();await Qt.child("storageInfo").child(en).set({storagePath:nn,downloadURL:sn,isAnonymous:!1}),console.log(`🔄 DEBUG: Successfully stored for auth user ${en}`)}catch(nn){console.error(`🔄 ERROR: Failed to save to Storage for auth user ${en}:`,nn)}}else if(tn.length>0){console.log("🔄 DEBUG: All participants are guests, storing in guest storage");try{const en=`analysisData/guests/${at}/combined/${At}.jpg`;console.log(`🔄 DEBUG: Storing photo in guest path: ${en}`);const rn=await(await firebase.storage().ref(en).put(qt)).ref.getDownloadURL();await Qt.child("storageInfo").set({storagePath:en,downloadURL:rn,isGuestStorage:!0}),console.log("🔄 DEBUG: Successfully stored for guest users")}catch(en){console.error("🔄 ERROR: Failed to save to Storage for guests:",en)}}return Yt.length>0?et(`Combined photo saved to ${Yt.length} authenticated user(s)`):et("Combined photo saved to guest storage"),setTimeout(()=>et(""),3e3),At}catch(At){throw console.error("🔄 ERROR: Failed to save combined photo to Firebase:",At),At}}catch(Ut){return console.error("🔄 ERROR creating combined photo:",Ut),null}},kt=at=>{const pt=at.dataUrl||at.downloadURL;return pt?jsxRuntimeExports.jsxs("div",{className:"photo-item",children:[jsxRuntimeExports.jsx("img",{src:pt,alt:"Captured"}),jsxRuntimeExports.jsxs("p",{children:["Taken at: ",new Date(at.timestamp).toLocaleTimeString()]})]},at.id):jsxRuntimeExports.jsx("div",{className:"photo-item error",children:jsxRuntimeExports.jsx("p",{children:"Photo unavailable"})},at.id)},lt=async(at,pt,ct={})=>{try{const Ct=firebase.auth().currentUser,Pt=Ct?Ct.uid:"anonymous",Tt=Ct?Ct.isAnonymous:!0,Ut=(pt==null?void 0:pt.id)||firebase.database().ref().push().key,Ot={url:at,downloadURL:at,dataUrl:at,createdAt:firebase.database.ServerValue.TIMESTAMP,userId:Pt,sessionId:i,...ct,...pt,isCombined:ct.isCombined||!1,timestamp:firebase.database.ServerValue.TIMESTAMP,participantIds:ct.participantIds||[Pt]};if(console.log(`💾 DEBUG: Saving photo ${Ut} to session. Combined: ${Ot.isCombined}`),await database.ref(`sessions/${i}/combinedPhotos/${Ut}`).set(Ot),Ct&&!Tt?(console.log("💾 DEBUG: User is authenticated, saving to permanent collection"),ct.isCombined?await database.ref(`users/${Pt}/combinedPhotos/${Ut}`).set(Ot):await database.ref(`users/${Pt}/photos/${Ut}`).set(Ot),AppUtils.info(`Photo saved to permanent user gallery: ${Ut}`)):(console.log("💾 DEBUG: User is guest/anonymous, photo only saved to session"),AppUtils.info(`Photo saved to session: ${Ut}`)),ct.isCombined&&ct.participantIds&&ct.participantIds.length>0){console.log(`💾 DEBUG: Combined photo with ${ct.participantIds.length} participants. Saving to all auth users.`);for(const Vt of ct.participantIds)if(Vt!==Pt)try{const Lt=(await database.ref(`sessions/${i}/participants/${Vt}`).once("value")).val();Lt&&!Lt.isAnonymous?(console.log(`💾 DEBUG: Saving combined photo to authenticated participant: ${Vt}`),await database.ref(`users/${Vt}/combinedPhotos/${Ut}`).set(Ot)):console.log(`💾 DEBUG: Participant ${Vt} is anonymous or not found, skipping save to profile`)}catch(Jt){console.error(`Failed to save to participant ${Vt}:`,Jt)}}return ft(Vt=>Vt.includes(at)?Vt:(console.log(`💾 DEBUG: Adding new photo to session thumbnails: ${at}`),[...Vt,at])),ct.isCombined&&st(Vt=>{if(Vt.some(Nt=>Nt.id===Ut))return Vt;const Jt={id:Ut,dataUrl:at,downloadURL:at,timestamp:Date.now(),...ct};return[...Vt,Jt]}),Ut}catch(Ct){return console.error("Error saving photo to album:",Ct),a("Failed to save photo"),setTimeout(()=>a(null),3e3),null}},Mt=()=>{Ft(),typeof e=="function"&&e()},wt=()=>{console.log("🔘 DEBUG: Gallery button clicked");const at=firebase.auth().currentUser;if(at&&!at.isAnonymous){const pt=!dt;if(console.log(`👥 DEBUG: Authenticated user accessing gallery. Setting showGallery to: ${pt}`),pt){const ct=at.uid;console.log(`🔍 DEBUG: Loading gallery for user: ${ct}`)}ht(pt)}else console.log("👥 DEBUG: Guest user attempted to access gallery"),a("Sign in to view your permanent photo gallery"),setTimeout(()=>a(null),3e3)},jt=reactExports.useCallback(()=>{if(rt.length===0){a("No photos to save");return}try{const at=firebase.auth().currentUser;if(!at){AppUtils.info("No user found, cannot save photos"),a("User not logged in");return}const pt=at.isAnonymous;AppUtils.info(`Saving combined photos to album. User: ${at.uid}, isAnonymous: ${pt}`);const ct={},Ct=[],Pt=[];ct[at.uid]={isAnonymous:pt,displayName:at.displayName||"Unknown",email:at.email||null},pt?Pt.push(at.uid):Ct.push(at.uid),Object.entries(nt).forEach(([Lt,zt])=>{if(Lt!==at.uid){const Kt=zt.isAnonymous!==void 0?zt.isAnonymous:!0;ct[Lt]={isAnonymous:Kt,displayName:zt.displayName||"Unknown"},Kt?Pt.push(Lt):Ct.push(Lt)}}),AppUtils.info(`Auth participants: ${Ct.length}, Guest participants: ${Pt.length}`);let Tt="",Ut=!1;if(Ct.length>0?pt?(AppUtils.info("Current user is guest but authenticated users exist - saving skipped for this device"),Ut=!1):(Tt=`users/${at.uid}/combined/`,Ut=!0,AppUtils.info("Saving to authenticated user storage (current user)")):(Tt=`analysisData/guests/${i}/combined/`,Ut=!0,AppUtils.info("All participants are guests - saving to guest storage")),!Ut){et("Skipped saving - authenticated users exist"),setTimeout(()=>et(""),2e3);return}const Ot=localStorage.getItem("combinedSessions"),Vt=Ot?JSON.parse(Ot):[],Jt={id:i,timestamp:Date.now(),photos:rt.filter(Lt=>Lt.isCombined||Lt.participantIds),participantsCount:Object.keys(nt).length,savedByUser:at.uid,isAnonymous:pt,participantAuthStatus:ct,savePath:Tt},Nt=[Jt,...Vt];localStorage.setItem("combinedSessions",JSON.stringify(Nt)),a(null),et(`Saved ${Jt.photos.length} combined photos to ${Tt}`),setTimeout(()=>et(""),2e3),AppUtils.info(`Successfully saved ${Jt.photos.length} combined photos to ${Tt}`)}catch(at){console.error("Error saving combined photos:",at),a("Failed to save photos to album")}},[rt,i,nt,a,et]);return reactExports.useEffect(()=>{if(rt.length>0){const at=firebase.auth().currentUser;if(!at){AppUtils.info("Auto-save skipped - no authenticated user");return}const pt=at.isAnonymous,ct=[],Ct=[];Object.entries(nt).forEach(([Ut,Ot])=>{Ot.isAnonymous===!1?ct.push(Ut):Ct.push(Ut)}),AppUtils.info(`Auto-save check: Auth users: ${ct.length}, Guest users: ${Ct.length}`);let Pt=!1,Tt="";if(ct.length>0)if(pt)Pt=!1,Tt="Guest user with authenticated participants present";else if(ct.length===1)Pt=!0,Tt="Only authenticated user in session";else{const Ut=ct.sort()[0];Pt=at.uid===Ut,Tt=`Authenticated user with lowest UID (${Ut})`}else{const Ot=Object.keys(nt).sort()[0];Pt=at.uid===Ot,Tt=`All guests, using lowest UID (${Ot})`}AppUtils.info(`Auto-save decision: ${Pt?"YES":"NO"}, Reason: ${Tt}`),Pt?(jt(),AppUtils.info("Combined photos automatically saved to album")):AppUtils.info(`Auto-save skipped - ${Tt}`)}},[rt,jt,nt]),reactExports.useEffect(()=>{AppUtils.info(`combinedPhotos state changed: ${rt.length} photos`);const at=rt.filter(ct=>ct.isCombined||ct.participantIds).length,pt=rt.length-at;if(AppUtils.info(`Photo breakdown - ${at} combined, ${pt} individual`),rt.length>0){const ct=rt[0];AppUtils.info(`First photo: id=${ct.id}, combined=${!!ct.isCombined}`)}},[rt]),reactExports.useEffect(()=>{ft([])},[i]),jsxRuntimeExports.jsxs("div",{className:"camera-screen",children:[jsxRuntimeExports.jsxs("div",{className:"camera-container",children:[jsxRuntimeExports.jsx("video",{ref:Rt,autoPlay:!0,playsInline:!0,muted:!0,className:"h-full w-auto object-cover mx-auto"}),jsxRuntimeExports.jsx("canvas",{ref:Dt,style:{display:"none"}}),b!==null&&jsxRuntimeExports.jsx("div",{className:"countdown-overlay",children:jsxRuntimeExports.jsx("div",{className:"countdown-number",children:b})})]}),rt.length===0&&jsxRuntimeExports.jsx("div",{className:"combined-photo-empty text-center p-4",children:jsxRuntimeExports.jsx("p",{children:"No combined photos captured yet. Combined photos will appear in the carousel below."})}),jsxRuntimeExports.jsxs("div",{className:"camera-screen-content",children:[jsxRuntimeExports.jsxs("div",{className:"header-area",children:[s&&jsxRuntimeExports.jsx("div",{className:"error",children:s}),jsxRuntimeExports.jsxs("div",{className:"session-header",children:[jsxRuntimeExports.jsx("button",{className:"btn btn-primary rainbow-button gallery-btn",onClick:at=>{at.preventDefault(),at.stopPropagation(),console.log("🖱️ DEBUG: Gallery button click event triggered"),wt()},title:"View Gallery",children:"Gallery"}),jsxRuntimeExports.jsx("button",{className:"btn-icon exit-btn",onClick:Mt,title:"Exit Session",children:jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),jsxRuntimeExports.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),jsxRuntimeExports.jsxs("button",{className:"session-id-btn",onClick:Gt,title:"Copy Session ID",children:[i,jsxRuntimeExports.jsxs("svg",{className:"copy-icon",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),jsxRuntimeExports.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),_e&&jsxRuntimeExports.jsx("span",{className:"copy-status",children:_e})]})]})]}),!dt&&jsxRuntimeExports.jsx("div",{className:"viewfinder-area"}),mt.length>0&&jsxRuntimeExports.jsx("div",{className:"fixed bottom-20 left-0 right-0 z-50 p-2 w-full touch-auto",children:jsxRuntimeExports.jsx("div",{className:`${emblaStyles.carousel} bg-black bg-opacity-50 p-2 rounded-lg w-full touch-auto`,ref:Et,style:{touchAction:"pan-y",pointerEvents:"auto"},children:jsxRuntimeExports.jsx("div",{className:emblaStyles.container,style:{pointerEvents:"auto"},children:mt.map((at,pt)=>jsxRuntimeExports.jsx("div",{className:"w-24 h-40 mx-1 rounded overflow-hidden flex items-center justify-center bg-black bg-opacity-20 cursor-pointer shadow-md",onClick:ct=>{ct.stopPropagation(),console.log(`🖱️ DEBUG: Thumbnail clicked, setting modal image URL: ${at}`),vt(at)},children:jsxRuntimeExports.jsx("img",{src:at,alt:`Session photo ${pt+1}`,className:"object-contain w-full h-full",onError:ct=>{console.error(`Failed to load image: ${at}`),ct.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2VlZSIvPjx0ZXh0IHg9IjUwIiB5PSI1MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjYWFhIj5JbWFnZSBFcnJvcjwvdGV4dD48L3N2Zz4="}})},pt))})})}),jsxRuntimeExports.jsxs("div",{className:"controls-area",children:[jsxRuntimeExports.jsx("div",{className:"shutter-button-container",children:c&&jsxRuntimeExports.jsx("button",{className:`
                    btn-circle btn-circle-rainbow
                    w-16 h-16 bg-white shadow-lg
                    border-4 border-gray-200 z-50
                    disabled:opacity-50 disabled:cursor-not-allowed
                  `,onClick:Ht,disabled:!c||_||b!==null||it<2,children:jsxRuntimeExports.jsx("span",{className:"block w-8 h-8 bg-gray-200 rounded-full m-auto"})})}),jsxRuntimeExports.jsxs("div",{className:"participants-count",children:[jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),jsxRuntimeExports.jsx("circle",{cx:"9",cy:"7",r:"4"}),jsxRuntimeExports.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),jsxRuntimeExports.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),it,"/2"]})]})]}),dt&&jsxRuntimeExports.jsx("div",{className:"gallery-container",style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"#000",zIndex:900},children:jsxRuntimeExports.jsxs("div",{className:"p-4 text-white",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold mb-4",children:"Your Photo Gallery"}),jsxRuntimeExports.jsx("p",{className:"debug-info",children:"🔍 DEBUG: Gallery component mounted. User is authenticated."}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 gap-2 mt-4",children:rt.length>0?rt.map((at,pt)=>jsxRuntimeExports.jsx("div",{className:"aspect-square overflow-hidden rounded",children:jsxRuntimeExports.jsx("img",{src:at,alt:`Gallery photo ${pt+1}`,className:"w-full h-full object-cover"})},pt)):jsxRuntimeExports.jsx("p",{className:"col-span-2 text-center py-8",children:"No photos in your gallery yet"})}),jsxRuntimeExports.jsx("button",{className:"mt-4 px-4 py-2 bg-red-500 text-white rounded",onClick:()=>{console.log("🔘 DEBUG: Close gallery button clicked"),ht(!1)},children:"Close Gallery"})]})}),jsxRuntimeExports.jsx("div",{className:"photos-grid",children:h.map(kt)}),bt&&jsxRuntimeExports.jsx(PhotoModal,{imageUrl:bt,onClose:()=>{console.log("🖱️ DEBUG: Closing photo modal"),vt(null)}})]})};var reactGridGallery_umd={exports:{}};(function(i,e){(function(o,s){s(e,reactExports)})(commonjsGlobal,function(o,s){function a(_t){return _t&&typeof _t=="object"&&"default"in _t?_t:{default:_t}}var c=a(s),d=function(){return d=Object.assign||function(ut){for(var gt,yt=1,kt=arguments.length;yt<kt;yt++){gt=arguments[yt];for(var lt in gt)Object.prototype.hasOwnProperty.call(gt,lt)&&(ut[lt]=gt[lt])}return ut},d.apply(this,arguments)};function h(_t,ut,gt){if(gt||arguments.length===2)for(var yt=0,kt=ut.length,lt;yt<kt;yt++)(lt||!(yt in ut))&&(lt||(lt=Array.prototype.slice.call(ut,0,yt)),lt[yt]=ut[yt]);return _t.concat(lt||Array.prototype.slice.call(ut))}typeof SuppressedError=="function"&&SuppressedError;var g={exports:{}},_={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j;function b(){if(j)return _;j=1;var _t=c.default,ut=Symbol.for("react.element"),gt=Symbol.for("react.fragment"),yt=Object.prototype.hasOwnProperty,kt=_t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,lt={key:!0,ref:!0,__self:!0,__source:!0};function Mt(wt,jt,at){var pt,ct={},Ct=null,Pt=null;at!==void 0&&(Ct=""+at),jt.key!==void 0&&(Ct=""+jt.key),jt.ref!==void 0&&(Pt=jt.ref);for(pt in jt)yt.call(jt,pt)&&!lt.hasOwnProperty(pt)&&(ct[pt]=jt[pt]);if(wt&&wt.defaultProps)for(pt in jt=wt.defaultProps,jt)ct[pt]===void 0&&(ct[pt]=jt[pt]);return{$$typeof:ut,type:wt,key:Ct,ref:Pt,props:ct,_owner:kt.current}}return _.Fragment=gt,_.jsx=Mt,_.jsxs=Mt,_}g.exports=b();var $=g.exports,nt=function(_t,ut,gt){return typeof _t=="function"?_t(gt):typeof _t=="object"?_t:ut(gt)},tt={3:"rotate(180deg)",2:"rotateY(180deg)",4:"rotate(180deg) rotateY(180deg)",5:"rotate(270deg) rotateY(180deg)",6:"rotate(90deg)",7:"rotate(90deg) rotateY(180deg)",8:"rotate(270deg)"},it=16,ot={display:"flex",flexWrap:"wrap"},_e=function(_t){var ut=_t.item,gt=tt[ut.orientation],yt={cursor:"pointer",maxWidth:"none",width:ut.scaledWidth,height:ut.scaledHeight,marginLeft:ut.marginLeft,marginTop:0,transform:gt};if(ut.isSelected){var kt=ut.scaledWidth/ut.scaledHeight,lt=ut.scaledHeight-it*2,Mt=ut.viewportWidth-it*2,wt=void 0,jt=void 0;ut.scaledWidth>ut.scaledHeight?(jt=ut.scaledWidth-it*2,wt=Math.floor(jt/kt)):(wt=ut.scaledHeight-it*2,jt=Math.floor(wt*kt));var at=Math.abs(Math.floor((lt-wt)/2)),pt=Math.abs(Math.floor((Mt-jt)/2));yt.width=jt,yt.height=wt,yt.marginLeft=pt===0?0:-pt,yt.marginTop=at===0?0:-at}return yt},et=function(_t){var ut=_t.item,gt={width:ut.viewportWidth,height:ut.scaledHeight,overflow:"hidden"};return ut.nano&&(gt.background="url(".concat(ut.nano,")"),gt.backgroundSize="cover",gt.backgroundPosition="center center"),ut.isSelected&&(gt.width=ut.viewportWidth-it*2,gt.height=ut.scaledHeight-it*2,gt.margin=it),gt},rt=function(_t){var ut=_t.hover;return{pointerEvents:"none",opacity:ut?1:0,position:"absolute",height:"100%",width:"100%"}},st=function(_t){var ut=_t.margin;return{margin:ut,WebkitUserSelect:"none",position:"relative",background:"#eee",padding:"0px"}},dt=function(_t){var ut=_t.showOverlay;return{pointerEvents:"none",opacity:1,position:"absolute",height:"100%",width:"100%",background:ut?"linear-gradient(to bottom,rgba(0,0,0,0.26),transparent 56px,transparent)":"none"}},ht={pointerEvents:"none",opacity:1,position:"absolute",height:"36px",width:"100%"},mt={background:"white",width:"100%",margin:0,userSelect:"text",WebkitUserSelect:"text",MozUserSelect:"text",overflow:"hidden"},ft={padding:"2px",pointerEvents:"none",position:"absolute",minHeight:"0px",maxHeight:"160px",width:"100%",bottom:"0px",overflow:"hidden"},bt={display:"inline-block",cursor:"pointer",pointerEvents:"visible",margin:"2px"},vt=function(){return{display:"inline",padding:".2em .6em .3em",fontSize:"75%",fontWeight:"600",lineHeight:"1",color:"yellow",background:"rgba(0,0,0,0.65)",textAlign:"center",whiteSpace:"nowrap",verticalAlign:"baseline",borderRadius:".25em"}},Et=function(_t){var ut=_t.isVisible;return{visibility:ut?"visible":"hidden",background:"none",float:"left",width:36,height:36,border:"none",padding:6,cursor:"pointer",pointerEvents:"visible"}},It=function(_t){var ut=_t.isSelected,gt=ut===void 0?!1:ut,yt=_t.isVisible,kt=yt===void 0?!0:yt,lt=_t.onClick,Mt=_t.color,wt=Mt===void 0?"#FFFFFFB2":Mt,jt=_t.selectedColor,at=jt===void 0?"#4285F4FF":jt,pt=_t.hoverColor,ct=pt===void 0?"#FFFFFFFF":pt,Ct=s.useState(!1),Pt=Ct[0],Tt=Ct[1],Ut={display:gt?"block":"none"},Ot=gt?at:Pt?ct:wt,Vt=function(){return Tt(!0)},Jt=function(){return Tt(!1)};return $.jsx("div",d({"data-testid":"grid-gallery-item_check-button",title:"Select",style:Et({isVisible:kt}),onClick:lt,onMouseOver:Vt,onMouseOut:Jt},{children:$.jsxs("svg",d({fill:Ot,height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},{children:[$.jsxs("radialGradient",d({id:"shadow",cx:"38",cy:"95.488",r:"10.488",gradientTransform:"matrix(1 0 0 -1 -26 109)",gradientUnits:"userSpaceOnUse"},{children:[$.jsx("stop",{offset:".832",stopColor:"#010101"}),$.jsx("stop",{offset:"1",stopColor:"#010101",stopOpacity:"0"})]})),$.jsx("circle",{style:Ut,opacity:".26",fill:"url(#shadow)",cx:"12",cy:"13.512",r:"10.488"}),$.jsx("circle",{style:Ut,fill:"#FFF",cx:"12",cy:"12.2",r:"8.292"}),$.jsx("path",{d:"M0 0h24v24H0z",fill:"none"}),$.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})]}))}))},Rt=function(_t){var ut=_t.item,gt=_t.thumbnailImageComponent,yt=_t.isSelectable,kt=yt===void 0?!0:yt,lt=_t.thumbnailStyle,Mt=_t.tagStyle,wt=_t.tileViewportStyle,jt=_t.margin,at=_t.index,pt=_t.onSelect,ct=_t.onClick,Ct={item:ut},Pt=s.useState(!1),Tt=Pt[0],Ut=Pt[1],Ot={key:at,"data-testid":"grid-gallery-item_thumbnail",src:ut.src,alt:ut.alt?ut.alt:"",title:typeof ut.caption=="string"?ut.caption:null,style:nt(lt,_e,Ct)},Vt=function(Lt){kt&&pt(at,Lt)},Jt=function(Lt){ct(at,Lt)},Nt={item:ut,index:at,margin:jt,onSelect:pt,onClick:ct,isSelectable:kt,tileViewportStyle:wt,thumbnailStyle:lt,tagStyle:Mt};return $.jsxs("div",d({className:"ReactGridGallery_tile","data-testid":"grid-gallery-item",onMouseEnter:function(){return Ut(!0)},onMouseLeave:function(){return Ut(!1)},style:st({margin:jt})},{children:[$.jsx("div",d({className:"ReactGridGallery_tile-icon-bar",style:ht},{children:$.jsx(It,{isSelected:ut.isSelected,isVisible:ut.isSelected||kt&&Tt,onClick:Vt})})),!!ut.tags&&$.jsx("div",d({className:"ReactGridGallery_tile-bottom-bar",style:ft},{children:ut.tags.map(function(Lt,zt){return $.jsx("div",d({title:Lt.title,style:bt},{children:$.jsx("span",d({style:nt(Mt,vt,Ct)},{children:Lt.value}))}),Lt.key||zt)})})),!!ut.customOverlay&&$.jsx("div",d({className:"ReactGridGallery_custom-overlay",style:rt({hover:Tt})},{children:ut.customOverlay})),$.jsx("div",{className:"ReactGridGallery_tile-overlay",style:dt({showOverlay:Tt&&!ut.isSelected&&kt})}),$.jsx("div",d({className:"ReactGridGallery_tile-viewport","data-testid":"grid-gallery-item_viewport",style:nt(wt,et,Ct),onClick:Jt},{children:gt?$.jsx(gt,d({},Nt,{imageProps:Ot})):$.jsx("img",d({},Ot))})),ut.thumbnailCaption&&$.jsx("div",d({className:"ReactGridGallery_tile-description",style:mt},{children:ut.thumbnailCaption}))]}))};function Dt(_t){var ut=s.useRef(null),gt=s.useRef(),yt=s.useState(_t),kt=yt[0],lt=yt[1],Mt=s.useCallback(function(wt){var jt;(jt=gt.current)===null||jt===void 0||jt.disconnect(),gt.current=void 0,ut.current=wt;var at=function(){if(ut.current){var pt=ut.current.clientWidth;try{pt=ut.current.getBoundingClientRect().width}catch{}lt(Math.floor(pt))}};at(),wt&&typeof ResizeObserver<"u"&&(gt.current=new ResizeObserver(at),gt.current.observe(wt))},[]);return{containerRef:Mt,containerWidth:kt}}var Ft=function(_t,ut,gt){var yt=[],kt=0;for(var lt in _t){var Mt=_t[lt],wt=Mt.scaledWidth/ut;yt[lt]=Math.floor(wt*gt),kt+=yt[lt]}for(var jt=gt-kt;jt>0;)for(var lt in yt)if(yt[lt]++,jt--,jt<0)break;return yt},Gt=function(_t,ut){for(var gt=ut.containerWidth,yt=ut.rowHeight,kt=ut.margin,lt=[],Mt=2*kt,wt=h([],_t,!0),jt=0;wt.length>0&&jt<gt;){var at=wt.shift(),pt=Math.floor(yt*(at.width/at.height)),ct=d(d({},at),{scaledHeight:yt,scaledWidth:pt,viewportWidth:pt,marginLeft:0});lt.push(ct),jt+=ct.scaledWidth+Mt}var Ct=jt-gt;if(lt.length>0&&Ct>0){var Pt=Ft(lt,jt,Ct);for(var Tt in lt){var Ut=Pt[Tt],at=lt[Tt];at.marginLeft=-Math.abs(Math.floor(Ut/2)),at.viewportWidth=at.scaledWidth-Ut}}return[lt,wt]},Ht=function(_t,ut,gt){gt===void 0&&(gt=[]);var yt=Gt(_t,ut),kt=yt[0],lt=yt[1],Mt=h(h([],gt,!0),[kt],!1);return ut.maxRows&&Mt.length>=ut.maxRows?Mt:lt.length?Ht(lt,ut,Mt):Mt},St=function(_t,ut){var gt=ut.containerWidth,yt=ut.maxRows,kt=ut.rowHeight,lt=ut.margin;if(kt=typeof kt>"u"?180:kt,lt=typeof lt>"u"?2:lt,!_t)return[];if(!gt)return[];var Mt={containerWidth:gt,maxRows:yt,rowHeight:kt,margin:lt};return Ht(_t,Mt)},xt=function(_t,ut){var gt=St(_t,ut);return[].concat.apply([],gt)},$t=function(_t){var ut=_t.images,gt=_t.id,yt=gt===void 0?"ReactGridGallery":gt,kt=_t.enableImageSelection,lt=kt===void 0?!0:kt,Mt=_t.onSelect,wt=Mt===void 0?function(){}:Mt,jt=_t.rowHeight,at=jt===void 0?180:jt,pt=_t.maxRows,ct=_t.margin,Ct=ct===void 0?2:ct,Pt=_t.defaultContainerWidth,Tt=Pt===void 0?0:Pt,Ut=_t.onClick,Ot=Ut===void 0?function(){}:Ut,Vt=_t.tileViewportStyle,Jt=_t.thumbnailStyle,Nt=_t.tagStyle,Lt=_t.thumbnailImageComponent,zt=Dt(Tt),Kt=zt.containerRef,Bt=zt.containerWidth,Wt=xt(ut,{containerWidth:Bt,maxRows:pt,rowHeight:at,margin:Ct}),At=function(Zt,Xt){Xt.preventDefault(),wt(Zt,ut[Zt],Xt)},Qt=function(Zt,Xt){Ot(Zt,ut[Zt],Xt)};return $.jsx("div",d({id:yt,className:"ReactGridGallery",ref:Kt},{children:$.jsx("div",d({style:ot},{children:Wt.map(function(Zt,Xt){return $.jsx(Rt,{item:Zt,index:Xt,margin:Ct,height:at,isSelectable:lt,onClick:Qt,onSelect:At,tagStyle:Nt,tileViewportStyle:Vt,thumbnailStyle:Jt,thumbnailImageComponent:Lt},Zt.key||Xt)})}))}))};$t.displayName="Gallery",o.CheckButton=It,o.Gallery=$t,o.buildLayout=St,o.buildLayoutFlat=xt,Object.defineProperty(o,"__esModule",{value:!0})})})(reactGridGallery_umd,reactGridGallery_umd.exports);var reactGridGallery_umdExports=reactGridGallery_umd.exports;const AlbumScreen=({onCreateSession:i,onReturn:e})=>{const[o,s]=reactExports.useState([]),[a,c]=reactExports.useState([]);reactExports.useEffect(()=>{const h=()=>{const _=localStorage.getItem("albumPhotos");_&&s(JSON.parse(_))},g=()=>{const _=localStorage.getItem("combinedSessions");_&&c(JSON.parse(_))};h(),g()},[]);const d=()=>{typeof i=="function"&&i()};return jsxRuntimeExports.jsxs("div",{className:"album-screen",children:[jsxRuntimeExports.jsxs("div",{className:"album-header",children:[jsxRuntimeExports.jsx("h1",{children:"My Album"}),jsxRuntimeExports.jsxs("div",{className:"album-actions",children:[jsxRuntimeExports.jsx("button",{className:"btn btn-primary rainbow-button",onClick:d,children:"Create New Session"}),jsxRuntimeExports.jsx("button",{className:"btn btn-secondary return-btn",onClick:e,children:"Return to Sessions"})]})]}),a.length>0&&jsxRuntimeExports.jsxs("div",{className:"combined-sessions",children:[jsxRuntimeExports.jsx("h2",{children:"Combined Photo Sessions"}),jsxRuntimeExports.jsx("div",{className:"sessions-grid",children:a.map((h,g)=>jsxRuntimeExports.jsxs("div",{className:"session-card",children:[jsxRuntimeExports.jsxs("h3",{children:["Session: ",h.id.substring(0,8),"..."]}),jsxRuntimeExports.jsx("div",{className:"session-photos-preview",children:h.photos.slice(0,4).map((_,j)=>jsxRuntimeExports.jsx("div",{className:"preview-photo",children:jsxRuntimeExports.jsx("img",{src:_.dataUrl,alt:`Session preview ${j}`})},j))}),jsxRuntimeExports.jsx("p",{children:new Date(h.timestamp).toLocaleString()})]},g))})]}),o.length>0?jsxRuntimeExports.jsxs("div",{className:"album-content",children:[jsxRuntimeExports.jsx("h2",{children:"Individual Photos"}),jsxRuntimeExports.jsx(reactGridGallery_umdExports.Gallery,{images:o.map(h=>({src:h.url,thumbnail:h.url,thumbnailWidth:h.width,thumbnailHeight:h.height,caption:new Date(h.timestamp).toLocaleString(),alt:`Photo taken at ${new Date(h.timestamp).toLocaleString()}`})),enableImageSelection:!1,rowHeight:180,margin:4})]}):jsxRuntimeExports.jsx("div",{className:"empty-album",children:jsxRuntimeExports.jsx("p",{children:"No photos yet. Start a new session to take some pictures!"})})]})};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var __assign$1=function(){return __assign$1=Object.assign||function(e){for(var o,s=1,a=arguments.length;s<a;s++){o=arguments[s];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(e[c]=o[c])}return e},__assign$1.apply(this,arguments)};function pad(i,e){for(;i.length<e;)i="0"+i;return i}function fold(i,e){var o,s,a;if(e.length===0)return i;for(o=0,a=e.length;o<a;o++)s=e.charCodeAt(o),i=(i<<5)-i+s,i|=0;return i<0?i*-2:i}function foldObject(i,e,o){return Object.keys(e).sort().reduce(s,i);function s(a,c){return foldValue(a,e[c],c,o)}}function foldValue(i,e,o,s){var a=fold(fold(fold(i,o),toString$1(e)),typeof e);if(e===null)return fold(a,"null");if(e===void 0)return fold(a,"undefined");if(typeof e=="object"||typeof e=="function"){if(s.indexOf(e)!==-1)return fold(a,"[Circular]"+o);s.push(e);var c=foldObject(a,e,s);if(!("valueOf"in e)||typeof e.valueOf!="function")return c;try{return fold(c,String(e.valueOf()))}catch(d){return fold(c,"[valueOf exception]"+(d.stack||d.message))}}return fold(a,e.toString())}function toString$1(i){return Object.prototype.toString.call(i)}function sum(i){return pad(foldValue(0,i,"",[]).toString(16),8)}var hashSum=sum;const hash=getDefaultExportFromCjs(hashSum);(function(){if(typeof window>"u"||typeof window.CustomEvent=="function")return!1;function i(e,o){o=o||{bubbles:!1,cancelable:!1,detail:null};var s=document.createEvent("CustomEvent");return s.initCustomEvent(e,o.bubbles,o.cancelable,o.detail),s}window.CustomEvent=i})();var isSafari=typeof window<"u"&&/^((?!chrome|android).)*safari/i.test(window.navigator.userAgent),isClient=typeof window<"u";function nextTick$1(i){if(!isClient||isSafari||typeof MutationObserver>"u"){setTimeout(i);return}var e=0,o=new MutationObserver(function(){return i()}),s=document.createTextNode("");o.observe(s,{characterData:!0}),s.data=String(e=++e)}var PROPERTY_NAME_DENY_LIST=Object.freeze(["__proto__","prototype","constructor"]),QueryString=function(){function i(){}return i.parseDeep=function(e){var o=this.parse(e);return this.deepen(o)},i.stringifyDeep=function(e){var o=this.flatten(e);return this.stringify(o)},i.parse=function(e){for(var o={},s=(e[0]==="?"?e.substr(1):e).split("&"),a=0;a<s.length;a++){var c=s[a].split("=");try{o[decodeURIComponent(c[0])]=decodeURIComponent(c[1]||"")}catch{}}return o},i.stringify=function(e){var o="";for(var s in e)if(e.hasOwnProperty(s)){var a=e[s];o&&(o+="&"),o+=encodeURIComponent(s)+"="+encodeURIComponent(a)}return o},i.deepen=function(e){var o={};for(var s in e){for(var a=o,c=s.split("."),d=c.pop(),h=0,g=c;h<g.length;h++){var _=g[h];assertAllowedPropertyName(_),a=a[_]=a[_]||{}}a[d]=e[s]}return o},i.flatten=function(e,o,s){s===void 0&&(s={});for(var a in e){var c=e[a],d=o?o+"."+a:a;c&&typeof c=="object"?this.flatten(c,d,s):s[d]=c}return s},i}();function assertAllowedPropertyName(i){if(PROPERTY_NAME_DENY_LIST.indexOf(i)>=0)throw new Error('Property name "'.concat(i,'" is not allowed'))}var Subscription=function(){function i(e,o){this.listeners=e,this.listener=o,this.unsubscribed=!1,this.otherSubscriptions=[]}return Object.defineProperty(i.prototype,"closed",{get:function(){return this.unsubscribed},enumerable:!1,configurable:!0}),i.prototype.add=function(e){this.otherSubscriptions.push(e)},i.prototype.unsubscribe=function(){if(!this.unsubscribed){if(this.listener&&this.listeners){var e=this.listeners.indexOf(this.listener);e>-1&&this.listeners.splice(e,1)}this.otherSubscriptions.forEach(function(o){return o.unsubscribe()}),this.unsubscribed=!0}},i}(),BehaviorSubject=function(){function i(e){var o=this;this.value=e,this.listeners=[],this.errorListeners=[],this.then=function(){for(var s,a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];return(s=o.toPromise()).then.apply(s,a)}}return i.prototype.next=function(e){this.value=e;for(var o=0,s=this.listeners;o<s.length;o++){var a=s[o];a(e)}},i.prototype.map=function(e){var o=new i(e(this.value));return this.subscribe(function(s){o.next(e(s))}),this.catch(function(s){o.error(s)}),o},i.prototype.catch=function(e){return this.errorListeners.push(e),new Subscription(this.errorListeners,e)},i.prototype.error=function(e){for(var o=0,s=this.errorListeners;o<s.length;o++){var a=s[o];a(e)}},i.prototype.subscribe=function(e,o){return this.listeners.push(e),o&&this.errorListeners.push(o),new Subscription(this.listeners,e)},i.prototype.toPromise=function(){var e=this;return new Promise(function(o,s){var a=e.subscribe(function(c){o(c),a.unsubscribe()},function(c){s(c),a.unsubscribe()})})},i.prototype.promise=function(){return this.toPromise()},i}(),State={Pending:"Pending",Fulfilled:"Fulfilled",Rejected:"Rejected"};function isFunction(i){return i&&typeof i=="function"}function isObject(i){return i&&typeof i=="object"}var TinyPromise=function(){function i(e){this._state=State.Pending,this._handlers=[],this._value=null,e(this._resolve.bind(this),this._reject.bind(this))}return i.prototype._resolve=function(e){var o=this;if(e instanceof i)e.then(this._resolve.bind(this),this._reject.bind(this));else if(isObject(e)||isFunction(e)){var s=!1;try{var a=e.then;isFunction(a)?a.call(e,function(c){s||o._resolve(c),s=!0},function(c){s||o._reject(c),s=!0}):this._fulfill(e)}catch(c){s||this._reject(c)}}else this._fulfill(e)},i.prototype._fulfill=function(e){var o=this;this._state=State.Fulfilled,this._value=e,this._handlers.forEach(function(s){return o._callHandler(s)})},i.prototype._reject=function(e){var o=this;this._state=State.Rejected,this._value=e,this._handlers.forEach(function(s){return o._callHandler(s)})},i.prototype._isPending=function(){return this._state===State.Pending},i.prototype._isFulfilled=function(){return this._state===State.Fulfilled},i.prototype._isRejected=function(){return this._state===State.Rejected},i.prototype._addHandler=function(e,o){this._handlers.push({onFulfilled:e,onRejected:o})},i.prototype._callHandler=function(e){this._isFulfilled()&&isFunction(e.onFulfilled)?e.onFulfilled(this._value):this._isRejected()&&isFunction(e.onRejected)&&e.onRejected(this._value)},i.prototype.then=function(e,o){var s=this;switch(this._state){case State.Pending:return new i(function(a,c){s._addHandler(function(d){nextTick$1(function(){try{isFunction(e)?a(e(d)):a(d)}catch(h){c(h)}})},function(d){nextTick$1(function(){try{isFunction(o)?a(o(d)):c(d)}catch(h){c(h)}})})});case State.Fulfilled:return new i(function(a,c){nextTick$1(function(){try{isFunction(e)?a(e(s._value)):a(s._value)}catch(d){c(d)}})});case State.Rejected:return new i(function(a,c){nextTick$1(function(){try{isFunction(o)?a(o(s._value)):c(s._value)}catch(d){c(d)}})})}},i}(),Promise$1=typeof Promise<"u"?Promise:TinyPromise,serverOnlyRequire;try{serverOnlyRequire=eval("require")}catch(i){serverOnlyRequire=function(){return null}}var serverOnlyRequire$1=serverOnlyRequire;function promiseResolve(i){return new Promise$1(function(e){return e(i)})}function tinyFetch(i,e){return e===void 0&&(e={}),new Promise$1(function(o,s){var a=new XMLHttpRequest;if(a.open(e.method||"get",i,!0),e.headers)for(var c in e.headers)a.setRequestHeader(c,e.headers[c]);a.withCredentials=e.credentials==="include",a.onload=function(){o(d())},a.onerror=s,a.send(e.body);function d(){var h=[],g=[],_={},j=void 0;return a.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(b,$,nt){var tt=$;return h.push(tt=tt.toLowerCase()),g.push([tt,nt]),j=_[tt],_[tt]=j?"".concat(j,",").concat(nt):nt,""}),{ok:(a.status/100|0)===2,status:a.status,statusText:a.statusText,url:a.responseURL,clone:d,text:function(){return promiseResolve(a.responseText)},json:function(){return promiseResolve(a.responseText).then(JSON.parse)},blob:function(){return promiseResolve(new Blob([a.response]))},headers:{keys:function(){return h},entries:function(){return g},get:function(b){return _[b.toLowerCase()]},has:function(b){return b.toLowerCase()in _}}}}})}function getFetch(){var i=void 0;if(globalThis.fetch)i??(i=globalThis.fetch);else if(typeof window>"u")try{i??(i=serverOnlyRequire$1("node-fetch"))}catch(e){console.warn("node-fetch is not installed. consider polyfilling fetch or installing node-fetch."),console.warn(e)}return i??tinyFetch}function assign(i){for(var e=Object(i),o=1;o<arguments.length;o++){var s=arguments[o];if(s!=null)for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}function throttle$1(i,e,o){o===void 0&&(o={});var s,a,c,d=null,h=0,g=function(){h=o.leading===!1?0:Date.now(),d=null,c=i.apply(s,a),d||(s=a=null)};return function(){var _=Date.now();!h&&o.leading===!1&&(h=_);var j=e-(_-h);return s=this,a=arguments,j<=0||j>e?(d&&(clearTimeout(d),d=null),h=_,c=i.apply(s,a),d||(s=a=null)):!d&&o.trailing!==!1&&(d=setTimeout(g,j)),c}}var camelCaseToKebabCase$1=function(i){return i?i.replace(/([A-Z])/g,function(e){return"-".concat(e[0].toLowerCase())}):""},Animator=function(){function i(){}return i.prototype.bindAnimations=function(e){for(var o=0,s=e;o<s.length;o++){var a=s[o];switch(a.trigger){case"pageLoad":this.triggerAnimation(a);break;case"hover":this.bindHoverAnimation(a);break;case"scrollInView":this.bindScrollInViewAnimation(a);break}}},i.prototype.warnElementNotPresent=function(e){console.warn("Cannot animate element: element with ID ".concat(e," not found!"))},i.prototype.augmentAnimation=function(e,o){for(var s=this.getAllStylesUsed(e),a=getComputedStyle(o),c=e.steps[0].styles,d=e.steps[e.steps.length-1].styles,h=[c,d],g=0,_=h;g<_.length;g++)for(var j=_[g],b=0,$=s;b<$.length;b++){var nt=$[b];nt in j||(j[nt]=a[nt])}},i.prototype.getAllStylesUsed=function(e){for(var o=[],s=0,a=e.steps;s<a.length;s++){var c=a[s];for(var d in c.styles)o.indexOf(d)===-1&&o.push(d)}return o},i.prototype.triggerAnimation=function(e){var o=this,s=Array.prototype.slice.call(document.getElementsByClassName(e.elementId||e.id||""));if(!s.length){this.warnElementNotPresent(e.elementId||e.id||"");return}Array.from(s).forEach(function(a){o.augmentAnimation(e,a),a.style.transition="none",a.style.transitionDelay="0",assign(a.style,e.steps[0].styles),setTimeout(function(){a.style.transition="all ".concat(e.duration,"s ").concat(camelCaseToKebabCase$1(e.easing)),e.delay&&(a.style.transitionDelay=e.delay+"s"),assign(a.style,e.steps[1].styles),setTimeout(function(){a.style.transition="",a.style.transitionDelay=""},(e.delay||0)*1e3+e.duration*1e3+100)})})},i.prototype.bindHoverAnimation=function(e){var o=this,s=Array.prototype.slice.call(document.getElementsByClassName(e.elementId||e.id||""));if(!s.length){this.warnElementNotPresent(e.elementId||e.id||"");return}Array.from(s).forEach(function(a){o.augmentAnimation(e,a);var c=e.steps[0].styles,d=e.steps[1].styles;function h(){assign(a.style,c)}function g(){assign(a.style,d)}h(),a.addEventListener("mouseenter",g),a.addEventListener("mouseleave",h),setTimeout(function(){a.style.transition="all ".concat(e.duration,"s ").concat(camelCaseToKebabCase$1(e.easing)),e.delay&&(a.style.transitionDelay=e.delay+"s")})})},i.prototype.bindScrollInViewAnimation=function(e){var o=this,s=Array.prototype.slice.call(document.getElementsByClassName(e.elementId||e.id||""));if(!s.length){this.warnElementNotPresent(e.elementId||e.id||"");return}Array.from(s).forEach(function(a){o.augmentAnimation(e,a);var c=!1,d=!1;function h(){!c&&_(a)?(c=!0,d=!0,setTimeout(function(){assign(a.style,e.steps[1].styles),e.repeat||document.removeEventListener("scroll",g),setTimeout(function(){d=!1,e.repeat||(a.style.transition="",a.style.transitionDelay="")},(e.duration+(e.delay||0))*1e3+100)})):e.repeat&&c&&!d&&!_(a)&&(c=!1,assign(a.style,e.steps[0].styles))}var g=throttle$1(h,200,{leading:!1});function _($){var nt=$.getBoundingClientRect(),tt=window.innerHeight,it=(e.thresholdPercent||0)/100,ot=it*tt;return nt.bottom>ot&&nt.top<tt-ot}var j=e.steps[0].styles;function b(){assign(a.style,j)}b(),setTimeout(function(){a.style.transition="all ".concat(e.duration,"s ").concat(camelCaseToKebabCase$1(e.easing)),e.delay&&(a.style.transitionDelay=e.delay+"s")}),document.addEventListener("scroll",g,{capture:!0,passive:!0}),h()})},i}(),fieldContentRegExp=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,Cookies=function(){function i(e,o){this.request=e,this.response=o}return i.prototype.get=function(e){var o=this.request.headers.cookie;if(o){var s=o.match(getPattern(e));if(s){var a=s[1];return a}}},i.prototype.set=function(e,o,s){var a=this.response,c=this.request,d=a.getHeader("Set-Cookie")||[],h=this.secure!==void 0?!!this.secure:c.protocol==="https"||c.connection.encrypted,g=new Cookie(e,o,s);if(typeof d=="string"&&(d=[d]),!h&&s&&s.secure)throw new Error("Cannot send secure cookie over unencrypted connection");g.secure=h,s&&"secure"in s&&(g.secure=!!s.secure),pushCookie(d,g);var _=a.setHeader;return _.call(a,"Set-Cookie",d),this},i}(),Cookie=function(){function i(e,o,s){if(this.path="/",this.domain=void 0,this.httpOnly=!0,this.sameSite=!1,this.secure=!1,this.overwrite=!1,this.name="",this.value="",!fieldContentRegExp.test(e))throw new TypeError("argument name is invalid");if(o&&!fieldContentRegExp.test(o))throw new TypeError("argument value is invalid");o||(this.expires=new Date(0)),this.name=e,this.value=o||"",s.expires&&(this.expires=s.expires),s.secure&&(this.secure=s.secure)}return i.prototype.toString=function(){return"".concat(this.name,"=").concat(this.value)},i.prototype.toHeader=function(){var e=this.toString();return this.maxAge&&(this.expires=new Date(Date.now()+this.maxAge)),this.path&&(e+="; path=".concat(this.path)),this.expires&&(e+="; expires=".concat(this.expires.toUTCString())),this.domain&&(e+="; domain=".concat(this.domain)),e+="; SameSite=".concat(this.sameSite===!0?"strict":"None"),this.secure&&(e+="; secure"),this.httpOnly&&(e+="; httponly"),e},i}();function getPattern(i){return new RegExp("(?:^|;) *".concat(i.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"=([^;]*)"))}function pushCookie(i,e){if(e.overwrite)for(var o=i.length-1;o>=0;o--)i[o].indexOf("".concat(e.name,"="))===0&&i.splice(o,1);i.push(e.toHeader())}function omit$3(i){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];for(var s=Object.assign({},i),a=0,c=e;a<c.length;a++){var d=c[a];delete s[d]}return s}function uuidv4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var e=Math.random()*16|0,o=i=="x"?e:e&3|8;return o.toString(16)})}function uuid(){return uuidv4().replace(/-/g,"")}function emptyUrl(){return{query:null,port:null,auth:null,hash:null,host:null,hostname:null,href:null,path:null,pathname:null,protocol:null,search:null,slashes:null}}function parse$1(i){var e,o=emptyUrl(),s,a=i===""||i[0]==="/";return a?(s=new URL(i,"http://0.0.0.0/"),o.href=s.href,o.href=(e=o.href)===null||e===void 0?void 0:e.slice(14)):(s=new URL(i),o.href=s.href,o.port=s.port===""?null:s.port,o.hash=s.hash===""?null:s.hash,o.host=s.host,o.hostname=s.hostname,o.href=s.href,o.pathname=s.pathname,o.protocol=s.protocol,o.slashes=i[s.protocol.length]==="/"),o.search=s.search,o.query=s.search.slice(1),o.path="".concat(s.pathname).concat(s.search),o.pathname=s.pathname,o}function toError$1(i){return i instanceof Error?i:new Error(String(i))}var DEFAULT_API_VERSION="v3",SDK_VERSION$1="6.0.9";function datePlusMinutes(i){return i===void 0&&(i=30),new Date(Date.now()+i*6e4)}var isPositiveNumber=function(i){return typeof i=="number"&&!isNaN(i)&&i>=0},isReactNative=typeof navigator=="object"&&navigator.product==="ReactNative",validEnvList=["production","qa","test","development","dev","cdn-qa","cloud","fast","cdn2","cdn-prod"];function getQueryParam(i,e){for(var o=i.split("?")[1]||"",s=o.split("&"),a=0;a<s.length;a++){var c=s[a].split("=");if(decodeURIComponent(c[0])===e)return decodeURIComponent(c[1])}return null}var urlParser={parse:function(i){var e=document.createElement("a");e.href=i;for(var o={},s=["username","password","host","hostname","port","protocol","origin","pathname","search","hash"],a=0,c=s;a<c.length;a++){var d=c[a];o[d]=e[d]}return(o.pathname||o.pathname==="")&&typeof o.pathname=="string"&&o.pathname.indexOf("/")!==0&&(o.pathname="/"+o.pathname),o}},parse=isReactNative?function(){return emptyUrl()}:typeof window=="object"?urlParser.parse:parse$1;function setCookie(i,e,o){try{var s="";o&&(s="; expires="+o.toUTCString());var a=isBrowser$1?location.protocol==="https:":!0;document.cookie=i+"="+(e||"")+s+"; path=/"+(a?"; secure; SameSite=None":"")}catch(c){console.warn("Could not set cookie",c)}}function getCookie(i){try{return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(i).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null}catch(e){console.warn("Could not get cookie",e)}}function size$2(i){return Object.keys(i).length}function find(i,e){for(var o=i,s=o.length>>>0,a=arguments[1],c=0;c<s;c++){var d=o[c];if(e.call(a,d,c,o))return d}}var sessionStorageKey="builderSessionId",localStorageKey="builderVisitorId",isBrowser$1=typeof window<"u"&&!isReactNative,isIframe=isBrowser$1&&window.top!==window.self,Builder=function(){function i(e,o,s,a,c,d){e===void 0&&(e=null),a===void 0&&(a=!1),c===void 0&&(c=null);var h=this;if(this.request=o,this.response=s,this.eventsQueue=[],this.throttledClearEventsQueue=throttle$1(function(){h.processEventsQueue(),h.setCookie(sessionStorageKey,h.sessionId,datePlusMinutes(30))},5),this.env="production",this.sessionId=this.getSessionId(),this.targetContent=!0,this.contentPerRequest=1,this.allowCustomFonts=!0,this.cookies=null,this.cachebust=!1,this.overrideParams="",this.noCache=!1,this.preview=!1,this.apiEndpoint$=new BehaviorSubject("query"),this.apiVersion$=new BehaviorSubject(void 0),this.canTrack$=new BehaviorSubject(!this.browserTrackingDisabled),this.hasOverriddenCanTrack=!1,this.apiKey$=new BehaviorSubject(null),this.authToken$=new BehaviorSubject(null),this.userAttributesChanged=new BehaviorSubject(null),this.editingMode$=new BehaviorSubject(isIframe),this.editingModel$=new BehaviorSubject(null),this.userAgent=typeof navigator=="object"&&navigator.userAgent||"",this.trackingHooks=[],this.visitorId=this.getVisitorId(),this.autoTrack=i.isBrowser?!this.isDevelopmentEnv&&!(i.isBrowser&&location.search.indexOf("builder.preview=")!==-1):!1,this.trackingUserAttributes={},this.blockContentLoading="",this.observersByKey={},this.noEditorUpdates={},this.overrides={},this.queryOptions={},this.getContentQueue=null,this.priorContentQueue=null,this.testCookiePrefix="builder.tests",this.cookieQueue=[],i.isBrowser&&!a&&i.singletonInstance)return i.singletonInstance;if(this.request&&this.response&&(this.setUserAgent(this.request.headers["user-agent"]||""),this.cookies=new Cookies(this.request,this.response)),e&&(this.apiKey=e),d&&(this.apiVersion=d),c&&(this.authToken=c),isBrowser$1&&i.isEditing&&(this.bindMessageListeners(),parent.postMessage({type:"builder.animatorOptions",data:{options:{version:2}}},"*")),isIframe&&this.messageFrameLoaded(),this.canTrack$.subscribe(function(j){if(j){if(typeof sessionStorage<"u")try{sessionStorage.getItem(sessionStorageKey)||sessionStorage.setItem(sessionStorageKey,h.sessionId)}catch(b){console.debug("Session storage error",b)}h.eventsQueue.length&&h.throttledClearEventsQueue(),h.cookieQueue.length&&(h.cookieQueue.forEach(function(b){h.setCookie(b[0],b[1])}),h.cookieQueue.length=0)}}),isBrowser$1){this.setTestsFromUrl(),this.getOverridesFromQueryString();var g=this.getCookie(i.attributesCookieName);if(g)try{var _=JSON.parse(g);this.setUserAttributes(_)}catch(j){console.debug("Error parsing user attributes cookie",j)}}}return i.register=function(e,o){e==="plugin"&&(o=this.serializeIncludingFunctions(o,!0));var s=this.registry[e];if(s||(s=this.registry[e]=[]),s.push(o),i.isBrowser){var a={type:"builder.register",data:{type:e,info:o}};try{parent.postMessage(a,"*"),parent!==window&&window.postMessage(a,"*")}catch(c){console.debug("Could not postmessage",c)}}this.registryChange.next(this.registry)},i.registerEditor=function(e){if(i.isBrowser){window.postMessage({type:"builder.registerEditor",data:omit$3(e,"component")},"*");var o=location.hostname;i.isTrustedHost(o)||console.error("Builder.registerEditor() called in the wrong environment! You cannot load custom editors from your app, they must be loaded through the Builder.io app itself. Follow the readme here for more details: https://github.com/builderio/builder/tree/master/plugins/cloudinary or contact chat us in our Spectrum community for help: https://spectrum.chat/builder")}this.editors.push(e)},i.registerPlugin=function(e){this.plugins.push(e)},i.registerAction=function(e){var o;if(this.actions.push(e),i.isBrowser){var s=JSON.parse(JSON.stringify(e));e.action&&(s.action=e.action.toString()),(o=window.parent)===null||o===void 0||o.postMessage({type:"builder.registerAction",data:s},"*")}},i.registerTrustedHost=function(e){this.trustedHosts.push(e)},i.setServerContext=function(e){this.serverContext=e},i.isTrustedHost=function(e){var o=this.trustedHosts.findIndex(function(s){return s.startsWith("*.")?e.endsWith(s.slice(1)):s===e})>-1;return o},i.isTrustedHostForEvent=function(e){if(e.origin==="null")return!1;var o=parse(e.origin);return o.hostname&&i.isTrustedHost(o.hostname)},i.runAction=function(e){var o=typeof e=="string"?find(this.actions,function(s){return s.name===e}):e;if(!o)throw new Error("Action not found: ".concat(e))},i.fields=function(e,o){var s;(s=window.parent)===null||s===void 0||s.postMessage({type:"builder.fields",data:{name:e,fields:o}},"*")},i.set=function(e){i.register("editor.settings",e)},i.import=function(e){if(!i.isBrowser){console.warn("Builder.import used on the server - this should only be used in the browser");return}var o=window.System;if(!o){console.warn("System.js not available. Please include System.js when using Builder.import");return}return o.import("https://cdn.builder.io/systemjs/".concat(e))},Object.defineProperty(i,"editingPage",{get:function(){return this._editingPage},set:function(e){this._editingPage=e,isBrowser$1&&isIframe&&(e?document.body.classList.add("builder-editing-page"):document.body.classList.remove("builder-editing-page"))},enumerable:!1,configurable:!0}),i.serializeIncludingFunctions=function(e,o){var s=function(c){var d=c.toString().trim(),h=/^[a-zA-Z0-9_]+\s*=>/i.test(d),g=!d.startsWith("function")&&!d.startsWith("async")&&!d.startsWith("(")&&!h;return"return (".concat(g?"function ":"").concat(d,").apply(this, arguments)")},a=JSON.parse(JSON.stringify(e,function(c,d){var h=o&&c==="onSave";return typeof d=="function"&&!h?s(d):d}));return o&&(a.onSave=e.onSave),a},i.prepareComponentSpecToSend=function(e){return __assign$1(__assign$1({},this.serializeIncludingFunctions(e)),{class:void 0})},i.registerBlock=function(e,o){this.registerComponent(e,o)},i.registerComponent=function(e,o){var s,a=__assign$1(__assign$1({class:e},e.builderOptions),o);this.addComponent(a);var c=o.models&&this.singletonInstance.editingModel?isBrowser$1&&o.models.includes(this.singletonInstance.editingModel):isBrowser$1;if(c){var d=this.prepareComponentSpecToSend(a);(s=window.parent)===null||s===void 0||s.postMessage({type:"builder.registerComponent",data:d},"*")}},i.addComponent=function(e){var o=find(this.components,function(s){return s.name===e.name});if(o){if(o.class&&!e.class)return;this.components.splice(this.components.indexOf(o),1,e)}else this.components.push(e)},i.component=function(e){var o=this;return e===void 0&&(e={}),function(s){var a,c=__assign$1(__assign$1({},e),{class:s});c.name||(c.name=s.name),o.addComponent(c);var d=o.prepareComponentSpecToSend(c);return isBrowser$1&&((a=window.parent)===null||a===void 0||a.postMessage({type:"builder.registerComponent",data:d},"*")),s}},Object.defineProperty(i,"Component",{get:function(){return this.component},enumerable:!1,configurable:!0}),i.prototype.processEventsQueue=function(){if(this.eventsQueue.length){var e=this.eventsQueue;this.eventsQueue=[];for(var o=__assign$1(__assign$1({},i.overrideUserAttributes),this.trackingUserAttributes),s=0,a=e;s<a.length;s++){var c=a[s];c.data.metadata||(c.data.metadata={}),c.data.metadata.user||(c.data.metadata.user={}),Object.assign(c.data.metadata.user,o,c.data.metadata.user)}var d=this.host;getFetch()("".concat(d,"/api/v1/track"),{method:"POST",body:JSON.stringify({events:e}),headers:__assign$1({"content-type":"application/json"},this.getSdkHeaders()),mode:"cors"}).catch(function(){})}},Object.defineProperty(i.prototype,"browserTrackingDisabled",{get:function(){return i.isBrowser&&!!(window.builderNoTrack||!navigator.cookieEnabled)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"canTrack",{get:function(){return this.canTrack$.value},set:function(e){this.hasOverriddenCanTrack=!0,this.canTrack!==e&&this.canTrack$.next(e)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"apiVersion",{get:function(){return this.apiVersion$.value},set:function(e){this.apiVersion!==e&&this.apiVersion$.next(e)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"apiEndpoint",{get:function(){return this.apiEndpoint$.value},set:function(e){this.apiEndpoint!==e&&this.apiEndpoint$.next(e)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"editingMode",{get:function(){return this.editingMode$.value},set:function(e){e!==this.editingMode&&this.editingMode$.next(e)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"editingModel",{get:function(){return this.editingModel$.value},set:function(e){e!==this.editingModel&&this.editingModel$.next(e)},enumerable:!1,configurable:!0}),i.prototype.findParentElement=function(e,o,s){if(s===void 0&&(s=!0),!(e instanceof HTMLElement))return null;var a=s?e:e.parentElement;do{if(!a)return null;var c=o(a);if(c)return a}while(a=a.parentElement);return null},i.prototype.findBuilderParent=function(e){return this.findParentElement(e,function(o){var s=o.getAttribute("builder-id")||o.id;return!!(s&&s.indexOf("builder-")===0)})},i.prototype.setUserAgent=function(e){this.userAgent=e||""},i.prototype.setTrackingHook=function(e){this.trackingHooks.push(e)},i.prototype.track=function(e,o,s){if(o===void 0&&(o={}),!(isIframe||!isBrowser$1||i.isPreviewing)){var a=this.apiKey;if(!a){console.error('Builder integration error: Looks like the Builder SDK has not been initialized properly (your API key has not been set). Make sure you are calling `builder.init("«YOUR-API-KEY»");` as early as possible in your application\'s code.');return}for(var c=JSON.parse(JSON.stringify({type:e,data:__assign$1(__assign$1({},omit$3(o,"meta")),{metadata:__assign$1(__assign$1({sdkVersion:i.VERSION,url:location.href},o.meta),o.metadata),ownerId:a,userAttributes:this.getUserAttributes(),sessionId:this.sessionId,visitorId:this.visitorId})})),d=0,h=this.trackingHooks;d<h.length;d++){var g=h[d],_=g(c,s||{});_&&(c=_)}this.eventsQueue.push(c),this.canTrack&&this.throttledClearEventsQueue()}},i.prototype.getSessionId=function(){var e=this,o=null;try{i.isBrowser&&typeof sessionStorage<"u"&&(o=this.getCookie(sessionStorageKey))}catch(s){console.debug("Session storage error",s)}return o||(o=uuid()),i.isBrowser&&setTimeout(function(){try{e.canTrack&&e.setCookie(sessionStorageKey,o,datePlusMinutes(30))}catch(s){console.debug("Cookie setting error",s)}}),o},i.prototype.getVisitorId=function(){var e=this;if(this.visitorId)return this.visitorId;var o=null;try{i.isBrowser&&typeof localStorage<"u"&&(o=localStorage.getItem(localStorageKey))}catch(s){console.debug("Local storage error",s)}return o||(o=uuid()),this.visitorId=o,i.isBrowser&&setTimeout(function(){try{e.canTrack&&typeof localStorage<"u"&&o&&localStorage.setItem(localStorageKey,o)}catch(s){console.debug("Session storage error",s)}}),o},i.prototype.trackImpression=function(e,o,s,a){isIframe||!isBrowser$1||i.isPreviewing||this.track("impression",{contentId:e,variationId:o!==e?o:void 0,metadata:s},a)},i.prototype.trackConversion=function(e,o,s,a,c){if(!(isIframe||!isBrowser$1||i.isPreviewing)){var d=typeof o=="object"?o:a,h=typeof o=="string"?o:void 0;this.track("conversion",{amount:e,variationId:s,meta:d,contentId:h},c)}},Object.defineProperty(i.prototype,"isDevelopmentEnv",{get:function(){return i.isIframe||i.isBrowser&&(location.hostname==="localhost"||location.port!=="")||this.env!=="production"},enumerable:!1,configurable:!0}),i.prototype.trackInteraction=function(e,o,s,a,c){if(s===void 0&&(s=!1),isIframe||!isBrowser$1||i.isPreviewing)return;var d=a&&a.target,h=d&&this.findBuilderParent(d);function g(et){return Math.round(et*1e3)/1e3}var _={};if(a){var j=a.clientX,b=a.clientY;if(d){var $=d.getBoundingClientRect(),nt=j-$.left,tt=b-$.top,it=g(nt/$.width),ot=g(tt/$.height);_.targetOffset={x:it,y:ot}}if(h){var $=h.getBoundingClientRect(),nt=j-$.left,tt=b-$.top,it=g(nt/$.width),ot=g(tt/$.height);_.builderTargetOffset={x:it,y:ot}}}var _e=h&&(h.getAttribute("builder-id")||h.id);_e&&h&&(_.builderElementIndex=[].slice.call(document.getElementsByClassName(_e)).indexOf(h)),this.track("click",{contentId:e,metadata:_,variationId:o!==e?o:void 0,unique:!s,targetBuilderElement:_e||void 0},c)},i.prototype.component=function(e){return e===void 0&&(e={}),i.component(e)},Object.defineProperty(i.prototype,"apiKey",{get:function(){return this.apiKey$.value},set:function(e){this.apiKey$.next(e)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"authToken",{get:function(){return this.authToken$.value},set:function(e){this.authToken$.next(e)},enumerable:!1,configurable:!0}),i.prototype.modifySearch=function(e){return e.replace(/(^|&|\?)(builder_.*?)=/gi,function(o,s,a){return s+a.replace(/_/g,".")+"="})},i.prototype.setTestsFromUrl=function(){var e=this.getLocation().search;try{var o=QueryString.parseDeep(this.modifySearch(e||"").substr(1)),s=o.builder&&o.builder.tests;if(s&&typeof s=="object")for(var a in s)s.hasOwnProperty(a)&&this.setTestCookie(a,s[a])}catch(c){console.debug("Error parsing tests from URL",c)}},i.prototype.resetOverrides=function(){i.overrideUserAttributes={},this.cachebust=!1,this.noCache=!1,this.preview=!1,this.editingModel=null,this.overrides={},this.env="production",this.userAgent="",this.request=void 0,this.response=void 0},i.prototype.getOverridesFromQueryString=function(){var e=this.getLocation();try{var o=QueryString.parseDeep(this.modifySearch(e.search||"").substr(1)),s=o.builder;if(s){var a=s.userAttributes,c=s.overrides,d=s.env,h=s.host,g=s.api,_=s.cachebust,j=s.noCache,b=s.preview,$=s.editing,nt=s.frameEditing,tt=s.options,it=s.params;if(a&&this.setUserAttributes(a),tt&&(this.queryOptions=__assign$1(__assign$1(__assign$1({},tt.locale&&{locale:tt.locale}),tt.includeRefs&&{includeRefs:tt.includeRefs}),tt.enrich&&{enrich:tt.enrich})),c&&(this.overrides=c),validEnvList.indexOf(d||g)>-1&&(this.env=d||g),i.isEditing){var ot=nt||$||b;ot&&ot!=="true"&&(this.editingModel=ot)}_&&(this.cachebust=!0),j&&(this.noCache=!0),b&&(this.preview=!0),o&&(this.overrideParams=it)}}catch(_e){console.debug("Error parsing overrides from URL",_e)}},i.prototype.messageFrameLoaded=function(){var e;(e=window.parent)===null||e===void 0||e.postMessage({type:"builder.loaded",data:{value:!0}},"*")},i.prototype.bindMessageListeners=function(){var e=this;addEventListener("message",function(o){var s,a,c,d,h=i.isTrustedHostForEvent(o);if(h){var g=o.data;if(g)switch(g.type){case"builder.ping":{(s=window.parent)===null||s===void 0||s.postMessage({type:"builder.pong",data:{}},"*");break}case"builder.register":{if(o.source===window)break;var _=g.data;if(!_)break;var j=_.type,b=_.info,$=i.registry[j];$||($=i.registry[j]=[]),$.push(b),i.registryChange.next(i.registry);break}case"builder.settingsChange":{if(o.source===window)break;var nt=g.data;if(!nt)break;Object.assign(i.settings,nt),i.settingsChange.next(i.settings);break}case"builder.registerEditor":{if(o.source===window)break;var tt=g.data;if(!tt)break;var it=!!tt.component;i.editors.every(function(Gt,Ht){return tt.name===Gt.name?(Gt.component&&!it||(i.editors[Ht]=Gt),!1):!0});break}case"builder.triggerAnimation":{i.animator.triggerAnimation(g.data);break}case"builder.contentUpdate":var ot=g.data.key||g.data.alias||g.data.entry||g.data.modelName,_e=g.data.data,et=e.observersByKey[ot];et&&!e.noEditorUpdates[ot]&&et.next([_e]);break;case"builder.getComponents":(a=window.parent)===null||a===void 0||a.postMessage({type:"builder.components",data:i.components.map(function(Gt){return i.prepareComponentSpecToSend(Gt)})},"*");break;case"builder.editingModel":e.editingModel=g.data.model;break;case"builder.registerComponent":var rt=g.data;i.addComponent(rt);break;case"builder.blockContentLoading":typeof g.data.model=="string"&&(e.blockContentLoading=g.data.model);break;case"builder.editingMode":var st=g.data;st?(e.editingMode=!0,document.body.classList.add("builder-editing")):(e.editingMode=!1,document.body.classList.remove("builder-editing"));break;case"builder.editingPageMode":var dt=g.data;i.editingPage=dt;break;case"builder.overrideUserAttributes":var ht=g.data;assign(i.overrideUserAttributes,ht),e.flushGetContentQueue(!0);break;case"builder.overrideTestGroup":var mt=g.data,ft=mt.variationId,bt=mt.contentId;ft&&bt&&(e.setTestCookie(bt,ft),e.flushGetContentQueue(!0));break;case"builder.evaluate":{var vt=g.data.text,Et=g.data.arguments||[],It=g.data.id,Rt=new Function(vt),Dt=void 0,Ft=null;try{Dt=Rt.apply(e,Et)}catch(Gt){Ft=toError$1(Gt)}Ft?(c=window.parent)===null||c===void 0||c.postMessage({type:"builder.evaluateError",data:{id:It,error:Ft.message}},"*"):Dt&&typeof Dt.then=="function"?Dt.then(function(Gt){var Ht;(Ht=window.parent)===null||Ht===void 0||Ht.postMessage({type:"builder.evaluateResult",data:{id:It,result:Gt}},"*")}).catch(console.error):(d=window.parent)===null||d===void 0||d.postMessage({type:"builder.evaluateResult",data:{result:Dt,id:It}},"*");break}}}})},Object.defineProperty(i.prototype,"defaultCanTrack",{get:function(){return!!(i.isBrowser&&navigator.userAgent.trim()&&!navigator.userAgent.match(/bot|crawler|spider|robot|crawling|prerender|google|baidu|bing|msn|duckduckbot|teoma|slurp|yandex|phantom|headless|selenium|puppeteer/i)&&!this.browserTrackingDisabled)},enumerable:!1,configurable:!0}),i.prototype.init=function(e,o,s,a,c,d){return o===void 0&&(o=this.defaultCanTrack),s&&(this.request=s),a&&(this.response=a),this.hasOverriddenCanTrack||(this.canTrack=o),this.apiKey=e,c&&(this.authToken=c),d&&(this.apiVersion=d),this},Object.defineProperty(i.prototype,"previewingModel",{get:function(){var e=this.getLocation().search,o=QueryString.parse((e||"").substr(1));return o["builder.preview"]},enumerable:!1,configurable:!0}),i.prototype.getLocation=function(){var e,o={};return this.request?o=parse((e=this.request.url)!==null&&e!==void 0?e:""):typeof location=="object"&&(o=parse(location.href)),o.pathname===""&&(o.pathname="/"),o},i.prototype.getUserAttributes=function(e){e===void 0&&(e=this.userAgent||"");var o={Android:function(){return e.match(/Android/i)},BlackBerry:function(){return e.match(/BlackBerry/i)},iOS:function(){return e.match(/iPhone|iPod/i)},Opera:function(){return e.match(/Opera Mini/i)},Windows:function(){return e.match(/IEMobile/i)||e.match(/WPDesktop/i)},any:function(){return o.Android()||o.BlackBerry()||o.iOS()||o.Opera()||o.Windows()}},s=e.match(/Tablet|iPad/i),a=this.getLocation();return __assign$1({urlPath:a.pathname,host:a.host||a.hostname,device:s?"tablet":o.any()?"mobile":"desktop"},i.overrideUserAttributes)},i.prototype.setUserAttributes=function(e){assign(i.overrideUserAttributes,e),this.canTrack&&this.setCookie(i.attributesCookieName,JSON.stringify(this.getUserAttributes())),this.userAttributesChanged.next(e)},i.prototype.setTrackingUserAttributes=function(e){assign(this.trackingUserAttributes,e)},i.prototype.get=function(e,o){var s;o===void 0&&(o={});var a=this,c=o.locale||((s=o.userAttributes)===null||s===void 0?void 0:s.locale)||this.getUserAttributes().locale;"noTraverse"in o||(o.noTraverse=!1);var d=__assign$1(__assign$1({},o),c&&{locale:String(c),userAttributes:__assign$1({locale:String(c)},o.userAttributes)});return i.isBrowser?(o.apiKey&&!this.apiKey&&(this.apiKey=o.apiKey),o.authToken&&!this.authToken&&(this.authToken=o.authToken),o.apiVersion&&!this.apiVersion&&(this.apiVersion=o.apiVersion)):(a=new i(o.apiKey||this.apiKey,o.req,o.res,void 0,o.authToken||this.authToken,o.apiVersion||this.apiVersion),a.apiEndpoint=this.apiEndpoint,a.setUserAttributes(this.getUserAttributes())),a.queueGetContent(e,d).map(function(h){var g=h&&h[0];if(i.isStatic)return g;var _=g&&g.data;return _?(typeof _.blocksString<"u"&&(_.blocks=JSON.parse(_.blocksString),delete _.blocksString),{data:_,id:g.id,variationId:g.testVariationId||g.variationId||null,testVariationId:g.testVariationId||g.variationId||null,testVariationName:g.testVariationName||null,lastUpdated:g.lastUpdated||null}):null})},i.prototype.queueGetContent=function(e,o){var s=this;o===void 0&&(o={});var a=o.key||o.alias||e,c=this.editingModel===e,d=this.observersByKey[a];this.apiKey==="DEMO"&&!this.overrides[a]&&!o.initialContent&&(o.initialContent=[]);var h=o.initialContent;if(d&&(!d.value||o.cache))return d.value&&nextTick$1(function(){d.next(d.value)}),d;if(c&&i.isBrowser&&parent.postMessage({type:"builder.updateContent",data:{options:o}},"*"),!h)if(this.getContentQueue||(this.getContentQueue=[]),this.getContentQueue.push(__assign$1(__assign$1({},o),{model:e,key:a})),this.getContentQueue&&this.getContentQueue.length>=this.contentPerRequest){var g=this.getContentQueue.slice();this.getContentQueue=[],nextTick$1(function(){s.flushGetContentQueue(!1,g)})}else nextTick$1(function(){s.flushGetContentQueue()});var _=new BehaviorSubject(null);return this.observersByKey[a]=_,o.noEditorUpdates&&(this.noEditorUpdates[a]=!0),h&&nextTick$1(function(){_.next(h)}),_},i.prototype.requestUrl=function(e,o){return getFetch()(e,this.addSdkHeaders(o)).then(function(s){return s.json()})},Object.defineProperty(i.prototype,"host",{get:function(){switch(this.env){case"qa":return"https://qa.builder.io";case"test":return"https://builder-io-test.web.app";case"fast":return"https://fast.builder.io";case"cloud":return"https://cloud.builder.io";case"cdn2":return"https://cdn2.builder.io";case"cdn-qa":return"https://cdn-qa.builder.io";case"development":case"dev":return"http://localhost:5000";case"cdn-prod":return"https://cdn.builder.io";default:return i.overrideHost||"https://cdn.builder.io"}},enumerable:!1,configurable:!0}),i.prototype.getSdkHeaders=function(){return i.sdkInfo?{"X-Builder-SDK":i.sdkInfo.name,"X-Builder-SDK-GEN":"1","X-Builder-SDK-Version":i.sdkInfo.version}:{}},i.prototype.addSdkHeaders=function(e){return __assign$1(__assign$1({},e),{headers:__assign$1(__assign$1({},e.headers),this.getSdkHeaders())})},i.prototype.makeFetchApiCall=function(e,o){return getFetch()(e,this.addSdkHeaders(o))},i.prototype.flattenMongoQuery=function(e,o,s){s===void 0&&(s={});for(var a in e){var c=e[a],d=o?o+"."+a:a;c&&typeof c=="object"&&!Array.isArray(c)&&!Object.keys(c).find(function(h){return h.startsWith("$")})?this.flattenMongoQuery(c,d,s):s[d]=c}return s},i.prototype.flushGetContentQueue=function(e,o){var s=this,a,c;if(e===void 0&&(e=!1),!this.apiKey)throw new Error("Fetching content failed, expected apiKey to be defined instead got: ".concat(this.apiKey));if(this.apiVersion){if(!["v1","v3"].includes(this.apiVersion))throw new Error("Invalid apiVersion: expected 'v1' or 'v3', received '".concat(this.apiVersion,"'"))}else this.apiVersion=DEFAULT_API_VERSION;if(!(!e&&!this.getContentQueue)){var d=o||(e?this.priorContentQueue:this.getContentQueue)||[];this.getOverridesFromQueryString();var h=__assign$1(__assign$1({omit:(a=d[0].omit)!==null&&a!==void 0?a:"meta.componentsUsed",apiKey:this.apiKey},d[0].options),this.queryOptions);d[0].locale&&(h.locale=d[0].locale),d[0].fields&&(h.fields=d[0].fields),d[0].format&&(h.format=d[0].format),"noTraverse"in d[0]&&(h.noTraverse=d[0].noTraverse),"includeUnpublished"in d[0]&&(h.includeUnpublished=d[0].includeUnpublished),d[0].sort&&(h.sort=d[0].sort);var g=(typeof location<"u"?QueryString.parseDeep(location.search.substr(1)):void 0)||{},_=d&&d[0].userAttributes?d[0].userAttributes:this.targetContent?this.getUserAttributes():{urlPath:this.getLocation().pathname},j=d.find(function(xt){return!!xt.includeUrl});if(j){var b=this.getLocation();b.origin&&(h.url="".concat(b.origin).concat(b.pathname).concat(b.search))}var $=o==null?void 0:o.find(function(xt){return xt.url});$!=null&&$.url&&(_.urlPath=$.url.split("?")[0]),h.userAttributes=JSON.stringify(_),!e&&!o&&(this.priorContentQueue=d,this.getContentQueue=null);var nt=this.cachebust||isIframe||g.cachebust||g["builder.cachebust"];if((nt||this.env!=="production")&&(h.cachebust=!0),i.isEditing&&(h.isEditing=!0),(this.noCache||this.env!=="production")&&(h.noCache=!0),size$2(this.overrides))for(var tt in this.overrides)this.overrides.hasOwnProperty(tt)&&(h["overrides.".concat(tt)]=this.overrides[tt]);for(var it=0,ot=d;it<ot.length;it++){var _e=ot[it],et=_e.format;et&&(h.format=et),_e.static&&(h.static=_e.static),_e.cachebust&&(h.cachebust=_e.cachebust),isPositiveNumber(_e.cacheSeconds)&&(h.cacheSeconds=_e.cacheSeconds),isPositiveNumber(_e.staleCacheSeconds)&&(h.staleCacheSeconds=_e.staleCacheSeconds),this.apiEndpoint==="content"&&(h.includeRefs=!0);for(var rt=["prerender","extractCss","limit","offset","query","preview","model","entry","rev","static","includeRefs"],st=0,dt=rt;st<dt.length;st++){var tt=dt[st],ht=_e[tt];ht!==void 0&&(this.apiEndpoint==="query"?(h.options=h.options||{},h.options[_e.key]=h.options[_e.key]||{},h.options[_e.key][tt]=JSON.stringify(ht)):h[tt]=JSON.stringify(ht))}}this.preview&&this.previewingModel===((c=d==null?void 0:d[0])===null||c===void 0?void 0:c.model)&&(h.preview="true");var mt=Object.keys(h).length>0,ft=this.host,bt=d.map(function(xt){return encodeURIComponent(xt.key)}).join(",");if(this.overrideParams){var vt=omit$3(QueryString.parse(this.overrideParams),"apiKey");assign(h,vt)}var Et=h.format,It=Et==="solid"||Et==="react",Rt=It||this.apiEndpoint==="query";if(this.apiEndpoint==="content"&&d[0].query){var Dt=this.flattenMongoQuery({query:d[0].query});for(var tt in Dt)h[tt]=Dt[tt];delete h.query}var Ft=QueryString.stringifyDeep(h),Gt=__assign$1({headers:{}},d[0].fetchOptions);this.authToken&&(Gt.headers=__assign$1(__assign$1({},Gt.headers),{Authorization:"Bearer ".concat(this.authToken)}));var Ht;It?Ht="".concat(ft,"/api/v1/codegen/").concat(this.apiKey,"/").concat(bt):this.apiEndpoint==="query"?Ht="".concat(ft,"/api/v3/query/").concat(this.apiKey,"/").concat(bt):Ht="".concat(ft,"/api/v3/content/").concat(d[0].model),Ht=Ht+(h&&mt?"?".concat(Ft):"");var St=this.makeFetchApiCall(Ht,Gt).then(function(xt){return xt.json()}).then(function(xt){for(var $t=0,_t=d;$t<_t.length;$t++){var ut=_t[$t],gt=ut.key;if(!(ut.model===s.blockContentLoading&&!ut.noEditorUpdates)){var yt=s.editingModel===ut.model;yt&&i.isEditing&&parent.postMessage({type:"builder.updateContent",data:{options:ut}},"*");var kt=s.observersByKey[gt];if(!kt)return;var lt=Rt?xt[gt]:xt.results,Mt=lt;if(lt){var wt=i.isServer?Mt:s.processResultsForTests(Mt);kt.next(wt)}else{var jt=s.getLocation().search;if((jt||"").includes("builder.preview="+ut.model)){var at={id:"preview",name:"Preview",data:{}};kt.next([at])}kt.next([])}}}},function(xt){for(var $t=0,_t=d;$t<_t.length;$t++){var ut=_t[$t],gt=s.observersByKey[ut.key];if(!gt)return;gt.error(xt)}});return St}},i.prototype.processResultsForTests=function(e){var o=this,s,a=e.map(function(c){if(!c.variations)return c;var d=o.getTestCookie(c.id),h=d===c.id?c:c.variations[d];if(h)return __assign$1(__assign$1({},c),{data:h.data,variationId:d,testVariationId:d,testVariationName:h.name});if(o.canTrack&&c.variations&&size$2(c.variations)){var g=0,_=Math.random();for(var j in c.variations){var b=c.variations[j],$=b.testRatio;if(g+=$,_<g){o.setTestCookie(c.id,b.id);var nt=b.name||(b.id===c.id?"Default variation":"");return __assign$1(__assign$1({},c),{data:b.data,variationId:b.id,testVariationId:b.id,variationName:nt,testVariationName:nt})}}o.setTestCookie(c.id,c.id)}return __assign$1(__assign$1(__assign$1({},c),{variationId:c.id}),c.variations&&size$2(c.variations)&&{testVariationId:c.id,testVariationName:"Default variation"})});return isIframe&&((s=window.parent)===null||s===void 0||s.postMessage({type:"builder.contentResults",data:{results:a}},"*")),a},i.prototype.getTestCookie=function(e){return this.getCookie("".concat(this.testCookiePrefix,".").concat(e))},i.prototype.setTestCookie=function(e,o){if(!this.canTrack){this.cookieQueue.push([e,o]);return}var s=new Date;return s.setDate(s.getDate()+30),this.setCookie("".concat(this.testCookiePrefix,".").concat(e),o,s)},i.prototype.getCookie=function(e){return this.cookies?this.cookies.get(e):i.isBrowser&&getCookie(e)},i.prototype.setCookie=function(e,o,s){return this.cookies&&!(i.isServer&&i.isStatic)?this.cookies.set(e,o,{expires:s,secure:this.getLocation().protocol==="https:"}):i.isBrowser&&setCookie(e,o,s)},i.prototype.getContent=function(e,o){if(o===void 0&&(o={}),!this.apiKey)throw new Error("Fetching content from model ".concat(e," failed, expected apiKey to be defined instead got: ").concat(this.apiKey));return this.queueGetContent(e,o)},i.prototype.getAll=function(e,o){o===void 0&&(o={});var s=this;return i.isBrowser?(o.apiKey&&!this.apiKey&&(this.apiKey=o.apiKey),o.authToken&&!this.authToken&&(this.authToken=o.authToken),o.apiVersion&&!this.apiVersion&&(this.apiVersion=o.apiVersion)):(s=new i(o.apiKey||this.apiKey,o.req,o.res,!1,o.authToken||this.authToken,o.apiVersion||this.apiVersion),s.setUserAttributes(this.getUserAttributes())),"noTraverse"in o||(o.noTraverse=!0),s.getContent(e,__assign$1(__assign$1({limit:30},o),{key:o.key||i.isBrowser?"".concat(e,":").concat(hash(omit$3(o,"initialContent","req","res"))):void 0})).promise()},i.VERSION=SDK_VERSION$1,i.components=[],i.isStatic=!0,i.animator=new Animator,i.nextTick=nextTick$1,i.throttle=throttle$1,i.editors=[],i.trustedHosts=["*.beta.builder.io","beta.builder.io","builder.io","localhost","qa.builder.io"],i.plugins=[],i.actions=[],i.registry={},i.attributesCookieName="builder.userAttributes",i.registryChange=new BehaviorSubject({}),i._editingPage=!1,i.isIframe=isIframe,i.isBrowser=isBrowser$1,i.isReactNative=isReactNative,i.isServer=!isBrowser$1&&!isReactNative,i.previewingModel=i.isBrowser&&getQueryParam(location.href,"builder.preview"),i.settings={},i.settingsChange=new BehaviorSubject({}),i.isEditing=!!(isIframe&&(document.referrer&&document.referrer.match(/builder\.io|localhost:1234/)||location.search.indexOf("builder.frameEditing=")!==-1)),i.isPreviewing=!!(isBrowser$1&&(location.search.indexOf("builder.preview=")!==-1||location.search.indexOf("builder.frameEditing=")!==-1)),i.isReact=!1,i.sdkInfo=void 0,i.overrideUserAttributes={},i}(),builder=new Builder(null,void 0,void 0,!0);Builder.singletonInstance=builder;function sheetForTag(i){if(i.sheet)return i.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===i)return document.styleSheets[e]}function createStyleElement(i){var e=document.createElement("style");return e.setAttribute("data-emotion",i.key),i.nonce!==void 0&&e.setAttribute("nonce",i.nonce),e.appendChild(document.createTextNode("")),e}var StyleSheet=function(){function i(o){this.isSpeedy=o.speedy===void 0?!0:o.speedy,this.tags=[],this.ctr=0,this.nonce=o.nonce,this.key=o.key,this.container=o.container,this.before=null}var e=i.prototype;return e.insert=function(s){if(this.ctr%(this.isSpeedy?65e3:1)===0){var a=createStyleElement(this),c;this.tags.length===0?c=this.before:c=this.tags[this.tags.length-1].nextSibling,this.container.insertBefore(a,c),this.tags.push(a)}var d=this.tags[this.tags.length-1];if(this.isSpeedy){var h=sheetForTag(d);try{var g=s.charCodeAt(1)===105&&s.charCodeAt(0)===64;h.insertRule(s,g?0:h.cssRules.length)}catch{}}else d.appendChild(document.createTextNode(s));this.ctr++},e.flush=function(){this.tags.forEach(function(s){return s.parentNode.removeChild(s)}),this.tags=[],this.ctr=0},i}();function stylis_min(i){function e(ut,gt,yt,kt,lt){for(var Mt=0,wt=0,jt=0,at=0,pt,ct,Ct=0,Pt=0,Tt,Ut=Tt=pt=0,Ot=0,Vt=0,Jt=0,Nt=0,Lt=yt.length,zt=Lt-1,Kt,Bt="",Wt="",At="",Qt="",Zt;Ot<Lt;){if(ct=yt.charCodeAt(Ot),Ot===zt&&wt+at+jt+Mt!==0&&(wt!==0&&(ct=wt===47?10:47),at=jt=Mt=0,Lt++,zt++),wt+at+jt+Mt===0){if(Ot===zt&&(0<Vt&&(Bt=Bt.replace($,"")),0<Bt.trim().length)){switch(ct){case 32:case 9:case 59:case 13:case 10:break;default:Bt+=yt.charAt(Ot)}ct=59}switch(ct){case 123:for(Bt=Bt.trim(),pt=Bt.charCodeAt(0),Tt=1,Nt=++Ot;Ot<Lt;){switch(ct=yt.charCodeAt(Ot)){case 123:Tt++;break;case 125:Tt--;break;case 47:switch(ct=yt.charCodeAt(Ot+1)){case 42:case 47:e:{for(Ut=Ot+1;Ut<zt;++Ut)switch(yt.charCodeAt(Ut)){case 47:if(ct===42&&yt.charCodeAt(Ut-1)===42&&Ot+2!==Ut){Ot=Ut+1;break e}break;case 10:if(ct===47){Ot=Ut+1;break e}}Ot=Ut}}break;case 91:ct++;case 40:ct++;case 34:case 39:for(;Ot++<zt&&yt.charCodeAt(Ot)!==ct;);}if(Tt===0)break;Ot++}switch(Tt=yt.substring(Nt,Ot),pt===0&&(pt=(Bt=Bt.replace(b,"").trim()).charCodeAt(0)),pt){case 64:switch(0<Vt&&(Bt=Bt.replace($,"")),ct=Bt.charCodeAt(1),ct){case 100:case 109:case 115:case 45:Vt=gt;break;default:Vt=Gt}if(Tt=e(gt,Vt,Tt,ct,lt+1),Nt=Tt.length,0<St&&(Vt=o(Gt,Bt,Jt),Zt=h(3,Tt,Vt,gt,Rt,It,Nt,ct,lt,kt),Bt=Vt.join(""),Zt!==void 0&&(Nt=(Tt=Zt.trim()).length)===0&&(ct=0,Tt="")),0<Nt)switch(ct){case 115:Bt=Bt.replace(ht,d);case 100:case 109:case 45:Tt=Bt+"{"+Tt+"}";break;case 107:Bt=Bt.replace(et,"$1 $2"),Tt=Bt+"{"+Tt+"}",Tt=Ft===1||Ft===2&&c("@"+Tt,3)?"@-webkit-"+Tt+"@"+Tt:"@"+Tt;break;default:Tt=Bt+Tt,kt===112&&(Tt=(Wt+=Tt,""))}else Tt="";break;default:Tt=e(gt,o(gt,Bt,Jt),Tt,kt,lt+1)}At+=Tt,Tt=Jt=Vt=Ut=pt=0,Bt="",ct=yt.charCodeAt(++Ot);break;case 125:case 59:if(Bt=(0<Vt?Bt.replace($,""):Bt).trim(),1<(Nt=Bt.length))switch(Ut===0&&(pt=Bt.charCodeAt(0),pt===45||96<pt&&123>pt)&&(Nt=(Bt=Bt.replace(" ",":")).length),0<St&&(Zt=h(1,Bt,gt,ut,Rt,It,Wt.length,kt,lt,kt))!==void 0&&(Nt=(Bt=Zt.trim()).length)===0&&(Bt="\0\0"),pt=Bt.charCodeAt(0),ct=Bt.charCodeAt(1),pt){case 0:break;case 64:if(ct===105||ct===99){Qt+=Bt+yt.charAt(Ot);break}default:Bt.charCodeAt(Nt-1)!==58&&(Wt+=a(Bt,pt,ct,Bt.charCodeAt(2)))}Jt=Vt=Ut=pt=0,Bt="",ct=yt.charCodeAt(++Ot)}}switch(ct){case 13:case 10:wt===47?wt=0:1+pt===0&&kt!==107&&0<Bt.length&&(Vt=1,Bt+="\0"),0<St*$t&&h(0,Bt,gt,ut,Rt,It,Wt.length,kt,lt,kt),It=1,Rt++;break;case 59:case 125:if(wt+at+jt+Mt===0){It++;break}default:switch(It++,Kt=yt.charAt(Ot),ct){case 9:case 32:if(at+Mt+wt===0)switch(Ct){case 44:case 58:case 9:case 32:Kt="";break;default:ct!==32&&(Kt=" ")}break;case 0:Kt="\\0";break;case 12:Kt="\\f";break;case 11:Kt="\\v";break;case 38:at+wt+Mt===0&&(Vt=Jt=1,Kt="\f"+Kt);break;case 108:if(at+wt+Mt+Dt===0&&0<Ut)switch(Ot-Ut){case 2:Ct===112&&yt.charCodeAt(Ot-3)===58&&(Dt=Ct);case 8:Pt===111&&(Dt=Pt)}break;case 58:at+wt+Mt===0&&(Ut=Ot);break;case 44:wt+jt+at+Mt===0&&(Vt=1,Kt+="\r");break;case 34:case 39:wt===0&&(at=at===ct?0:at===0?ct:at);break;case 91:at+wt+jt===0&&Mt++;break;case 93:at+wt+jt===0&&Mt--;break;case 41:at+wt+Mt===0&&jt--;break;case 40:if(at+wt+Mt===0){if(pt===0)switch(2*Ct+3*Pt){case 533:break;default:pt=1}jt++}break;case 64:wt+jt+at+Mt+Ut+Tt===0&&(Tt=1);break;case 42:case 47:if(!(0<at+Mt+jt))switch(wt){case 0:switch(2*ct+3*yt.charCodeAt(Ot+1)){case 235:wt=47;break;case 220:Nt=Ot,wt=42}break;case 42:ct===47&&Ct===42&&Nt+2!==Ot&&(yt.charCodeAt(Nt+2)===33&&(Wt+=yt.substring(Nt,Ot+1)),Kt="",wt=0)}}wt===0&&(Bt+=Kt)}Pt=Ct,Ct=ct,Ot++}if(Nt=Wt.length,0<Nt){if(Vt=gt,0<St&&(Zt=h(2,Wt,Vt,ut,Rt,It,Nt,kt,lt,kt),Zt!==void 0&&(Wt=Zt).length===0))return Qt+Wt+At;if(Wt=Vt.join(",")+"{"+Wt+"}",Ft*Dt!==0){switch(Ft!==2||c(Wt,2)||(Dt=0),Dt){case 111:Wt=Wt.replace(st,":-moz-$1")+Wt;break;case 112:Wt=Wt.replace(rt,"::-webkit-input-$1")+Wt.replace(rt,"::-moz-$1")+Wt.replace(rt,":-ms-input-$1")+Wt}Dt=0}}return Qt+Wt+At}function o(ut,gt,yt){var kt=gt.trim().split(ot);gt=kt;var lt=kt.length,Mt=ut.length;switch(Mt){case 0:case 1:var wt=0;for(ut=Mt===0?"":ut[0]+" ";wt<lt;++wt)gt[wt]=s(ut,gt[wt],yt).trim();break;default:var jt=wt=0;for(gt=[];wt<lt;++wt)for(var at=0;at<Mt;++at)gt[jt++]=s(ut[at]+" ",kt[wt],yt).trim()}return gt}function s(ut,gt,yt){var kt=gt.charCodeAt(0);switch(33>kt&&(kt=(gt=gt.trim()).charCodeAt(0)),kt){case 38:return gt.replace(_e,"$1"+ut.trim());case 58:return ut.trim()+gt.replace(_e,"$1"+ut.trim());default:if(0<1*yt&&0<gt.indexOf("\f"))return gt.replace(_e,(ut.charCodeAt(0)===58?"":"$1")+ut.trim())}return ut+gt}function a(ut,gt,yt,kt){var lt=ut+";",Mt=2*gt+3*yt+4*kt;if(Mt===944){ut=lt.indexOf(":",9)+1;var wt=lt.substring(ut,lt.length-1).trim();return wt=lt.substring(0,ut).trim()+wt+";",Ft===1||Ft===2&&c(wt,1)?"-webkit-"+wt+wt:wt}if(Ft===0||Ft===2&&!c(lt,1))return lt;switch(Mt){case 1015:return lt.charCodeAt(10)===97?"-webkit-"+lt+lt:lt;case 951:return lt.charCodeAt(3)===116?"-webkit-"+lt+lt:lt;case 963:return lt.charCodeAt(5)===110?"-webkit-"+lt+lt:lt;case 1009:if(lt.charCodeAt(4)!==100)break;case 969:case 942:return"-webkit-"+lt+lt;case 978:return"-webkit-"+lt+"-moz-"+lt+lt;case 1019:case 983:return"-webkit-"+lt+"-moz-"+lt+"-ms-"+lt+lt;case 883:if(lt.charCodeAt(8)===45)return"-webkit-"+lt+lt;if(0<lt.indexOf("image-set(",11))return lt.replace(Et,"$1-webkit-$2")+lt;break;case 932:if(lt.charCodeAt(4)===45)switch(lt.charCodeAt(5)){case 103:return"-webkit-box-"+lt.replace("-grow","")+"-webkit-"+lt+"-ms-"+lt.replace("grow","positive")+lt;case 115:return"-webkit-"+lt+"-ms-"+lt.replace("shrink","negative")+lt;case 98:return"-webkit-"+lt+"-ms-"+lt.replace("basis","preferred-size")+lt}return"-webkit-"+lt+"-ms-"+lt+lt;case 964:return"-webkit-"+lt+"-ms-flex-"+lt+lt;case 1023:if(lt.charCodeAt(8)!==99)break;return wt=lt.substring(lt.indexOf(":",15)).replace("flex-","").replace("space-between","justify"),"-webkit-box-pack"+wt+"-webkit-"+lt+"-ms-flex-pack"+wt+lt;case 1005:return tt.test(lt)?lt.replace(nt,":-webkit-")+lt.replace(nt,":-moz-")+lt:lt;case 1e3:switch(wt=lt.substring(13).trim(),gt=wt.indexOf("-")+1,wt.charCodeAt(0)+wt.charCodeAt(gt)){case 226:wt=lt.replace(dt,"tb");break;case 232:wt=lt.replace(dt,"tb-rl");break;case 220:wt=lt.replace(dt,"lr");break;default:return lt}return"-webkit-"+lt+"-ms-"+wt+lt;case 1017:if(lt.indexOf("sticky",9)===-1)break;case 975:switch(gt=(lt=ut).length-10,wt=(lt.charCodeAt(gt)===33?lt.substring(0,gt):lt).substring(ut.indexOf(":",7)+1).trim(),Mt=wt.charCodeAt(0)+(wt.charCodeAt(7)|0)){case 203:if(111>wt.charCodeAt(8))break;case 115:lt=lt.replace(wt,"-webkit-"+wt)+";"+lt;break;case 207:case 102:lt=lt.replace(wt,"-webkit-"+(102<Mt?"inline-":"")+"box")+";"+lt.replace(wt,"-webkit-"+wt)+";"+lt.replace(wt,"-ms-"+wt+"box")+";"+lt}return lt+";";case 938:if(lt.charCodeAt(5)===45)switch(lt.charCodeAt(6)){case 105:return wt=lt.replace("-items",""),"-webkit-"+lt+"-webkit-box-"+wt+"-ms-flex-"+wt+lt;case 115:return"-webkit-"+lt+"-ms-flex-item-"+lt.replace(ft,"")+lt;default:return"-webkit-"+lt+"-ms-flex-line-pack"+lt.replace("align-content","").replace(ft,"")+lt}break;case 973:case 989:if(lt.charCodeAt(3)!==45||lt.charCodeAt(4)===122)break;case 931:case 953:if(vt.test(ut)===!0)return(wt=ut.substring(ut.indexOf(":")+1)).charCodeAt(0)===115?a(ut.replace("stretch","fill-available"),gt,yt,kt).replace(":fill-available",":stretch"):lt.replace(wt,"-webkit-"+wt)+lt.replace(wt,"-moz-"+wt.replace("fill-",""))+lt;break;case 962:if(lt="-webkit-"+lt+(lt.charCodeAt(5)===102?"-ms-"+lt:"")+lt,yt+kt===211&&lt.charCodeAt(13)===105&&0<lt.indexOf("transform",10))return lt.substring(0,lt.indexOf(";",27)+1).replace(it,"$1-webkit-$2")+lt}return lt}function c(ut,gt){var yt=ut.indexOf(gt===1?":":"{"),kt=ut.substring(0,gt!==3?yt:10);return yt=ut.substring(yt+1,ut.length-1),xt(gt!==2?kt:kt.replace(bt,"$1"),yt,gt)}function d(ut,gt){var yt=a(gt,gt.charCodeAt(0),gt.charCodeAt(1),gt.charCodeAt(2));return yt!==gt+";"?yt.replace(mt," or ($1)").substring(4):"("+gt+")"}function h(ut,gt,yt,kt,lt,Mt,wt,jt,at,pt){for(var ct=0,Ct=gt,Pt;ct<St;++ct)switch(Pt=Ht[ct].call(j,ut,Ct,yt,kt,lt,Mt,wt,jt,at,pt)){case void 0:case!1:case!0:case null:break;default:Ct=Pt}if(Ct!==gt)return Ct}function g(ut){switch(ut){case void 0:case null:St=Ht.length=0;break;default:if(typeof ut=="function")Ht[St++]=ut;else if(typeof ut=="object")for(var gt=0,yt=ut.length;gt<yt;++gt)g(ut[gt]);else $t=!!ut|0}return g}function _(ut){return ut=ut.prefix,ut!==void 0&&(xt=null,ut?typeof ut!="function"?Ft=1:(Ft=2,xt=ut):Ft=0),_}function j(ut,gt){var yt=ut;if(33>yt.charCodeAt(0)&&(yt=yt.trim()),_t=yt,yt=[_t],0<St){var kt=h(-1,gt,yt,yt,Rt,It,0,0,0,0);kt!==void 0&&typeof kt=="string"&&(gt=kt)}var lt=e(Gt,yt,gt,0,0);return 0<St&&(kt=h(-2,lt,yt,yt,Rt,It,lt.length,0,0,0),kt!==void 0&&(lt=kt)),_t="",Dt=0,It=Rt=1,lt}var b=/^\0+/g,$=/[\0\r\f]/g,nt=/: */g,tt=/zoo|gra/,it=/([,: ])(transform)/g,ot=/,\r+?/g,_e=/([\t\r\n ])*\f?&/g,et=/@(k\w+)\s*(\S*)\s*/,rt=/::(place)/g,st=/:(read-only)/g,dt=/[svh]\w+-[tblr]{2}/,ht=/\(\s*(.*)\s*\)/g,mt=/([\s\S]*?);/g,ft=/-self|flex-/g,bt=/[^]*?(:[rp][el]a[\w-]+)[^]*/,vt=/stretch|:\s*\w+\-(?:conte|avail)/,Et=/([^-])(image-set\()/,It=1,Rt=1,Dt=0,Ft=1,Gt=[],Ht=[],St=0,xt=null,$t=0,_t="";return j.use=g,j.set=_,i!==void 0&&_(i),j}var delimiter="/*|*/",needle=delimiter+"}";function toSheet(i){i&&Sheet.current.insert(i+"}")}var Sheet={current:null},ruleSheet=function i(e,o,s,a,c,d,h,g,_,j){switch(e){case 1:{switch(o.charCodeAt(0)){case 64:return Sheet.current.insert(o+";"),"";case 108:if(o.charCodeAt(2)===98)return""}break}case 2:{if(g===0)return o+delimiter;break}case 3:switch(g){case 102:case 112:return Sheet.current.insert(s[0]+o),"";default:return o+(j===0?delimiter:"")}case-2:o.split(needle).forEach(toSheet)}},createCache=function i(e){e===void 0&&(e={});var o=e.key||"css",s;e.prefix!==void 0&&(s={prefix:e.prefix});var a=new stylis_min(s),c={},d;{d=e.container||document.head;var h=document.querySelectorAll("style[data-emotion-"+o+"]");Array.prototype.forEach.call(h,function(j){var b=j.getAttribute("data-emotion-"+o);b.split(" ").forEach(function($){c[$]=!0}),j.parentNode!==d&&d.appendChild(j)})}var g;a.use(e.stylisPlugins)(ruleSheet),g=function(b,$,nt,tt){var it=$.name;Sheet.current=nt,a(b,$.styles),tt&&(_.inserted[it]=!0)};var _={key:o,sheet:new StyleSheet({key:o,container:d,nonce:e.nonce,speedy:e.speedy}),nonce:e.nonce,inserted:c,registered:{},insert:g};return _},isBrowser=!0;function getRegisteredStyles(i,e,o){var s="";return o.split(" ").forEach(function(a){i[a]!==void 0?e.push(i[a]):s+=a+" "}),s}var insertStyles=function i(e,o,s){var a=e.key+"-"+o.name;if((s===!1||isBrowser===!1)&&e.registered[a]===void 0&&(e.registered[a]=o.styles),e.inserted[o.name]===void 0){var c=o;do e.insert("."+a,c,e.sheet,!0),c=c.next;while(c!==void 0)}};function murmur2(i){for(var e=0,o,s=0,a=i.length;a>=4;++s,a-=4)o=i.charCodeAt(s)&255|(i.charCodeAt(++s)&255)<<8|(i.charCodeAt(++s)&255)<<16|(i.charCodeAt(++s)&255)<<24,o=(o&65535)*1540483477+((o>>>16)*59797<<16),o^=o>>>24,e=(o&65535)*1540483477+((o>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(a){case 3:e^=(i.charCodeAt(s+2)&255)<<16;case 2:e^=(i.charCodeAt(s+1)&255)<<8;case 1:e^=i.charCodeAt(s)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var unitlessKeys={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function memoize(i){var e={};return function(o){return e[o]===void 0&&(e[o]=i(o)),e[o]}}var hyphenateRegex=/[A-Z]|^ms/g,animationRegex=/_EMO_([^_]+?)_([^]*?)_EMO_/g,isCustomProperty=function i(e){return e.charCodeAt(1)===45},isProcessableValue=function i(e){return e!=null&&typeof e!="boolean"},processStyleName=memoize(function(i){return isCustomProperty(i)?i:i.replace(hyphenateRegex,"-$&").toLowerCase()}),processStyleValue=function i(e,o){switch(e){case"animation":case"animationName":if(typeof o=="string")return o.replace(animationRegex,function(s,a,c){return cursor={name:a,styles:c,next:cursor},a})}return unitlessKeys[e]!==1&&!isCustomProperty(e)&&typeof o=="number"&&o!==0?o+"px":o};function handleInterpolation(i,e,o,s){if(o==null)return"";if(o.__emotion_styles!==void 0)return o;switch(typeof o){case"boolean":return"";case"object":{if(o.anim===1)return cursor={name:o.name,styles:o.styles,next:cursor},o.name;if(o.styles!==void 0){var a=o.next;if(a!==void 0)for(;a!==void 0;)cursor={name:a.name,styles:a.styles,next:cursor},a=a.next;var c=o.styles+";";return c}return createStringFromObject(i,e,o)}case"function":{if(i!==void 0){var d=cursor,h=o(i);return cursor=d,handleInterpolation(i,e,h,s)}break}}if(e==null)return o;var g=e[o];return g!==void 0&&!s?g:o}function createStringFromObject(i,e,o){var s="";if(Array.isArray(o))for(var a=0;a<o.length;a++)s+=handleInterpolation(i,e,o[a],!1);else for(var c in o){var d=o[c];if(typeof d!="object")e!=null&&e[d]!==void 0?s+=c+"{"+e[d]+"}":isProcessableValue(d)&&(s+=processStyleName(c)+":"+processStyleValue(c,d)+";");else if(Array.isArray(d)&&typeof d[0]=="string"&&(e==null||e[d[0]]===void 0))for(var h=0;h<d.length;h++)isProcessableValue(d[h])&&(s+=processStyleName(c)+":"+processStyleValue(c,d[h])+";");else{var g=handleInterpolation(i,e,d,!1);switch(c){case"animation":case"animationName":{s+=processStyleName(c)+":"+g+";";break}default:s+=c+"{"+g+"}"}}}return s}var labelPattern=/label:\s*([^\s;\n{]+)\s*;/g,cursor,serializeStyles=function i(e,o,s){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var a=!0,c="";cursor=void 0;var d=e[0];d==null||d.raw===void 0?(a=!1,c+=handleInterpolation(s,o,d,!1)):c+=d[0];for(var h=1;h<e.length;h++)c+=handleInterpolation(s,o,e[h],c.charCodeAt(c.length-1)===46),a&&(c+=d[h]);labelPattern.lastIndex=0;for(var g="",_;(_=labelPattern.exec(c))!==null;)g+="-"+_[1];var j=murmur2(c)+g;return{name:j,styles:c,next:cursor}},hasOwnProperty=Object.prototype.hasOwnProperty,EmotionCacheContext=reactExports.createContext(typeof HTMLElement<"u"?createCache():null),ThemeContext=reactExports.createContext({});EmotionCacheContext.Provider;var withEmotionCache=function i(e){var o=function(a,c){return reactExports.createElement(EmotionCacheContext.Consumer,null,function(d){return e(a,d,c)})};return reactExports.forwardRef(o)},typePropName="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",createEmotionProps=function i(e,o){var s={};for(var a in o)hasOwnProperty.call(o,a)&&(s[a]=o[a]);return s[typePropName]=e,s},Noop$1=function i(){return null},render=function i(e,o,s,a){var c=s===null?o.css:o.css(s);typeof c=="string"&&e.registered[c]!==void 0&&(c=e.registered[c]);var d=o[typePropName],h=[c],g="";typeof o.className=="string"?g=getRegisteredStyles(e.registered,h,o.className):o.className!=null&&(g=o.className+" ");var _=serializeStyles(h);insertStyles(e,_,typeof d=="string"),g+=e.key+"-"+_.name;var j={};for(var b in o)hasOwnProperty.call(o,b)&&b!=="css"&&b!==typePropName&&(j[b]=o[b]);j.ref=a,j.className=g;var $=reactExports.createElement(d,j),nt=reactExports.createElement(Noop$1,null);return reactExports.createElement(reactExports.Fragment,null,nt,$)},Emotion=withEmotionCache(function(i,e,o){return typeof i.css=="function"?reactExports.createElement(ThemeContext.Consumer,null,function(s){return render(e,i,s,o)}):render(e,i,null,o)});function css(){for(var i=arguments.length,e=new Array(i),o=0;o<i;o++)e[o]=arguments[o];return serializeStyles(e)}var jsx=function i(e,o){var s=arguments;if(o==null||!hasOwnProperty.call(o,"css"))return reactExports.createElement.apply(void 0,s);var a=s.length,c=new Array(a);c[0]=Emotion,c[1]=createEmotionProps(e,o);for(var d=2;d<a;d++)c[d]=s[d];return reactExports.createElement.apply(null,c)},classnames=function i(e){for(var o=e.length,s=0,a="";s<o;s++){var c=e[s];if(c!=null){var d=void 0;switch(typeof c){case"boolean":break;case"object":{if(Array.isArray(c))d=i(c);else{d="";for(var h in c)c[h]&&h&&(d&&(d+=" "),d+=h)}break}default:d=c}d&&(a&&(a+=" "),a+=d)}}return a};function merge(i,e,o){var s=[],a=getRegisteredStyles(i,s,o);return s.length<2?o:a+e(s)}var Noop=function i(){return null},ClassNames=withEmotionCache(function(i,e){return reactExports.createElement(ThemeContext.Consumer,null,function(o){var s=!1,a=function(){for(var j=arguments.length,b=new Array(j),$=0;$<j;$++)b[$]=arguments[$];var nt=serializeStyles(b,e.registered);return insertStyles(e,nt,!1),e.key+"-"+nt.name},c=function(){for(var j=arguments.length,b=new Array(j),$=0;$<j;$++)b[$]=arguments[$];return merge(e.registered,a,classnames(b))},d={css:a,cx:c,theme:o},h=i.children(d);s=!0;var g=reactExports.createElement(Noop,null);return reactExports.createElement(reactExports.Fragment,null,g,h)})}),SDK_VERSION="8.2.0",_a;typeof window<"u"&&((_a=window.parent)===null||_a===void 0||_a.postMessage({type:"builder.isReactSdk",data:{value:!0,supportsPatchUpdates:"v4",supportsCustomBreakpoints:!0,supportsXSmallBreakpoint:!0,supportsGlobalSymbols:!0,blockLevelPersonalization:!0,version:SDK_VERSION}},"*"));var extendStatics=function(i,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,s){o.__proto__=s}||function(o,s){for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(o[a]=s[a])})(i,e)};function __extends(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=i}extendStatics(i,e),i.prototype=e===null?Object.create(e):(o.prototype=e.prototype,new o)}var __assign=function(){return(__assign=Object.assign||function(i){for(var e,o=1,s=arguments.length;o<s;o++)for(var a in e=arguments[o])Object.prototype.hasOwnProperty.call(e,a)&&(i[a]=e[a]);return i}).apply(this,arguments)};function __rest(i,e){var o={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(o[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function"){var a=0;for(s=Object.getOwnPropertySymbols(i);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(i,s[a])&&(o[s[a]]=i[s[a]])}return o}function __decorate(i,e,o,s){var a,c=arguments.length,d=c<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,o):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(i,e,o,s);else for(var h=i.length-1;h>=0;h--)(a=i[h])&&(d=(c<3?a(d):c>3?a(e,o,d):a(e,o))||d);return c>3&&d&&Object.defineProperty(e,o,d),d}function __metadata(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function __awaiter(i,e,o,s){return new(o||(o=Promise))(function(a,c){function d(_){try{g(s.next(_))}catch(j){c(j)}}function h(_){try{g(s.throw(_))}catch(j){c(j)}}function g(_){var j;_.done?a(_.value):(j=_.value,j instanceof o?j:new o(function(b){b(j)})).then(d,h)}g((s=s.apply(i,e||[])).next())})}function __generator(i,e){var o,s,a,c,d={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function h(g){return function(_){return function(j){if(o)throw new TypeError("Generator is already executing.");for(;c&&(c=0,j[0]&&(d=0)),d;)try{if(o=1,s&&(a=2&j[0]?s.return:j[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,j[1])).done)return a;switch(s=0,a&&(j=[2&j[0],a.value]),j[0]){case 0:case 1:a=j;break;case 4:return d.label++,{value:j[1],done:!1};case 5:d.label++,s=j[1],j=[0];continue;case 7:j=d.ops.pop(),d.trys.pop();continue;default:if(a=d.trys,!((a=a.length>0&&a[a.length-1])||j[0]!==6&&j[0]!==2)){d=0;continue}if(j[0]===3&&(!a||j[1]>a[0]&&j[1]<a[3])){d.label=j[1];break}if(j[0]===6&&d.label<a[1]){d.label=a[1],a=j;break}if(a&&d.label<a[2]){d.label=a[2],d.ops.push(j);break}a[2]&&d.ops.pop(),d.trys.pop();continue}j=e.call(i,d)}catch(b){j=[6,b],s=0}finally{o=a=0}if(5&j[0])throw j[1];return{value:j[0]?j[1]:void 0,done:!0}}([g,_])}}}function __spreadArray(i,e,o){if(o||arguments.length===2)for(var s,a=0,c=e.length;a<c;a++)!s&&a in e||(s||(s=Array.prototype.slice.call(e,0,a)),s[a]=e[a]);return i.concat(s||Array.prototype.slice.call(e))}var fastClone=function(i){return JSON.parse(JSON.stringify(i))},omit$2=function(i){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];for(var s=Object.assign({},i),a=0,c=e;a<c.length;a++){var d=c[a];delete s[d]}return s},sizeNames=["xsmall","small","medium","large"],sizes={xsmall:{min:0,default:160,max:320},small:{min:321,default:321,max:640},medium:{min:641,default:642,max:991},large:{min:990,default:991,max:1200},getWidthForSize:function(i){return this[i].default},getSizeForWidth:function(i){for(var e=0,o=sizeNames;e<o.length;e++){var s=o[e];if(i<=this[s].max)return s}return"large"}},getSizesForBreakpoints=function(i){var e=__assign(__assign({},sizes),fastClone(sizes));if(!i)return e;var o=i.xsmall,s=i.small,a=i.medium;if(o){var c=Math.floor(o/2);e.xsmall={max:o,min:c,default:c+1}}if(!s||!a)return e;var d=o?e.xsmall.max+1:Math.floor(s/2);e.small={max:s,min:d,default:d+1};var h=e.small.max+1;e.medium={max:a,min:h,default:h+1};var g=e.medium.max+1;return e.large={max:2e3,min:g,default:g+1},e},set=function(i,e,o){if(Object(i)!==i)return i;var s=Array.isArray(e)?e:e.toString().match(/[^.[\]]+/g);return s.slice(0,-1).reduce(function(a,c,d){return Object(a[c])===a[c]?a[c]:a[c]=Math.abs(Number(s[d+1]))>>0==+s[d+1]?[]:{}},i)[s[s.length-1]]=o,i},noop=function(){return null},safeDynamicRequire;if(typeof(globalThis==null?void 0:globalThis.require)=="function"||Builder.isServer&&typeof require=="function")try{safeDynamicRequire=eval("require")}catch(i){safeDynamicRequire=globalThis!=null&&globalThis.require?globalThis.require:noop}function isDebug(){return!!(typeof process<"u"&&process.env!==void 0&&{}.DEBUG)}function isNodeRuntime(){var i;return typeof process<"u"&&!!(!((i=process==null?void 0:process.versions)===null||i===void 0)&&i.node)}safeDynamicRequire!=null||(safeDynamicRequire=noop);var shouldForceBrowserRuntimeInNode=function(){var i;if(!isNodeRuntime())return!1;var e=process.arch==="arm64",o=process.version.startsWith("v20"),s=(i={}.NODE_OPTIONS)===null||i===void 0?void 0:i.includes("--no-node-snapshot");return!(!e||!o||s)&&(console.log("Skipping usage of `isolated-vm` to avoid crashes in Node v20 on an arm64 machine.\n    If you would like to use the `isolated-vm` package on this machine, please provide the `NODE_OPTIONS=--no-node-snapshot` config to your Node process.\n    See https://github.com/BuilderIO/builder/blob/main/packages/react/README.md#node-v20--m1-macs-apple-silicon-support for more information.\n    "),!0)},fnCache={},api=function(i){return builder};function stringToFunction(i,e,o,s){if(e===void 0&&(e=!0),!i||!i.trim())return function(){};var a=i+":"+e;if(fnCache[a])return fnCache[a];var c=e&&!(i.includes(";")||i.includes(" return ")||i.trim().startsWith("return "))||i.trim().startsWith("builder.run"),d=function(){};try{Builder.isBrowser&&(d=new Function("state","event","block","builder","Device","update","Builder","context",`
          var names = [
            'state',
            'event',
            'block',
            'builder',
            'Device',
            'update',
            'Builder',
            'context'
          ];
          var rootState = state;
          if (typeof Proxy !== 'undefined') {
            rootState = new Proxy(rootState, {
              set: function () {
                return false;
              },
              get: function (target, key) {
                if (names.includes(key)) {
                  return undefined;
                }
                return target[key];
              }
            });
          }
          /* Alias */
          var ctx = context;
          var log = console.log.bind(console);
          with (rootState) {
            `.concat(c?"return (".concat(i,");"):i,`;
          }
        `)))}catch(_){o&&o.push(_);var h=_&&_.message;h&&typeof h=="string"&&s&&s.indexOf(h)===-1&&s.push(h),Builder.isBrowser&&console.warn("Function compile error in ".concat(i),_)}var g=function(){for(var _=[],j=0;j<arguments.length;j++)_[j]=arguments[j];try{if(Builder.isBrowser||shouldForceBrowserRuntimeInNode())return d.apply(void 0,_);var b=getIsolateContext(),$=safeDynamicRequire("isolated-vm"),nt=b.evalClosureSync(makeFn(i,c),_.map(function(it,ot){return typeof it=="object"?new $.Reference(ot===indexOfBuilderInstance?__assign(__assign({},it),{getUserAttributes:function(){return it.getUserAttributes("")}}):it):null}));try{var tt=JSON.parse(nt);return tt}catch{return nt}}catch(it){return Builder.isBrowser?console.warn("Builder custom code error:",it.message||it,"in",i,it.stack||it):isDebug()&&console.debug("Builder custom code error:",it.message||it,"in",i,it.stack||it),o&&o.push(it),null}};return Builder.isBrowser&&(fnCache[a]=g),g}var indexOfBuilderInstance=3,makeFn=function(i,e,o){var s=o||["state","event","block","builder","Device","update","Builder","context"];return`
`.concat(`
  var refToProxy = (obj) => {
    if (typeof obj !== 'object' || obj === null) {
      return obj;
    }
    return new Proxy({}, {
        get(target, key) {
            if (key === 'copySync') {
              return () => obj.copySync();
            }
            const val = obj.getSync(key);
            if (typeof val?.copySync === 'function') {
                return JSON.parse(stringify(val));
            }
            return val;
        },
        set(target, key, value) {
            obj.setSync(key, value);
        },
        deleteProperty(target, key) {
            obj.deleteSync(key);
        }
      })
  }
`,`
`).concat(`
    var stringify = (val) => {
      if (typeof val === 'object' && val !== null) {
        return JSON.stringify(val.copySync ? val.copySync() : val);
      }
      return val;
    }
  `,`
`).concat(s.map(function(a,c){return"var ".concat(a," = refToProxy($").concat(c,");")}).join(`
`)).concat(`
`.concat(s.includes("context")?"var ctx = context;":"",`
var endResult = function() {
  `).concat(e?"return (".concat(i,");"):i,`;
};

return stringify(endResult());
`))},getIsolateContext=function(){var i=Builder.serverContext;i||(i=new(safeDynamicRequire("isolated-vm")).Isolate({memoryLimit:128}).createContextSync(),Builder.setServerContext(i));var e=i.global;return e.setSync("global",e.derefInto()),e.setSync("log",function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];isDebug()&&console.log.apply(console,o)}),i},isPromise=function(i){return typeof i.then=="function"},isRequestInfo=function(i){return!isPromise(i)},BuilderAsyncRequestsContext=React.createContext({requests:[],errors:[],logs:[]}),BuilderStoreContext=React.createContext({state:{},rootState:{},content:{},context:{},update:function(i){return null}}),applyPatchWithMinimalMutationChain=function(i,e,o){if(o===void 0&&(o=!1),Object(i)!==i)return i;var s=e.path,a=e.op,c=e.value,d=s.split(/\//);d[0]===""&&d.shift();for(var h=o?i:__assign({},i),g=h,_=0;_<d.length;_++){var j=_===d.length-1,b=d[_];if(j)if(a==="replace")g[b]=c;else if(a==="add"){var $=Number(b);Array.isArray(g)?b==="-"?g.push(c):g.splice($,0,c):g[b]=c}else a==="remove"&&($=Number(b),Array.isArray(g)?g.splice($,1):delete g[b]);else{var nt=d[_+1],tt=Object(g[b])===g[b]?g[b]:String(Number(nt))===nt?[]:{};g=g[b]=Array.isArray(tt)?__spreadArray([],tt,!0):__assign({},tt)}}return h},htmlEscape=function(i){return i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},blockToHtmlString=function(i){var e;return"<".concat(htmlEscape(i.tagName||"div"),` 
    class="builder-block `).concat(i.id," ").concat(i.class||"",`"
    builder-id="`).concat(i.id,`"
  `).concat(Object.keys(i.properties||{}).map(function(o){return"".concat(htmlEscape(o),'="').concat(htmlEscape(i.properties[o]),'"')}).join(" "),`
  >`).concat(((e=i==null?void 0:i.component)===null||e===void 0?void 0:e.name)==="Text"?i.component.options.text:i.children?i.children.map(function(o){return blockToHtmlString(o)}).join(""):"","</").concat(i.tagName||"div",">").replace(/\s+/g," ")},Link=function(i){return React.createElement(BuilderStoreContext.Consumer,null,function(e){return e.renderLink?e.renderLink(i):React.createElement("a",__assign({},i))})};function traverse(i,e,o,s,a){o===void 0&&(o=null),s===void 0&&(s=null),a===void 0&&(a=new WeakSet),i!=null&&typeof i=="object"?a.has(i)||(a.add(i),Array.isArray(i)?i.forEach(function(c,d){e(c,function(h){i[d]=h}),traverse(c,e,i,d,a)}):Object.entries(i).forEach(function(c){var d=c[0],h=c[1];e(h,function(g){i[d]=g}),traverse(h,e,i,d,a)})):e(i,function(c){o!==null&&s!==null&&(o[s]=c)})}var isLocalizedField=function(i){return i&&typeof i=="object"&&i["@type"]==="@builder.io/core:LocalizedValue"},containsLocalizedValues=function(i){if(!i||!Object.getOwnPropertyNames(i).length)return!1;var e=!1;return traverse(i,function(o){isLocalizedField(o)&&(e=!0)}),e},extractLocalizedValues=function(i,e){return i&&Object.getOwnPropertyNames(i).length?(traverse(i,function(o,s){var a;isLocalizedField(o)&&s((a=o[e])!==null&&a!==void 0?a:void 0)}),i):{}},camelCaseToKebabCase=function(i){return i?i.replace(/([A-Z])/g,function(e){return"-".concat(e[0].toLowerCase())}):""},kebabCaseToCamelCase=function(i){return i===void 0&&(i=""),i.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})},Device={desktop:0,tablet:1,mobile:2};function deepCloneWithConditions(i){if(i===null||typeof i!="object")return i;if(Array.isArray(i))return i.map(function(s){return deepCloneWithConditions(s)});if(i["@type"]==="@builder.io/sdk:Element")return i;var e={};for(var o in i)o!=="meta"&&Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=deepCloneWithConditions(i[o]));return e}var voidElements=new Set(["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr","textarea"]),last=function(i){return i[i.length-1]};function omit$1(i,e){for(var o=Object.assign({},i),s=0,a=e;s<a.length;s++)delete o[a[s]];return o}var cssCase=function(i){if(!i)return i;var e=camelCaseToKebabCase(i);return i[0]===i[0].toUpperCase()&&(e="-"+e),e};function capitalize(i){if(i)return i[0].toUpperCase()+i.slice(1)}var BuilderBlock$1=function(_super){function BuilderBlock(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.hydrated=!1,_this.state={hasError:!1,updates:0},_this.privateState={state:{},rootState:{},context:{},update:function(){}},_this.onWindowMessage=function(event){var message=event.data;if(message)switch(message.type){case"builder.selectionChange":var data=message.data;if(!data)break;var selection=data.selection,id=_this.block&&_this.block.id;id&&Array.isArray(selection)&&selection.indexOf(id)>-1&&setTimeout(function(){window.$block=_this,window.$blocks||(window.$blocks=[]),window.$blocks.push(_this)});break;case"builder.patchUpdates":var data=message.data;if(!data||!data.data)break;var patches=data.data[_this.block.id];if(!patches)return;location.href.includes("builder.debug=true")&&eval("debugger");for(var _i=0,patches_1=patches;_i<patches_1.length;_i++){var patch=patches_1[_i];applyPatchWithMinimalMutationChain(_this.props.block,patch,!0)}_this.setState({updates:_this.state.updates+1})}},_this}return __extends(BuilderBlock,_super),Object.defineProperty(BuilderBlock.prototype,"store",{get:function(){return this.privateState},enumerable:!1,configurable:!0}),BuilderBlock.getDerivedStateFromError=function(i){return{hasError:!0}},BuilderBlock.prototype.componentDidCatch=function(i,e){console.error("Builder block error:",i,e)},BuilderBlock.prototype.stringToFunction=function(i,e){return e===void 0&&(e=!0),stringToFunction(i,e,this._errors,this._logs)},Object.defineProperty(BuilderBlock.prototype,"block",{get:function(){return this.props.block},enumerable:!1,configurable:!0}),BuilderBlock.prototype.emotionCss=function(i){var e,o,s,a,c,d,h,g,_=this.block,j=_.animations&&_.animations[0];if(j&&j.trigger!=="hover"){var b=j&&j.steps&&j.steps[0],$=b&&b.styles;$&&(g=$)}var nt=sizeNames.slice().reverse(),tt={};if(i)for(var it=!!(!((s=(o=(e=this.privateState.context.builderContent)===null||e===void 0?void 0:e.meta)===null||o===void 0?void 0:o.breakpoints)===null||s===void 0)&&s.xsmall),ot=0,_e=nt;ot<_e.length;ot++){var et=_e[ot];if(it||et!=="xsmall")if(et==="large")this.props.emailMode||(tt["&.builder-block"]=Object.assign({},i[et],g));else{var rt=getSizesForBreakpoints(((c=(a=this.privateState.context.builderContent)===null||a===void 0?void 0:a.meta)===null||c===void 0?void 0:c.breakpoints)||{});tt["@media only screen and (max-width: ".concat(rt[et].max,"px)")]={"&.builder-block":i[et]}}}var st=_.animations&&_.animations.find(function(dt){return dt.trigger==="hover"});return st&&(tt[":hover"]=((h=(d=st.steps)===null||d===void 0?void 0:d[1])===null||h===void 0?void 0:h.styles)||{},tt.transition="all ".concat(st.duration,"s ").concat(camelCaseToKebabCase(st.easing)),st.delay&&(tt.transitionDelay=st.delay+"s")),tt},BuilderBlock.prototype.eval=function(i){return this.stringToFunction(i)(this.privateState.state,void 0,this.block,builder,Device,this.privateState.update,Builder,this.privateState.context)},BuilderBlock.prototype.componentWillUnmount=function(){Builder.isEditing&&removeEventListener("message",this.onWindowMessage)},BuilderBlock.prototype.componentDidMount=function(){var i,e=this;this.hydrated=!0;var o=this.block,s=o&&o.animations;if(Builder.isEditing&&addEventListener("message",this.onWindowMessage),s){var a={animations:fastClone(s)};if(o.bindings){for(var c in o.bindings)if(!((i=c.trim)===null||i===void 0)&&i.call(c)&&c.startsWith("animations.")){var d=this.stringToFunction(o.bindings[c]);d!==void 0&&set(a,c,d(this.privateState.state,null,o,builder,null,null,Builder,this.privateState.context))}}Builder.animator.bindAnimations(a.animations.filter(function(h){return h.trigger!=="hover"}).map(function(h){return __assign(__assign({},h),{elementId:e.block.id})}))}},BuilderBlock.prototype.getElement=function(i,e){var o,s,a,c,d,h,g=this;i===void 0&&(i=0),e===void 0&&(e=this.privateState.state);var _=this.props;_.child,_.fieldName;var j,b=this.block,$=(b.tagName||"div").toLowerCase();if($==="template"){var nt=b.children?b.children.map(function(Rt){return blockToHtmlString(Rt)}).join(" "):"";return console.debug("template html",nt),jsx("template",__assign({},b.properties,{dangerouslySetInnerHTML:{__html:nt}}))}var tt=b.component&&(b.component.name||b.component.component),it=null;b.component&&!b.component.class&&(b.component&&b.component.tag?j=b.component.tag:(it=Builder.components.find(function(Rt){return Rt.name===tt})||null)&&it.class?j=it.class:it&&it.tag?j=it.tag:tt!=null&&tt.startsWith("Builder:")?console.warn("Missing @builder.io/widgets installation, please install and import @builder.io/widgets to use ".concat(tt.split(":")[1]," in your content, more info here: https://github.com/BuilderIO/builder/tree/main/packages/widgets")):tt&&console.warn("Missing registration for ".concat(tt,", have you included the registration in your bundle?")));var ot=__assign(__assign({},b.properties),{style:{},responsiveStyles:fastClone(b.responsiveStyles||{})});if(ot=__assign(__assign({},ot.properties),ot),b.component&&(ot.component=deepCloneWithConditions(b.component)),b.bindings){for(var _e in b.bindings)if(!((s=_e.trim)===null||s===void 0)&&s.call(_e)){var et=this.stringToFunction(b.bindings[_e]);set(ot,_e,et(e,null,b,api(),Device,null,Builder,this.privateState.context))}}if(ot.hide||(delete ot.hide,("show"in ot||b.bindings&&b.bindings.show)&&!ot.show))return null;if(delete ot.show,b.actions){var rt=function(Rt){if(!(!((a=Rt.trim)===null||a===void 0)&&a.call(Rt)))return"continue";var Dt=b.actions[Rt];ot["on"+capitalize(Rt)]=function(Ft){var Gt=e;return typeof Proxy<"u"&&(Gt=new Proxy(e,{set:function(Ht,St,xt){return Ht[St]=xt,g.privateState.rootState[St]=xt,!0}})),g.stringToFunction(Dt,!1)(Gt,Ft,g.block,builder,Device,g.privateState.update,Builder,g.privateState.context)}};for(var _e in b.actions)rt(_e)}var st=(ot.component||ot.options)&&__assign(__assign({},ot.options),ot.component.options||ot.component.data);containsLocalizedValues(st)&&(this.privateState.state.locale||console.warn("[Builder.io] In order to use localized fields in Builder, you must pass a locale prop to the BuilderComponent or to options object while fetching the content to resolve localized fields. Learn more: https://www.builder.io/c/docs/localization-inline#targeting-and-inline-localization"),st=extractLocalizedValues(st,(c=this.privateState.state.locale)!==null&&c!==void 0?c:"Default"));var dt=voidElements.has($),ht=it&&(it.fragment||it.noWrap),mt=((d=ot.attr)===null||d===void 0?void 0:d.style)||(typeof ot.style=="string"?ot.style:"")||"";if(typeof mt=="string"){typeof ot.style!="object"&&(ot.style={});for(var ft=0,bt=mt.split(";");ft<bt.length;ft++){var vt=bt[ft].split(":");if(!vt.length)return;_e=vt[0],et=vt[1],_e&&(vt.length>2&&(et=vt.slice(1).join(":")),ot.style[kebabCaseToCamelCase(_e)]=et)}}var Et=__assign(__assign(__assign({},omit$1(ot,["class","component","attr","responsiveStyles"])),((o={})[typeof $!="string"||$.includes("-")?"class":"className"]="builder-block ".concat(this.id).concat(b.class?" ".concat(b.class):"").concat(!b.component||["Image","Video","Banner"].indexOf(tt)>-1?"":" builder-has-component")+(ot.class?" "+ot.class:"")+(this.hydrated&&Builder.isEditing&&((h=this.privateState.state._spacer)===null||h===void 0?void 0:h.parent)===b.id?" builder-spacer-parent":""),o.key=this.id+i,o["builder-id"]=this.id,o)),i!==0&&{"builder-index":i});Builder.isEditing&&this.hydrated&&(Et["builder-inline-styles"]=ot.attr&&ot.attr.style?Object.keys(ot.style).reduce(function(Rt,Dt){return(Rt?"".concat(Rt,";"):"")+"".concat(cssCase(Dt),":").concat(ot.style[Dt],";")},""):""),(Et.properties&&Et.properties.href||Et.href)&&$==="div"&&($="a"),$==="a"&&($=Link);var It=b.children||Et.children||[];return jsx(React.Fragment,null,jsx(ClassNames,null,function(Rt){var Dt=Rt.css;if(Rt.cx,!g.props.emailMode){var Ft=" "+Dt(g.emotionCss(ot.responsiveStyles));Et.class&&(Et.class+=Ft),Et.className&&(Et.className+=Ft)}return jsx(BuilderAsyncRequestsContext.Consumer,null,function(Gt){return g._asyncRequests=Gt&&Gt.requests,g._errors=Gt&&Gt.errors,g._logs=Gt&&Gt.logs,dt?jsx($,__assign({},Et)):j&&(ht||g.props.emailMode)?jsx(j,__assign({},st,{attributes:Et,builderBlock:b,builderState:g.privateState})):jsx($,__assign({},Et),j&&jsx(j,__assign({builderState:g.privateState,builderBlock:b},st)),b.text||ot.text?ot.text:!j&&It&&Array.isArray(It)&&It.length?It.map(function(Ht,St){return jsx(BuilderBlock,{key:(g.id||"")+St,block:Ht,index:St,size:g.props.size,fieldName:g.props.fieldName,child:g.props.child,emailMode:g.props.emailMode})}):null)})}))},Object.defineProperty(BuilderBlock.prototype,"id",{get:function(){var i=this.block;return i.id&&!i.id.startsWith("builder")?"builder-"+i.id:i.id||""},enumerable:!1,configurable:!0}),BuilderBlock.prototype.contents=function(i){var e=this,o=this.block;if(this.privateState=i,o.repeat&&o.repeat.collection){var s=o.repeat.collection,a=last((s||"").trim().split("(")[0].trim().split(".")),c=o.repeat.itemName||(a?a+"Item":"item"),d=this.stringToFunction(s)(i.state,null,o,api(),Device,null,Builder,this.privateState.context);return Array.isArray(d)?d.map(function(h,g){var _,j=__assign(__assign({},i.state),((_={$index:g,$item:h})[c]=h,_["$".concat(c,"Index")]=g,_));return jsx(BuilderStoreContext.Provider,{key:g,value:__assign(__assign({},i),{state:j})},e.getElement(g,j))}):null}return this.getElement()},BuilderBlock.prototype.render=function(){var i=this;return this.state.hasError?jsx("span",{css:{display:"inline-block",padding:5,color:"#999",fontSize:11,fontStyle:"italic"}},"Builder block error :( Check console for details"):jsx(BuilderStoreContext.Consumer,null,function(e){return i.contents(e)})},BuilderBlock}(React.Component),BuilderBlocks=function(i){function e(){var o=i!==null&&i.apply(this,arguments)||this;return o.hydrated=!1,o.onClickEmptyBlocks=function(){var s;Builder.isIframe&&o.noBlocks&&((s=window.parent)===null||s===void 0||s.postMessage({type:"builder.clickEmptyBlocks",data:{parentElementId:o.parentId,dataPath:o.path}},"*"))},o.onHoverEmptyBlocks=function(){var s;Builder.isEditing&&o.noBlocks&&((s=window.parent)===null||s===void 0||s.postMessage({type:"builder.hoverEmptyBlocks",data:{parentElementId:o.parentId,dataPath:o.path}},"*"))},o}return __extends(e,i),Object.defineProperty(e.prototype,"isRoot",{get:function(){return!this.props.child},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"noBlocks",{get:function(){var o=this.props.blocks;return!(o&&o.length)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){var o=this.props.dataPath||"";return o.trim()&&(o.startsWith("this.")?o=o.replace("this.",""):o.startsWith("component.options.")||(o="component.options."+o)),o},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentId",{get:function(){return this.props.parentElementId?this.props.parentElementId:this.props.parent&&this.props.parent.id},enumerable:!1,configurable:!0}),e.prototype.componentDidMount=function(){this.hydrated=!0},e.prototype.render=function(){var o=this,s=this.props.blocks,a=this.props.emailMode?"span":"div";return jsx(a,__assign({className:"builder-blocks"+(this.noBlocks?" no-blocks":"")+(this.props.child?" builder-blocks-child":"")+(this.props.className?" "+this.props.className:""),"builder-type":"blocks","builder-path":Builder.isIframe&&this.hydrated?this.path:void 0,"builder-parent-id":this.parentId,css:__assign(__assign({},!this.props.emailMode&&{display:"flex",flexDirection:"column",alignItems:"stretch"}),this.props.style),onClick:function(){o.noBlocks&&o.onClickEmptyBlocks()}},Builder.isEditing&&{onMouseEnter:function(){return o.onHoverEmptyBlocks()}}),s&&Array.isArray(s)&&s.map(function(c,d){return c&&c["@type"]==="@builder.io/sdk:Element"?jsx(BuilderBlock$1,{key:c.id,block:c,index:d,fieldName:o.props.fieldName,child:o.props.child,emailMode:o.props.emailMode}):c})||s)},e.renderInto=function(o,s,a){if(s===void 0&&(s={}),o){var c=null;return typeof o=="string"?c=document.querySelector(o):o instanceof Element&&(c=o),ReactDOM.render(jsx(BuilderStoreContext.Provider,{value:a},jsx(e,__assign({},s))),c)}},e}(React.Component),NoWrap=function(i){return i.children};function getData(i){if((i==null?void 0:i.data)!==void 0){var e=i.data,o=e.blocks,s=e.blocksString,a=Array.isArray(o)||typeof s=="string",c=__assign(__assign({},i.data),a&&{blocks:o||JSON.parse(s)});return delete c.blocksString,c}}var variantsScript=function(i,e){return`
(function() {
  if (window.builderNoTrack || !navigator.cookieEnabled) {
    return;
  }

  var variants = `.concat(i,`;
  function removeVariants() {
    variants.forEach(function (template) {
      document.querySelector('template[data-template-variant-id="' + template.id + '"]').remove();
    });
    document.getElementById('variants-script-`).concat(e,`').remove();
  }

  if (typeof document.createElement("template").content === 'undefined') {
    removeVariants();
    return ;
  }

  function setCookie(name,value,days) {
    var expires = "";
    if (days) {
        var date = new Date();
        date.setTime(date.getTime() + (days*24*60*60*1000));
        expires = "; expires=" + date.toUTCString();
    }
    document.cookie = name + "=" + (value || "")  + expires + "; path=/" + "; Secure; SameSite=None";
  }

  function getCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
  }
  var cookieName = 'builder.tests.`).concat(e,`';
  var variantInCookie = getCookie(cookieName);
  var availableIDs = variants.map(function(vr) { return vr.id }).concat('`).concat(e,`');
  var variantId;
  if (availableIDs.indexOf(variantInCookie) > -1) {
    variantId = variantInCookie;
  }
  if (!variantId) {
    var n = 0;
    var random = Math.random();
    for (var i = 0; i < variants.length; i++) {
      var variant = variants[i];
      var testRatio = variant.testRatio;
      n += testRatio;
      if (random < n) {
        setCookie(cookieName, variant.id);
        variantId = variant.id;
        break;
      }
    }
    if (!variantId) {
      variantId = "`).concat(e,`";
      setCookie(cookieName, "`).concat(e,`");
    }
  }
  if (variantId && variantId !== "`).concat(e,`") {
    var winningTemplate = document.querySelector('template[data-template-variant-id="' + variantId + '"]');
    if (winningTemplate) {
      var parentNode = winningTemplate.parentNode;
      var newParent = parentNode.cloneNode(false);
      newParent.appendChild(winningTemplate.content.firstChild);
      parentNode.parentNode.replaceChild(newParent, parentNode);
    }
  } else if (variants.length > 0) {
    removeVariants();
  }
})()`).replace(/\s+/g," ")},VariantsProvider=function(i){var e=i.initialContent,o=i.children;if(Builder.isBrowser&&!builder.canTrack)return o([e]);if(!Object.keys((e==null?void 0:e.variations)||{}).length)return o([e]);var s=Object.keys(e.variations).map(function($){return __assign(__assign({id:$},e.variations[$]),{data:getData(e.variations[$])})}),a=__spreadArray(__spreadArray([],s,!0),[e],!1);if(Builder.isServer){var c=JSON.stringify(Object.keys(e.variations||{}).map(function($){return{id:$,testRatio:e.variations[$].testRatio}}));return reactExports.createElement(reactExports.Fragment,null,o(a,function(){return reactExports.createElement("script",{id:"variants-script-".concat(e.id),dangerouslySetInnerHTML:{__html:variantsScript(c,e.id)}})}))}var d="builder.tests.".concat(e.id),h=builder.getCookie(d);if(!h&&Builder.isBrowser)for(var g=0,_=Math.random(),j=0;j<s.length;j++){var b=s[j];if(_<(g+=b.testRatio)){builder.setCookie(d,b.id),h=b.id;break}}return h||(h=e.id,builder.setCookie(d,h)),o([a.find(function($){return $.id===h})])},BuilderContent=function(_super){function BuilderContent(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.ref=null,_this.state={loading:!_this.props.content,data:getContentWithInfo(_this.props.content),updates:1},_this.onWindowMessage=function(event){var _a,_b,isTrusted=Builder.isTrustedHostForEvent(event);if(isTrusted){var message=event.data;if(message)switch(message.type){case"builder.patchUpdates":if(!((_a=_this.props.options)===null||_a===void 0)&&_a.noEditorUpdates)return;var data=message.data;if(!data||!data.data)break;var patches=data.data[(_b=_this.state.data)===null||_b===void 0?void 0:_b.id];if(!patches||!patches.length)return;location.href.includes("builder.debug=true")&&eval("debugger");for(var newData=_this.state.data,_i=0,patches_1=patches;_i<patches_1.length;_i++){var patch=patches_1[_i];newData=applyPatchWithMinimalMutationChain(newData,patch,!1)}_this.setState({updates:_this.state.updates+1,data:newData}),_this.props.contentLoaded&&_this.props.contentLoaded(newData.data,newData)}}},_this.subscriptions=new Subscription,_this.firstLoad=!0,_this.clicked=!1,_this.trackedImpression=!1,_this.intersectionObserver=null,_this.onClick=function(i){var e=i.nativeEvent,o=_this.data;o&&(builder.autoTrack&&_this.builder.trackInteraction(o.id,_this.renderedVariantId,_this.clicked,e,{content:o}),_this.clicked||(_this.clicked=!0))},_this}return __extends(BuilderContent,_super),Object.defineProperty(BuilderContent.prototype,"builder",{get:function(){return this.props.builder||builder},enumerable:!1,configurable:!0}),Object.defineProperty(BuilderContent.prototype,"name",{get:function(){var i=this.props;return"model"in i?i.model:i.modelName},enumerable:!1,configurable:!0}),Object.defineProperty(BuilderContent.prototype,"renderedVariantId",{get:function(){var i,e,o=this.props.isStatic?this.builder.getCookie("builder.tests.".concat((i=this.data)===null||i===void 0?void 0:i.id)):(e=this.data)===null||e===void 0?void 0:e.variationId;if(o!==null)return o},enumerable:!1,configurable:!0}),Object.defineProperty(BuilderContent.prototype,"options",{get:function(){var i,e,o=__assign({},this.props.options||{});return o.key||!(!((i=this.props.content)===null||i===void 0)&&i.id)||Builder.isEditing||Builder.isPreviewing||(o.key=this.props.content.id),!this.props.content||!((e=o.initialContent)===null||e===void 0)&&e.length||!this.props.inline&&Builder.isPreviewing||(o.initialContent=[this.props.content]),o},enumerable:!1,configurable:!0}),Object.defineProperty(BuilderContent.prototype,"data",{get:function(){var i=(this.props.inline||!Builder.isBrowser||this.firstLoad)&&this.options.initialContent&&this.options.initialContent[0]||this.state.data;return getContentWithInfo(i)},enumerable:!1,configurable:!0}),BuilderContent.prototype.componentDidMount=function(){var i,e;if(!this.props.inline||Builder.isEditing||Builder.isPreviewing)this.subscribeToContent();else if(this.props.inline&&(!((e=(i=this.options)===null||i===void 0?void 0:i.initialContent)===null||e===void 0)&&e.length)){var o=this.options.initialContent[0];o!=null&&o.id&&this.builder.trackImpression(o.id,this.renderedVariantId,void 0,{content:o})}Builder.isEditing&&addEventListener("message",this.onWindowMessage)},BuilderContent.prototype.subscribeToContent=function(){var i=this;this.name!=="_inline"&&this.subscriptions.add(this.builder.queueGetContent(this.name,this.options).subscribe(function(e){var o=e&&e[0];i.setState({data:o,loading:!1});var s=(i.builder.editingModel||i.builder.previewingModel)===i.name;if(!i.props.inline&&i.props.content&&i.firstLoad&&s&&(i.firstLoad=!1,i.subscriptions.unsubscribe(),i.subscribeToContent()),o&&i.firstLoad&&(i.firstLoad=!1,builder.autoTrack&&!Builder.isEditing)){var a=!1;if(typeof IntersectionObserver=="function"&&i.ref)try{(i.intersectionObserver=new IntersectionObserver(function(c,d){c.forEach(function(h){h.intersectionRatio>0&&!i.trackedImpression&&(i.builder.trackImpression(o.id,i.renderedVariantId,void 0,{content:i.data}),i.data,i.trackedImpression=!0,i.ref&&d.unobserve(i.ref))})})).observe(i.ref),a=!0}catch{console.warn("Could not bind intersection observer")}a||(i.trackedImpression=!0,i.builder.trackImpression(o.id,i.renderedVariantId,void 0,{content:o}))}i.props.contentLoaded&&i.props.contentLoaded(o&&o.data,o)},function(e){i.props.contentError&&(i.props.contentError(e),i.setState({loading:!1}))}))},BuilderContent.prototype.componentWillUnmount=function(){Builder.isEditing&&removeEventListener("message",this.onWindowMessage),this.subscriptions.unsubscribe(),this.intersectionObserver&&this.ref&&this.intersectionObserver.unobserve(this.ref)},BuilderContent.prototype.render=function(){var i=this;if(this.props.dataOnly)return null;var e=this.state.loading,o=this.data,s=this.props.dataOnly?NoWrap:"div";return React.createElement(VariantsProvider,{initialContent:o},function(a,c){return React.createElement(React.Fragment,null,a.map(function(d,h){var g=h===a.length-1?React.Fragment:"template";return React.createElement(React.Fragment,{key:String((d==null?void 0:d.id)+h)},g!=="template"&&(c==null?void 0:c()),React.createElement(g,__assign({key:String((d==null?void 0:d.id)+h)},g==="template"&&{"data-template-variant-id":d==null?void 0:d.id}),React.createElement(s,__assign({},h===0&&!i.props.dataOnly&&{ref:function(_){return i.ref=_}},{className:"builder-content",onClick:i.onClick,"builder-content-id":d==null?void 0:d.id,"builder-model":i.name}),i.props.children(d==null?void 0:d.data,!i.props.inline&&e,o))))}))})},BuilderContent}(React.Component),getContentWithInfo=function(i){var e;if(i){var o=builder.getCookie("builder.tests.".concat(i.id)),s=o===i.id?i:(e=i.variations)===null||e===void 0?void 0:e[o],a=(s==null?void 0:s.name)||((s==null?void 0:s.id)===i.id?"Default variation":"");return __assign(__assign({},i),{variationId:o,testVariationId:o,testVariationName:a})}return null};function unwrapExports(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function createCommonjsModule(i,e){return i(e={exports:{}},e.exports),e.exports}var onChange_1=createCommonjsModule(function(i,e){Object.defineProperty(e,"__esModule",{value:!0});var o=Symbol("target"),s=Symbol("unsubscribe"),a=function(h,g){return g&&g.toString&&(h&&(h+="."),h+=g.toString()),h},c=function(h){return Array.isArray(h)?h.slice():Object.assign({},h)},d=function(h,g,_){if(typeof Proxy>"u")return h;_===void 0&&(_={});var j,b,$=Symbol("ProxyTarget"),nt=!1,tt=!1,it=!1,ot=_.equals||Object.is,_e=new WeakMap,et=new WeakMap,rt=new WeakMap,st=function(vt,Et,It,Rt){if(!it)if(nt){if(nt&&b&&It!==void 0&&Rt!==void 0&&Et!=="length"){var Dt=b;vt!==j&&function(Ft,Gt){for(var Ht;Ft;)(Ht=Ft.indexOf("."))===-1&&(Ht=Ft.length),Gt(Ft.slice(0,Ht)),Ft=Ft.slice(Ht+1)}(vt=vt.replace(j,"").slice(1),function(Ft){Dt[Ft]=c(Dt[Ft]),Dt=Dt[Ft]}),Dt[Et]=It}tt=!0}else g(a(vt,Et),Rt,It)},dt=function(vt,Et){var It=_e?_e.get(vt):void 0;It&&It.delete(Et)},ht=function(vt,Et){if(it)return vt;et.set(vt,Et);var It=rt.get(vt);return It===void 0&&(It=new Proxy(vt,ft),rt.set(vt,It)),It},mt=function(vt){return it||_.ignoreSymbols===!0&&typeof vt=="symbol"},ft={get:function(vt,Et,It){if(Et===$||Et===o)return vt;if(Et===s&&et.get(vt)==="")return function(Ft){return it=!0,_e=null,et=null,rt=null,Ft}(vt);var Rt=Reflect.get(vt,Et,It);if(function(Ft){return Ft===null||typeof Ft!="object"&&typeof Ft!="function"}(Rt)||function(Ft){return Ft instanceof RegExp||Ft instanceof Number}(Rt)||Et==="constructor"||_.isShallow===!0)return Rt;var Dt=function(Ft,Gt){var Ht=_e?_e.get(Ft):void 0;if(Ht)return Ht;Ht=new Map,_e.set(Ft,Ht);var St=Ht.get(Gt);return St||(St=Reflect.getOwnPropertyDescriptor(Ft,Gt),Ht.set(Gt,St)),St}(vt,Et);if(Dt&&!Dt.configurable){if(Dt.set&&!Dt.get)return;if(Dt.writable===!1)return Rt}return ht(Rt,a(et.get(vt),Et))},set:function(vt,Et,It,Rt){It&&It[$]!==void 0&&(It=It[$]);var Dt=mt(Et),Ft=Dt?null:Reflect.get(vt,Et,Rt),Gt=Reflect.set(vt[$]||vt,Et,It);return Dt||ot(Ft,It)||st(et.get(vt),Et,Ft,It),Gt},defineProperty:function(vt,Et,It){var Rt=Reflect.defineProperty(vt,Et,It);return mt(Et)||(dt(vt,Et),st(et.get(vt),Et,void 0,It.value)),Rt},deleteProperty:function(vt,Et){if(!Reflect.has(vt,Et))return!0;var It=mt(Et),Rt=It?null:Reflect.get(vt,Et),Dt=Reflect.deleteProperty(vt,Et);return It||(dt(vt,Et),st(et.get(vt),Et,Rt)),Dt},apply:function(vt,Et,It){var Rt=Et instanceof Date;if(Rt&&(Et=Et[$]),!nt){nt=!0,Rt&&(b=Et.valueOf()),(Array.isArray(Et)||toString.call(Et)==="[object Object]")&&(b=c(Et[$])),j=(j=et.get(vt)).slice(0,Math.max(j.lastIndexOf("."),0));var Dt=Reflect.apply(vt,Et,It);return nt=!1,(tt||Rt&&!ot(b,Et.valueOf()))&&(st(j,"",b,Et[$]||Et),b=null,tt=!1),Dt}return Reflect.apply(vt,Et,It)}},bt=ht(h,"");return g=g.bind(bt),bt};d.target=function(h){return h[o]||h},d.unsubscribe=function(h){return h[s]||h},i.exports=d,e.default=d}),onChange=unwrapExports(onChange_1),nextTick=Builder.nextTick;function debounceNextTick(i,e,o){return e===void 0&&typeof i=="function"?debounceNextTickImpl(i):{configurable:!0,enumerable:o.enumerable,get:function(){return Object.defineProperty(this,e,{configurable:!0,enumerable:o.enumerable,value:debounceNextTickImpl(o.value)}),this[e]}}}function debounceNextTickImpl(i){var e=null,o=null;return function(){var a=e;e=[].slice.call(arguments),o=this,a===null&&nextTick(s)};function s(){i.apply(o,e),e=null,o=null}}function throttle(i,e,o){var s,a,c;o===void 0&&(o={});var d=null,h=0,g=function(){h=o.leading===!1?0:Date.now(),d=null,c=i.apply(s,a),d||(s=a=null)};return function(){var _=Date.now();h||o.leading!==!1||(h=_);var j=e-(_-h);return s=this,a=arguments,j<=0||j>e?(d&&(clearTimeout(d),d=null),h=_,c=i.apply(s,a),d||(s=a=null)):d||o.trailing===!1||(d=setTimeout(g,j)),c}}var BuilderMetaContext=React.createContext({emailMode:!1,ampMode:!1,isServer:!1}),tryEval=function(i,e,o){e===void 0&&(e={});var s=i;if(typeof s=="string"&&s.trim()){var a=!(s.includes(";")||s.includes(" return ")),c=function(){};try{Builder.isBrowser&&(c=new Function("state",`var rootState = state;
        if (typeof Proxy !== 'undefined') {
          rootState = new Proxy(rootState, {
            set: function () {
              return false;
            },
            get: function (target, key) {
              if (key === 'state') {
                return state;
              }
              return target[key]
            }
          });
        }
        with (rootState) {
          `.concat(a?"return (".concat(i,");"):i,`;
        }`)))}catch(j){Builder.isBrowser&&console.warn("Could not compile javascript",j)}try{if(Builder.isBrowser||shouldForceBrowserRuntimeInNode())return c(e||{});var d=safeDynamicRequire("isolated-vm"),h=getIsolateContext(),g=makeFn(i,a,["state"]),_=h.evalClosureSync(g,[new d.Reference(e||{})]);try{return JSON.parse(_)}catch{return _}}catch(j){o&&o.push(j),Builder.isBrowser?console.warn("Builder custom code error:",j.message,"in",i,j.stack):isDebug()&&console.debug("Builder custom code error:",j.message,"in",i,j.stack)}}};function toError(i){return i instanceof Error?i:new Error(String(i))}function getBuilderPixel(i){return{id:"builder-pixel-"+Math.random().toString(36).split(".")[1],"@type":"@builder.io/sdk:Element",tagName:"img",properties:{role:"presentation","aria-hidden":"true",src:"https://cdn.builder.io/api/v1/pixel?apiKey=".concat(i)},responsiveStyles:{large:{height:"0",width:"0",display:"inline-block",opacity:"0",overflow:"hidden",pointerEvents:"none"}}}}function pick(i){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];var s={};return e.forEach(function(a){s[a]=i[a]}),s}function omit(i){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];var s=__assign({},i);return e.forEach(function(a){delete s[a]}),s}var instancesMap=new Map,wrapComponent=function(i){return function(e){var o,s=e.builderTag||"div",a=["children"].concat(((o=i.inputs)===null||o===void 0?void 0:o.map(function(h){return h.name}))||[]),c=omit.apply(void 0,__spreadArray(__spreadArray([e],a,!1),["attributes"],!1)),d=e;return i.noWrap?React.createElement(i.class,__assign({attributes:c},d)):React.createElement(s,__assign({},c),React.createElement(i.class,__assign({},d)))}},size$1=function(i){return Object.keys(i).length};function debounce(i,e,o){var s;return o===void 0&&(o=!1),function(){var a=this,c=arguments;clearTimeout(s),s=setTimeout(function(){s=null,o||i.apply(a,c)},e),o&&!s&&i.apply(a,c)}}var fontsLoaded=new Set,fetch$1;globalThis.fetch&&(fetch$1=globalThis.fetch),fetch$1!=null||(fetch$1=require("node-fetch"));var sizeMap={desktop:"large",tablet:"medium",mobile:"small",xsmall:"xsmall"},fetchCache={};function searchToObject$1(i){var e=(i.search||"").substring(1).split("&"),o={};for(var s in e)if(e[s]&&typeof e[s]=="string"){var a=e[s].split("=");o[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return o}var BuilderComponent=function(i){function e(o){var s,a,c=this;(c=i.call(this,o)||this).subscriptions=new Subscription,c.onStateChange=new BehaviorSubject(null),c.asServer=Builder.isServer,c.contentRef=null,c.styleRef=null,c.rootState=Builder.isServer?{}:onChange({},function(){return c.updateState()}),c.lastJsCode="",c.lastHttpRequests={},c.httpSubscriptionPerKey={},c.firstLoad=!0,c.ref=null,c.messageListener=function(b){var $;if(Builder.isTrustedHostForEvent(b)){var nt=b.data;switch(nt.type){case"builder.configureSdk":var tt=nt.data;if(!tt.contentId||tt.contentId!==(($=c.useContent)===null||$===void 0?void 0:$.id))return;c.sizes=getSizesForBreakpoints(tt.breakpoints||{}),c.setState({state:Object.assign(c.rootState,{deviceSize:c.deviceSizeState,device:c.device}),updates:(c.state&&c.state.updates||0)+1,breakpoints:tt.breakpoints});break;case"builder.updateSpacer":var it=nt.data;c.rootState._spacer,c.updateState(function(dt){dt._spacer=it});break;case"builder.resetState":var ot=nt.data,_e=ot.state;if(ot.model===c.name){for(var et in c.rootState)typeof c.rootState[et]!="function"&&delete c.rootState[et];Object.assign(c.rootState,_e),c.setState(__assign(__assign({},c.state),{state:c.rootState,updates:(c.state&&c.state.updates||0)+1}))}break;case"builder.resetSymbolState":var rt=nt.data.state,st=(_e=rt.state,rt.model,rt.id);if(c.props.builderBlock&&c.props.builderBlock===st){for(var et in c.rootState)delete c.rootState[et];Object.assign(c.rootState,_e),c.setState(__assign(__assign({},c.state),{state:c.rootState,updates:(c.state&&c.state.updates||0)+1}))}}}},c.resizeFn=function(){var b=c.deviceSizeState;b!==c.state.state.deviceSize&&c.setState(__assign(__assign({},c.state),{updates:(c.state&&c.state.updates||0)+1,state:Object.assign(c.rootState,__assign(__assign({},c.state.state),{deviceSize:b}))}))},c.resizeListener=Builder.isEditing?throttle(c.resizeFn,200):debounce(c.resizeFn,400),c.mounted=!1,c.updateState=function(b){var $=c.rootState;b&&b($),c.mounted?c.setState({update:c.updateState,state:$,updates:(c.state&&c.state.updates||0)+1}):c.state=__assign(__assign({},c.state),{update:c.updateState,state:$,updates:(c.state&&c.state.updates||0)+1}),c.notifyStateChange()},c.onContentLoaded=function(b,$){if(c.name==="page"&&Builder.isBrowser&&b){var nt=b.title,tt=b.pageTitle,it=b.description,ot=b.pageDescription;if((nt||tt)&&(document.title=nt||tt),it||ot){var _e=document.querySelector('meta[name="description"]');_e||((_e=document.createElement("meta")).setAttribute("name","description"),document.head.appendChild(_e)),_e.setAttribute("content",it||ot)}}if(Builder.isEditing&&c.notifyStateChange(),c.props.contentLoaded&&c.props.contentLoaded(b,$),b&&b.inputs&&Array.isArray(b.inputs)&&b.inputs.length&&(b.state||(b.state={}),b.inputs.forEach(function(ft){ft&&ft.name&&ft.defaultValue!==void 0&&b.state[ft.name]===void 0&&(b.state[ft.name]=ft.defaultValue)})),b&&b.state){var et=__assign(__assign({},c.state),{updates:(c.state&&c.state.updates||0)+1,state:Object.assign(c.rootState,__assign(__assign(__assign(__assign(__assign({},c.state.state),{location:c.locationState,device:c.device}),b.state),c.externalState),{deviceSize:c.deviceSizeState}))});c.mounted?c.setState(et):c.state=et}if(b&&b.jsCode&&!c.options.codegen){var rt=!1;if(Builder.isEditing&&(c.lastJsCode===b.jsCode?rt=!0:c.lastJsCode=b.jsCode),!rt){var st=c.state.state;try{new Function("data","ref","state","update","element","Builder","builder","context",b.jsCode)(b,c,st,c.state.update,c.ref,Builder,builder,c.state.context)}catch(ft){var dt=toError(ft);Builder.isBrowser?console.warn("Builder custom code error:",dt.message,"in",b.jsCode,dt.stack):isDebug()&&console.debug("Builder custom code error:",dt.message,"in",b.jsCode,dt.stack)}}}if(b&&b.httpRequests&&!c.props.noAsync&&!(rt=!1)){var ht=function(ft){var bt=b.httpRequests[ft];if(bt&&(!c.data[ft]||Builder.isEditing)){var vt=typeof bt=="object"&&bt["@type"]==="@builder.io/core:Request";if(Builder.isBrowser){var Et=vt?c.evalExpression(bt.request.url):c.evalExpression(bt);if(Builder.isEditing&&c.lastHttpRequests[ft]===Et)return"continue";c.lastHttpRequests[ft]=Et,vt?c.handleRequest(ft,{url:Et,method:bt.request.method,body:bt.request.body,headers:bt.request.headers}):c.handleRequest(ft,{url:Et,method:"GET"});var It=c.httpSubscriptionPerKey[ft];It&&It.unsubscribe();var Rt=c.httpSubscriptionPerKey[ft]=c.onStateChange.subscribe(function(){var Dt=vt?c.evalExpression(bt.request.url):c.evalExpression(bt);Dt!==Et&&(vt?c.handleRequest(ft,{url:Dt,method:bt.request.method,body:bt.request.body,headers:bt.request.headers}):c.handleRequest(ft,{url:Dt,method:"GET"}),c.lastHttpRequests[ft]=Dt)});c.subscriptions.add(Rt)}else vt?c.handleRequest(ft,{url:c.evalExpression(bt.request.url),method:bt.request.method,body:bt.request.body,headers:bt.request.headers}):c.handleRequest(ft,{url:c.evalExpression(bt),method:"GET"})}};for(var mt in b.httpRequests)ht(mt)}};var d=c.inlinedContent;d&&d.content&&(d=d.content),c.sizes=getSizesForBreakpoints(((s=d==null?void 0:d.meta)===null||s===void 0?void 0:s.breakpoints)||{});var h=(a=c.inlinedContent)===null||a===void 0?void 0:a.data;h&&Array.isArray(h.inputs)&&h.inputs.length>0&&(h.state||(h.state={}),h.inputs.forEach(function(b){b&&b.name&&b.defaultValue!==void 0&&h.state[b.name]===void 0&&(h.state[b.name]=b.defaultValue)})),c.state={context:__assign(__assign({},o.context),{apiKey:c.props.apiKey||builder.apiKey}),state:Object.assign(c.rootState,__assign(__assign(__assign(__assign({},c.inlinedContent&&c.inlinedContent.data&&c.inlinedContent.data.state),{isBrowser:Builder.isBrowser,isServer:!Builder.isBrowser,_hydrate:o.hydrate,location:c.locationState,deviceSize:c.deviceSizeState,device:c.device}),c.getHtmlData()),o.data)),updates:0,key:0,update:c.updateState};var g=c.props.apiKey;if(g&&g!==c.builder.apiKey&&!instancesMap.has(g)){var _=new Builder(g,void 0,void 0,!0);instancesMap.set(g,_)}if(c.inlinedContent){var j=c.inlinedContent.content||c.inlinedContent;c.onContentLoaded(j==null?void 0:j.data,getContentWithInfo(j))}return c.registerCustomComponents(),c}return __extends(e,i),Object.defineProperty(e.prototype,"options",{get:function(){return __assign(__assign({},e.defaults),this.props)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.props.model||this.props.modelName||this.props.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this.ref},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inlinedContent",{get:function(){if(!this.isPreviewing||this.props.inlineContent)return this.props.content},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"builder",{get:function(){return this.props.apiKey&&instancesMap.get(this.props.apiKey)||this.props.builder||builder},enumerable:!1,configurable:!0}),e.prototype.getHtmlData=function(){var o=this.inlinedContent&&this.inlinedContent.id||this.props.entry,s=o&&Builder.isBrowser&&document.querySelector('script[data-builder-json="'.concat(o,'"],script[data-builder-state="').concat(o,'"]'));if(s)try{return JSON.parse(s.innerText)}catch(a){console.warn("Could not parse Builder.io HTML data transfer",a,s.innerText)}return{}},Object.defineProperty(e.prototype,"device",{get:function(){return this.builder.getUserAttributes().device||"desktop"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"locationState",{get:function(){return __assign(__assign({},pick(this.location,"pathname","hostname","search","host")),{path:this.location.pathname&&this.location.pathname.split("/").slice(1)||"",query:searchToObject$1(this.location)})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deviceSizeState",{get:function(){return Builder.isBrowser?this.sizes.getSizeForWidth(window.innerWidth):sizeMap[this.device]||"large"},enumerable:!1,configurable:!0}),e.renderInto=function(o,s,a,c){if(s===void 0&&(s={}),a===void 0&&(a=!0),c===void 0&&(c=!1),console.debug("BuilderPage.renderInto",o,s,a,this),o){var d=null;if(typeof o=="string"?d=document.querySelector(o):o instanceof Element&&(d=o),d){var h=d.classList.contains("builder-hydrated");if(!h||c){d.classList.add("builder-hydrated");var g=a&&d.innerHTML.includes("builder-block");if(!d.classList.contains("builder-component")){var _=d.querySelector(".builder-api-styles")||(d.previousElementSibling&&d.previousElementSibling.matches(".builder-api-styles")?d.previousElementSibling:null),j="";_&&(_.innerHTML.replace(/\/\*start:([^\*]+?)\*\/([\s\S]*?)\/\*end:([^\*]+?)\*\//g,function(ot,_e,et){var rt=null;try{rt=document.querySelector('[data-emotion-css="'.concat(_e,'"]'))}catch(st){console.warn(st)}return rt?rt.innerHTML=et:Builder.isEditing||(j+=ot),ot}),Builder.nextTick(function(){_.innerHTML=j}));var b=d.querySelector(".builder-component");b?d=b:g=!1}location.search.includes("builder.debug=true")&&console.debug("hydrate",g,d);var $=d;if(!h){var nt=document.createElement("div");d.insertAdjacentElement("beforebegin",nt),nt.appendChild(d),$=nt}if((Builder.isEditing||Builder.isBrowser&&location.search.includes("builder.preview="))&&(g=!1),g&&d){var tt=ReactDOM.render(React.createElement(e,__assign({},s)),$,$.builderRootRef);return $.builderRootRef=tt,tt}var it=ReactDOM.render(React.createElement(e,__assign({},s)),$,$.builderRootRef);return $.builderRootRef=it,it}console.debug("Tried to hydrate multiple times")}}},e.prototype.registerCustomComponents=function(){if(this.props.customComponents)for(var o=0,s=this.props.customComponents;o<s.length;o++){var a=s[o];if(a){var c=a.component,d=__rest(a,["component"]);Builder.registerComponent(c,d)}}},e.prototype.componentDidMount=function(){var o,s=this;this.mounted=!0,this.asServer&&(this.asServer=!1,this.updateState(function(a){a.isBrowser=!0,a.isServer=!1})),Builder.isIframe&&((o=window.parent)===null||o===void 0||o.postMessage({type:"builder.sdkInjected",data:{modelName:this.name,apiKey:this.props.apiKey||builder.apiKey}},"*")),Builder.isBrowser&&(window.addEventListener("resize",this.resizeListener),Builder.isEditing&&window.addEventListener("message",this.messageListener),(Builder.isEditing||Builder.isPreviewing)&&Builder.nextTick(function(){s.firstLoad=!1,s.reload()}),setTimeout(function(){window.dispatchEvent(new CustomEvent("builder:component:load",{detail:{ref:s}}))}))},Object.defineProperty(e.prototype,"isPreviewing",{get:function(){return(Builder.isServer||Builder.isBrowser&&Builder.isPreviewing&&!this.firstLoad)&&(builder.previewingModel===this.name||builder.previewingModel==="BUILDER_STUDIO")},enumerable:!1,configurable:!0}),e.prototype.notifyStateChange=function(){if(!Builder.isServer&&this&&this.state){var o=this.state.state;this.props.onStateChange&&this.props.onStateChange(o),Builder.isBrowser&&window.dispatchEvent(new CustomEvent("builder:component:stateChange",{detail:{state:o,ref:this}})),this.onStateChange.next(o)}},e.prototype.processStateFromApi=function(o){return o},Object.defineProperty(e.prototype,"location",{get:function(){return this.props.location||(Builder.isBrowser?location:{})},enumerable:!1,configurable:!0}),e.prototype.getCssFromFont=function(o,s){var a=o.family+(o.kind&&!o.kind.includes("#")?", "+o.kind:""),c=a.split(",")[0],d=o.fileUrl?o.fileUrl:o.files&&o.files.regular,h="";if(d&&a&&c&&(h+=`
@font-face {
  font-family: "`.concat(a,`";
  src: local("`).concat(c,`"), url('`).concat(d,`') format('woff2');
  font-display: fallback;
  font-weight: 400;
}
        `).trim()),o.files){for(var g in o.files)if(String(Number(g))===g){var _=o.files[g];_&&_!==d&&(h+=`
@font-face {
  font-family: "`.concat(a,`";
  src: url('`).concat(_,`') format('woff2');
  font-display: fallback;
  font-weight: `).concat(g,`;
}
          `).trim())}}return h},e.prototype.componentWillUnmount=function(){this.unsubscribe(),Builder.isBrowser&&(window.removeEventListener("resize",this.resizeListener),window.removeEventListener("message",this.messageListener))},e.prototype.getFontCss=function(o){var s=this;return this.builder.allowCustomFonts&&(o==null?void 0:o.customFonts)&&o.customFonts.length&&o.customFonts.map(function(a){return s.getCssFromFont(a,o)}).join(" ")||""},e.prototype.ensureFontsLoaded=function(o){if(this.builder.allowCustomFonts&&(o!=null&&o.customFonts)&&Array.isArray(o.customFonts))for(var s=0,a=o.customFonts;s<a.length;s++){var c=a[s],d=c.fileUrl?c.fileUrl:c.files&&c.files.regular;if(!fontsLoaded.has(d)){var h=this.getCssFromFont(c,o);if(fontsLoaded.add(d),!h)continue;var g=document.createElement("style");g.className="builder-custom-font",g.setAttribute("data-builder-custom-font",d),g.innerHTML=h,document.head.appendChild(g)}}},e.prototype.getCss=function(o){var s,a=(s=this.useContent)===null||s===void 0?void 0:s.id,c=(o==null?void 0:o.cssCode)||"";return a&&(c=c.replace(/&/g,".builder-component-".concat(a))),c+this.getFontCss(o)},Object.defineProperty(e.prototype,"data",{get:function(){var o,s=__assign(__assign(__assign({},this.inlinedContent&&((o=this.inlinedContent.data)===null||o===void 0?void 0:o.state)),this.externalState),this.state.state);return Object.assign(this.rootState,s),s},enumerable:!1,configurable:!0}),e.prototype.componentDidUpdate=function(o){var s=this;this.props.data&&o.data!==this.props.data&&this.state.update(function(a){Object.assign(a,s.externalState)}),this.props.customComponents&&this.props.customComponents!==o.customComponents&&this.registerCustomComponents(),Builder.isEditing&&this.inlinedContent&&o.content!==this.inlinedContent&&this.onContentLoaded(this.inlinedContent.data,this.inlinedContent)},e.prototype.checkStyles=function(o){if(this.styleRef){var s=this.getCss(o);this.styleRef.innerHTML!==s&&(this.styleRef.innerHTML=s)}},e.prototype.reload=function(){this.setState({key:this.state.key+1})},Object.defineProperty(e.prototype,"content",{get:function(){var o=this.inlinedContent;return o&&o.content&&(o=__assign(__assign({},o),{data:o.content})),o},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"externalState",{get:function(){return __assign(__assign({},this.props.data),this.props.locale?{locale:this.props.locale}:{})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"useContent",{get:function(){return this.content||this.state.context.builderContent},enumerable:!1,configurable:!0}),e.prototype.render=function(){var o,s=this,a=this.content,c=Builder.isBrowser&&this.externalState&&size$1(this.externalState)&&hash(this.externalState),d=Builder.isEditing?this.name:this.props.entry;d&&!Builder.isEditing&&c&&c.length<300&&(d+=":"+c);var h=this.props.dataOnly?React.Fragment:"div",g=(o=this.useContent)===null||o===void 0?void 0:o.id;return React.createElement(h,{onClick:function(_){!Builder.isEditing||s.props.isChild||s.props.stopClickPropagationWhenEditing||_.stopPropagation()},className:"builder-component ".concat(g?"builder-component-".concat(g):""),"data-name":this.name,"data-source":"Rendered by Builder.io",key:this.state.key,ref:function(_){return s.ref=_}},React.createElement(BuilderMetaContext.Consumer,null,function(_){return React.createElement(BuilderMetaContext.Provider,{value:typeof s.props.ampMode=="boolean"?__assign(__assign({},_),{ampMode:s.props.ampMode}):_},React.createElement(BuilderAsyncRequestsContext.Consumer,null,function(j){var b;return s._asyncRequests=j&&j.requests,s._errors=j&&j.errors,s._logs=j&&j.logs,React.createElement(BuilderContent,{isStatic:s.props.isStatic||Builder.isStatic,key:((b=s.inlinedContent)===null||b===void 0?void 0:b.id)||("content"in s.props&&!s.isPreviewing?"null-content-prop":"no-content-prop"),builder:s.builder,ref:function($){return s.contentRef=$},contentLoaded:function($,nt){return s.onContentLoaded($,nt)},options:__assign(__assign(__assign(__assign(__assign(__assign({key:d,entry:s.props.entry},a&&{initialContent:[a]}),!a&&"content"in s.props&&!s.isPreviewing&&{initialContent:[]}),s.props.url&&{url:s.props.url}),s.props.options),s.props.locale?{locale:s.props.locale}:{}),s.options.codegen&&{format:"react"}),inline:s.props.inlineContent||!s.isPreviewing&&"content"in s.props,contentError:s.props.contentError,modelName:s.name||"page"},function($,nt,tt){var it;if(s.props.dataOnly)return null;tt&&tt.id&&(s.state.breakpoints&&(tt.meta=tt.meta||{},tt.meta.breakpoints=s.state.breakpoints),s.state.context.builderContent=tt),Builder.isBrowser&&Builder.nextTick(function(){s.checkStyles($)});var ot=s.options.codegen;if(ot&&!s.Component&&($!=null&&$.blocksJs)){var _e=Array.from(new Set(Builder.components.map(function(ft){return ft.name}))),et=Builder.components.slice().reverse(),rt=_e.map(function(ft){return et.find(function(bt){return bt.class&&bt.name===ft})}),st=_e.map(function(ft){return(ft||"").replace(/[^\w]+/gi,"")}),dt=rt.map(function(ft){return wrapComponent(ft)});s.Component=new(Function.bind.apply(Function,__spreadArray(__spreadArray([void 0,"jsx","_css","Builder","builder","React","useBuilderState"],st,!1),[$.blocksJs],!1)))().apply(void 0,__spreadArray([jsx,css,Builder,builder,React,function(ft){var bt=React.useState(0)[1];return React.useState(function(){return onChange(ft,function(){bt(function(vt){return vt+1})})})[0]}],dt,!1))}var ht=($==null?void 0:$.blocks)||[],mt=ht.find(function(ft){var bt;return(bt=ft.id)===null||bt===void 0?void 0:bt.startsWith("builder-pixel")});return $&&!mt&&ht.length>0&&ht.push(getBuilderPixel(builder.apiKey)),$?React.createElement("div",__assign({"data-builder-component":s.name,"data-builder-content-id":tt.id},s.isPreviewing?{"data-builder-variation-id":tt.testVariationId||tt.variationId||tt.id}:{}),!ot&&s.getCss($)&&React.createElement("style",{ref:function(ft){return s.styleRef=ft},className:"builder-custom-styles",dangerouslySetInnerHTML:{__html:s.getCss($)}}),React.createElement(BuilderStoreContext.Provider,{value:__assign(__assign({},s.state),{rootState:s.rootState,state:s.data,content:tt,renderLink:s.props.renderLink})},ot&&s.Component?React.createElement(s.Component,{data:s.data,context:s.state.context}):React.createElement(BuilderBlocks,{key:String(!!(!((it=$==null?void 0:$.blocks)===null||it===void 0)&&it.length)),emailMode:s.props.emailMode,fieldName:"blocks",blocks:ht}))):nt?React.createElement("div",{"data-builder-component":s.name,className:"builder-loading"},s.props.children):React.createElement("div",{"data-builder-component":s.name,className:"builder-no-content"})})}))}))},e.prototype.evalExpression=function(o){var s=this,a=this.data;return String(o).replace(/{{([^}]+)}}/g,function(c,d){return tryEval(d,a,s._errors)})},e.prototype.handleRequest=function(o,s){return __awaiter(this,void 0,void 0,function(){var a,c,d,h,g,_,j,b,$,nt=this;return __generator(this,function(tt){return a=s.url,c=s.method,d=s.body,h=s.headers,g=JSON.stringify({url:a,method:c,body:d,headers:h}),Builder.isIframe&&fetchCache[g]?(this.updateState(function(it){it[o]=fetchCache[g]}),[2,fetchCache[g]]):(_=function(){return __awaiter(nt,void 0,void 0,function(){var it,ot,_e,et;return __generator(this,function(rt){switch(rt.label){case 0:it=Date.now(),Builder.isBrowser||console.time("Fetch "+g),rt.label=1;case 1:return rt.trys.push([1,4,5,6]),[4,fetch$1(a,{method:c,headers:h,body:d})];case 2:return[4,rt.sent().json()];case 3:return ot=rt.sent(),[3,6];case 4:return _e=rt.sent(),et=toError(_e),this._errors&&this._errors.push(et),this._logs&&this._logs.push("Fetch to ".concat(g," errored in ").concat(Date.now()-it,"ms")),[2];case 5:return Builder.isBrowser||(console.timeEnd("Fetch "+g),this._logs&&this._logs.push("Fetched ".concat(g," in ").concat(Date.now()-it,"ms"))),[7];case 6:return ot&&(Builder.isIframe&&(fetchCache[g]=ot),this.updateState(function(st){st[o]=ot})),[2,ot]}})})},(j=this._asyncRequests&&this._asyncRequests.find(function(it){return isRequestInfo(it)&&it.url===a}))?((b=j.promise).then(function(it){it&&nt.updateState(function(ot){ot[o]=it})}),[2,b]):($=_(),Builder.nextTick(function(){nt._asyncRequests&&nt._asyncRequests.push($)}),[2,$]))})})},e.prototype.unsubscribe=function(){this.subscriptions&&(this.subscriptions.unsubscribe(),this.subscriptions=new Subscription)},e.prototype.handleBuilderRequest=function(o,s){var a=this,c=tryEval(s,this.data,this._errors);this.subscriptions&&this.unsubscribe(),c&&this.subscriptions.add(this.builder.queueGetContent(c.model,c).subscribe(function(d){d&&a.updateState(function(h){h[o]=d})}))},e.defaults={codegen:!!(Builder.isBrowser&&location.href.includes("builder.codegen=true"))},__decorate([debounceNextTick,__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],e.prototype,"notifyStateChange",null),e}(React.Component);function BuilderBlock(i){return i.type="react",Builder.Component(i)}function withBuilder(i,e){return BuilderBlock(e)(i),i}var isBuilderElement=function(i){return!!(typeof i=="object"&&i&&(i==null?void 0:i["@type"])==="@builder.io/sdk:Element")},withChildren=function(i){var e=React.forwardRef(function(o,s){var a,c,d=__assign({},o),h=o.children||o.builderBlock&&o.builderBlock.children&&o.builderBlock.children.map(function(_){return React.createElement(BuilderBlock$1,{key:_.id,block:_})}),g=(c=(a=o.builderBlock)===null||a===void 0?void 0:a.component)===null||c===void 0?void 0:c.options;return g&&Object.keys(g).forEach(function(_){var j=g[_];Array.isArray(j)&&j.every(isBuilderElement)?d[_]=j.map(function(b){return React.createElement(BuilderBlock$1,{key:b.id,block:b})}):isBuilderElement(j)&&(d[_]=React.createElement(BuilderBlock$1,{block:j}))}),React.createElement(i,__assign({},d,{ref:s}),h)});return e.builderOptions={canHaveChildren:!0},e},iconUrl="https://firebasestorage.googleapis.com/v0/b/builder-3b0a2.appspot.com/o/images%2Fbaseline-text_fields-24px%20(1).svg?alt=media&token=12177b73-0ee3-42ca-98c6-0dd003de1929",TextComponent=function(i){function e(){var o=i!==null&&i.apply(this,arguments)||this;return o.textRef=null,o}return __extends(e,i),e.prototype.componentDidMount=function(){this.textRef&&!/{{([^}]+)}}/.test(this.props.text)&&(this.textRef.innerHTML=this.props.text)},e.prototype.evalExpression=function(o,s){return this.allowTextEdit?String(o):String(o).replace(/{{([^}]+)}}/g,function(a,c){return tryEval(c,s)})},Object.defineProperty(e.prototype,"allowTextEdit",{get:function(){return Builder.isBrowser&&Builder.isEditing&&location.search.includes("builder.allowTextEdit=true")&&!(this.props.builderBlock&&this.props.builderBlock.bindings&&(this.props.builderBlock.bindings["component.options.text"]||this.props.builderBlock.bindings["options.text"]||this.props.builderBlock.bindings.text))},enumerable:!1,configurable:!0}),e.prototype.render=function(){var o=this,s={outline:"none","& p:first-of-type, & .builder-paragraph:first-of-type":{margin:0},"& > p, & .builder-paragraph":{color:"inherit",lineHeight:"inherit",letterSpacing:"inherit",fontWeight:"inherit",fontSize:"inherit",textAlign:"inherit",fontFamily:"inherit"}};return jsx(BuilderStoreContext.Consumer,null,function(a){var c;return!((c=a.content.meta)===null||c===void 0)&&c.rtlMode&&(s.direction="rtl"),jsx(React.Fragment,null,jsx("span",__assign({ref:function(d){o.textRef=d},css:s,className:"builder-text"},{dangerouslySetInnerHTML:{__html:o.evalExpression(o.props.text||o.props.content||"",a.state)}})))})},e}(React.Component);withBuilder(TextComponent,{name:"Text",static:!0,image:iconUrl,inputs:[{name:"text",type:"html",required:!0,autoFocus:!0,bubble:!0,defaultValue:"Enter some text..."}],defaultStyles:{lineHeight:"normal",height:"auto",textAlign:"center"}});function Slot(i){var e=i.name,o=reactExports.useContext(BuilderStoreContext),s=!o.context.symbolId;return jsx("div",__assign({css:{pointerEvents:"auto"}},s&&{"builder-slot":e}),jsx(BuilderBlocks,{child:!0,parentElementId:o.context.symbolId,dataPath:"symbol.data.".concat(e),blocks:o.state[e]||[]}))}Builder.registerComponent(Slot,{name:"Slot",description:"Allow child blocks to be inserted into this content when used as a Symbol",docsLink:"https://www.builder.io/c/docs/symbols-with-blocks",image:"https://cdn.builder.io/api/v1/image/assets%2FYJIGb4i01jvw0SRdL5Bt%2F3aad6de36eae43b59b52c85190fdef56",inputs:[{name:"name",type:"string",required:!0,defaultValue:"children"}]});var FragmentComponent=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return __extends(e,i),e.prototype.render=function(){return this.props.builderBlock&&this.props.builderBlock.children&&this.props.builderBlock.children.map(function(o,s){return React.createElement(BuilderBlock$1,{block:o,key:o.id,index:s})})},e}(React.Component);withBuilder(FragmentComponent,{name:"Core:Fragment",canHaveChildren:!0,noWrap:!0,static:!0,hideFromInsertMenu:!0});var DEFAULT_ASPECT_RATIO$2=.7004048582995948,defaultBlocks=[{"@type":"@builder.io/sdk:Element",responsiveStyles:{large:{display:"flex",flexDirection:"column",alignItems:"stretch",flexShrink:"0",position:"relative",marginTop:"30px",textAlign:"center",lineHeight:"normal",height:"auto",minHeight:"20px",minWidth:"20px",overflow:"hidden"}},component:{name:"Image",options:{image:"https://builder.io/api/v1/image/assets%2Fpwgjf0RoYWbdnJSbpBAjXNRMe9F2%2Ffb27a7c790324294af8be1c35fe30f4d",backgroundPosition:"center",backgroundSize:"cover",aspectRatio:DEFAULT_ASPECT_RATIO$2}}},{"@type":"@builder.io/sdk:Element",responsiveStyles:{large:{display:"flex",flexDirection:"column",alignItems:"stretch",flexShrink:"0",position:"relative",marginTop:"30px",textAlign:"center",lineHeight:"normal",height:"auto"}},component:{name:"Text",options:{text:"<p>Enter some text...</p>"}}}],ColumnsComponent=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return __extends(e,i),Object.defineProperty(e.prototype,"columns",{get:function(){return this.props.columns||[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gutterSize",{get:function(){return typeof this.props.space=="number"?this.props.space||0:20},enumerable:!1,configurable:!0}),e.prototype.getWidth=function(o){return this.columns[o]&&this.columns[o].width||100/this.columns.length},e.prototype.getColumnWidth=function(o){var s=this.columns,a=this.gutterSize,c=this.getWidth(o),d=a*(s.length-1)*(c/100);return"calc(".concat(c,"% - ").concat(d,"px)")},e.prototype.render=function(){var o,s,a,c,d=this,h=this.columns,g=this.gutterSize,_=((c=(a=(s=this.props.builderState)===null||s===void 0?void 0:s.context.builderContent)===null||a===void 0?void 0:a.meta)===null||c===void 0?void 0:c.breakpoints)||{},j=getSizesForBreakpoints(_);return jsx(React.Fragment,null,jsx("div",{className:"builder-columns",css:__assign({display:"flex",height:"100%"},this.props.stackColumnsAt!=="never"&&(o={},o["@media (max-width: ".concat(this.props.stackColumnsAt!=="tablet"?j.small.max:j.medium.max,"px)")]={flexDirection:this.props.reverseColumnsWhenStacked?"column-reverse":"column",alignItems:"stretch"},o))},h.map(function(b,$){var nt,tt,it=b.link?Link:"div";return jsx(React.Fragment,{key:$},jsx(it,__assign({className:"builder-column"},b.link?{href:b.link}:null,{css:__assign((nt={display:"flex",flexDirection:"column",alignItems:"stretch",lineHeight:"normal"},nt["& > .builder-blocks"]={flexGrow:1},nt.width=d.getColumnWidth($),nt.marginLeft=$===0?0:g,nt),d.props.stackColumnsAt!=="never"&&(tt={},tt["@media (max-width: ".concat(d.props.stackColumnsAt!=="tablet"?j.small.max:j.medium.max,"px)")]={width:"100%",marginLeft:0},tt))}),jsx(BuilderBlocks,{key:$,child:!0,parentElementId:d.props.builderBlock&&d.props.builderBlock.id,blocks:b.blocks,dataPath:"component.options.columns.".concat($,".blocks")})))})))},e}(React.Component);withBuilder(ColumnsComponent,{name:"Columns",static:!0,inputs:[{name:"columns",type:"array",broadcast:!0,subFields:[{name:"blocks",type:"array",hideFromUI:!0,defaultValue:defaultBlocks},{name:"width",type:"number",hideFromUI:!0,helperText:"Width %, e.g. set to 50 to fill half of the space"},{name:"link",type:"url",helperText:"Optionally set a url that clicking this column will link to"}],defaultValue:[{blocks:defaultBlocks},{blocks:defaultBlocks}],onChange:function(i){function e(){o.forEach(function(s){s.delete("width")})}var o=i.get("columns");Array.isArray(o)&&(!o.find(function(s){return s.get("width")})||(o.find(function(s){return!s.get("width")})||o.reduce(function(s,a){return s+a.get("width")},0)!==100)&&e())}},{name:"space",type:"number",defaultValue:20,helperText:"Size of gap between columns",advanced:!0},{name:"stackColumnsAt",type:"string",defaultValue:"tablet",helperText:"Convert horizontal columns to vertical at what device size",enum:["tablet","mobile","never"],advanced:!0},{name:"reverseColumnsWhenStacked",type:"boolean",defaultValue:!1,helperText:"When stacking columns for mobile devices, reverse the ordering",advanced:!0}]});var EmbedComponent=function(i){function e(){var o=i!==null&&i.apply(this,arguments)||this;return o.elementRef=null,o.scriptsInserted=new Set,o.scriptsRun=new Set,o}return __extends(e,i),e.prototype.shouldComponentUpdate=function(o){return o.content!==this.props.content},e.prototype.componentDidUpdate=function(o){this.props.content!==o.content&&this.findAndRunScripts()},e.prototype.componentDidMount=function(){this.findAndRunScripts()},e.prototype.findAndRunScripts=function(){if(this.elementRef&&typeof window<"u")for(var o=this.elementRef.getElementsByTagName("script"),s=0;s<o.length;s++){var a=o[s];if(a.src){if(this.scriptsInserted.has(a.src))continue;this.scriptsInserted.add(a.src);var c=document.createElement("script");c.async=!0,c.src=a.src,document.head.appendChild(c)}else{if(this.scriptsRun.has(a.innerText))continue;this.scriptsRun.add(a.innerText);try{new Function(a.innerText)()}catch(d){console.warn("Builder custom code component error:",d)}}}},Object.defineProperty(e.prototype,"content",{get:function(){return Builder.isServer?(this.props.content||"").replace(/<script[\s\S]*?<\/script>/g,""):this.props.content},enumerable:!1,configurable:!0}),e.prototype.render=function(){var o=this;return React.createElement("div",{ref:function(s){return o.elementRef=s},className:"builder-embed",dangerouslySetInnerHTML:{__html:this.content}})},e}(React.Component);withBuilder(EmbedComponent,{name:"Embed",static:!0,inputs:[{name:"url",type:"url",required:!0,defaultValue:"",helperText:"e.g. enter a youtube url, google map, etc"},{name:"content",type:"html",defaultValue:'<div style="padding: 20px; text-align: center">(Choose an embed URL)<div>',hideFromUI:!0}]});var globalReplaceNodes={},isShopify$1=Builder.isBrowser&&"Shopify"in window;if(Builder.isBrowser&&globalReplaceNodes){var customCodeQuerySelector_1=".builder-custom-code";try{var allCustomCodeElements_1=Array.from(document.querySelectorAll(customCodeQuerySelector_1)),builderTemplates=document.querySelectorAll("template[data-template-variant-id]");builderTemplates.length&&Array.from(builderTemplates).forEach(function(i){var e=i.content.querySelectorAll(customCodeQuerySelector_1);e.length&&(allCustomCodeElements_1=allCustomCodeElements_1.concat(Array.from(e)))}),allCustomCodeElements_1.forEach(function(i){var e=i.parentElement,o=e&&e.getAttribute("builder-id");o&&(globalReplaceNodes[o]=globalReplaceNodes[o]||[],globalReplaceNodes[o].push(isShopify$1?i:i.cloneNode(!0)))})}catch(i){console.error("Builder replace nodes error:",i)}}var CustomCodeComponent=function(i){function e(o){var s,a=this;if((a=i.call(this,o)||this).elementRef=null,a.originalRef=null,a.scriptsInserted=new Set,a.scriptsRun=new Set,a.firstLoad=!0,a.replaceNodes=!1,a.state={hydrated:!1},Builder.isBrowser){var c=(s=a.props.builderBlock)===null||s===void 0?void 0:s.id;if(a.replaceNodes=!!(Builder.isBrowser&&(o.replaceNodes||isShopify$1)&&c&&(globalReplaceNodes!=null&&globalReplaceNodes[c])),a.firstLoad&&a.props.builderBlock){if(c&&(globalReplaceNodes!=null&&globalReplaceNodes[c])){var d=globalReplaceNodes[c].shift()||null;a.originalRef=d,globalReplaceNodes[c].length===0&&delete globalReplaceNodes[c]}else if(a.replaceNodes){var h=document.querySelectorAll(".".concat(a.props.builderBlock.id," .builder-custom-code"));if(h.length===1){var g=h[0];a.originalRef=g,a.originalRef.remove()}}}}return a}return __extends(e,i),e.prototype.shouldComponentUpdate=function(o){return o.code!==this.props.code},Object.defineProperty(e.prototype,"noReactRender",{get:function(){var o;return!!(isShopify$1&&(!((o=this.props.code)===null||o===void 0)&&o.match(/{[{%]/g)))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHydrating",{get:function(){return!isShopify$1&&this.originalRef},enumerable:!1,configurable:!0}),e.prototype.componentDidUpdate=function(o){this.props.code!==o.code&&this.findAndRunScripts()},e.prototype.componentDidMount=function(){var o=this;this.firstLoad=!1,this.replaceNodes||(this.isHydrating?(this.setState({hydrated:!0}),Builder.nextTick(function(){return o.findAndRunScripts()})):this.findAndRunScripts()),Builder.isBrowser&&this.replaceNodes&&this.originalRef&&this.elementRef&&this.elementRef.appendChild(this.originalRef)},e.prototype.findAndRunScripts=function(){if(this.elementRef&&typeof window<"u")for(var o=this.elementRef.getElementsByTagName("script"),s=0;s<o.length;s++){var a=o[s];if(a.src){if(this.scriptsInserted.has(a.src))continue;this.scriptsInserted.add(a.src);var c=document.createElement("script");c.async=!0,c.src=a.src,document.head.appendChild(c)}else if(!a.type||["text/javascript","application/javascript","application/ecmascript"].includes(a.type)){if(this.scriptsRun.has(a.innerText))continue;try{this.scriptsRun.add(a.innerText),new Function(a.innerText)()}catch(d){console.warn("Builder custom code component error:",d)}}}},Object.defineProperty(e.prototype,"code",{get:function(){return(Builder.isServer||this.isHydrating&&this.firstLoad)&&this.props.scriptsClientOnly?(this.props.code||"").replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""):this.props.code},enumerable:!1,configurable:!0}),e.prototype.render=function(){var o=this;return React.createElement("div",__assign({ref:function(s){return o.elementRef=s},className:"builder-custom-code"},!this.replaceNodes&&!this.noReactRender&&{dangerouslySetInnerHTML:{__html:this.code}}))},e}(React.Component);withBuilder(CustomCodeComponent,{name:"Custom Code",static:!0,requiredPermissions:["editCode"],inputs:[{name:"code",type:"html",required:!0,defaultValue:"<p>Hello there, I am custom HTML code!</p>",code:!0},__assign({name:"replaceNodes",type:"boolean",helperText:"Preserve server rendered dom nodes",advanced:!0},isShopify$1&&{defaultValue:!0}),__assign({name:"scriptsClientOnly",type:"boolean",helperText:"Only print and run scripts on the client. Important when scripts influence DOM that could be replaced when client loads",advanced:!0},!isShopify$1&&{defaultValue:!0})]});var IMAGE_FILE_TYPES=["jpeg","jpg","png","svg","webp","gif","jfif","pjpeg","pjp","apng","avif","tif","tiff","heif","bmp","eps","raw","cr2","nef","orf","sr2","psd","heic","dib","ai"],VIDEO_FILE_TYPES=["mp4","webm","mkv","flv","vob","ogv","ogg","drc","gif","gifv","mng","avi","mov","qt","mts","m2ts","ts","wmv","yuv","rm","rmvb","viv","asf","amv","m4p","mpeg","mpe","m2v","m4v","svi","3gp","3g2","mxf","roq","nsv","f4v","f4p","f4a","f4b"];function removeProtocol(i){return i.replace(/http(s)?:/,"")}function isElementInViewport(i){var e=i.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}function getShopifyImageUrl(i,e){if(!i||!(i!=null&&i.match(/cdn\.shopify\.com/))||!e)return i;if(e==="master")return removeProtocol(i);var o=i.match(/(_\d+x(\d+)?)?(\.(jpg|jpeg|gif|png|bmp|bitmap|tiff|tif)(\?v=\d+)?)/i);if(o){var s=i.split(o[0]),a=o[3],c=e.match("x")?e:"".concat(e,"x");return removeProtocol("".concat(s[0],"_").concat(c).concat(a))}return null}var DEFAULT_ASPECT_RATIO$1=.7041;function updateQueryParam(i,e,o){i===void 0&&(i="");var s=new RegExp("([?&])"+e+"=.*?(&|$)","i"),a=i.indexOf("?")!==-1?"&":"?";return i.match(s)?i.replace(s,"$1"+e+"="+encodeURIComponent(o)+"$2"):i+a+e+"="+encodeURIComponent(o)}function getSrcSet(i){if(!i)return i;var e=[100,200,400,800,1200,1600,2e3];if(i.match(/builder\.io/)){var o=i,s=Number(i.split("?width=")[1]);return isNaN(s)||(o="".concat(o," ").concat(s,"w")),e.filter(function(a){return a!==s}).map(function(a){return"".concat(updateQueryParam(i,"width",a)," ").concat(a,"w")}).concat([o]).join(", ")}return i.match(/cdn\.shopify\.com/)?e.map(function(a){return[getShopifyImageUrl(i,"".concat(a,"x").concat(a)),a]}).filter(function(a){return!!a[0]}).map(function(a){var c=a[0],d=a[1];return"".concat(c," ").concat(d,"w")}).concat([i]).join(", "):i}var getSizes=function(i,e,o){var s,a,c,d,h,g,_,j;o===void 0&&(o={});var b="";if(i){var $=i.split(","),nt=$.length;b=$.map(function(dt,ht){return nt===ht+1?dt.replace(/\([\s\S]*?\)/g,"").trim():dt}).join(", ")}else if(e&&e.responsiveStyles){var tt=[],it=!1,ot=/^\d+/,_e=getSizesForBreakpoints(o);if(!((c=(a=(s=e.responsiveStyles)===null||s===void 0?void 0:s.small)===null||a===void 0?void 0:a.width)===null||c===void 0)&&c.match(ot)){it=!0;var et="(max-width: ".concat(_e.small.max,"px)"),rt="".concat(et," ").concat(e.responsiveStyles.small.width.replace("%","vw"));tt.push(rt)}if(!((g=(h=(d=e.responsiveStyles)===null||d===void 0?void 0:d.medium)===null||h===void 0?void 0:h.width)===null||g===void 0)&&g.match(ot)&&(it=!0,et="(max-width: ".concat(_e.medium.max,"px)"),rt="".concat(et," ").concat(e.responsiveStyles.medium.width.replace("%","vw")),tt.push(rt)),!((j=(_=e.responsiveStyles)===null||_===void 0?void 0:_.large)===null||j===void 0)&&j.width){var st=e.responsiveStyles.large.width.replace("%","vw");tt.push(st)}else it&&tt.push("100vw");tt.length&&(b=tt.join(", "))}return b},ImageComponent=function(i){function e(){var o=i!==null&&i.apply(this,arguments)||this;return o.state={imageLoaded:!o.useLazyLoading,load:!o.useLazyLoading},o.pictureRef=null,o.scrollListener=null,o.intersectionObserver=null,o}return __extends(e,i),Object.defineProperty(e.prototype,"useLazyLoading",{get:function(){return!this.props.highPriority&&(!Builder.isBrowser||!location.search.includes("builder.lazyLoadImages=false"))&&(!(!Builder.isBrowser||!location.href.includes("builder.lazyLoadImages=true"))||this.props.lazy)},enumerable:!1,configurable:!0}),e.prototype.componentWillUnmount=function(){Builder.isBrowser&&(this.scrollListener&&(window.removeEventListener("scroll",this.scrollListener),this.scrollListener=null),this.intersectionObserver&&this.pictureRef&&this.intersectionObserver.unobserve(this.pictureRef))},e.prototype.componentDidMount=function(){var o=this;if(this.props.lazy&&Builder.isBrowser)if(this.pictureRef&&isElementInViewport(this.pictureRef))this.setState({load:!0});else if(typeof IntersectionObserver=="function"&&this.pictureRef)(this.intersectionObserver=new IntersectionObserver(function(a,c){a.forEach(function(d){d.intersectionRatio>0&&(o.setState({load:!0}),o.pictureRef&&c.unobserve(o.pictureRef))})})).observe(this.pictureRef);else{var s=throttle(function(a){if(o.pictureRef){var c=o.pictureRef.getBoundingClientRect(),d=window.innerHeight/2;c.top<window.innerHeight+d&&(o.setState(__assign(__assign({},o.state),{load:!0})),window.removeEventListener("scroll",s),o.scrollListener=null)}},400,{leading:!1,trailing:!0});this.scrollListener=s,window.addEventListener("scroll",s,{capture:!0,passive:!0}),s()}},Object.defineProperty(e.prototype,"image",{get:function(){return this.props.image||this.props.src},enumerable:!1,configurable:!0}),e.prototype.getSrcSet=function(){var o=this.image;if(o&&typeof o=="string"&&!this.props.noWebp&&(o.match(/builder\.io/)||o.match(/cdn\.shopify\.com/)))return getSrcSet(o)},e.prototype.render=function(){var o,s,a=this,c=this.props,d=c.aspectRatio,h=c.lazy,g=c.builderBlock,_=c.builderState,j=this.props.builderBlock&&this.props.builderBlock.children,b=this.props.srcset,$=getSizes(this.props.sizes,g,((s=(o=_==null?void 0:_.context.builderContent)===null||o===void 0?void 0:o.meta)===null||s===void 0?void 0:s.breakpoints)||{}),nt=this.image;b&&nt&&nt.includes("builder.io/api/v1/image")?b.includes(nt.split("?")[0])||(console.debug("Removed given srcset"),b=this.getSrcSet()):nt&&!b&&(b=this.getSrcSet());var tt=(g==null?void 0:g.id.startsWith("builder-pixel-"))||this.props.highPriority,it=this.props.fitContent;return jsx(BuilderMetaContext.Consumer,null,function(ot){var _e,et=ot.ampMode,rt=et?"amp-img":"img",st=(!h||a.state.load||et)&&jsx(rt,__assign({},et?{layout:"responsive",height:a.props.height||(d?Math.round(1e3*d):void 0),width:a.props.width||(d?Math.round(1e3/d):void 0)}:null,{alt:a.props.altText,title:a.props.title,key:Builder.isEditing&&typeof a.image=="string"&&a.image.split("?")[0]||void 0,role:a.props.altText?void 0:"presentation",css:__assign(__assign({opacity:et?1:a.useLazyLoading&&!a.state.imageLoaded?0:1,transition:"opacity 0.2s ease-in-out",objectFit:a.props.backgroundSize||"cover",objectPosition:a.props.backgroundPosition||"center"},d&&!et&&{position:"absolute",height:"100%",width:"100%",left:0,top:0}),et&&(_e={},_e["& img"]={objectFit:a.props.backgroundSize,objectPosition:a.props.backgroundPosition},_e)),loading:tt?"eager":"lazy",fetchPriority:tt?"high":"auto",className:"builder-image"+(a.props.className?" "+a.props.className:""),src:a.image},!et&&{onLoad:function(){return a.setState({imageLoaded:!0})}},{srcSet:b,sizes:!et&&$?$:void 0}));return jsx(React.Fragment,null,et?st:jsx("picture",{ref:function(dt){return a.pictureRef=dt}},b&&b.match(/builder\.io/)&&!a.props.noWebp&&jsx("source",{srcSet:b.replace(/\?/g,"?format=webp&"),type:"image/webp"}),st),!d||et||it&&j&&j.length?null:jsx("div",{className:"builder-image-sizer",css:{width:"100%",paddingTop:100*d+"%",pointerEvents:"none",fontSize:0}}," "),j&&j.length?it?j.map(function(dt,ht){return jsx(BuilderBlock$1,{key:dt.id,block:dt})}):jsx("div",{css:{display:"flex",flexDirection:"column",alignItems:"stretch",position:"absolute",top:0,left:0,width:"100%",height:"100%"}},j.map(function(dt,ht){return jsx(BuilderBlock$1,{key:dt.id,block:dt})})):null)})},e}(React.Component);withBuilder(ImageComponent,{name:"Image",static:!0,image:"https://firebasestorage.googleapis.com/v0/b/builder-3b0a2.appspot.com/o/images%2Fbaseline-insert_photo-24px.svg?alt=media&token=4e5d0ef4-f5e8-4e57-b3a9-38d63a9b9dc4",defaultStyles:{position:"relative",minHeight:"20px",minWidth:"20px",overflow:"hidden"},canHaveChildren:!0,inputs:[{name:"image",type:"file",bubble:!0,allowedFileTypes:IMAGE_FILE_TYPES,required:!0,defaultValue:"https://cdn.builder.io/api/v1/image/assets%2FYJIGb4i01jvw0SRdL5Bt%2F72c80f114dc149019051b6852a9e3b7a",onChange:function(i){i.delete("srcset"),i.delete("noWebp");var e,o,s=i.get("image"),a=i.get("aspectRatio");if(fetch(s).then(function(c){return c.blob()}).then(function(c){c.type.includes("svg")&&i.set("noWebp",!0)}),s&&(!a||a===.7041))return(e=s,o===void 0&&(o=6e4),new Promise(function(c,d){var h=document.createElement("img"),g=!1;h.onload=function(){g=!0,c(h)},h.addEventListener("error",function(_){console.warn("Image load failed",_.error),d(_.error)}),h.src=e,setTimeout(function(){g||d(new Error("Image load timed out"))},o)})).then(function(c){var d,h=i.get("aspectRatio");i.get("image")!==s||h&&h!==.7041||c.width&&c.height&&(i.set("aspectRatio",(d=c.height/c.width,Math.round(1e3*d)/1e3)),i.set("height",c.height),i.set("width",c.width))})}},{name:"backgroundSize",type:"text",defaultValue:"cover",enum:[{label:"contain",value:"contain",helperText:"The image should never get cropped"},{label:"cover",value:"cover",helperText:"The image should fill its box, cropping when needed"}]},{name:"backgroundPosition",type:"text",defaultValue:"center",enum:["center","top","left","right","bottom","top left","top right","bottom left","bottom right"]},{name:"altText",type:"string",helperText:"Text to display when the user has images off"},{name:"title",type:"string",helperText:"Text to display when hovering over the asset"},{name:"highPriority",type:"boolean",advanced:!0,helperText:"Mark this image as high priority compared to other images on the page. This prevents lazy loading of the image and tells the browser to load this image before others on the page."},{name:"height",type:"number",hideFromUI:!0},{name:"width",type:"number",hideFromUI:!0},{name:"sizes",type:"string",hideFromUI:!0},{name:"srcset",type:"string",hideFromUI:!0},{name:"lazy",type:"boolean",defaultValue:!0,hideFromUI:!0},{name:"fitContent",type:"boolean",helperText:"When child blocks are provided, fit to them instead of using the image's aspect ratio",defaultValue:!0},{name:"aspectRatio",type:"number",helperText:"This is the ratio of height/width, e.g. set to 1.5 for a 300px wide and 200px tall photo. Set to 0 to not force the image to maintain it's aspect ratio",advanced:!0,defaultValue:DEFAULT_ASPECT_RATIO$1}]});var DEFAULT_ASPECT_RATIO=.7004048582995948,VideoComponent=function(i){function e(){var o=i!==null&&i.apply(this,arguments)||this;return o.video=null,o.containerRef=null,o.lazyVideoObserver=null,o.state={load:!o.lazyLoad},o}return __extends(e,i),Object.defineProperty(e.prototype,"lazyLoad",{get:function(){return this.props.lazyLoad!==!1},enumerable:!1,configurable:!0}),e.prototype.updateVideo=function(){var o=this,s=this.video;s&&["muted","playsInline","autoPlay"].forEach(function(a){var c=a.toLowerCase();o.props[a]?s.setAttribute(c,c):s.removeAttribute(c)})},e.prototype.componentDidUpdate=function(){this.updateVideo()},e.prototype.componentDidMount=function(){var o=this;if(this.updateVideo(),this.lazyLoad&&Builder.isBrowser){var s=new IntersectionObserver(function(a){a.forEach(function(c){c.isIntersecting&&(o.setState(function(d){return __assign(__assign({},d),{load:!0})}),o.lazyVideoObserver&&(o.lazyVideoObserver.disconnect(),o.lazyVideoObserver=null))})});this.containerRef&&(s.observe(this.containerRef),this.lazyVideoObserver=s)}},e.prototype.componentWillUnmount=function(){this.lazyVideoObserver&&(this.lazyVideoObserver.disconnect(),this.lazyVideoObserver=null)},e.prototype.render=function(){var o=this,s=this.props,a=s.aspectRatio,c=s.children;return jsx("div",{ref:function(d){return o.containerRef=d},css:{position:"relative"}},jsx("video",{key:this.props.video||"no-src",poster:this.props.posterImage,ref:function(d){return o.video=d},autoPlay:this.props.autoPlay,muted:this.props.muted,controls:this.props.controls,loop:this.props.loop,preload:this.props.preload||"metadata",className:"builder-video",css:__assign({width:"100%",height:"100%",objectFit:this.props.fit,objectPosition:this.props.position,borderRadius:1},a?{position:"absolute"}:null)},(!this.lazyLoad||this.state.load)&&jsx("source",{type:"video/mp4",src:this.props.video})),!a||this.props.fitContent&&c?null:jsx("div",{css:{width:"100%",paddingTop:100*a+"%",pointerEvents:"none",fontSize:0}}),c&&this.props.fitContent?jsx("div",{css:{display:"flex",flexDirection:"column",alignItems:"stretch"}},c):c?jsx("div",{css:{pointerEvents:"none",display:"flex",flexDirection:"column",alignItems:"stretch",position:"absolute",top:0,left:0,width:"100%",height:"100%"}},c):null)},e}(React.Component);Builder.registerComponent(withChildren(VideoComponent),{name:"Video",canHaveChildren:!0,defaultStyles:{minHeight:"20px",minWidth:"20px"},image:"https://firebasestorage.googleapis.com/v0/b/builder-3b0a2.appspot.com/o/images%2Fbaseline-videocam-24px%20(1).svg?alt=media&token=49a84e4a-b20e-4977-a650-047f986874bb",inputs:[{name:"video",type:"file",allowedFileTypes:VIDEO_FILE_TYPES,bubble:!0,defaultValue:"https://cdn.builder.io/o/assets%2FYJIGb4i01jvw0SRdL5Bt%2Fd27731a526464deba0016216f5f9e570%2Fcompressed?apiKey=YJIGb4i01jvw0SRdL5Bt&token=d27731a526464deba0016216f5f9e570&alt=media&optimized=true",required:!0},{name:"posterImage",type:"file",allowedFileTypes:IMAGE_FILE_TYPES,helperText:"Image to show before the video plays"},{name:"autoPlay",type:"boolean",defaultValue:!0},{name:"controls",type:"boolean",defaultValue:!1},{name:"muted",type:"boolean",defaultValue:!0},{name:"loop",type:"boolean",defaultValue:!0},{name:"playsInline",type:"boolean",defaultValue:!0},{name:"fit",type:"text",defaultValue:"cover",enum:["contain","cover","fill","auto"]},{name:"preload",type:"text",defaultValue:"metadata",enum:["auto","metadata","none"]},{name:"fitContent",type:"boolean",helperText:"When child blocks are provided, fit to them instead of using the aspect ratio",defaultValue:!0,advanced:!0},{name:"position",type:"text",defaultValue:"center",enum:["center","top","left","right","bottom","top left","top right","bottom left","bottom right"]},{name:"height",type:"number",advanced:!0},{name:"width",type:"number",advanced:!0},{name:"aspectRatio",type:"number",advanced:!0,defaultValue:DEFAULT_ASPECT_RATIO},{name:"lazyLoad",type:"boolean",helperText:'Load this video "lazily" - as in only when a user scrolls near the video. Recommended for optmized performance and bandwidth consumption',defaultValue:!0,advanced:!0}]});var size=function(i){return Object.keys(i).length},isShopify=Builder.isBrowser&&"Shopify"in window,refs={};if(Builder.isBrowser)try{Array.from(document.querySelectorAll("[builder-static-symbol]")).forEach(function(i){var e=i.getAttribute("builder-static-symbol");e&&(refs[e]=i)})}catch(i){console.error("Builder replace nodes error:",i)}var SymbolComponent=function(i){function e(){var o=i!==null&&i.apply(this,arguments)||this;return o.ref=null,o.staticRef=null,o.isEditingThisSymbol=!1,o}return __extends(e,i),Object.defineProperty(e.prototype,"placeholder",{get:function(){return jsx("div",{css:{padding:10}},"Symbols let you reuse dynamic elements across your content. Please choose a model and entry for this symbol.")},enumerable:!1,configurable:!0}),e.prototype.componentDidMount=function(){var o,s,a,c=this;this.useStatic&&this.staticRef&&refs[(o=this.props.builderBlock)===null||o===void 0?void 0:o.id]&&((s=this.staticRef.parentNode)===null||s===void 0||s.replaceChild(refs[(a=this.props.builderBlock)===null||a===void 0?void 0:a.id],this.staticRef)),Builder.nextTick(function(){var d=c.props.symbol||{},h=d.model,g=d.entry;c.isEditingThisSymbol=!!(Builder.isEditing&&h===builder.editingModel&&g&&location.search.includes("overrides.".concat(g)))})},Object.defineProperty(e.prototype,"useStatic",{get:function(){var o;return!!(Builder.isBrowser&&refs[(o=this.props.builderBlock)===null||o===void 0?void 0:o.id]&&!(Builder.isEditing||Builder.isPreviewing))},enumerable:!1,configurable:!0}),e.prototype.render=function(){var o,s,a=this;if(this.useStatic)return jsx("div",{ref:function(rt){return a.staticRef=rt}});var c=this.props.symbol,d=!1;c||(d=!0);var h=this.props.dataOnly?NoWrap:this.props.builderBlock&&this.props.builderBlock.tagName||"div",g=c||{},_=g.model,j=g.entry,b=g.data,$=g.content,nt=g.inline,tt=g.ownerId,it=(c==null?void 0:c.dynamic)||this.props.dynamic;_&&(j||it)||!((o=$==null?void 0:$.data)===null||o===void 0)&&o.blocksJs||nt||(d=!0),this.isEditingThisSymbol&&(d=!1);var ot=it?(s=this.props.builderBlock)===null||s===void 0?void 0:s.id:[_,j].join(":"),_e=b&&size(b)&&hash(b);ot&&_e&&_e.length<300&&(ot+=":"+_e);var et=this.props.attributes||{};return jsx(BuilderStoreContext.Consumer,{key:(_||"no model")+":"+(j||"no entry"+this.isEditingThisSymbol)},function(rt){var st,dt,ht,mt,ft,bt,vt,Et,It,Rt,Dt,Ft="".concat(ot,"_").concat(((st=rt==null?void 0:rt.state)===null||st===void 0?void 0:st.locale)||"Default");return jsx(h,__assign({"data-model":_},et,{className:(et.class||et.className||"")+" builder-symbol"+(c!=null&&c.inline?" builder-inline-symbol":"")+(c!=null&&c.dynamic||a.props.dynamic?" builder-dynamic-symbol":"")}),d?a.placeholder:jsx(BuilderComponent,__assign({},tt&&{apiKey:tt},((dt=rt.state)===null||dt===void 0?void 0:dt.locale)&&{locale:rt.state.locale},{isChild:!0,ref:function(Gt){return a.ref=Gt},context:__assign(__assign({},rt.context),{symbolId:(ht=a.props.builderBlock)===null||ht===void 0?void 0:ht.id}),model:_,entry:j,data:__assign(__assign(__assign({},b),!!a.props.inheritState&&omit$2(rt.state,"children")),(It=(Et=(vt=(bt=(ft=(mt=a.props.builderBlock)===null||mt===void 0?void 0:mt.component)===null||ft===void 0?void 0:ft.options)===null||bt===void 0?void 0:bt.symbol)===null||vt===void 0?void 0:vt.content)===null||Et===void 0?void 0:Et.data)===null||It===void 0?void 0:It.state),renderLink:rt.renderLink,inlineContent:c==null?void 0:c.inline},$&&{content:$},{key:Ft,options:__assign(__assign({},!a.isEditingThisSymbol&&{key:Ft,noEditorUpdates:!0}),Builder.singletonInstance.apiEndpoint==="content"&&j&&{query:{id:j}}),codegen:!!(!((Rt=$==null?void 0:$.data)===null||Rt===void 0)&&Rt.blocksJs),hydrate:(Dt=rt.state)===null||Dt===void 0?void 0:Dt._hydrate,builderBlock:a.props.builderBlock,dataOnly:a.props.dataOnly}),a.props.children))})},e}(React.Component);withBuilder(SymbolComponent,{name:"Symbol",noWrap:!0,static:!0,inputs:[{name:"symbol",type:"uiSymbol"},{name:"dataOnly",helperText:"Make this a data symbol that doesn't display any UI",type:"boolean",defaultValue:!1,advanced:!0,hideFromUI:!0},{name:"inheritState",helperText:"Inherit the parent component state and data",type:"boolean",defaultValue:isShopify,advanced:!0},{name:"renderToLiquid",helperText:"Render this symbols contents to liquid. Turn off to fetch with javascript and use custom targeting",type:"boolean",defaultValue:isShopify,advanced:!0,hideFromUI:!0},{name:"useChildren",hideFromUI:!0,type:"boolean"}]});var ButtonComponent=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return __extends(e,i),e.prototype.render=function(){var o=this.props.link?Link:"span";return React.createElement(o,__assign({role:"button",href:this.props.link,target:this.props.openLinkInNewTab?"_blank":void 0},this.props.attributes),this.props.text)},e}(React.Component);withBuilder(ButtonComponent,{name:"Core:Button",image:"https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2F81a15681c3e74df09677dfc57a615b13",defaultStyles:{appearance:"none",paddingTop:"15px",paddingBottom:"15px",paddingLeft:"25px",paddingRight:"25px",backgroundColor:"#000000",color:"white",borderRadius:"4px",textAlign:"center",cursor:"pointer"},inputs:[{name:"text",type:"text",defaultValue:"Click me!",bubble:!0},{name:"link",type:"url",bubble:!0},{name:"openLinkInNewTab",type:"boolean",defaultValue:!1,friendlyName:"Open link in new tab"}],static:!0,noWrap:!0});var SectionComponent=function(i){function e(){var o=i!==null&&i.apply(this,arguments)||this;return o.ref=null,o.unmountCallbacks=[],o.state={inView:!1},o}return __extends(e,i),Object.defineProperty(e.prototype,"renderContents",{get:function(){return this.props.lazyLoad!==!0||this.state.inView},enumerable:!1,configurable:!0}),e.prototype.componentWillUnmount=function(){this.unmountCallbacks.forEach(function(o){return o()})},e.prototype.componentDidMount=function(){var o=this;if(this.props.lazyLoad)if(typeof IntersectionObserver<"u"&&this.ref){var s=new IntersectionObserver(function(a,c){a.forEach(function(d){d.intersectionRatio>0&&(o.setState({inView:!0}),o.ref&&c.unobserve(o.ref))})},{rootMargin:"10px"});s.observe(this.ref),this.unmountCallbacks.push(function(){o.ref&&s.unobserve(o.ref)})}else this.setState({inView:!0})},e.prototype.render=function(){var o=this;return jsx("section",{ref:function(s){return o.ref=s},css:__assign({width:"100%",alignSelf:"stretch",flexGrow:1,boxSizing:"border-box",maxWidth:this.props.maxWidth,display:"flex",flexDirection:"column",alignItems:"stretch",marginLeft:"auto",marginRight:"auto"},this.renderContents?null:this.props.lazyStyles)},this.renderContents?jsx(React.Fragment,null,this.props.children,this.props.builderBlock&&this.props.builderBlock.children&&this.props.builderBlock.children.map(function(s,a){return jsx(BuilderBlock$1,{key:s.id,block:s})})):null)},e}(React.Component);withBuilder(SectionComponent,{name:"Core:Section",static:!0,image:"https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2F682efef23ace49afac61748dd305c70a",inputs:[{name:"maxWidth",type:"number",defaultValue:1200},{name:"lazyLoad",type:"boolean",defaultValue:!1,advanced:!0,description:"Only render this section when in view"}],defaultStyles:{paddingLeft:"20px",paddingRight:"20px",paddingTop:"50px",paddingBottom:"50px",marginTop:"0px",width:"100vw",marginLeft:"calc(50% - 50vw)"},canHaveChildren:!0,defaultChildren:[{"@type":"@builder.io/sdk:Element",responsiveStyles:{large:{textAlign:"center"}},component:{name:"Text",options:{text:"<p><b>I am a section! My content keeps from getting too wide, so that it's easy to read even on big screens.</b></p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur</p>"}}}]});var StateProviderComponent=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return __extends(e,i),e.prototype.render=function(){var o=this;return React.createElement(BuilderStoreContext.Consumer,null,function(s){return React.createElement(BuilderStoreContext.Provider,{value:__assign(__assign({},s),{state:__assign(__assign({},s.state),o.props.state),context:__assign(__assign({},s.context),o.props.context)})},o.props.builderBlock&&o.props.builderBlock.children&&o.props.builderBlock.children.map(function(a,c){return React.createElement(BuilderBlock$1,{block:a,key:a.id,index:c,child:!0})}),o.props.children)})},e}(React.Component);withBuilder(StateProviderComponent,{name:"Builder:StateProvider",canHaveChildren:!0,static:!0,noWrap:!0,hideFromInsertMenu:!0});var prefetched=new Set;function searchToObject(i){var e=(i.search||"").substring(1).split("&"),o={};for(var s in e)if(e[s]&&typeof e[s]=="string"){var a=e[s].split("=");o[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return o}var RouterComponent=function(i){function e(){var o=i!==null&&i.apply(this,arguments)||this;return o.builder=builder,o.routed=!1,o.preloadQueue=0,o.onPopState=function(s){o.updateLocationState()},o.onMouseOverOrTouchStart=function(s){if(!(o.preloadQueue>4)&&o.props.preloadOnHover!==!1){var a=o.findHrefTarget(s);if(a){var c=a.getAttribute("href");if(c){if(!o.isRelative(c)){var d=o.convertToRelative(c);if(!d)return;c=d}if(!c.startsWith("#")&&!prefetched.has(c)){prefetched.add(c);var h=o.parseUrl(c);o.preloadQueue++;var g=builder.getUserAttributes();g.urlPath=h.pathname,g.queryString=h.search;var _=builder.get(o.model,{userAttributes:g,key:o.model+":"+h.pathname+h.search}).subscribe(function(){o.preloadQueue--,_.unsubscribe()})}}}}},o.onClick=function(s){return __awaiter(o,void 0,void 0,function(){var a,c,d,h;return __generator(this,function(g){if(this.props.handleRouting===!1)return[2];if(s.button!==0||s.ctrlKey||s.defaultPrevented||s.metaKey)return[2];if(!(a=this.findHrefTarget(s)))return[2];if(a.target&&a.target!=="_client")return[2];if(!(c=a.getAttribute("href")))return[2];if(this.props.onRoute&&(d={url:c,anchorNode:a,preventDefault:function(){this.defaultPrevented=!0},defaultPrevented:!1},this.props.onRoute(d),d.defaultPrevented))return[2];if(!this.isRelative(c)){if(!(h=this.convertToRelative(c)))return[2];c=h}return c.startsWith("#")||(s.preventDefault(),this.route(c)),[2]})})},o.privateState=null,o}return __extends(e,i),e.prototype.route=function(o){var s;return this.routed=!0,typeof((s=window.history)===null||s===void 0?void 0:s.pushState)=="function"?(history.pushState(null,"",o),this.updateLocationState(),!0):(location.href=o,!1)},e.prototype.updateLocationState=function(){this.privateState&&this.privateState.update(function(o){o.location=__assign(__assign({},o.location),{pathname:location.pathname,search:location.search,path:location.pathname.split("/").slice(1),query:searchToObject(location)})})},Object.defineProperty(e.prototype,"model",{get:function(){return this.props.model||"page"},enumerable:!1,configurable:!0}),e.prototype.componentDidMount=function(){typeof document<"u"&&(document.addEventListener("click",this.onClick),window.addEventListener("popstate",this.onPopState),document.addEventListener("mouseover",this.onMouseOverOrTouchStart),document.addEventListener("touchstart",this.onMouseOverOrTouchStart))},e.prototype.componentWillUnmount=function(){typeof document<"u"&&(document.removeEventListener("click",this.onClick),document.removeEventListener("mouseover",this.onMouseOverOrTouchStart),window.removeEventListener("popstate",this.onPopState),document.removeEventListener("touchstart",this.onMouseOverOrTouchStart))},e.prototype.render=function(){var o=this,s=this.model;return jsx(BuilderStoreContext.Consumer,null,function(a){o.privateState=a;var c=a.state&&a.state.location&&a.state.location.pathname+a.state.location.search;return jsx("div",{className:"builder-router","data-model":s},jsx("style",null,`
                @keyframes builderLoadingSpinner {
                  0% {
                    transform: rotate(0deg);
                  }
                  100% {
                    transform: rotate(360deg);
                  }
                }
                /* TODO: overridable tag */
                .builder-page-loading {
                  -webkit-animation: builderLoadingSpinner 1s infinite linear;
                  animation: builderLoadingSpinner 1s infinite linear;
                  -webkit-transform: translateZ(0);
                  transform: translateZ(0);
                  border-radius: 50%;
                  width: 36px;
                  height: 36px;
                  margin: 6px auto;
                  position: relative;
                  border: 1px solid transparent;
                  border-left: 1px solid #808284;
                }
              `),jsx(BuilderComponent,{key:c,data:o.props.data,content:o.routed?void 0:o.props.content,modelName:s,options:{key:Builder.isEditing?void 0:o.model+":"+c}},o.props.children||jsx("div",{css:{display:"flex"}},jsx("div",{css:{margin:"40vh auto"},className:"builder-page-loading"}))))})},e.prototype.findHrefTarget=function(o){for(var s=o.target;s;){if(s instanceof HTMLAnchorElement&&s.getAttribute("href"))return s;if(s===o.currentTarget)break;s=s.parentElement}return null},e.prototype.isRelative=function(o){return!o.match(/^(\/\/|https?:\/\/)/i)},e.prototype.parseUrl=function(o){var s=document.createElement("a");return s.href=o,s},e.prototype.convertToRelative=function(o){var s=this.parseUrl(location.href),a=this.parseUrl(o);if(s.host===a.host){var c=a.pathname+(a.search?a.search:"");return c.startsWith("#")?null:c||"/"}return null},e}(React.Component);withBuilder(RouterComponent,{name:"Core:Router",hideFromInsertMenu:!0,inputs:[{name:"model",type:"string",defaultValue:"page",advanced:!0},{name:"handleRouting",type:"boolean",defaultValue:!0,advanced:!0},{name:"preloadOnHover",type:"boolean",defaultValue:!0,advanced:!0},{name:"onRoute",type:"function",advanced:!0}]});function Mutation(i){var e,o,s=React.useRef(null);useWaitForSelector(i.selector,function(c){i.type!=="afterEnd"&&(c.innerHTML=""),c.appendChild(s.current.firstElementChild)});var a=(e=i.builderBlock)===null||e===void 0?void 0:e.children;return jsx("span",{style:{display:"none"},ref:s},jsx(BuilderBlocks,{style:{display:"inline"},child:!0,parentElementId:(o=i.builderBlock)===null||o===void 0?void 0:o.id,dataPath:"this.children",blocks:a}))}function useWaitForSelector(i,e){React.useLayoutEffect(function(){try{var o=document.querySelector(i);if(o)return void e(o)}catch(a){console.warn(a)}var s=new MutationObserver(function(){try{var a=document.querySelector(i);a&&(s.disconnect(),e(a))}catch(c){console.warn(c)}});return s.observe(document.body,{attributes:!0,subtree:!0,characterData:!0}),function(){s.disconnect()}},[i])}Builder.registerComponent(Mutation,{name:"Builder:Mutation",canHaveChildren:!0,noWrap:!0,hideFromInsertMenu:!0,inputs:[{name:"type",type:"string",defaultValue:"replace",enum:[{label:"Replace",value:"replace",helperText:"Replace the contents of this site region with content from Builder"},{label:"Append",value:"afterEnd",helperText:"Append Builder content after the chosen site region"}]},{name:"selector",type:"builder:domSelector"}]});var get=function(i,e,o){var s=String.prototype.split.call(e,/[,[\].]+?/).filter(Boolean).reduce(function(a,c){return a!=null?a[c]:a},i);return s===void 0||s===i?o:s},MULTIPART_CONTENT_TYPE="multipart/form-data",JSON_CONTENT_TYPE="application/json",ENCODED_CONTENT_TYPE="application/x-www-form-urlencoded",FormComponent=function(i){function e(){var o=i!==null&&i.apply(this,arguments)||this;return o.ref=null,o.state={state:"unsubmitted",responseData:null,formErrorMessage:""},o}return __extends(e,i),Object.defineProperty(e.prototype,"submissionState",{get:function(){return Builder.isEditing&&this.props.previewState||this.state.state},enumerable:!1,configurable:!0}),e.prototype.render=function(){var o=this;return jsx(BuilderStoreContext.Consumer,null,function(s){return jsx(BuilderStoreContext.Provider,{value:__assign(__assign({},s),{state:__assign(__assign({},s.state),{formErrorMessage:o.state.formErrorMessage})})},jsx("form",__assign({},o.props.validate?{}:{noValidate:!0},{ref:function(a){return o.ref=a},action:!o.props.sendWithJs&&o.props.action?o.props.action:void 0,method:o.props.method,name:o.props.name,onSubmit:function(a){var c,d=o.props.sendWithJs||o.props.sendSubmissionsTo==="email";if(o.props.sendSubmissionsTo==="zapier")a.preventDefault();else if(d){if(!o.props.action&&o.props.sendSubmissionsTo!=="email")return void a.preventDefault();a.preventDefault();var h=a.currentTarget,g=o.props.customHeaders||{},_=void 0,j=new FormData(h),b=Array.from(a.currentTarget.querySelectorAll("input,select,textarea")).filter(function(ot){return!!ot.name}).map(function(ot){var _e,et=ot.name;if(ot instanceof HTMLInputElement)if(ot.type==="radio"){if(ot.checked)return{key:et,value:_e=ot.name}}else if(ot.type==="checkbox")_e=ot.checked;else if(ot.type==="number"||ot.type==="range"){var rt=ot.valueAsNumber;isNaN(rt)||(_e=rt)}else _e=ot.type==="file"?ot.files:ot.value;else _e=ot.value;return{key:et,value:_e}}),$=o.props.contentType;if(o.props.sendSubmissionsTo==="email"&&($=MULTIPART_CONTENT_TYPE),Array.from(b).forEach(function(ot){var _e=ot.value;(_e instanceof File||Array.isArray(_e)&&_e[0]instanceof File||_e instanceof FileList)&&($=MULTIPART_CONTENT_TYPE)}),$===MULTIPART_CONTENT_TYPE)_=j;else if($===JSON_CONTENT_TYPE){var nt={};Array.from(b).forEach(function(ot){var _e=ot.value,et=ot.key;set(nt,et,_e)}),_=JSON.stringify(nt)}else{if($!==ENCODED_CONTENT_TYPE)return void console.error("Unsupported content type: ",$);_=Array.from(b).map(function(ot){var _e=ot.value,et=ot.key;return encodeURIComponent(et)+"="+encodeURIComponent(_e)}).join("&")}$&&$!==MULTIPART_CONTENT_TYPE&&(d&&(!((c=o.props.action)===null||c===void 0)&&c.includes("zapier.com"))||(g["content-type"]=$));var tt=new CustomEvent("presubmit",{detail:{body:_}});if(o.ref&&(o.ref.dispatchEvent(tt),tt.defaultPrevented))return;o.setState(__assign(__assign({},o.state),{state:"sending"}));var it="".concat(builder.env==="dev"?"http://localhost:5000":"https://builder.io","/api/v1/form-submit?apiKey=").concat(builder.apiKey,"&to=").concat(btoa(o.props.sendSubmissionsToEmail||""),"&name=").concat(encodeURIComponent(o.props.name||""));fetch(o.props.sendSubmissionsTo==="email"?it:o.props.action,{body:_,headers:g,method:o.props.method||"post"}).then(function(ot){return __awaiter(o,void 0,void 0,function(){var _e,et,rt,st,dt;return __generator(this,function(ht){switch(ht.label){case 0:return(et=ot.headers.get("content-type"))&&et.indexOf(JSON_CONTENT_TYPE)!==-1?[4,ot.json()]:[3,2];case 1:return _e=ht.sent(),[3,4];case 2:return[4,ot.text()];case 3:_e=ht.sent(),ht.label=4;case 4:if(!ot.ok&&this.props.errorMessagePath&&(rt=get(_e,this.props.errorMessagePath))&&(typeof rt!="string"&&(rt=JSON.stringify(rt)),this.setState(__assign(__assign({},this.state),{formErrorMessage:rt}))),this.setState(__assign(__assign({},this.state),{responseData:_e,state:ot.ok?"success":"error"})),ot.ok){if(st=new CustomEvent("submit:success",{detail:{res:ot,body:_e}}),this.ref){if(this.ref.dispatchEvent(st),st.defaultPrevented)return[2];this.props.resetFormOnSubmit!==!1&&this.ref.reset()}this.props.successUrl&&(this.ref?(dt=new CustomEvent("route",{detail:{url:this.props.successUrl}}),this.ref.dispatchEvent(dt),dt.defaultPrevented||(location.href=this.props.successUrl)):location.href=this.props.successUrl)}return[2]}})})},function(ot){var _e=new CustomEvent("submit:error",{detail:{error:ot}});o.ref&&(o.ref.dispatchEvent(_e),_e.defaultPrevented)||o.setState(__assign(__assign({},o.state),{responseData:ot,state:"error"}))})}}},o.props.attributes),o.props.builderBlock&&o.props.builderBlock.children&&o.props.builderBlock.children.map(function(a,c){return jsx(BuilderBlock$1,{key:a.id,block:a})}),o.submissionState==="error"&&jsx(BuilderBlocks,{dataPath:"errorMessage",blocks:o.props.errorMessage}),o.submissionState==="sending"&&jsx(BuilderBlocks,{dataPath:"sendingMessage",blocks:o.props.sendingMessage}),o.submissionState==="error"&&o.state.responseData&&jsx("pre",{className:"builder-form-error-text",css:{padding:10,color:"red",textAlign:"center"}},JSON.stringify(o.state.responseData,null,2)),o.submissionState==="success"&&jsx(BuilderBlocks,{dataPath:"successMessage",blocks:o.props.successMessage})))})},e}(React.Component);withBuilder(FormComponent,{name:"Form:Form",defaults:{responsiveStyles:{large:{marginTop:"15px",paddingBottom:"15px"}}},image:"https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2Fef36d2a846134910b64b88e6d18c5ca5",inputs:[{name:"sendSubmissionsTo",type:"string",enum:[{label:"Send to email",value:"email",helperText:"Send form submissions to the email address of your choosing"},{label:"Custom",value:"custom",helperText:"Handle where the form requests go manually with a little code, e.g. to your own custom backend"}],defaultValue:"email"},{name:"sendSubmissionsToEmail",type:"string",required:!0,defaultValue:"your@email.com",showIf:'options.get("sendSubmissionsTo") === "email"'},{name:"sendWithJs",type:"boolean",helperText:"Set to false to use basic html form action",defaultValue:!0,showIf:'options.get("sendSubmissionsTo") === "custom"'},{name:"name",type:"string",defaultValue:"My form"},{name:"action",type:"string",helperText:"URL to send the form data to",showIf:'options.get("sendSubmissionsTo") === "custom"'},{name:"contentType",type:"string",defaultValue:JSON_CONTENT_TYPE,advanced:!0,enum:[JSON_CONTENT_TYPE,MULTIPART_CONTENT_TYPE,ENCODED_CONTENT_TYPE],showIf:'options.get("sendSubmissionsTo") === "custom" && options.get("sendWithJs") === true'},{name:"method",type:"string",showIf:'options.get("sendSubmissionsTo") === "custom"',defaultValue:"POST",advanced:!0},{name:"previewState",type:"string",enum:["unsubmitted","sending","success","error"],defaultValue:"unsubmitted",helperText:'Choose a state to edit, e.g. choose "success" to show what users see on success and edit the message',showIf:'options.get("sendSubmissionsTo") !== "zapier" && options.get("sendWithJs") === true'},{name:"successUrl",type:"url",helperText:"Optional URL to redirect the user to on form submission success",showIf:'options.get("sendSubmissionsTo") !== "zapier" && options.get("sendWithJs") === true'},{name:"resetFormOnSubmit",type:"boolean",showIf:function(i){return i.get("sendSubmissionsTo")==="custom"&&i.get("sendWithJs")===!0},advanced:!0},{name:"successMessage",type:"uiBlocks",hideFromUI:!0,defaultValue:[{"@type":"@builder.io/sdk:Element",responsiveStyles:{large:{marginTop:"10px"}},component:{name:"Text",options:{text:"<span>Thanks!</span>"}}}]},{name:"validate",type:"boolean",defaultValue:!0,advanced:!0},{name:"errorMessagePath",type:"text",advanced:!0,helperText:'Path to where to get the error message from in a JSON response to display to the user, e.g. "error.message" for a response like { "error": { "message": "this username is taken" }}'},{name:"errorMessage",type:"uiBlocks",hideFromUI:!0,defaultValue:[{"@type":"@builder.io/sdk:Element",responsiveStyles:{large:{marginTop:"10px"}},bindings:{"component.options.text":"state.formErrorMessage || block.component.options.text"},component:{name:"Text",options:{text:"<span>Form submission error :( Please check your answers and try again</span>"}}}]},{name:"sendingMessage",type:"uiBlocks",hideFromUI:!0,defaultValue:[{"@type":"@builder.io/sdk:Element",responsiveStyles:{large:{marginTop:"10px"}},component:{name:"Text",options:{text:"<span>Sending...</span>"}}}]},__assign(__assign({name:"customHeaders",type:"map"},{valueType:{type:"string"}}),{advanced:!0,showIf:'options.get("sendSubmissionsTo") === "custom" && options.get("sendWithJs") === true'})],noWrap:!0,canHaveChildren:!0,defaultChildren:[{"@type":"@builder.io/sdk:Element",responsiveStyles:{large:{marginTop:"10px"}},component:{name:"Text",options:{text:"<span>Enter your name</span>"}}},{"@type":"@builder.io/sdk:Element",responsiveStyles:{large:{marginTop:"10px"}},component:{name:"Form:Input",options:{name:"name",placeholder:"Jane Doe"}}},{"@type":"@builder.io/sdk:Element",responsiveStyles:{large:{marginTop:"10px"}},component:{name:"Text",options:{text:"<span>Enter your email</span>"}}},{"@type":"@builder.io/sdk:Element",responsiveStyles:{large:{marginTop:"10px"}},component:{name:"Form:Input",options:{name:"email",placeholder:"jane@doe.com"}}},{"@type":"@builder.io/sdk:Element",responsiveStyles:{large:{marginTop:"10px"}},component:{name:"Form:SubmitButton",options:{text:"Submit"}}}]});var FormInputComponent=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return __extends(e,i),e.prototype.render=function(){return React.createElement("input",__assign({key:Builder.isEditing&&this.props.defaultValue?this.props.defaultValue:"default-key",placeholder:this.props.placeholder,type:this.props.type,name:this.props.name},this.props.value===void 0?{defaultValue:this.props.defaultValue}:{value:this.props.value},{required:this.props.required},this.props.attributes))},e}(React.Component);withBuilder(FormInputComponent,{name:"Form:Input",image:"https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2Fad6f37889d9e40bbbbc72cdb5875d6ca",inputs:[{name:"type",type:"text",enum:["text","number","email","url","checkbox","radio","range","date","datetime-local","search","tel","time","file","month","week","password","color","hidden"],defaultValue:"text"},{name:"name",type:"string",required:!0,helperText:'Every input in a form needs a unique name describing what it takes, e.g. "email"'},{name:"placeholder",type:"string",defaultValue:"Hello there",helperText:"Text to display when there is no value"},{name:"defaultValue",type:"string"},{name:"value",type:"string",advanced:!0},{name:"required",type:"boolean",helperText:"Is this input required to be filled out to submit a form",defaultValue:!1}],noWrap:!0,static:!0,defaultStyles:{paddingTop:"10px",paddingBottom:"10px",paddingLeft:"10px",paddingRight:"10px",borderRadius:"3px",borderWidth:"1px",borderStyle:"solid",borderColor:"#ccc"}});var FormSubmitButtonComponent=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return __extends(e,i),e.prototype.render=function(){return React.createElement("button",__assign({type:"submit"},this.props.attributes),this.props.text)},e}(React.Component);withBuilder(FormSubmitButtonComponent,{name:"Form:SubmitButton",image:"https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2Fdf2820ffed1f4349a94c40b3221f5b98",defaultStyles:{appearance:"none",paddingTop:"15px",paddingBottom:"15px",paddingLeft:"25px",paddingRight:"25px",backgroundColor:"#3898EC",color:"white",borderRadius:"4px",cursor:"pointer"},inputs:[{name:"text",type:"text",defaultValue:"Click me"}],static:!0,noWrap:!0});var LabelComponent=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return __extends(e,i),e.prototype.render=function(){return React.createElement("label",__assign({htmlFor:this.props.for},this.props.attributes),this.props.text&&React.createElement("span",{className:"builder-label-text",dangerouslySetInnerHTML:{__html:this.props.text}}),this.props.builderBlock&&this.props.builderBlock.children&&this.props.builderBlock.children.map(function(o){return React.createElement(BuilderBlock$1,{key:o.id,block:o})}))},e}(React.Component);withBuilder(LabelComponent,{name:"Form:Label",image:"https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2F9322342f04b545fb9a8091cd801dfb5b",inputs:[{name:"text",type:"html",richText:!0,defaultValue:"Label"},{name:"for",type:"text",helperText:"The name of the input this label is for",advanced:!0}],noWrap:!0,static:!0,canHaveChildren:!0});var FormSelectComponent=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return __extends(e,i),e.prototype.render=function(){var o=this.props.options;return React.createElement("select",__assign({value:this.props.value,key:Builder.isEditing&&this.props.defaultValue?this.props.defaultValue:"default-key",defaultValue:this.props.defaultValue,name:this.props.name,required:this.props.required},this.props.attributes),o&&o.map(function(s){return React.createElement("option",{value:s.value},s.name||s.value)}))},e}(React.Component);withBuilder(FormSelectComponent,{name:"Form:Select",image:"https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2F83acca093fb24aaf94dee136e9a4b045",defaultStyles:{alignSelf:"flex-start"},inputs:[{name:"options",type:"list",required:!0,subFields:[{name:"value",type:"text",required:!0},{name:"name",type:"text"}],defaultValue:[{value:"option 1"},{value:"option 2"}]},{name:"name",type:"string",required:!0,helperText:'Every select in a form needs a unique name describing what it gets, e.g. "email"'},{name:"defaultValue",type:"string"},{name:"value",type:"string",advanced:!0},{name:"required",type:"boolean",defaultValue:!1}],static:!0,noWrap:!0});var TextAreaComponent=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return __extends(e,i),e.prototype.render=function(){return React.createElement("textarea",__assign({placeholder:this.props.placeholder,name:this.props.name,value:this.props.value,defaultValue:this.props.defaultValue,required:this.props.required},this.props.attributes))},e}(React.Component);withBuilder(TextAreaComponent,{name:"Form:TextArea",image:"https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2Ff74a2f3de58c4c3e939204e5b6b8f6c3",inputs:[{advanced:!0,name:"value",type:"string"},{name:"name",type:"string",required:!0,helperText:'Every input in a form needs a unique name describing what it gets, e.g. "email"'},{name:"defaultValue",type:"string"},{name:"placeholder",type:"string",defaultValue:"Hello there"},{name:"required",type:"boolean",defaultValue:!1}],defaultStyles:{paddingTop:"10px",paddingBottom:"10px",paddingLeft:"10px",paddingRight:"10px",borderRadius:"3px",borderWidth:"1px",borderStyle:"solid",borderColor:"#ccc"},static:!0,noWrap:!0});var ImgComponent=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return __extends(e,i),e.prototype.getSrcSet=function(){var o=this.props.image;if(o&&typeof o=="string"&&o.match(/builder\.io/))return getSrcSet(o)},e.prototype.render=function(){var o=this.props.attributes||{},s=this.getSrcSet();return React.createElement("img",__assign({loading:"lazy"},this.props.attributes,{src:this.props.image||o.src,srcSet:s}))},e}(React.Component);withBuilder(ImgComponent,{name:"Raw:Img",hideFromInsertMenu:!0,image:"https://firebasestorage.googleapis.com/v0/b/builder-3b0a2.appspot.com/o/images%2Fbaseline-insert_photo-24px.svg?alt=media&token=4e5d0ef4-f5e8-4e57-b3a9-38d63a9b9dc4",inputs:[{name:"image",bubble:!0,type:"file",allowedFileTypes:IMAGE_FILE_TYPES,required:!0}],noWrap:!0,static:!0});var RawText=function(i){var e=i.attributes||{};return reactExports.createElement("span",{className:(e==null?void 0:e.class)||(e==null?void 0:e.className),dangerouslySetInnerHTML:{__html:i.text||""}})};Builder.registerComponent(RawText,{name:"Builder:RawText",hideFromInsertMenu:!0,inputs:[{name:"text",bubble:!0,type:"longText",required:!0}]});var filterWithCustomTargetingScript='function filterWithCustomTargeting(e,t,n,r){var i={query:t,startDate:n,endDate:r},o=e.date&&new Date(e.date)||new Date;return!(i.startDate&&new Date(i.startDate)>o)&&(!(i.endDate&&new Date(i.endDate)<o)&&(!i.query||!i.query.length||i.query.every((function(t){return objectMatchesQuery(e,t)}))))}function isString(e){return"string"==typeof e}function isNumber(e){return"number"==typeof e}function objectMatchesQuery(e,t){return function(){var n=t.property,r=t.operator,i=t.value;if(t&&"urlPath"===t.property&&t.value&&"string"==typeof t.value&&"/"!==t.value&&t.value.endsWith("/")&&(i=t.value.slice(0,-1)),!n||!r)return!0;if(Array.isArray(i))return"isNot"===r?i.every((function(t){return objectMatchesQuery(e,{property:n,operator:r,value:t})})):!!i.find((function(t){return objectMatchesQuery(e,{property:n,operator:r,value:t})}));var o=e[n];if(Array.isArray(o))return o.includes(i);switch(r){case"is":return o===i;case"isNot":return o!==i;case"contains":return(isString(o)||Array.isArray(o))&&o.includes(String(i));case"startsWith":return isString(o)&&o.startsWith(String(i));case"endsWith":return isString(o)&&o.endsWith(String(i));case"greaterThan":return isNumber(o)&&isNumber(i)&&o>i;case"lessThan":return isNumber(o)&&isNumber(i)&&o<i;case"greaterThanOrEqualTo":return isNumber(o)&&isNumber(i)&&o>=i;case"lessThanOrEqualTo":return isNumber(o)&&isNumber(i)&&o<=i}return!1}()}';function filterWithCustomTargeting(i,e,o,s){var a={query:e,startDate:o,endDate:s},c=i.date&&new Date(i.date)||new Date;return!(a.startDate&&new Date(a.startDate)>c)&&!(a.endDate&&new Date(a.endDate)<c)&&(!a.query||!a.query.length||a.query.every(function(d){return objectMatchesQuery(i,d)}))}function isString(i){return typeof i=="string"}function isNumber(i){return typeof i=="number"}function objectMatchesQuery(i,e){return function(){var o=e.property,s=e.operator,a=e.value;if(e&&e.property==="urlPath"&&e.value&&typeof e.value=="string"&&e.value!=="/"&&e.value.endsWith("/")&&(a=e.value.slice(0,-1)),!o||!s)return!0;if(Array.isArray(a))return s==="isNot"?a.every(function(d){return objectMatchesQuery(i,{property:o,operator:s,value:d})}):!!a.find(function(d){return objectMatchesQuery(i,{property:o,operator:s,value:d})});var c=i[o];if(Array.isArray(c))return c.includes(a);switch(s){case"is":return c===a;case"isNot":return c!==a;case"contains":return(isString(c)||Array.isArray(c))&&c.includes(String(a));case"startsWith":return isString(c)&&c.startsWith(String(a));case"endsWith":return isString(c)&&c.endsWith(String(a));case"greaterThan":return isNumber(c)&&isNumber(a)&&c>a;case"lessThan":return isNumber(c)&&isNumber(a)&&c<a;case"greaterThanOrEqualTo":return isNumber(c)&&isNumber(a)&&c>=a;case"lessThanOrEqualTo":return isNumber(c)&&isNumber(a)&&c<=a}return!1}()}function PersonalizationContainer(i){var e,o,s,a,c,d,h,g,_,j,b,$,nt,tt,it,ot,_e,et,rt,st,dt,ht=!!(Builder.isBrowser&&(!((e=window.__hydrated)===null||e===void 0)&&e[(o=i.builderBlock)===null||o===void 0?void 0:o.id])),mt=reactExports.useRef(null),ft=reactExports.useState(ht),bt=ft[0],vt=ft[1],Et=reactExports.useState(!1),It=Et[0],Rt=Et[1],Dt=reactExports.useState(0);Dt[0];var Ft=Dt[1],Gt=reactExports.useContext(BuilderStoreContext);if(reactExports.useEffect(function(){var St;vt(!0),Rt(!0);var xt=builder.userAttributesChanged.subscribe(function(){Ft(function(gt){return gt+1})}),$t=[function(){return xt.unsubscribe()}];if(!Builder.isEditing&&!Builder.isPreviewing){var _t=Ht[0];(St=mt.current)===null||St===void 0||St.dispatchEvent(new CustomEvent("builder.variantLoaded",{detail:{variant:_t||"default",content:Gt.content},bubbles:!0}));var ut=new IntersectionObserver(function(gt){gt.forEach(function(yt){var kt;yt.isIntersecting&&((kt=mt.current)===null||kt===void 0||kt.dispatchEvent(new CustomEvent("builder.variantDisplayed",{detail:{variant:_t||"default",content:Gt.content},bubbles:!0})))})});ut.observe(mt.current),$t.push(function(){return ut.disconnect()})}return function(){$t.forEach(function(gt){return gt()})}},[]),Builder.isServer)return React.createElement(React.Fragment,null,React.createElement("div",__assign({},i.attributes,{style:__assign({opacity:1,transition:"opacity 0.2s ease-in-out"},(s=i.attributes)===null||s===void 0?void 0:s.style),className:"builder-personalization-container ".concat(i.attributes.className)}),(a=i.variants)===null||a===void 0?void 0:a.map(function(St,xt){var $t,_t;return React.createElement("template",{key:xt,"data-variant-id":(($t=i.builderBlock)===null||$t===void 0?void 0:$t.id)+xt},React.createElement(BuilderBlocks,{blocks:St.blocks,parentElementId:(_t=i.builderBlock)===null||_t===void 0?void 0:_t.id,dataPath:"component.options.variants.".concat(xt,".blocks"),child:!0}))}),React.createElement("script",{id:"variants-script-".concat((c=i.builderBlock)===null||c===void 0?void 0:c.id),dangerouslySetInnerHTML:{__html:getPersonalizationScript(i.variants,((d=i.builderBlock)===null||d===void 0?void 0:d.id)||"none",(h=i.builderState.state)===null||h===void 0?void 0:h.locale)}}),React.createElement(BuilderBlocks,{blocks:(g=i.builderBlock)===null||g===void 0?void 0:g.children,parentElementId:(_=i.builderBlock)===null||_===void 0?void 0:_.id,dataPath:"this.children",child:!0})),React.createElement("script",{dangerouslySetInnerHTML:{__html:`
         window.__hydrated = window.__hydrated || {};
         window.__hydrated['`.concat((j=i.builderBlock)===null||j===void 0?void 0:j.id,`'] = true;
        `).replace(/\s+/g," ")}}));var Ht=(i.variants||[]).filter(function(St){var xt;return filterWithCustomTargeting(__assign(__assign({},!((xt=i.builderState.state)===null||xt===void 0)&&xt.locale?{locale:i.builderState.state.locale}:{}),builder.getUserAttributes()),St.query,St.startDate,St.endDate)});return React.createElement(React.Fragment,null,React.createElement("div",__assign({ref:mt},i.attributes,{style:__assign({opacity:bt?1:0,transition:"opacity 0.2s ease-in-out"},(b=i.attributes)===null||b===void 0?void 0:b.style),className:"builder-personalization-container ".concat(i.attributes.className).concat(bt?"":" builder-personalization-container-loading")}),It&&Builder.isEditing&&typeof i.previewingIndex=="number"&&i.previewingIndex<((($=i.variants)===null||$===void 0?void 0:$.length)||0)?React.createElement(BuilderBlocks,{blocks:(tt=(nt=i.variants)===null||nt===void 0?void 0:nt[i.previewingIndex])===null||tt===void 0?void 0:tt.blocks,parentElementId:(it=i.builderBlock)===null||it===void 0?void 0:it.id,dataPath:"component.options.variants.".concat(i.previewingIndex,".blocks"),child:!0}):It&&Builder.isEditing&&typeof i.previewingIndex!="number"||!bt||!Ht.length?React.createElement(BuilderBlocks,{blocks:(ot=i.builderBlock)===null||ot===void 0?void 0:ot.children,parentElementId:(_e=i.builderBlock)===null||_e===void 0?void 0:_e.id,dataPath:"this.children",child:!0}):React.createElement(BuilderBlocks,{blocks:(et=Ht[0])===null||et===void 0?void 0:et.blocks,parentElementId:(rt=i.builderBlock)===null||rt===void 0?void 0:rt.id,dataPath:"component.options.variants.".concat((st=i.variants)===null||st===void 0?void 0:st.indexOf(Ht[0]),".blocks"),child:!0})),React.createElement("script",{dangerouslySetInnerHTML:{__html:`
         window.__hydrated = window.__hydrated || {};
         window.__hydrated['`.concat((dt=i.builderBlock)===null||dt===void 0?void 0:dt.id,`'] = true;
        `).replace(/\s+/g," ")}}))}function getPersonalizationScript(i,e,o){return`
      (function() {
        function getCookie(name) {
          var nameEQ = name + "=";
          var ca = document.cookie.split(';');
          for(var i=0;i < ca.length;i++) {
              var c = ca[i];
              while (c.charAt(0)==' ') c = c.substring(1,c.length);
              if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
          }
          return null;
        }
        function removeVariants() {
          variants.forEach(function (template, index) {
            document.querySelector('template[data-variant-id="' + "`.concat(e,`" + index + '"]').remove();
          });
          document.getElementById('variants-script-`).concat(e,`').remove();
        }

        var attributes = JSON.parse(getCookie("`).concat(Builder.attributesCookieName,`") || "{}");
        `).concat(o?'attributes.locale = "'.concat(o,'";'):"",`
        var variants = `).concat(JSON.stringify(i==null?void 0:i.map(function(s){return{query:s.query,startDate:s.startDate,endDate:s.endDate}})),`;
        var winningVariantIndex = variants.findIndex(function(variant) {
          return filterWithCustomTargeting(
            attributes,
            variant.query,
            variant.startDate,
            variant.endDate
          );
        });
        var isDebug = location.href.includes('builder.debug=true');
        if (isDebug) {
          console.debug('PersonalizationContainer', {
            attributes: attributes,
            variants: variants,
            winningVariantIndex: winningVariantIndex,
            });
        }
        if (winningVariantIndex !== -1) {
          var winningVariant = document.querySelector('template[data-variant-id="' + "`).concat(e,`" + winningVariantIndex + '"]');
          if (winningVariant) {
            var parentNode = winningVariant.parentNode;
            var newParent = parentNode.cloneNode(false);
            newParent.appendChild(winningVariant.content.firstChild);
            parentNode.parentNode.replaceChild(newParent, parentNode);
            if (isDebug) {
              console.debug('PersonalizationContainer', 'Winning variant Replaced:', winningVariant);
            }
          }
        } else if (variants.length > 0) {
          removeVariants();
        }
        `).concat(filterWithCustomTargetingScript,`
      })();
    `).replace(/\s+/g," ")}Builder.registerComponent(PersonalizationContainer,{name:"PersonalizationContainer",noWrap:!0,friendlyName:"Dynamic Container",image:"https://cdn.builder.io/api/v1/image/assets%2FYJIGb4i01jvw0SRdL5Bt%2F37229ed30d8c41dfb10b8cca1992053a",canHaveChildren:!0,inputs:[{name:"variants",defaultValue:[],behavior:"personalizationVariantList",type:"list",subFields:[{name:"name",type:"text",localized:!1},{name:"query",friendlyName:"Targeting rules",type:"BuilderQuery",defaultValue:[],localized:!1},{name:"startDate",type:"date",localized:!1},{name:"endDate",type:"date",localized:!1},{name:"blocks",type:"UiBlocks",hideFromUI:!0,defaultValue:[]}]}]}),Builder.isReact=!0,Builder.sdkInfo={name:"react",version:SDK_VERSION};const apiKey={}.VITE_BUILDER_API_KEY||"",BUILDER_API_KEY=apiKey;function initBuilder(){return BUILDER_API_KEY?(Builder.init(BUILDER_API_KEY),console.log("Builder.io initialized with API key:",BUILDER_API_KEY),!0):(console.warn(`Builder.io API key is missing. Please add your API key to .env file:
VITE_BUILDER_API_KEY=your_builder_api_key_here`),!1)}function registerComponents(){const{default:i}=require("../components/Logo");Builder.registerComponent(i,{name:"PixCrab Logo",description:"Displays the PixCrab logo",image:"https://img.icons8.com/color/96/000000/camera.png"});const e=o=>jsxRuntimeExports.jsx("button",{className:`btn-primary ${o.className||""}`,onClick:o.onClick||(()=>console.log("Button clicked")),children:o.text||"Button"});Builder.registerComponent(e,{name:"PixCrab Button",description:"Standard PixCrab button",inputs:[{name:"text",type:"string",defaultValue:"Click Me"},{name:"className",type:"string"}]}),console.log("PixCrab components registered with Builder.io")}const builderStyles="";function BuilderPage({model:i="page"}){const[e,o]=reactExports.useState(null),[s,a]=reactExports.useState(!0),[c,d]=reactExports.useState(null),g=useParams().page||"/";reactExports.useEffect(()=>(console.log(`BuilderPage initialized for model: ${i}, path: ${g}`),console.log("Using Builder.io API key:",BUILDER_API_KEY?"Valid key set":"Missing API key"),BUILDER_API_KEY||(d("Builder.io API key is missing. Add VITE_BUILDER_API_KEY to your .env file."),a(!1)),()=>{console.log("BuilderPage unmounted")}),[i,g]);const _=j=>{console.error("Error loading Builder.io content:",j),d(`Failed to load content: ${j.message||"Unknown error"}`),a(!1)};return jsxRuntimeExports.jsxs("div",{className:"builder-page-wrapper",children:[s&&!c&&jsxRuntimeExports.jsx("div",{className:"builder-loading",children:jsxRuntimeExports.jsx("div",{className:"builder-loading-indicator",children:"Loading Builder.io content..."})}),c&&jsxRuntimeExports.jsxs("div",{className:"builder-error",children:[jsxRuntimeExports.jsx("h3",{children:"Error Loading Builder Content"}),jsxRuntimeExports.jsx("p",{children:c}),jsxRuntimeExports.jsx("a",{href:"/",className:"back-link",children:"Return to PixCrab Home"})]}),!c&&BUILDER_API_KEY&&jsxRuntimeExports.jsx(BuilderComponent,{model:i,contentLoaded:j=>{console.log("Builder content loaded:",j?"Success":"No content found"),o(j),a(!1)},contentError:_,apiKey:BUILDER_API_KEY,userAttributes:{urlPath:g}}),!s&&!e&&!c&&jsxRuntimeExports.jsxs("div",{className:"builder-no-content",children:[jsxRuntimeExports.jsx("h3",{children:"No Content Found"}),jsxRuntimeExports.jsxs("p",{children:["No Builder.io content was found for this URL: ",g]}),jsxRuntimeExports.jsx("p",{children:"You may need to create content for this page in the Builder.io dashboard."}),jsxRuntimeExports.jsxs("div",{className:"builder-actions",children:[jsxRuntimeExports.jsx("a",{href:"/builder",className:"back-link",children:"Return to Builder home"}),jsxRuntimeExports.jsx("a",{href:"/",className:"back-link",children:"Return to PixCrab Home"})]})]})]})}const PixCrabContext=reactExports.createContext(null),PixCrabProvider=({children:i,value:e})=>jsxRuntimeExports.jsx(PixCrabContext.Provider,{value:e,children:i});function App(){const[i,e]=reactExports.useState("auth"),[o,s]=reactExports.useState(null),[a,c]=reactExports.useState(null),[d,h]=reactExports.useState(!1),[g,_]=reactExports.useState(null);reactExports.useEffect(()=>{try{if(!firebase.apps.length){_("Firebase initialization failed. Please check your setup.");return}initBuilder()&&registerComponents(),h(!0)}catch(et){console.error("Error initializing app:",et),_("Failed to initialize the application. Please try again later.")}},[]),reactExports.useEffect(()=>{if(!d)return;const et=auth.onAuthStateChanged(dt=>{s(dt),e(dt?"session":"auth")}),st=new URLSearchParams(window.location.search).get("sessionId");return st&&c(st),()=>et()},[d]);const j=et=>{c(et),e("camera")},b=et=>{c(et),e("camera")},$=()=>{c(null),e("session")},nt=()=>{e("album")},tt=()=>{e("session")},it=async()=>{try{await auth.signOut(),e("auth"),c(null)}catch(et){console.error("Error signing out:",et)}};if(g)return jsxRuntimeExports.jsx("div",{className:"app-container",children:jsxRuntimeExports.jsx("div",{className:"error",children:g})});if(!d)return jsxRuntimeExports.jsx("div",{className:"app-container",children:jsxRuntimeExports.jsx("div",{children:"Loading..."})});const ot=window.location.pathname.startsWith("/builder"),_e=jsxRuntimeExports.jsx(PixCrabProvider,{value:{user:o,sessionId:a},children:jsxRuntimeExports.jsxs("div",{className:`app-container ${i==="camera"?"camera-mode":""}`,children:[i!=="camera"&&jsxRuntimeExports.jsx("div",{className:"flex justify-center items-center w-full mb-4",children:jsxRuntimeExports.jsx(Logo,{})}),i==="auth"&&jsxRuntimeExports.jsx(AuthScreen,{onCreateSession:j,onJoinSession:b,onSignOut:it}),i==="session"&&jsxRuntimeExports.jsx(SessionSetup,{onCreateSession:j,onJoinSession:b,onSignOut:it,onViewAlbum:nt,initialSessionId:a}),i==="camera"&&jsxRuntimeExports.jsx(CameraScreen,{sessionId:a,onExitSession:$,onSignOut:it}),i==="album"&&jsxRuntimeExports.jsx(AlbumScreen,{onCreateSession:j,onReturn:tt})]})});return ot?jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/builder",element:jsxRuntimeExports.jsx(BuilderPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/builder/:page",element:jsxRuntimeExports.jsx(BuilderPage,{})}),jsxRuntimeExports.jsx(Route,{path:"*",element:_e})]})}):_e}const index="";client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
//# sourceMappingURL=main-ad115916.js.map
